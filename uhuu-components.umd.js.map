{"version":3,"file":"uhuu-components.umd.js","sources":["../node_modules/pagedjs/src/utils/utils.js","../node_modules/pagedjs/src/utils/dom.js","../node_modules/pagedjs/src/chunker/breaktoken.js","../node_modules/pagedjs/src/chunker/renderresult.js","../node_modules/type/value/is.js","../node_modules/type/object/is.js","../node_modules/type/prototype/is.js","../node_modules/type/function/is.js","../node_modules/type/plain-function/is.js","../node_modules/es5-ext/object/assign/is-implemented.js","../node_modules/es5-ext/object/keys/is-implemented.js","../node_modules/es5-ext/function/noop.js","../node_modules/es5-ext/object/is-value.js","../node_modules/es5-ext/object/keys/shim.js","../node_modules/es5-ext/object/keys/index.js","../node_modules/es5-ext/object/valid-value.js","../node_modules/es5-ext/object/assign/shim.js","../node_modules/es5-ext/object/assign/index.js","../node_modules/es5-ext/object/normalize-options.js","../node_modules/es5-ext/string/#/contains/is-implemented.js","../node_modules/es5-ext/string/#/contains/shim.js","../node_modules/es5-ext/string/#/contains/index.js","../node_modules/d/index.js","../node_modules/es5-ext/object/valid-callable.js","../node_modules/event-emitter/index.js","../node_modules/pagedjs/src/utils/hook.js","../node_modules/pagedjs/src/chunker/layout.js","../node_modules/pagedjs/src/chunker/page.js","../node_modules/pagedjs/src/chunker/parser.js","../node_modules/pagedjs/src/utils/queue.js","../node_modules/pagedjs/src/chunker/chunker.js","../node_modules/css-tree/lib/common/List.js","../node_modules/css-tree/lib/utils/createCustomError.js","../node_modules/css-tree/lib/common/SyntaxError.js","../node_modules/css-tree/lib/tokenizer/const.js","../node_modules/css-tree/lib/tokenizer/char-code-definitions.js","../node_modules/css-tree/lib/tokenizer/utils.js","../node_modules/css-tree/lib/common/TokenStream.js","../node_modules/css-tree/lib/definition-syntax/generate.js","../node_modules/css-tree/lib/lexer/error.js","../node_modules/css-tree/lib/utils/names.js","../node_modules/css-tree/lib/common/adopt-buffer.js","../node_modules/css-tree/lib/tokenizer/index.js","../node_modules/css-tree/lib/lexer/generic-an-plus-b.js","../node_modules/css-tree/lib/lexer/generic-urange.js","../node_modules/css-tree/lib/lexer/generic.js","../node_modules/css-tree/lib/definition-syntax/SyntaxError.js","../node_modules/css-tree/lib/definition-syntax/tokenizer.js","../node_modules/css-tree/lib/definition-syntax/parse.js","../node_modules/css-tree/lib/definition-syntax/walk.js","../node_modules/css-tree/lib/lexer/prepare-tokens.js","../node_modules/css-tree/lib/lexer/match-graph.js","../node_modules/css-tree/lib/lexer/match.js","../node_modules/css-tree/lib/lexer/trace.js","../node_modules/css-tree/lib/lexer/search.js","../node_modules/css-tree/lib/lexer/structure.js","../node_modules/css-tree/lib/lexer/Lexer.js","../node_modules/css-tree/lib/definition-syntax/index.js","../node_modules/css-tree/lib/common/OffsetToLocation.js","../node_modules/css-tree/lib/parser/sequence.js","../node_modules/css-tree/lib/parser/create.js","../node_modules/source-map/lib/base64.js","../node_modules/source-map/lib/base64-vlq.js","../node_modules/source-map/lib/util.js","../node_modules/source-map/lib/array-set.js","../node_modules/source-map/lib/mapping-list.js","../node_modules/source-map/lib/source-map-generator.js","../node_modules/css-tree/lib/generator/sourceMap.js","../node_modules/css-tree/lib/generator/create.js","../node_modules/css-tree/lib/convertor/create.js","../node_modules/css-tree/lib/walker/create.js","../node_modules/css-tree/lib/utils/clone.js","../node_modules/css-tree/lib/syntax/config/mix.js","../node_modules/css-tree/lib/syntax/create.js","../node_modules/css-tree/data/index.js","../node_modules/css-tree/lib/syntax/node/AnPlusB.js","../node_modules/css-tree/lib/syntax/node/Raw.js","../node_modules/css-tree/lib/syntax/node/Atrule.js","../node_modules/css-tree/lib/syntax/node/AtrulePrelude.js","../node_modules/css-tree/lib/syntax/node/AttributeSelector.js","../node_modules/css-tree/lib/syntax/node/Block.js","../node_modules/css-tree/lib/syntax/node/Brackets.js","../node_modules/css-tree/lib/syntax/node/CDC.js","../node_modules/css-tree/lib/syntax/node/CDO.js","../node_modules/css-tree/lib/syntax/node/ClassSelector.js","../node_modules/css-tree/lib/syntax/node/Combinator.js","../node_modules/css-tree/lib/syntax/node/Comment.js","../node_modules/css-tree/lib/syntax/node/Declaration.js","../node_modules/css-tree/lib/syntax/node/DeclarationList.js","../node_modules/css-tree/lib/syntax/node/Dimension.js","../node_modules/css-tree/lib/syntax/node/Function.js","../node_modules/css-tree/lib/syntax/node/Hash.js","../node_modules/css-tree/lib/syntax/node/Identifier.js","../node_modules/css-tree/lib/syntax/node/IdSelector.js","../node_modules/css-tree/lib/syntax/node/MediaFeature.js","../node_modules/css-tree/lib/syntax/node/MediaQuery.js","../node_modules/css-tree/lib/syntax/node/MediaQueryList.js","../node_modules/css-tree/lib/syntax/node/Nth.js","../node_modules/css-tree/lib/syntax/node/Number.js","../node_modules/css-tree/lib/syntax/node/Operator.js","../node_modules/css-tree/lib/syntax/node/Parentheses.js","../node_modules/css-tree/lib/syntax/node/Percentage.js","../node_modules/css-tree/lib/syntax/node/PseudoClassSelector.js","../node_modules/css-tree/lib/syntax/node/PseudoElementSelector.js","../node_modules/css-tree/lib/syntax/node/Ratio.js","../node_modules/css-tree/lib/syntax/node/Rule.js","../node_modules/css-tree/lib/syntax/node/Selector.js","../node_modules/css-tree/lib/syntax/node/SelectorList.js","../node_modules/css-tree/lib/syntax/node/String.js","../node_modules/css-tree/lib/syntax/node/StyleSheet.js","../node_modules/css-tree/lib/syntax/node/TypeSelector.js","../node_modules/css-tree/lib/syntax/node/UnicodeRange.js","../node_modules/css-tree/lib/syntax/node/Url.js","../node_modules/css-tree/lib/syntax/node/Value.js","../node_modules/css-tree/lib/syntax/node/WhiteSpace.js","../node_modules/css-tree/lib/syntax/node/index.js","../node_modules/css-tree/lib/syntax/config/lexer.js","../node_modules/css-tree/lib/syntax/scope/default.js","../node_modules/css-tree/lib/syntax/scope/atrulePrelude.js","../node_modules/css-tree/lib/syntax/scope/selector.js","../node_modules/css-tree/lib/syntax/function/expression.js","../node_modules/css-tree/lib/syntax/function/var.js","../node_modules/css-tree/lib/syntax/scope/value.js","../node_modules/css-tree/lib/syntax/scope/index.js","../node_modules/css-tree/lib/syntax/atrule/font-face.js","../node_modules/css-tree/lib/syntax/atrule/import.js","../node_modules/css-tree/lib/syntax/atrule/media.js","../node_modules/css-tree/lib/syntax/atrule/page.js","../node_modules/css-tree/lib/syntax/atrule/supports.js","../node_modules/css-tree/lib/syntax/atrule/index.js","../node_modules/css-tree/lib/syntax/pseudo/dir.js","../node_modules/css-tree/lib/syntax/pseudo/has.js","../node_modules/css-tree/lib/syntax/pseudo/lang.js","../node_modules/css-tree/lib/syntax/pseudo/common/selectorList.js","../node_modules/css-tree/lib/syntax/pseudo/matches.js","../node_modules/css-tree/lib/syntax/pseudo/not.js","../node_modules/css-tree/lib/syntax/pseudo/common/nthWithOfClause.js","../node_modules/css-tree/lib/syntax/pseudo/nth-child.js","../node_modules/css-tree/lib/syntax/pseudo/nth-last-child.js","../node_modules/css-tree/lib/syntax/pseudo/common/nth.js","../node_modules/css-tree/lib/syntax/pseudo/nth-last-of-type.js","../node_modules/css-tree/lib/syntax/pseudo/nth-of-type.js","../node_modules/css-tree/lib/syntax/pseudo/slotted.js","../node_modules/css-tree/lib/syntax/pseudo/index.js","../node_modules/css-tree/lib/syntax/config/parser.js","../node_modules/css-tree/lib/syntax/config/walker.js","../node_modules/css-tree/lib/syntax/index.js","../node_modules/css-tree/lib/index.js","../node_modules/pagedjs/src/polisher/sheet.js","../node_modules/pagedjs/src/polisher/base.js","../node_modules/pagedjs/src/utils/request.js","../node_modules/pagedjs/src/polisher/polisher.js","../node_modules/pagedjs/src/modules/handler.js","../node_modules/pagedjs/src/polisher/sizes.js","../node_modules/pagedjs/src/modules/paged-media/atpage.js","../node_modules/pagedjs/src/modules/paged-media/breaks.js","../node_modules/pagedjs/src/modules/paged-media/print-media.js","../node_modules/pagedjs/src/modules/paged-media/splits.js","../node_modules/pagedjs/src/modules/paged-media/counters.js","../node_modules/pagedjs/src/modules/paged-media/lists.js","../node_modules/pagedjs/src/modules/paged-media/position-fixed.js","../node_modules/pagedjs/src/modules/paged-media/page-counter-increment.js","../node_modules/pagedjs/src/modules/paged-media/nth-of-type.js","../node_modules/pagedjs/src/modules/paged-media/following.js","../node_modules/pagedjs/src/modules/paged-media/footnotes.js","../node_modules/pagedjs/src/modules/paged-media/index.js","../node_modules/pagedjs/src/modules/generated-content/running-headers.js","../node_modules/pagedjs/src/utils/css.js","../node_modules/pagedjs/src/modules/generated-content/string-sets.js","../node_modules/pagedjs/src/modules/generated-content/target-counters.js","../node_modules/pagedjs/src/modules/generated-content/target-text.js","../node_modules/pagedjs/src/modules/generated-content/index.js","../node_modules/pagedjs/src/modules/filters/whitespace.js","../node_modules/pagedjs/src/modules/filters/comments.js","../node_modules/pagedjs/src/modules/filters/scripts.js","../node_modules/clear-cut/index.js","../node_modules/pagedjs/src/modules/filters/undisplayed.js","../node_modules/pagedjs/src/modules/filters/index.js","../node_modules/es5-ext/array/from/is-implemented.js","../node_modules/ext/global-this/is-implemented.js","../node_modules/ext/global-this/implementation.js","../node_modules/ext/global-this/index.js","../node_modules/es6-symbol/is-implemented.js","../node_modules/es6-symbol/is-symbol.js","../node_modules/es6-symbol/validate-symbol.js","../node_modules/es6-symbol/lib/private/generate-name.js","../node_modules/es6-symbol/lib/private/setup/standard-symbols.js","../node_modules/es6-symbol/lib/private/setup/symbol-registry.js","../node_modules/es6-symbol/polyfill.js","../node_modules/es6-symbol/index.js","../node_modules/es5-ext/function/is-arguments.js","../node_modules/es5-ext/function/is-function.js","../node_modules/es5-ext/math/sign/is-implemented.js","../node_modules/es5-ext/math/sign/shim.js","../node_modules/es5-ext/math/sign/index.js","../node_modules/es5-ext/number/to-integer.js","../node_modules/es5-ext/number/to-pos-integer.js","../node_modules/es5-ext/string/is-string.js","../node_modules/es5-ext/array/from/shim.js","../node_modules/es5-ext/array/from/index.js","../node_modules/es5-ext/number/is-nan/is-implemented.js","../node_modules/es5-ext/number/is-nan/shim.js","../node_modules/es5-ext/number/is-nan/index.js","../node_modules/es5-ext/array/#/e-index-of.js","../node_modules/es5-ext/array/#/remove.js","../node_modules/es5-ext/object/is-object.js","../node_modules/es5-ext/object/valid-object.js","../node_modules/event-emitter/pipe.js","../node_modules/pagedjs/src/utils/handlers.js","../node_modules/pagedjs/src/polyfill/previewer.js","../node_modules/lodash/isObject.js","../node_modules/lodash/_freeGlobal.js","../node_modules/lodash/_root.js","../node_modules/lodash/now.js","../node_modules/lodash/_trimmedEndIndex.js","../node_modules/lodash/_baseTrim.js","../node_modules/lodash/_Symbol.js","../node_modules/lodash/_getRawTag.js","../node_modules/lodash/_objectToString.js","../node_modules/lodash/_baseGetTag.js","../node_modules/lodash/isObjectLike.js","../node_modules/lodash/isSymbol.js","../node_modules/lodash/toNumber.js","../node_modules/lodash/debounce.js","../src/uhuu/pagination-dynamic/pagination/DocumentUtils.ts","../src/uhuu/utility/PageSizeUtils.js","../src/uhuu/config/config-provider.tsx","../src/uhuu/pagination-dynamic/pagination-dynamic.tsx","../src/uhuu/pagination-dynamic/sheet-dynamic.tsx","../src/uhuu/pagination-static/pagination/CompatibilityUtils.ts","../src/uhuu/pagination-static/pagination/DocumentUtils.ts","../src/uhuu/pagination-static/pagination-static.tsx","../src/uhuu/pagination-static/sheet-static.tsx","../src/uhuu/editable/dialog-props.js","../src/uhuu/image/image-bleed.tsx","../src/uhuu/image/image-spread.tsx","../src/uhuu/editable/editable.tsx","../src/PagedPreview.jsx","../src/index.js"],"sourcesContent":["export function getBoundingClientRect(element) {\n\tif (!element) {\n\t\treturn;\n\t}\n\tlet rect;\n\tif (typeof element.getBoundingClientRect !== \"undefined\") {\n\t\trect = element.getBoundingClientRect();\n\t} else {\n\t\tlet range = document.createRange();\n\t\trange.selectNode(element);\n\t\trect = range.getBoundingClientRect();\n\t}\n\treturn rect;\n}\n\nexport function getClientRects(element) {\n\tif (!element) {\n\t\treturn;\n\t}\n\tlet rect;\n\tif (typeof element.getClientRects !== \"undefined\") {\n\t\trect = element.getClientRects();\n\t} else {\n\t\tlet range = document.createRange();\n\t\trange.selectNode(element);\n\t\trect = range.getClientRects();\n\t}\n\treturn rect;\n}\n\n/**\n * Generates a UUID\n * based on: http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript\n * @returns {string} uuid\n */\nexport function UUID() {\n\tvar d = new Date().getTime();\n\tif (typeof performance !== \"undefined\" && typeof performance.now === \"function\") {\n\t\td += performance.now(); //use high-precision timer if available\n\t}\n\treturn \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, function (c) {\n\t\tvar r = (d + Math.random() * 16) % 16 | 0;\n\t\td = Math.floor(d / 16);\n\t\treturn (c === \"x\" ? r : (r & 0x3 | 0x8)).toString(16);\n\t});\n}\n\n// From: https://hg.mozilla.org/mozilla-central/file/tip/toolkit/modules/css-selector.js#l52\n\n/**\n * Find the position of [element] in [nodeList].\n * @param {Element} element to check\n * @param {NodeList} nodeList to find in\n * @returns {int} an index of the match, or -1 if there is no match\n */\nexport function positionInNodeList(element, nodeList) {\n\tfor (let i = 0; i < nodeList.length; i++) {\n\t\tif (element === nodeList[i]) {\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn -1;\n}\n\n/**\n * Find a unique CSS selector for a given element\n * @param {Element} ele to check\n * @returns {string} a string such that ele.ownerDocument.querySelector(reply) === ele\n * and ele.ownerDocument.querySelectorAll(reply).length === 1\n */\nexport function findCssSelector(ele) {\n\tlet document = ele.ownerDocument;\n\t// Fred: commented out to allow for parsing in fragments\n\t// if (!document || !document.contains(ele)) {\n\t//   throw new Error(\"findCssSelector received element not inside document\");\n\t// }\n\n\tlet cssEscape = window.CSS.escape;\n\n\t// document.querySelectorAll(\"#id\") returns multiple if elements share an ID\n\tif (ele.id &&\n\t\tdocument.querySelectorAll(\"#\" + cssEscape(ele.id)).length === 1) {\n\t\treturn \"#\" + cssEscape(ele.id);\n\t}\n\n\t// Inherently unique by tag name\n\tlet tagName = ele.localName;\n\tif (tagName === \"html\") {\n\t\treturn \"html\";\n\t}\n\tif (tagName === \"head\") {\n\t\treturn \"head\";\n\t}\n\tif (tagName === \"body\") {\n\t\treturn \"body\";\n\t}\n\n\t// We might be able to find a unique class name\n\tlet selector, index, matches;\n\tif (ele.classList.length > 0) {\n\t\tfor (let i = 0; i < ele.classList.length; i++) {\n\t\t\t// Is this className unique by itself?\n\t\t\tselector = \".\" + cssEscape(ele.classList.item(i));\n\t\t\tmatches = document.querySelectorAll(selector);\n\t\t\tif (matches.length === 1) {\n\t\t\t\treturn selector;\n\t\t\t}\n\t\t\t// Maybe it's unique with a tag name?\n\t\t\tselector = cssEscape(tagName) + selector;\n\t\t\tmatches = document.querySelectorAll(selector);\n\t\t\tif (matches.length === 1) {\n\t\t\t\treturn selector;\n\t\t\t}\n\t\t\t// Maybe it's unique using a tag name and nth-child\n\t\t\tindex = positionInNodeList(ele, ele.parentNode.children) + 1;\n\t\t\tselector = selector + \":nth-child(\" + index + \")\";\n\t\t\tmatches = document.querySelectorAll(selector);\n\t\t\tif (matches.length === 1) {\n\t\t\t\treturn selector;\n\t\t\t}\n\t\t}\n\t}\n\n\t// Not unique enough yet.  As long as it's not a child of the document,\n\t// continue recursing up until it is unique enough.\n\tif (ele.parentNode !== document && ele.parentNode.nodeType === 1) {\n\t\tindex = positionInNodeList(ele, ele.parentNode.children) + 1;\n\t\tselector = findCssSelector(ele.parentNode) + \" > \" +\n\t\t\tcssEscape(tagName) + \":nth-child(\" + index + \")\";\n\t}\n\n\treturn selector;\n}\n\nexport function attr(element, attributes) {\n\tfor (var i = 0; i < attributes.length; i++) {\n\t\tif (element.hasAttribute(attributes[i])) {\n\t\t\treturn element.getAttribute(attributes[i]);\n\t\t}\n\t}\n}\n\n/* Based on by https://mths.be/cssescape v1.5.1 by @mathias | MIT license\n * Allows # and .\n */\nexport function querySelectorEscape(value) {\n\tif (arguments.length == 0) {\n\t\tthrow new TypeError(\"`CSS.escape` requires an argument.\");\n\t}\n\tvar string = String(value);\n\n\tvar length = string.length;\n\tvar index = -1;\n\tvar codeUnit;\n\tvar result = \"\";\n\tvar firstCodeUnit = string.charCodeAt(0);\n\twhile (++index < length) {\n\t\tcodeUnit = string.charCodeAt(index);\n\n\n\n\t\t// Note: there’s no need to special-case astral symbols, surrogate\n\t\t// pairs, or lone surrogates.\n\n\t\t// If the character is NULL (U+0000), then the REPLACEMENT CHARACTER\n\t\t// (U+FFFD).\n\t\tif (codeUnit == 0x0000) {\n\t\t\tresult += \"\\uFFFD\";\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (\n\t\t\t// If the character is in the range [\\1-\\1F] (U+0001 to U+001F) or is\n\t\t\t// U+007F, […]\n\t\t\t(codeUnit >= 0x0001 && codeUnit <= 0x001F) || codeUnit == 0x007F ||\n\t\t\t// If the character is the first character and is in the range [0-9]\n\t\t\t// (U+0030 to U+0039), […]\n\t\t\t(index == 0 && codeUnit >= 0x0030 && codeUnit <= 0x0039) ||\n\t\t\t// If the character is the second character and is in the range [0-9]\n\t\t\t// (U+0030 to U+0039) and the first character is a `-` (U+002D), […]\n\t\t\t(\n\t\t\t\tindex == 1 &&\n\t\t\t\tcodeUnit >= 0x0030 && codeUnit <= 0x0039 &&\n\t\t\t\tfirstCodeUnit == 0x002D\n\t\t\t)\n\t\t) {\n\t\t\t// https://drafts.csswg.org/cssom/#escape-a-character-as-code-point\n\t\t\tresult += \"\\\\\" + codeUnit.toString(16) + \" \";\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (\n\t\t\t// If the character is the first character and is a `-` (U+002D), and\n\t\t\t// there is no second character, […]\n\t\t\tindex == 0 &&\n\t\t\tlength == 1 &&\n\t\t\tcodeUnit == 0x002D\n\t\t) {\n\t\t\tresult += \"\\\\\" + string.charAt(index);\n\t\t\tcontinue;\n\t\t}\n\n\t\t// support for period character in id\n\t\tif (codeUnit == 0x002E) {\n\t\t\tif (string.charAt(0) == \"#\") {\n\t\t\t\tresult += \"\\\\.\";\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\n\t\t// If the character is not handled by one of the above rules and is\n\t\t// greater than or equal to U+0080, is `-` (U+002D) or `_` (U+005F), or\n\t\t// is in one of the ranges [0-9] (U+0030 to U+0039), [A-Z] (U+0041 to\n\t\t// U+005A), or [a-z] (U+0061 to U+007A), […]\n\t\tif (\n\t\t\tcodeUnit >= 0x0080 ||\n\t\t\tcodeUnit == 0x002D ||\n\t\t\tcodeUnit == 0x005F ||\n\t\t\tcodeUnit == 35 || // Allow #\n\t\t\tcodeUnit == 46 || // Allow .\n\t\t\tcodeUnit >= 0x0030 && codeUnit <= 0x0039 ||\n\t\t\tcodeUnit >= 0x0041 && codeUnit <= 0x005A ||\n\t\t\tcodeUnit >= 0x0061 && codeUnit <= 0x007A\n\t\t) {\n\t\t\t// the character itself\n\t\t\tresult += string.charAt(index);\n\t\t\tcontinue;\n\t\t}\n\n\t\t// Otherwise, the escaped character.\n\t\t// https://drafts.csswg.org/cssom/#escape-a-character\n\t\tresult += \"\\\\\" + string.charAt(index);\n\n\t}\n\treturn result;\n}\n\n/**\n * Creates a new pending promise and provides methods to resolve or reject it.\n * From: https://developer.mozilla.org/en-US/docs/Mozilla/JavaScript_code_modules/Promise.jsm/Deferred#backwards_forwards_compatible\n * @returns {object} defered\n */\nexport function defer() {\n\tthis.resolve = null;\n\n\tthis.reject = null;\n\n\tthis.id = UUID();\n\n\tthis.promise = new Promise((resolve, reject) => {\n\t\tthis.resolve = resolve;\n\t\tthis.reject = reject;\n\t});\n\tObject.freeze(this);\n}\n\nexport const requestIdleCallback = typeof window !== \"undefined\" && (\"requestIdleCallback\" in window ? window.requestIdleCallback : window.requestAnimationFrame);\n\nexport function CSSValueToString(obj) {\n\treturn obj.value + (obj.unit || \"\");\n}","export function isElement(node) {\n\treturn node && node.nodeType === 1;\n}\n\nexport function isText(node) {\n\treturn node && node.nodeType === 3;\n}\n\nexport function* walk(start, limiter) {\n\tlet node = start;\n\n\twhile (node) {\n\n\t\tyield node;\n\n\t\tif (node.childNodes.length) {\n\t\t\tnode = node.firstChild;\n\t\t} else if (node.nextSibling) {\n\t\t\tif (limiter && node === limiter) {\n\t\t\t\tnode = undefined;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tnode = node.nextSibling;\n\t\t} else {\n\t\t\twhile (node) {\n\t\t\t\tnode = node.parentNode;\n\t\t\t\tif (limiter && node === limiter) {\n\t\t\t\t\tnode = undefined;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (node && node.nextSibling) {\n\t\t\t\t\tnode = node.nextSibling;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function nodeAfter(node, limiter) {\n\tif (limiter && node === limiter) {\n\t\treturn;\n\t}\n\tlet significantNode = nextSignificantNode(node);\n\tif (significantNode) {\n\t\treturn significantNode;\n\t}\n\tif (node.parentNode) {\n\t\twhile ((node = node.parentNode)) {\n\t\t\tif (limiter && node === limiter) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsignificantNode = nextSignificantNode(node);\n\t\t\tif (significantNode) {\n\t\t\t\treturn significantNode;\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function nodeBefore(node, limiter) {\n\tif (limiter && node === limiter) {\n\t\treturn;\n\t}\n\tlet significantNode = previousSignificantNode(node);\n\tif (significantNode) {\n\t\treturn significantNode;\n\t}\n\tif (node.parentNode) {\n\t\twhile ((node = node.parentNode)) {\n\t\t\tif (limiter && node === limiter) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsignificantNode = previousSignificantNode(node);\n\t\t\tif (significantNode) {\n\t\t\t\treturn significantNode;\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function elementAfter(node, limiter) {\n\tlet after = nodeAfter(node, limiter);\n\n\twhile (after && after.nodeType !== 1) {\n\t\tafter = nodeAfter(after, limiter);\n\t}\n\n\treturn after;\n}\n\nexport function elementBefore(node, limiter) {\n\tlet before = nodeBefore(node, limiter);\n\n\twhile (before && before.nodeType !== 1) {\n\t\tbefore = nodeBefore(before, limiter);\n\t}\n\n\treturn before;\n}\n\nexport function displayedElementAfter(node, limiter) {\n\tlet after = elementAfter(node, limiter);\n\n\twhile (after && after.dataset.undisplayed) {\n\t\tafter = elementAfter(after, limiter);\n\t}\n\n\treturn after;\n}\n\nexport function displayedElementBefore(node, limiter) {\n\tlet before = elementBefore(node, limiter);\n\n\twhile (before && before.dataset.undisplayed) {\n\t\tbefore = elementBefore(before, limiter);\n\t}\n\n\treturn before;\n}\n\nexport function stackChildren(currentNode, stacked) {\n\tlet stack = stacked || [];\n\n\tstack.unshift(currentNode);\n\n\tlet children = currentNode.children;\n\tfor (var i = 0, length = children.length; i < length; i++) {\n\t\tstackChildren(children[i], stack);\n\t}\n\n\treturn stack;\n}\n\nexport function rebuildAncestors(node) {\n\tlet parent, ancestor;\n\tlet ancestors = [];\n\tlet added = [];\n\n\tlet fragment = document.createDocumentFragment();\n\n\t// Handle rowspan on table\n\tif (node.nodeName === \"TR\") {\n\t\tlet previousRow = node.previousElementSibling;\n\t\tlet previousRowDistance = 1;\n\t\twhile (previousRow) {\n\t\t\t// previous row has more columns, might indicate a rowspan.\n\t\t\tif (previousRow.childElementCount > node.childElementCount) {\n\t\t\t\tconst initialColumns = Array.from(node.children);\n\t\t\t\twhile (node.firstChild) {\n\t\t\t\t\tnode.firstChild.remove();\n\t\t\t\t}\n\t\t\t\tlet k = 0;\n\t\t\t\tfor (let j = 0; j < previousRow.children.length; j++) {\n\t\t\t\t\tlet column = previousRow.children[j];\n\t\t\t\t\tif (column.rowSpan && column.rowSpan > previousRowDistance) {\n\t\t\t\t\t\tconst duplicatedColumn = column.cloneNode(true);\n\t\t\t\t\t\t// Adjust rowspan value\n\t\t\t\t\t\tduplicatedColumn.rowSpan = column.rowSpan - previousRowDistance;\n\t\t\t\t\t\t// Add the column to the row\n\t\t\t\t\t\tnode.appendChild(duplicatedColumn);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Fill the gap with the initial columns (if exists)\n\t\t\t\t\t\tconst initialColumn = initialColumns[k++];\n\t\t\t\t\t\t// The initial column can be undefined if the newly created table has less columns than the original table\n\t\t\t\t\t\tif (initialColumn) {\n\t\t\t\t\t\t\tnode.appendChild(initialColumn);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tpreviousRow = previousRow.previousElementSibling;\n\t\t\tpreviousRowDistance++;\n\t\t}\n\t}\n\n\t// Gather all ancestors\n\tlet element = node;\n\twhile(element.parentNode && element.parentNode.nodeType === 1) {\n\t\tancestors.unshift(element.parentNode);\n\t\telement = element.parentNode;\n\t}\n\n\tfor (var i = 0; i < ancestors.length; i++) {\n\t\tancestor = ancestors[i];\n\t\tparent = ancestor.cloneNode(false);\n\t\n\t\tparent.setAttribute(\"data-split-from\", parent.getAttribute(\"data-ref\"));\n\t\t// ancestor.setAttribute(\"data-split-to\", parent.getAttribute(\"data-ref\"));\n\n\t\tif (parent.hasAttribute(\"id\")) {\n\t\t\tlet dataID = parent.getAttribute(\"id\");\n\t\t\tparent.setAttribute(\"data-id\", dataID);\n\t\t\tparent.removeAttribute(\"id\");\n\t\t}\n\n\t\t// This is handled by css :not, but also tidied up here\n\t\tif (parent.hasAttribute(\"data-break-before\")) {\n\t\t\tparent.removeAttribute(\"data-break-before\");\n\t\t}\n\n\t\tif (parent.hasAttribute(\"data-previous-break-after\")) {\n\t\t\tparent.removeAttribute(\"data-previous-break-after\");\n\t\t}\n\n\t\tif (added.length) {\n\t\t\tlet container = added[added.length-1];\n\t\t\tcontainer.appendChild(parent);\n\t\t} else {\n\t\t\tfragment.appendChild(parent);\n\t\t}\n\t\tadded.push(parent);\n\n\t\t// rebuild table rows\n\t\tif (parent.nodeName === \"TD\" && ancestor.parentElement.contains(ancestor)) {\n\t\t\tlet td = ancestor;\n\t\t\tlet prev = parent;\n\t\t\twhile ((td = td.previousElementSibling)) {\n\t\t\t\tlet sib = td.cloneNode(false);\n\t\t\t\tparent.parentElement.insertBefore(sib, prev);\n\t\t\t\tprev = sib;\n\t\t\t}\n\t\t\t\n\t\t}\n\t}\n\n\tadded = undefined;\n\treturn fragment;\n}\n/*\nexport function split(bound, cutElement, breakAfter) {\n\t\tlet needsRemoval = [];\n\t\tlet index = indexOf(cutElement);\n\n\t\tif (!breakAfter && index === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (breakAfter && index === (cutElement.parentNode.children.length - 1)) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Create a fragment with rebuilt ancestors\n\t\tlet fragment = rebuildAncestors(cutElement);\n\n\t\t// Clone cut\n\t\tif (!breakAfter) {\n\t\t\tlet clone = cutElement.cloneNode(true);\n\t\t\tlet ref = cutElement.parentNode.getAttribute('data-ref');\n\t\t\tlet parent = fragment.querySelector(\"[data-ref='\" + ref + \"']\");\n\t\t\tparent.appendChild(clone);\n\t\t\tneedsRemoval.push(cutElement);\n\t\t}\n\n\t\t// Remove all after cut\n\t\tlet next = nodeAfter(cutElement, bound);\n\t\twhile (next) {\n\t\t\tlet clone = next.cloneNode(true);\n\t\t\tlet ref = next.parentNode.getAttribute('data-ref');\n\t\t\tlet parent = fragment.querySelector(\"[data-ref='\" + ref + \"']\");\n\t\t\tparent.appendChild(clone);\n\t\t\tneedsRemoval.push(next);\n\t\t\tnext = nodeAfter(next, bound);\n\t\t}\n\n\t\t// Remove originals\n\t\tneedsRemoval.forEach((node) => {\n\t\t\tif (node) {\n\t\t\t\tnode.remove();\n\t\t\t}\n\t\t});\n\n\t\t// Insert after bounds\n\t\tbound.parentNode.insertBefore(fragment, bound.nextSibling);\n\t\treturn [bound, bound.nextSibling];\n}\n*/\n\nexport function needsBreakBefore(node) {\n\tif( typeof node !== \"undefined\" &&\n\t\t\ttypeof node.dataset !== \"undefined\" &&\n\t\t\ttypeof node.dataset.breakBefore !== \"undefined\" &&\n\t\t\t(node.dataset.breakBefore === \"always\" ||\n\t\t\t node.dataset.breakBefore === \"page\" ||\n\t\t\t node.dataset.breakBefore === \"left\" ||\n\t\t\t node.dataset.breakBefore === \"right\" ||\n\t\t\t node.dataset.breakBefore === \"recto\" ||\n\t\t\t node.dataset.breakBefore === \"verso\")\n\t\t ) {\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n\nexport function needsBreakAfter(node) {\n\tif( typeof node !== \"undefined\" &&\n\t\t\ttypeof node.dataset !== \"undefined\" &&\n\t\t\ttypeof node.dataset.breakAfter !== \"undefined\" &&\n\t\t\t(node.dataset.breakAfter === \"always\" ||\n\t\t\t node.dataset.breakAfter === \"page\" ||\n\t\t\t node.dataset.breakAfter === \"left\" ||\n\t\t\t node.dataset.breakAfter === \"right\" ||\n\t\t\t node.dataset.breakAfter === \"recto\" ||\n\t\t\t node.dataset.breakAfter === \"verso\")\n\t\t ) {\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n\nexport function needsPreviousBreakAfter(node) {\n\tif( typeof node !== \"undefined\" &&\n\t\t\ttypeof node.dataset !== \"undefined\" &&\n\t\t\ttypeof node.dataset.previousBreakAfter !== \"undefined\" &&\n\t\t\t(node.dataset.previousBreakAfter === \"always\" ||\n\t\t\t node.dataset.previousBreakAfter === \"page\" ||\n\t\t\t node.dataset.previousBreakAfter === \"left\" ||\n\t\t\t node.dataset.previousBreakAfter === \"right\" ||\n\t\t\t node.dataset.previousBreakAfter === \"recto\" ||\n\t\t\t node.dataset.previousBreakAfter === \"verso\")\n\t\t ) {\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n\nexport function needsPageBreak(node, previousSignificantNode) {\n\tif (typeof node === \"undefined\" || !previousSignificantNode || isIgnorable(node)) {\n\t\treturn false;\n\t}\n\tif (node.dataset && node.dataset.undisplayed) {\n\t\treturn false;\n\t}\n\tlet previousSignificantNodePage = previousSignificantNode.dataset ? previousSignificantNode.dataset.page : undefined;\n\tif (typeof previousSignificantNodePage === \"undefined\") {\n\t\tconst nodeWithNamedPage = getNodeWithNamedPage(previousSignificantNode);\n\t\tif (nodeWithNamedPage) {\n\t\t\tpreviousSignificantNodePage = nodeWithNamedPage.dataset.page;\n\t\t}\n\t}\n\tlet currentNodePage = node.dataset ? node.dataset.page : undefined;\n\tif (typeof currentNodePage === \"undefined\") {\n\t\tconst nodeWithNamedPage = getNodeWithNamedPage(node, previousSignificantNode);\n\t\tif (nodeWithNamedPage) {\n\t\t\tcurrentNodePage = nodeWithNamedPage.dataset.page;\n\t\t}\n\t}\n\treturn currentNodePage !== previousSignificantNodePage;\n}\n\nexport function *words(node) {\n\tlet currentText = node.nodeValue;\n\tlet max = currentText.length;\n\tlet currentOffset = 0;\n\tlet currentLetter;\n\n\tlet range;\n\tconst significantWhitespaces = node.parentElement && node.parentElement.nodeName === \"PRE\";\n\n\twhile (currentOffset < max) {\n\t\tcurrentLetter = currentText[currentOffset];\n\t\tif (/^[\\S\\u202F\\u00A0]$/.test(currentLetter) || significantWhitespaces) {\n\t\t\tif (!range) {\n\t\t\t\trange = document.createRange();\n\t\t\t\trange.setStart(node, currentOffset);\n\t\t\t}\n\t\t} else {\n\t\t\tif (range) {\n\t\t\t\trange.setEnd(node, currentOffset);\n\t\t\t\tyield range;\n\t\t\t\trange = undefined;\n\t\t\t}\n\t\t}\n\n\t\tcurrentOffset += 1;\n\t}\n\n\tif (range) {\n\t\trange.setEnd(node, currentOffset);\n\t\tyield range;\n\t}\n}\n\nexport function *letters(wordRange) {\n\tlet currentText = wordRange.startContainer;\n\tlet max = currentText.length;\n\tlet currentOffset = wordRange.startOffset;\n\t// let currentLetter;\n\n\tlet range;\n\n\twhile(currentOffset < max) {\n\t\t // currentLetter = currentText[currentOffset];\n\t\t range = document.createRange();\n\t\t range.setStart(currentText, currentOffset);\n\t\t range.setEnd(currentText, currentOffset+1);\n\n\t\t yield range;\n\n\t\t currentOffset += 1;\n\t}\n}\n\nexport function isContainer(node) {\n\tlet container;\n\n\tif (typeof node.tagName === \"undefined\") {\n\t\treturn true;\n\t}\n\n\tif (node.style && node.style.display === \"none\") {\n\t\treturn false;\n\t}\n\n\tswitch (node.tagName) {\n\t\t// Inline\n\t\tcase \"A\":\n\t\tcase \"ABBR\":\n\t\tcase \"ACRONYM\":\n\t\tcase \"B\":\n\t\tcase \"BDO\":\n\t\tcase \"BIG\":\n\t\tcase \"BR\":\n\t\tcase \"BUTTON\":\n\t\tcase \"CITE\":\n\t\tcase \"CODE\":\n\t\tcase \"DFN\":\n\t\tcase \"EM\":\n\t\tcase \"I\":\n\t\tcase \"IMG\":\n\t\tcase \"INPUT\":\n\t\tcase \"KBD\":\n\t\tcase \"LABEL\":\n\t\tcase \"MAP\":\n\t\tcase \"OBJECT\":\n\t\tcase \"Q\":\n\t\tcase \"SAMP\":\n\t\tcase \"SCRIPT\":\n\t\tcase \"SELECT\":\n\t\tcase \"SMALL\":\n\t\tcase \"SPAN\":\n\t\tcase \"STRONG\":\n\t\tcase \"SUB\":\n\t\tcase \"SUP\":\n\t\tcase \"TEXTAREA\":\n\t\tcase \"TIME\":\n\t\tcase \"TT\":\n\t\tcase \"VAR\":\n\t\tcase \"P\":\n\t\tcase \"H1\":\n\t\tcase \"H2\":\n\t\tcase \"H3\":\n\t\tcase \"H4\":\n\t\tcase \"H5\":\n\t\tcase \"H6\":\n\t\tcase \"FIGCAPTION\":\n\t\tcase \"BLOCKQUOTE\":\n\t\tcase \"PRE\":\n\t\tcase \"LI\":\n\t\tcase \"TD\":\n\t\tcase \"DT\":\n\t\tcase \"DD\":\n\t\tcase \"VIDEO\":\n\t\tcase \"CANVAS\":\n\t\t\tcontainer = false;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tcontainer = true;\n\t}\n\n\treturn container;\n}\n\nexport function cloneNode(n, deep=false) {\n\treturn n.cloneNode(deep);\n}\n\nexport function findElement(node, doc, forceQuery) {\n\tconst ref = node.getAttribute(\"data-ref\");\n\treturn findRef(ref, doc, forceQuery);\n}\n\nexport function findRef(ref, doc, forceQuery) {\n\tif (!forceQuery && doc.indexOfRefs && doc.indexOfRefs[ref]) {\n\t\treturn doc.indexOfRefs[ref];\n\t} else {\n\t\treturn doc.querySelector(`[data-ref='${ref}']`);\n\t}\n}\n\nexport function validNode(node) {\n\tif (isText(node)) {\n\t\treturn true;\n\t}\n\n\tif (isElement(node) && node.dataset.ref) {\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n\nexport function prevValidNode(node) {\n\twhile (!validNode(node)) {\n\t\tif (node.previousSibling) {\n\t\t\tnode = node.previousSibling;\n\t\t} else {\n\t\t\tnode = node.parentNode;\n\t\t}\n\n\t\tif (!node) {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn node;\n}\n\nexport function nextValidNode(node) {\n\twhile (!validNode(node)) {\n\t\tif (node.nextSibling) {\n\t\t\tnode = node.nextSibling;\n\t\t} else {\n\t\t\tnode = node.parentNode.nextSibling;\n\t\t}\n\n\t\tif (!node) {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn node;\n}\n\n\nexport function indexOf(node) {\n\tlet parent = node.parentNode;\n\tif (!parent) {\n\t\treturn 0;\n\t}\n\treturn Array.prototype.indexOf.call(parent.childNodes, node);\n}\n\nexport function child(node, index) {\n\treturn node.childNodes[index];\n}\n\nexport function isVisible(node) {\n\tif (isElement(node) && window.getComputedStyle(node).display !== \"none\") {\n\t\treturn true;\n\t} else if (isText(node) &&\n\t\t\thasTextContent(node) &&\n\t\t\twindow.getComputedStyle(node.parentNode).display !== \"none\") {\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport function hasContent(node) {\n\tif (isElement(node)) {\n\t\treturn true;\n\t} else if (isText(node) &&\n\t\t\tnode.textContent.trim().length) {\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport function hasTextContent(node) {\n\tif (isElement(node)) {\n\t\tlet child;\n\t\tfor (var i = 0; i < node.childNodes.length; i++) {\n\t\t\tchild = node.childNodes[i];\n\t\t\tif (child && isText(child) && child.textContent.trim().length) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t} else if (isText(node) &&\n\t\t\tnode.textContent.trim().length) {\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport function indexOfTextNode(node, parent) {\n\tif (!isText(node)) {\n\t\treturn -1;\n\t}\n\tlet nodeTextContent = node.textContent;\n\tlet child;\n\tlet index = -1;\n\tfor (var i = 0; i < parent.childNodes.length; i++) {\n\t\tchild = parent.childNodes[i];\n\t\tif (child.nodeType === 3) {\n\t\t\tlet text = parent.childNodes[i].textContent;\n\t\t\tif (text.includes(nodeTextContent)) {\n\t\t\t\tindex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn index;\n}\n\n\n/**\n * Throughout, whitespace is defined as one of the characters\n *  \"\\t\" TAB \\u0009\n *  \"\\n\" LF  \\u000A\n *  \"\\r\" CR  \\u000D\n *  \" \"  SPC \\u0020\n *\n * This does not use Javascript's \"\\s\" because that includes non-breaking\n * spaces (and also some other characters).\n */\n\n/**\n * Determine if a node should be ignored by the iterator functions.\n * taken from https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model/Whitespace#Whitespace_helper_functions\n *\n * @param {Node} node An object implementing the DOM1 |Node| interface.\n * @return {boolean} true if the node is:\n *  1) A |Text| node that is all whitespace\n *  2) A |Comment| node\n *  and otherwise false.\n */\nexport function isIgnorable(node) {\n\treturn (node.nodeType === 8) || // A comment node\n\t\t((node.nodeType === 3) && isAllWhitespace(node)); // a text node, all whitespace\n}\n\n/**\n * Determine whether a node's text content is entirely whitespace.\n *\n * @param {Node} node  A node implementing the |CharacterData| interface (i.e., a |Text|, |Comment|, or |CDATASection| node\n * @return {boolean} true if all of the text content of |nod| is whitespace, otherwise false.\n */\nexport function isAllWhitespace(node) {\n\treturn !(/[^\\t\\n\\r ]/.test(node.textContent));\n}\n\n/**\n * Version of |previousSibling| that skips nodes that are entirely\n * whitespace or comments.  (Normally |previousSibling| is a property\n * of all DOM nodes that gives the sibling node, the node that is\n * a child of the same parent, that occurs immediately before the\n * reference node.)\n *\n * @param {ChildNode} sib  The reference node.\n * @return {Node|null} Either:\n *  1) The closest previous sibling to |sib| that is not ignorable according to |is_ignorable|, or\n *  2) null if no such node exists.\n */\nexport function previousSignificantNode(sib) {\n\twhile ((sib = sib.previousSibling)) {\n\t\tif (!isIgnorable(sib)) return sib;\n\t}\n\treturn null;\n}\n\nfunction getNodeWithNamedPage(node, limiter) {\n\tif (node && node.dataset && node.dataset.page) {\n\t\treturn node;\n\t}\n\tif (node.parentNode) {\n\t\twhile ((node = node.parentNode)) {\n\t\t\tif (limiter && node === limiter) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (node.dataset && node.dataset.page) {\n\t\t\t\treturn node;\n\t\t\t}\n\t\t}\n\t}\n\treturn null;\n}\n\nexport function breakInsideAvoidParentNode(node) {\n\twhile ((node = node.parentNode)) {\n\t\tif (node && node.dataset && node.dataset.breakInside === \"avoid\") {\n\t\t\treturn node;\n\t\t}\n\t}\n\treturn null;\n}\n\n/**\n * Find a parent with a given node name.\n * @param {Node} node - initial Node\n * @param {string} nodeName - node name (eg. \"TD\", \"TABLE\", \"STRONG\"...)\n * @param {Node} limiter - go up to the parent until there's no more parent or the current node is equals to the limiter\n * @returns {Node|undefined} - Either:\n *  1) The closest parent for a the given node name, or\n *  2) undefined if no such node exists.\n */\nexport function parentOf(node, nodeName, limiter) {\n\tif (limiter && node === limiter) {\n\t\treturn;\n\t}\n\tif (node.parentNode) {\n\t\twhile ((node = node.parentNode)) {\n\t\t\tif (limiter && node === limiter) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (node.nodeName === nodeName) {\n\t\t\t\treturn node;\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * Version of |nextSibling| that skips nodes that are entirely\n * whitespace or comments.\n *\n * @param {ChildNode} sib  The reference node.\n * @return {Node|null} Either:\n *  1) The closest next sibling to |sib| that is not ignorable according to |is_ignorable|, or\n *  2) null if no such node exists.\n */\nexport function nextSignificantNode(sib) {\n\twhile ((sib = sib.nextSibling)) {\n\t\tif (!isIgnorable(sib)) return sib;\n\t}\n\treturn null;\n}\n\nexport function filterTree(content, func, what) {\n\tconst treeWalker = document.createTreeWalker(\n\t\tcontent || this.dom,\n\t\twhat || NodeFilter.SHOW_ALL,\n\t\tfunc ? { acceptNode: func } : null,\n\t\tfalse\n\t);\n\n\tlet node;\n\tlet current;\n\tnode = treeWalker.nextNode();\n\twhile(node) {\n\t\tcurrent = node;\n\t\tnode = treeWalker.nextNode();\n\t\tcurrent.parentNode.removeChild(current);\n\t}\n}\n","import {\n\tisElement\n} from \"../utils/dom.js\";\n\n/**\n * BreakToken\n * @class\n */\nclass BreakToken {\n\n\tconstructor(node, offset) {\n\t\tthis.node = node;\n\t\tthis.offset = offset;\n\t}\n\n\tequals(otherBreakToken) {\n\t\tif (!otherBreakToken) {\n\t\t\treturn false;\n\t\t}\n\t\tif (this[\"node\"] && otherBreakToken[\"node\"] &&\n\t\t\tthis[\"node\"] !== otherBreakToken[\"node\"]) {\n\t\t\treturn false;\n\t\t}\n\t\tif (this[\"offset\"] && otherBreakToken[\"offset\"] &&\n\t\t\tthis[\"offset\"] !== otherBreakToken[\"offset\"]) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\ttoJSON(hash) {\n\t\tlet node;\n\t\tlet index = 0;\n\t\tif (!this.node) {\n\t\t\treturn {};\n\t\t}\n\t\tif (isElement(this.node) && this.node.dataset.ref) {\n\t\t\tnode = this.node.dataset.ref;\n\t\t} else if (hash) {\n\t\t\tnode = this.node.parentElement.dataset.ref;\n\t\t}\n\n\t\tif (this.node.parentElement) {\n\t\t\tconst children = Array.from(this.node.parentElement.childNodes);\n\t\t\tindex = children.indexOf(this.node);\n\t\t}\n\n\t\treturn JSON.stringify({\n\t\t\t\"node\": node,\n\t\t\t\"index\" : index,\n\t\t\t\"offset\": this.offset\n\t\t});\n\t}\n\n}\n\nexport default BreakToken;","/**\n * Render result.\n * @class\n */\nclass RenderResult {\n\n\tconstructor(breakToken, error) {\n\t\tthis.breakToken = breakToken;\n\t\tthis.error = error;\n\t}\n}\n\nexport class OverflowContentError extends Error {\n\tconstructor(message, items) {\n\t\tsuper(message);\n\t\tthis.items = items;\n\t}\n}\n\nexport default RenderResult;\n","\"use strict\";\n\n// ES3 safe\nvar _undefined = void 0;\n\nmodule.exports = function (value) { return value !== _undefined && value !== null; };\n","\"use strict\";\n\nvar isValue = require(\"../value/is\");\n\n// prettier-ignore\nvar possibleTypes = { \"object\": true, \"function\": true, \"undefined\": true /* document.all */ };\n\nmodule.exports = function (value) {\n\tif (!isValue(value)) return false;\n\treturn hasOwnProperty.call(possibleTypes, typeof value);\n};\n","\"use strict\";\n\nvar isObject = require(\"../object/is\");\n\nmodule.exports = function (value) {\n\tif (!isObject(value)) return false;\n\ttry {\n\t\tif (!value.constructor) return false;\n\t\treturn value.constructor.prototype === value;\n\t} catch (error) {\n\t\treturn false;\n\t}\n};\n","\"use strict\";\n\nvar isPrototype = require(\"../prototype/is\");\n\nmodule.exports = function (value) {\n\tif (typeof value !== \"function\") return false;\n\n\tif (!hasOwnProperty.call(value, \"length\")) return false;\n\n\ttry {\n\t\tif (typeof value.length !== \"number\") return false;\n\t\tif (typeof value.call !== \"function\") return false;\n\t\tif (typeof value.apply !== \"function\") return false;\n\t} catch (error) {\n\t\treturn false;\n\t}\n\n\treturn !isPrototype(value);\n};\n","\"use strict\";\n\nvar isFunction = require(\"../function/is\");\n\nvar classRe = /^\\s*class[\\s{/}]/, functionToString = Function.prototype.toString;\n\nmodule.exports = function (value) {\n\tif (!isFunction(value)) return false;\n\tif (classRe.test(functionToString.call(value))) return false;\n\treturn true;\n};\n","\"use strict\";\n\nmodule.exports = function () {\n\tvar assign = Object.assign, obj;\n\tif (typeof assign !== \"function\") return false;\n\tobj = { foo: \"raz\" };\n\tassign(obj, { bar: \"dwa\" }, { trzy: \"trzy\" });\n\treturn obj.foo + obj.bar + obj.trzy === \"razdwatrzy\";\n};\n","\"use strict\";\n\nmodule.exports = function () {\n\ttry {\n\t\tObject.keys(\"primitive\");\n\t\treturn true;\n\t} catch (e) {\n\t\treturn false;\n\t}\n};\n","\"use strict\";\n\n// eslint-disable-next-line no-empty-function\nmodule.exports = function () {};\n","\"use strict\";\n\nvar _undefined = require(\"../function/noop\")(); // Support ES3 engines\n\nmodule.exports = function (val) { return val !== _undefined && val !== null; };\n","\"use strict\";\n\nvar isValue = require(\"../is-value\");\n\nvar keys = Object.keys;\n\nmodule.exports = function (object) { return keys(isValue(object) ? Object(object) : object); };\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? Object.keys : require(\"./shim\");\n","\"use strict\";\n\nvar isValue = require(\"./is-value\");\n\nmodule.exports = function (value) {\n\tif (!isValue(value)) throw new TypeError(\"Cannot use null or undefined\");\n\treturn value;\n};\n","\"use strict\";\n\nvar keys  = require(\"../keys\")\n  , value = require(\"../valid-value\")\n  , max   = Math.max;\n\nmodule.exports = function (dest, src /*, …srcn*/) {\n\tvar error, i, length = max(arguments.length, 2), assign;\n\tdest = Object(value(dest));\n\tassign = function (key) {\n\t\ttry {\n\t\t\tdest[key] = src[key];\n\t\t} catch (e) {\n\t\t\tif (!error) error = e;\n\t\t}\n\t};\n\tfor (i = 1; i < length; ++i) {\n\t\tsrc = arguments[i];\n\t\tkeys(src).forEach(assign);\n\t}\n\tif (error !== undefined) throw error;\n\treturn dest;\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? Object.assign : require(\"./shim\");\n","\"use strict\";\n\nvar isValue = require(\"./is-value\");\n\nvar forEach = Array.prototype.forEach, create = Object.create;\n\nvar process = function (src, obj) {\n\tvar key;\n\tfor (key in src) obj[key] = src[key];\n};\n\n// eslint-disable-next-line no-unused-vars\nmodule.exports = function (opts1 /*, …options*/) {\n\tvar result = create(null);\n\tforEach.call(arguments, function (options) {\n\t\tif (!isValue(options)) return;\n\t\tprocess(Object(options), result);\n\t});\n\treturn result;\n};\n","\"use strict\";\n\nvar str = \"razdwatrzy\";\n\nmodule.exports = function () {\n\tif (typeof str.contains !== \"function\") return false;\n\treturn str.contains(\"dwa\") === true && str.contains(\"foo\") === false;\n};\n","\"use strict\";\n\nvar indexOf = String.prototype.indexOf;\n\nmodule.exports = function (searchString /*, position*/) {\n\treturn indexOf.call(this, searchString, arguments[1]) > -1;\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? String.prototype.contains : require(\"./shim\");\n","\"use strict\";\n\nvar isValue         = require(\"type/value/is\")\n  , isPlainFunction = require(\"type/plain-function/is\")\n  , assign          = require(\"es5-ext/object/assign\")\n  , normalizeOpts   = require(\"es5-ext/object/normalize-options\")\n  , contains        = require(\"es5-ext/string/#/contains\");\n\nvar d = (module.exports = function (dscr, value/*, options*/) {\n\tvar c, e, w, options, desc;\n\tif (arguments.length < 2 || typeof dscr !== \"string\") {\n\t\toptions = value;\n\t\tvalue = dscr;\n\t\tdscr = null;\n\t} else {\n\t\toptions = arguments[2];\n\t}\n\tif (isValue(dscr)) {\n\t\tc = contains.call(dscr, \"c\");\n\t\te = contains.call(dscr, \"e\");\n\t\tw = contains.call(dscr, \"w\");\n\t} else {\n\t\tc = w = true;\n\t\te = false;\n\t}\n\n\tdesc = { value: value, configurable: c, enumerable: e, writable: w };\n\treturn !options ? desc : assign(normalizeOpts(options), desc);\n});\n\nd.gs = function (dscr, get, set/*, options*/) {\n\tvar c, e, options, desc;\n\tif (typeof dscr !== \"string\") {\n\t\toptions = set;\n\t\tset = get;\n\t\tget = dscr;\n\t\tdscr = null;\n\t} else {\n\t\toptions = arguments[3];\n\t}\n\tif (!isValue(get)) {\n\t\tget = undefined;\n\t} else if (!isPlainFunction(get)) {\n\t\toptions = get;\n\t\tget = set = undefined;\n\t} else if (!isValue(set)) {\n\t\tset = undefined;\n\t} else if (!isPlainFunction(set)) {\n\t\toptions = set;\n\t\tset = undefined;\n\t}\n\tif (isValue(dscr)) {\n\t\tc = contains.call(dscr, \"c\");\n\t\te = contains.call(dscr, \"e\");\n\t} else {\n\t\tc = true;\n\t\te = false;\n\t}\n\n\tdesc = { get: get, set: set, configurable: c, enumerable: e };\n\treturn !options ? desc : assign(normalizeOpts(options), desc);\n};\n","\"use strict\";\n\nmodule.exports = function (fn) {\n\tif (typeof fn !== \"function\") throw new TypeError(fn + \" is not a function\");\n\treturn fn;\n};\n","'use strict';\n\nvar d        = require('d')\n  , callable = require('es5-ext/object/valid-callable')\n\n  , apply = Function.prototype.apply, call = Function.prototype.call\n  , create = Object.create, defineProperty = Object.defineProperty\n  , defineProperties = Object.defineProperties\n  , hasOwnProperty = Object.prototype.hasOwnProperty\n  , descriptor = { configurable: true, enumerable: false, writable: true }\n\n  , on, once, off, emit, methods, descriptors, base;\n\non = function (type, listener) {\n\tvar data;\n\n\tcallable(listener);\n\n\tif (!hasOwnProperty.call(this, '__ee__')) {\n\t\tdata = descriptor.value = create(null);\n\t\tdefineProperty(this, '__ee__', descriptor);\n\t\tdescriptor.value = null;\n\t} else {\n\t\tdata = this.__ee__;\n\t}\n\tif (!data[type]) data[type] = listener;\n\telse if (typeof data[type] === 'object') data[type].push(listener);\n\telse data[type] = [data[type], listener];\n\n\treturn this;\n};\n\nonce = function (type, listener) {\n\tvar once, self;\n\n\tcallable(listener);\n\tself = this;\n\ton.call(this, type, once = function () {\n\t\toff.call(self, type, once);\n\t\tapply.call(listener, this, arguments);\n\t});\n\n\tonce.__eeOnceListener__ = listener;\n\treturn this;\n};\n\noff = function (type, listener) {\n\tvar data, listeners, candidate, i;\n\n\tcallable(listener);\n\n\tif (!hasOwnProperty.call(this, '__ee__')) return this;\n\tdata = this.__ee__;\n\tif (!data[type]) return this;\n\tlisteners = data[type];\n\n\tif (typeof listeners === 'object') {\n\t\tfor (i = 0; (candidate = listeners[i]); ++i) {\n\t\t\tif ((candidate === listener) ||\n\t\t\t\t\t(candidate.__eeOnceListener__ === listener)) {\n\t\t\t\tif (listeners.length === 2) data[type] = listeners[i ? 0 : 1];\n\t\t\t\telse listeners.splice(i, 1);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif ((listeners === listener) ||\n\t\t\t\t(listeners.__eeOnceListener__ === listener)) {\n\t\t\tdelete data[type];\n\t\t}\n\t}\n\n\treturn this;\n};\n\nemit = function (type) {\n\tvar i, l, listener, listeners, args;\n\n\tif (!hasOwnProperty.call(this, '__ee__')) return;\n\tlisteners = this.__ee__[type];\n\tif (!listeners) return;\n\n\tif (typeof listeners === 'object') {\n\t\tl = arguments.length;\n\t\targs = new Array(l - 1);\n\t\tfor (i = 1; i < l; ++i) args[i - 1] = arguments[i];\n\n\t\tlisteners = listeners.slice();\n\t\tfor (i = 0; (listener = listeners[i]); ++i) {\n\t\t\tapply.call(listener, this, args);\n\t\t}\n\t} else {\n\t\tswitch (arguments.length) {\n\t\tcase 1:\n\t\t\tcall.call(listeners, this);\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tcall.call(listeners, this, arguments[1]);\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\tcall.call(listeners, this, arguments[1], arguments[2]);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tl = arguments.length;\n\t\t\targs = new Array(l - 1);\n\t\t\tfor (i = 1; i < l; ++i) {\n\t\t\t\targs[i - 1] = arguments[i];\n\t\t\t}\n\t\t\tapply.call(listeners, this, args);\n\t\t}\n\t}\n};\n\nmethods = {\n\ton: on,\n\tonce: once,\n\toff: off,\n\temit: emit\n};\n\ndescriptors = {\n\ton: d(on),\n\tonce: d(once),\n\toff: d(off),\n\temit: d(emit)\n};\n\nbase = defineProperties({}, descriptors);\n\nmodule.exports = exports = function (o) {\n\treturn (o == null) ? create(base) : defineProperties(Object(o), descriptors);\n};\nexports.methods = methods;\n","/**\n * Hooks allow for injecting functions that must all complete in order before finishing\n * They will execute in parallel but all must finish before continuing\n * Functions may return a promise if they are asycn.\n * From epubjs/src/utils/hooks\n * @param {any} context scope of this\n * @example this.content = new Hook(this);\n */\nclass Hook {\n\tconstructor(context){\n\t\tthis.context = context || this;\n\t\tthis.hooks = [];\n\t}\n\n\t/**\n\t * Adds a function to be run before a hook completes\n\t * @example this.content.register(function(){...});\n\t * @return {undefined} void\n\t */\n\tregister(){\n\t\tfor(var i = 0; i < arguments.length; ++i) {\n\t\t\tif (typeof arguments[i]  === \"function\") {\n\t\t\t\tthis.hooks.push(arguments[i]);\n\t\t\t} else {\n\t\t\t\t// unpack array\n\t\t\t\tfor(var j = 0; j < arguments[i].length; ++j) {\n\t\t\t\t\tthis.hooks.push(arguments[i][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Triggers a hook to run all functions\n\t * @example this.content.trigger(args).then(function(){...});\n\t * @return {Promise} results\n\t */\n\ttrigger(){\n\t\tvar args = arguments;\n\t\tvar context = this.context;\n\t\tvar promises = [];\n\n\t\tthis.hooks.forEach(function(task) {\n\t\t\tvar executing = task.apply(context, args);\n\n\t\t\tif(executing && typeof executing[\"then\"] === \"function\") {\n\t\t\t\t// Task is a function that returns a promise\n\t\t\t\tpromises.push(executing);\n\t\t\t} else {\n\t\t\t\t// Otherwise Task resolves immediately, add resolved promise with result\n\t\t\t\tpromises.push(new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(executing);\n\t\t\t\t}));\n\t\t\t}\n\t\t});\n\n\n\t\treturn Promise.all(promises);\n\t}\n\n\t/**\n   * Triggers a hook to run all functions synchronously\n   * @example this.content.trigger(args).then(function(){...});\n   * @return {Array} results\n   */\n\ttriggerSync(){\n\t\tvar args = arguments;\n\t\tvar context = this.context;\n\t\tvar results = [];\n\n\t\tthis.hooks.forEach(function(task) {\n\t\t\tvar executing = task.apply(context, args);\n\n\t\t\tresults.push(executing);\n\t\t});\n\n\n\t\treturn results;\n\t}\n\n\t// Adds a function to be run before a hook completes\n\tlist(){\n\t\treturn this.hooks;\n\t}\n\n\tclear(){\n\t\treturn this.hooks = [];\n\t}\n}\nexport default Hook;\n","import { getBoundingClientRect, getClientRects } from \"../utils/utils.js\";\nimport {\n\tbreakInsideAvoidParentNode,\n\tchild,\n\tcloneNode,\n\tfindElement,\n\thasContent,\n\tindexOf,\n\tindexOfTextNode,\n\tisContainer,\n\tisElement,\n\tisText,\n\tletters,\n\tneedsBreakBefore,\n\tneedsPageBreak,\n\tneedsPreviousBreakAfter,\n\tnodeAfter,\n\tnodeBefore,\n\tparentOf,\n\tprevValidNode,\n\trebuildAncestors,\n\tvalidNode,\n\twalk,\n\twords\n} from \"../utils/dom.js\";\nimport BreakToken from \"./breaktoken.js\";\nimport RenderResult, { OverflowContentError } from \"./renderresult.js\";\nimport EventEmitter from \"event-emitter\";\nimport Hook from \"../utils/hook.js\";\n\nconst MAX_CHARS_PER_BREAK = 1500;\n\n/**\n * Layout\n * @class\n */\nclass Layout {\n\n\tconstructor(element, hooks, options) {\n\t\tthis.element = element;\n\n\t\tthis.bounds = this.element.getBoundingClientRect();\n\t\tthis.parentBounds = this.element.offsetParent.getBoundingClientRect();\n\t\tlet gap = parseFloat(window.getComputedStyle(this.element).columnGap);\n\t\n\t\tif (gap) {\n\t\t\tlet leftMargin = this.bounds.left - this.parentBounds.left;\n\t\t\tthis.gap =  gap - leftMargin;\t\n\t\t} else {\n\t\t\tthis.gap = 0;\n\t\t}\n\n\t\tif (hooks) {\n\t\t\tthis.hooks = hooks;\n\t\t} else {\n\t\t\tthis.hooks = {};\n\t\t\tthis.hooks.onPageLayout = new Hook();\n\t\t\tthis.hooks.layout = new Hook();\n\t\t\tthis.hooks.renderNode = new Hook();\n\t\t\tthis.hooks.layoutNode = new Hook();\n\t\t\tthis.hooks.beforeOverflow = new Hook();\n\t\t\tthis.hooks.onOverflow = new Hook();\n\t\t\tthis.hooks.afterOverflowRemoved = new Hook();\n\t\t\tthis.hooks.onBreakToken = new Hook();\n\t\t\tthis.hooks.beforeRenderResult = new Hook();\n\t\t}\n\n\t\tthis.settings = options || {};\n\n\t\tthis.maxChars = this.settings.maxChars || MAX_CHARS_PER_BREAK;\n\t\tthis.forceRenderBreak = false;\n\t}\n\n\tasync renderTo(wrapper, source, breakToken, bounds = this.bounds) {\n\t\tlet start = this.getStart(source, breakToken);\n\t\tlet walker = walk(start, source);\n\n\t\tlet node;\n\t\tlet prevNode;\n\t\tlet done;\n\t\tlet next;\n\n\t\tlet hasRenderedContent = false;\n\t\tlet newBreakToken;\n\n\t\tlet length = 0;\n\n\t\tlet prevBreakToken = breakToken || new BreakToken(start);\n\n\t\tthis.hooks && this.hooks.onPageLayout.trigger(wrapper, prevBreakToken, this);\n\n\t\twhile (!done && !newBreakToken) {\n\t\t\tnext = walker.next();\n\t\t\tprevNode = node;\n\t\t\tnode = next.value;\n\t\t\tdone = next.done;\n\n\t\t\tif (!node) {\n\t\t\t\tthis.hooks && this.hooks.layout.trigger(wrapper, this);\n\n\t\t\t\tlet imgs = wrapper.querySelectorAll(\"img\");\n\t\t\t\tif (imgs.length) {\n\t\t\t\t\tawait this.waitForImages(imgs);\n\t\t\t\t}\n\n\t\t\t\tnewBreakToken = this.findBreakToken(wrapper, source, bounds, prevBreakToken);\n\n\t\t\t\tif (newBreakToken && newBreakToken.equals(prevBreakToken)) {\n\t\t\t\t\tconsole.warn(\"Unable to layout item: \", prevNode);\n\t\t\t\t\tthis.hooks && this.hooks.beforeRenderResult.trigger(undefined, wrapper, this);\n\t\t\t\t\treturn new RenderResult(undefined, new OverflowContentError(\"Unable to layout item\", [prevNode]));\n\t\t\t\t}\n\n\t\t\t\tthis.rebuildTableFromBreakToken(newBreakToken, wrapper);\n\n\t\t\t\tthis.hooks && this.hooks.beforeRenderResult.trigger(newBreakToken, wrapper, this);\n\t\t\t\treturn new RenderResult(newBreakToken);\n\t\t\t}\n\n\t\t\tthis.hooks && this.hooks.layoutNode.trigger(node);\n\n\t\t\t// Check if the rendered element has a break set\n\t\t\tif (hasRenderedContent && this.shouldBreak(node, start)) {\n\t\t\t\tthis.hooks && this.hooks.layout.trigger(wrapper, this);\n\n\t\t\t\tlet imgs = wrapper.querySelectorAll(\"img\");\n\t\t\t\tif (imgs.length) {\n\t\t\t\t\tawait this.waitForImages(imgs);\n\t\t\t\t}\n\n\t\t\t\tnewBreakToken = this.findBreakToken(wrapper, source, bounds, prevBreakToken);\n\n\t\t\t\tif (!newBreakToken) {\n\t\t\t\t\tnewBreakToken = this.breakAt(node);\n\t\t\t\t} else {\n\t\t\t\t\tthis.rebuildTableFromBreakToken(newBreakToken, wrapper);\n\t\t\t\t}\n\n\t\t\t\tif (newBreakToken && newBreakToken.equals(prevBreakToken)) {\n\t\t\t\t\tconsole.warn(\"Unable to layout item: \", node);\n\t\t\t\t\tlet after = newBreakToken.node && nodeAfter(newBreakToken.node);\n\t\t\t\t\tif (after) {\n\t\t\t\t\t\tnewBreakToken = new BreakToken(after);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn new RenderResult(undefined, new OverflowContentError(\"Unable to layout item\", [node]));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlength = 0;\n\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (node.dataset && node.dataset.page) {\n\t\t\t\tlet named = node.dataset.page;\n\t\t\t\tlet page = this.element.closest(\".pagedjs_page\");\n\t\t\t\tpage.classList.add(\"pagedjs_named_page\");\n\t\t\t\tpage.classList.add(\"pagedjs_\" + named + \"_page\");\n\n\t\t\t\tif (!node.dataset.splitFrom) {\n\t\t\t\t\tpage.classList.add(\"pagedjs_\" + named + \"_first_page\");\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Should the Node be a shallow or deep clone\n\t\t\tlet shallow = isContainer(node);\n\n\t\t\tlet rendered = this.append(node, wrapper, breakToken, shallow);\n\n\t\t\tlength += rendered.textContent.length;\n\n\t\t\t// Check if layout has content yet\n\t\t\tif (!hasRenderedContent) {\n\t\t\t\thasRenderedContent = hasContent(node);\n\t\t\t}\n\n\t\t\t// Skip to the next node if a deep clone was rendered\n\t\t\tif (!shallow) {\n\t\t\t\twalker = walk(nodeAfter(node, source), source);\n\t\t\t}\n\n\t\t\tif (this.forceRenderBreak) {\n\t\t\t\tthis.hooks && this.hooks.layout.trigger(wrapper, this);\n\n\t\t\t\tnewBreakToken = this.findBreakToken(wrapper, source, bounds, prevBreakToken);\n\n\t\t\t\tif (!newBreakToken) {\n\t\t\t\t\tnewBreakToken = this.breakAt(node);\n\t\t\t\t} else {\n\t\t\t\t\tthis.rebuildTableFromBreakToken(newBreakToken, wrapper);\n\t\t\t\t}\n\n\t\t\t\tlength = 0;\n\t\t\t\tthis.forceRenderBreak = false;\n\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// Only check x characters\n\t\t\tif (length >= this.maxChars) {\n\n\t\t\t\tthis.hooks && this.hooks.layout.trigger(wrapper, this);\n\n\t\t\t\tlet imgs = wrapper.querySelectorAll(\"img\");\n\t\t\t\tif (imgs.length) {\n\t\t\t\t\tawait this.waitForImages(imgs);\n\t\t\t\t}\n\n\t\t\t\tnewBreakToken = this.findBreakToken(wrapper, source, bounds, prevBreakToken);\n\n\t\t\t\tif (newBreakToken) {\n\t\t\t\t\tlength = 0;\n\t\t\t\t\tthis.rebuildTableFromBreakToken(newBreakToken, wrapper);\n\t\t\t\t}\n\n\t\t\t\tif (newBreakToken && newBreakToken.equals(prevBreakToken)) {\n\t\t\t\t\tconsole.warn(\"Unable to layout item: \", node);\n\t\t\t\t\tlet after = newBreakToken.node && nodeAfter(newBreakToken.node);\n\t\t\t\t\tif (after) {\n\t\t\t\t\t\tnewBreakToken = new BreakToken(after);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.hooks && this.hooks.beforeRenderResult.trigger(undefined, wrapper, this);\n\t\t\t\t\t\treturn new RenderResult(undefined, new OverflowContentError(\"Unable to layout item\", [node]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\tthis.hooks && this.hooks.beforeRenderResult.trigger(newBreakToken, wrapper, this);\n\t\treturn new RenderResult(newBreakToken);\n\t}\n\n\tbreakAt(node, offset = 0) {\n\t\tlet newBreakToken = new BreakToken(\n\t\t\tnode,\n\t\t\toffset\n\t\t);\n\t\tlet breakHooks = this.hooks.onBreakToken.triggerSync(newBreakToken, undefined, node, this);\n\t\tbreakHooks.forEach((newToken) => {\n\t\t\tif (typeof newToken != \"undefined\") {\n\t\t\t\tnewBreakToken = newToken;\n\t\t\t}\n\t\t});\n\n\t\treturn newBreakToken;\n\t}\n\n\tshouldBreak(node, limiter) {\n\t\tlet previousNode = nodeBefore(node, limiter);\n\t\tlet parentNode = node.parentNode;\n\t\tlet parentBreakBefore = needsBreakBefore(node) && parentNode && !previousNode && needsBreakBefore(parentNode);\n\t\tlet doubleBreakBefore;\n\n\t\tif (parentBreakBefore) {\n\t\t\tdoubleBreakBefore = node.dataset.breakBefore === parentNode.dataset.breakBefore;\n\t\t}\n\n\t\treturn !doubleBreakBefore && needsBreakBefore(node) || needsPreviousBreakAfter(node) || needsPageBreak(node, previousNode);\n\t}\n\n\tforceBreak() {\n\t\tthis.forceRenderBreak = true;\n\t}\n\n\tgetStart(source, breakToken) {\n\t\tlet start;\n\t\tlet node = breakToken && breakToken.node;\n\n\t\tif (node) {\n\t\t\tstart = node;\n\t\t} else {\n\t\t\tstart = source.firstChild;\n\t\t}\n\n\t\treturn start;\n\t}\n\n\tappend(node, dest, breakToken, shallow = true, rebuild = true) {\n\n\t\tlet clone = cloneNode(node, !shallow);\n\n\t\tif (node.parentNode && isElement(node.parentNode)) {\n\t\t\tlet parent = findElement(node.parentNode, dest);\n\t\t\t// Rebuild chain\n\t\t\tif (parent) {\n\t\t\t\tparent.appendChild(clone);\n\t\t\t} else if (rebuild) {\n\t\t\t\tlet fragment = rebuildAncestors(node);\n\t\t\t\tparent = findElement(node.parentNode, fragment);\n\t\t\t\tif (!parent) {\n\t\t\t\t\tdest.appendChild(clone);\n\t\t\t\t} else if (breakToken && isText(breakToken.node) && breakToken.offset > 0) {\n\t\t\t\t\tclone.textContent = clone.textContent.substring(breakToken.offset);\n\t\t\t\t\tparent.appendChild(clone);\n\t\t\t\t} else {\n\t\t\t\t\tparent.appendChild(clone);\n\t\t\t\t}\n\n\t\t\t\tdest.appendChild(fragment);\n\t\t\t} else {\n\t\t\t\tdest.appendChild(clone);\n\t\t\t}\n\n\n\t\t} else {\n\t\t\tdest.appendChild(clone);\n\t\t}\n\n\t\tif (clone.dataset && clone.dataset.ref) {\n\t\t\tif (!dest.indexOfRefs) {\n\t\t\t\tdest.indexOfRefs = {};\n\t\t\t}\n\t\t\tdest.indexOfRefs[clone.dataset.ref] = clone;\n\t\t}\n\n\t\tlet nodeHooks = this.hooks.renderNode.triggerSync(clone, node, this);\n\t\tnodeHooks.forEach((newNode) => {\n\t\t\tif (typeof newNode != \"undefined\") {\n\t\t\t\tclone = newNode;\n\t\t\t}\n\t\t});\n\n\t\treturn clone;\n\t}\n\n\trebuildTableFromBreakToken(breakToken, dest) {\n\t\tif (!breakToken || !breakToken.node) {\n\t\t\treturn;\n\t\t}\n\t\tlet node = breakToken.node;\n\t\tlet td = isElement(node) ? node.closest(\"td\") : node.parentElement.closest(\"td\");\n\t\tif (td) {\n\t\t\tlet rendered = findElement(td, dest, true);\n\t\t\tif (!rendered) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\twhile ((td = td.nextElementSibling)) {\n\t\t\t\tthis.append(td, dest, null, true);\n\t\t\t}\n\t\t}\n\t}\n\n\tasync waitForImages(imgs) {\n\t\tlet results = Array.from(imgs).map(async (img) => {\n\t\t\treturn this.awaitImageLoaded(img);\n\t\t});\n\t\tawait Promise.all(results);\n\t}\n\n\tasync awaitImageLoaded(image) {\n\t\treturn new Promise(resolve => {\n\t\t\tif (image.complete !== true) {\n\t\t\t\timage.onload = function () {\n\t\t\t\t\tlet {width, height} = window.getComputedStyle(image);\n\t\t\t\t\tresolve(width, height);\n\t\t\t\t};\n\t\t\t\timage.onerror = function (e) {\n\t\t\t\t\tlet {width, height} = window.getComputedStyle(image);\n\t\t\t\t\tresolve(width, height, e);\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tlet {width, height} = window.getComputedStyle(image);\n\t\t\t\tresolve(width, height);\n\t\t\t}\n\t\t});\n\t}\n\n\tavoidBreakInside(node, limiter) {\n\t\tlet breakNode;\n\n\t\tif (node === limiter) {\n\t\t\treturn;\n\t\t}\n\n\t\twhile (node.parentNode) {\n\t\t\tnode = node.parentNode;\n\n\t\t\tif (node === limiter) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (window.getComputedStyle(node)[\"break-inside\"] === \"avoid\") {\n\t\t\t\tbreakNode = node;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t}\n\t\treturn breakNode;\n\t}\n\n\tcreateBreakToken(overflow, rendered, source) {\n\t\tlet container = overflow.startContainer;\n\t\tlet offset = overflow.startOffset;\n\t\tlet node, renderedNode, parent, index, temp;\n\n\t\tif (isElement(container)) {\n\t\t\ttemp = child(container, offset);\n\n\t\t\tif (isElement(temp)) {\n\t\t\t\trenderedNode = findElement(temp, rendered);\n\n\t\t\t\tif (!renderedNode) {\n\t\t\t\t\t// Find closest element with data-ref\n\t\t\t\t\tlet prevNode = prevValidNode(temp);\n\t\t\t\t\tif (!isElement(prevNode)) {\n\t\t\t\t\t\tprevNode = prevNode.parentElement;\n\t\t\t\t\t}\n\t\t\t\t\trenderedNode = findElement(prevNode, rendered);\n\t\t\t\t\t// Check if temp is the last rendered node at its level.\n\t\t\t\t\tif (!temp.nextSibling) {\n\t\t\t\t\t\t// We need to ensure that the previous sibling of temp is fully rendered.\n\t\t\t\t\t\tconst renderedNodeFromSource = findElement(renderedNode, source);\n\t\t\t\t\t\tconst walker = document.createTreeWalker(renderedNodeFromSource, NodeFilter.SHOW_ELEMENT);\n\t\t\t\t\t\tconst lastChildOfRenderedNodeFromSource = walker.lastChild();\n\t\t\t\t\t\tconst lastChildOfRenderedNodeMatchingFromRendered = findElement(lastChildOfRenderedNodeFromSource, rendered);\n\t\t\t\t\t\t// Check if we found that the last child in source\n\t\t\t\t\t\tif (!lastChildOfRenderedNodeMatchingFromRendered) {\n\t\t\t\t\t\t\t// Pending content to be rendered before virtual break token\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Otherwise we will return a break token as per below\n\t\t\t\t\t}\n\t\t\t\t\t// renderedNode is actually the last unbroken box that does not overflow.\n\t\t\t\t\t// Break Token is therefore the next sibling of renderedNode within source node.\n\t\t\t\t\tnode = findElement(renderedNode, source).nextSibling;\n\t\t\t\t\toffset = 0;\n\t\t\t\t} else {\n\t\t\t\t\tnode = findElement(renderedNode, source);\n\t\t\t\t\toffset = 0;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\trenderedNode = findElement(container, rendered);\n\n\t\t\t\tif (!renderedNode) {\n\t\t\t\t\trenderedNode = findElement(prevValidNode(container), rendered);\n\t\t\t\t}\n\n\t\t\t\tparent = findElement(renderedNode, source);\n\t\t\t\tindex = indexOfTextNode(temp, parent);\n\t\t\t\t// No seperatation for the first textNode of an element\n\t\t\t\tif(index === 0) {\n\t\t\t\t\tnode = parent;\n\t\t\t\t\toffset = 0;\n\t\t\t\t} else {\n\t\t\t\t\tnode = child(parent, index);\n\t\t\t\t\toffset = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\trenderedNode = findElement(container.parentNode, rendered);\n\n\t\t\tif (!renderedNode) {\n\t\t\t\trenderedNode = findElement(prevValidNode(container.parentNode), rendered);\n\t\t\t}\n\n\t\t\tparent = findElement(renderedNode, source);\n\t\t\tindex = indexOfTextNode(container, parent);\n\n\t\t\tif (index === -1) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tnode = child(parent, index);\n\n\t\t\toffset += node.textContent.indexOf(container.textContent);\n\t\t}\n\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn new BreakToken(\n\t\t\tnode,\n\t\t\toffset\n\t\t);\n\n\t}\n\n\tfindBreakToken(rendered, source, bounds = this.bounds, prevBreakToken, extract = true) {\n\t\tlet overflow = this.findOverflow(rendered, bounds);\n\t\tlet breakToken, breakLetter;\n\n\t\tlet overflowHooks = this.hooks.onOverflow.triggerSync(overflow, rendered, bounds, this);\n\t\toverflowHooks.forEach((newOverflow) => {\n\t\t\tif (typeof newOverflow != \"undefined\") {\n\t\t\t\toverflow = newOverflow;\n\t\t\t}\n\t\t});\n\n\t\tif (overflow) {\n\t\t\tbreakToken = this.createBreakToken(overflow, rendered, source);\n\t\t\t// breakToken is nullable\n\t\t\tlet breakHooks = this.hooks.onBreakToken.triggerSync(breakToken, overflow, rendered, this);\n\t\t\tbreakHooks.forEach((newToken) => {\n\t\t\t\tif (typeof newToken != \"undefined\") {\n\t\t\t\t\tbreakToken = newToken;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Stop removal if we are in a loop\n\t\t\tif (breakToken && breakToken.equals(prevBreakToken)) {\n\t\t\t\treturn breakToken;\n\t\t\t}\n\n\t\t\tif (breakToken && breakToken[\"node\"] && breakToken[\"offset\"] && breakToken[\"node\"].textContent) {\n\t\t\t\tbreakLetter = breakToken[\"node\"].textContent.charAt(breakToken[\"offset\"]);\n\t\t\t} else {\n\t\t\t\tbreakLetter = undefined;\n\t\t\t}\n\n\t\t\tif (breakToken && breakToken.node && extract) {\n\t\t\t\tlet removed = this.removeOverflow(overflow, breakLetter);\n\t\t\t\tthis.hooks && this.hooks.afterOverflowRemoved.trigger(removed, rendered, this);\n\t\t\t}\n\n\t\t}\n\t\treturn breakToken;\n\t}\n\n\thasOverflow(element, bounds = this.bounds) {\n\t\tlet constrainingElement = element && element.parentNode; // this gets the element, instead of the wrapper for the width workaround\n\t\tlet {width, height} = element.getBoundingClientRect();\n\t\tlet scrollWidth = constrainingElement ? constrainingElement.scrollWidth : 0;\n\t\tlet scrollHeight = constrainingElement ? constrainingElement.scrollHeight : 0;\n\t\treturn Math.max(Math.floor(width), scrollWidth) > Math.round(bounds.width) ||\n\t\t\tMath.max(Math.floor(height), scrollHeight) > Math.round(bounds.height);\n\t}\n\n\tfindOverflow(rendered, bounds = this.bounds, gap = this.gap) {\n\t\tif (!this.hasOverflow(rendered, bounds)) return;\n\n\t\tlet start = Math.floor(bounds.left);\n\t\tlet end = Math.round(bounds.right + gap);\n\t\tlet vStart = Math.round(bounds.top);\n\t\tlet vEnd = Math.round(bounds.bottom);\n\t\tlet range;\n\n\t\tlet walker = walk(rendered.firstChild, rendered);\n\n\t\t// Find Start\n\t\tlet next, done, node, offset, skip, breakAvoid, prev, br;\n\t\twhile (!done) {\n\t\t\tnext = walker.next();\n\t\t\tdone = next.done;\n\t\t\tnode = next.value;\n\t\t\tskip = false;\n\t\t\tbreakAvoid = false;\n\t\t\tprev = undefined;\n\t\t\tbr = undefined;\n\n\t\t\tif (node) {\n\t\t\t\tlet pos = getBoundingClientRect(node);\n\t\t\t\tlet left = Math.round(pos.left);\n\t\t\t\tlet right = Math.floor(pos.right);\n\t\t\t\tlet top = Math.round(pos.top);\n\t\t\t\tlet bottom = Math.floor(pos.bottom);\n\n\t\t\t\tif (!range && (left >= end || top >= vEnd)) {\n\t\t\t\t\t// Check if it is a float\n\t\t\t\t\tlet isFloat = false;\n\n\t\t\t\t\t// Check if the node is inside a break-inside: avoid table cell\n\t\t\t\t\tconst insideTableCell = parentOf(node, \"TD\", rendered);\n\t\t\t\t\tif (insideTableCell && window.getComputedStyle(insideTableCell)[\"break-inside\"] === \"avoid\") {\n\t\t\t\t\t\t// breaking inside a table cell produces unexpected result, as a workaround, we forcibly avoid break inside in a cell.\n\t\t\t\t\t\t// But we take the whole row, not just the cell that is causing the break.\n\t\t\t\t\t\tprev = insideTableCell.parentElement;\n\t\t\t\t\t} else if (isElement(node)) {\n\t\t\t\t\t\tlet styles = window.getComputedStyle(node);\n\t\t\t\t\t\tisFloat = styles.getPropertyValue(\"float\") !== \"none\";\n\t\t\t\t\t\tskip = styles.getPropertyValue(\"break-inside\") === \"avoid\";\n\t\t\t\t\t\tbreakAvoid = node.dataset.breakBefore === \"avoid\" || node.dataset.previousBreakAfter === \"avoid\";\n\t\t\t\t\t\tprev = breakAvoid && nodeBefore(node, rendered);\n\t\t\t\t\t\tbr = node.tagName === \"BR\" || node.tagName === \"WBR\";\n\t\t\t\t\t}\n\n\t\t\t\t\tlet tableRow;\n\t\t\t\t\tif (node.nodeName === \"TR\") {\n\t\t\t\t\t\ttableRow = node;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttableRow = parentOf(node, \"TR\", rendered);\n\t\t\t\t\t}\n\t\t\t\t\tif (tableRow) {\n\t\t\t\t\t\t// honor break-inside=\"avoid\" in parent tbody/thead\n\t\t\t\t\t\tlet container = tableRow.parentElement;\n\t\t\t\t\t\tif ([\"TBODY\", \"THEAD\"].includes(container.nodeName)) {\n\t\t\t\t\t\t\tlet styles = window.getComputedStyle(container);\n\t\t\t\t\t\t\tif (styles.getPropertyValue(\"break-inside\") === \"avoid\") prev = container;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Check if the node is inside a row with a rowspan\n\t\t\t\t\t\tconst table = parentOf(tableRow, \"TABLE\", rendered);\n\t\t\t\t\t\tconst rowspan = table.querySelector(\"[colspan]\");\n\t\t\t\t\t\tif (table && rowspan) {\n\t\t\t\t\t\t\tlet columnCount = 0;\n\t\t\t\t\t\t\tfor (const cell of Array.from(table.rows[0].cells)) {\n\t\t\t\t\t\t\t\tcolumnCount += parseInt(cell.getAttribute(\"colspan\") || \"1\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (tableRow.cells.length !== columnCount) {\n\t\t\t\t\t\t\t\tlet previousRow = tableRow.previousElementSibling;\n\t\t\t\t\t\t\t\tlet previousRowColumnCount;\n\t\t\t\t\t\t\t\twhile (previousRow !== null) {\n\t\t\t\t\t\t\t\t\tpreviousRowColumnCount = 0;\n\t\t\t\t\t\t\t\t\tfor (const cell of Array.from(previousRow.cells)) {\n\t\t\t\t\t\t\t\t\t\tpreviousRowColumnCount += parseInt(cell.getAttribute(\"colspan\") || \"1\");\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (previousRowColumnCount === columnCount) {\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tpreviousRow = previousRow.previousElementSibling;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (previousRowColumnCount === columnCount) {\n\t\t\t\t\t\t\t\t\tprev = previousRow;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (prev) {\n\t\t\t\t\t\trange = document.createRange();\n\t\t\t\t\t\trange.selectNode(prev);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!br && !isFloat && isElement(node)) {\n\t\t\t\t\t\trange = document.createRange();\n\t\t\t\t\t\trange.selectNode(node);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (isText(node) && node.textContent.trim().length) {\n\t\t\t\t\t\trange = document.createRange();\n\t\t\t\t\t\trange.selectNode(node);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif (!range && isText(node) &&\n\t\t\t\t\tnode.textContent.trim().length &&\n\t\t\t\t\t!breakInsideAvoidParentNode(node.parentNode)) {\n\n\t\t\t\t\tlet rects = getClientRects(node);\n\t\t\t\t\tlet rect;\n\t\t\t\t\tleft = 0;\n\t\t\t\t\ttop = 0;\n\t\t\t\t\tfor (var i = 0; i != rects.length; i++) {\n\t\t\t\t\t\trect = rects[i];\n\t\t\t\t\t\tif (rect.width > 0 && (!left || rect.left > left)) {\n\t\t\t\t\t\t\tleft = rect.left;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (rect.height > 0 && (!top || rect.top > top)) {\n\t\t\t\t\t\t\ttop = rect.top;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (left >= end || top >= vEnd) {\n\t\t\t\t\t\trange = document.createRange();\n\t\t\t\t\t\toffset = this.textBreak(node, start, end, vStart, vEnd);\n\t\t\t\t\t\tif (!offset) {\n\t\t\t\t\t\t\trange = undefined;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trange.setStart(node, offset);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Skip children\n\t\t\t\tif (skip || (right <= end && bottom <= vEnd)) {\n\t\t\t\t\tnext = nodeAfter(node, rendered);\n\t\t\t\t\tif (next) {\n\t\t\t\t\t\twalker = walk(next, rendered);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\t// Find End\n\t\tif (range) {\n\t\t\trange.setEndAfter(rendered.lastChild);\n\t\t\treturn range;\n\t\t}\n\n\t}\n\n\tfindEndToken(rendered, source) {\n\t\tif (rendered.childNodes.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet lastChild = rendered.lastChild;\n\n\t\tlet lastNodeIndex;\n\t\twhile (lastChild && lastChild.lastChild) {\n\t\t\tif (!validNode(lastChild)) {\n\t\t\t\t// Only get elements with refs\n\t\t\t\tlastChild = lastChild.previousSibling;\n\t\t\t} else if (!validNode(lastChild.lastChild)) {\n\t\t\t\t// Deal with invalid dom items\n\t\t\t\tlastChild = prevValidNode(lastChild.lastChild);\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\tlastChild = lastChild.lastChild;\n\t\t\t}\n\t\t}\n\n\t\tif (isText(lastChild)) {\n\n\t\t\tif (lastChild.parentNode.dataset.ref) {\n\t\t\t\tlastNodeIndex = indexOf(lastChild);\n\t\t\t\tlastChild = lastChild.parentNode;\n\t\t\t} else {\n\t\t\t\tlastChild = lastChild.previousSibling;\n\t\t\t}\n\t\t}\n\n\t\tlet original = findElement(lastChild, source);\n\n\t\tif (lastNodeIndex) {\n\t\t\toriginal = original.childNodes[lastNodeIndex];\n\t\t}\n\n\t\tlet after = nodeAfter(original);\n\n\t\treturn this.breakAt(after);\n\t}\n\n\ttextBreak(node, start, end, vStart, vEnd) {\n\t\tlet wordwalker = words(node);\n\t\tlet left = 0;\n\t\tlet right = 0;\n\t\tlet top = 0;\n\t\tlet bottom = 0;\n\t\tlet word, next, done, pos;\n\t\tlet offset;\n\t\twhile (!done) {\n\t\t\tnext = wordwalker.next();\n\t\t\tword = next.value;\n\t\t\tdone = next.done;\n\n\t\t\tif (!word) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tpos = getBoundingClientRect(word);\n\n\t\t\tleft = Math.floor(pos.left);\n\t\t\tright = Math.floor(pos.right);\n\t\t\ttop = Math.floor(pos.top);\n\t\t\tbottom = Math.floor(pos.bottom);\n\n\t\t\tif (left >= end || top >= vEnd) {\n\t\t\t\toffset = word.startOffset;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (right > end || bottom > vEnd) {\n\t\t\t\tlet letterwalker = letters(word);\n\t\t\t\tlet letter, nextLetter, doneLetter;\n\n\t\t\t\twhile (!doneLetter) {\n\t\t\t\t\tnextLetter = letterwalker.next();\n\t\t\t\t\tletter = nextLetter.value;\n\t\t\t\t\tdoneLetter = nextLetter.done;\n\n\t\t\t\t\tif (!letter) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tpos = getBoundingClientRect(letter);\n\t\t\t\t\tleft = Math.floor(pos.left);\n\t\t\t\t\ttop = Math.floor(pos.top);\n\n\t\t\t\t\tif (left >= end || top >= vEnd) {\n\t\t\t\t\t\toffset = letter.startOffset;\n\t\t\t\t\t\tdone = true;\n\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\treturn offset;\n\t}\n\n\tremoveOverflow(overflow, breakLetter) {\n\t\tlet {startContainer} = overflow;\n\t\tlet extracted = overflow.extractContents();\n\n\t\tthis.hyphenateAtBreak(startContainer, breakLetter);\n\n\t\treturn extracted;\n\t}\n\n\thyphenateAtBreak(startContainer, breakLetter) {\n\t\tif (isText(startContainer)) {\n\t\t\tlet startText = startContainer.textContent;\n\t\t\tlet prevLetter = startText[startText.length - 1];\n\n\t\t\t// Add a hyphen if previous character is a letter or soft hyphen\n\t\t\tif (\n\t\t\t\t(breakLetter && /^\\w|\\u00AD$/.test(prevLetter) && /^\\w|\\u00AD$/.test(breakLetter)) ||\n\t\t\t\t(!breakLetter && /^\\w|\\u00AD$/.test(prevLetter))\n\t\t\t) {\n\t\t\t\tstartContainer.parentNode.classList.add(\"pagedjs_hyphen\");\n\t\t\t\tstartContainer.textContent += this.settings.hyphenGlyph || \"\\u2011\";\n\t\t\t}\n\t\t}\n\t}\n\n\tequalTokens(a, b) {\n\t\tif (!a || !b) {\n\t\t\treturn false;\n\t\t}\n\t\tif (a[\"node\"] && b[\"node\"] && a[\"node\"] !== b[\"node\"]) {\n\t\t\treturn false;\n\t\t}\n\t\tif (a[\"offset\"] && b[\"offset\"] && a[\"offset\"] !== b[\"offset\"]) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n}\n\nEventEmitter(Layout.prototype);\n\nexport default Layout;\n","import Layout from \"./layout.js\";\nimport EventEmitter from \"event-emitter\";\n\n/**\n * Render a page\n * @class\n */\nclass Page {\n\tconstructor(pagesArea, pageTemplate, blank, hooks, options) {\n\t\tthis.pagesArea = pagesArea;\n\t\tthis.pageTemplate = pageTemplate;\n\t\tthis.blank = blank;\n\n\t\tthis.width = undefined;\n\t\tthis.height = undefined;\n\n\t\tthis.hooks = hooks;\n\n\t\tthis.settings = options || {};\n\n\t\t// this.element = this.create(this.pageTemplate);\n\t}\n\n\tcreate(template, after) {\n\t\t//let documentFragment = document.createRange().createContextualFragment( TEMPLATE );\n\t\t//let page = documentFragment.children[0];\n\t\tlet clone = document.importNode(this.pageTemplate.content, true);\n\n\t\tlet page, index;\n\t\tif (after) {\n\t\t\tthis.pagesArea.insertBefore(clone, after.nextElementSibling);\n\t\t\tindex = Array.prototype.indexOf.call(this.pagesArea.children, after.nextElementSibling);\n\t\t\tpage = this.pagesArea.children[index];\n\t\t} else {\n\t\t\tthis.pagesArea.appendChild(clone);\n\t\t\tpage = this.pagesArea.lastChild;\n\t\t}\n\n\t\tlet pagebox = page.querySelector(\".pagedjs_pagebox\");\n\t\tlet area = page.querySelector(\".pagedjs_page_content\");\n\t\tlet footnotesArea = page.querySelector(\".pagedjs_footnote_area\");\n\n\n\t\tlet size = area.getBoundingClientRect();\n\n\n\t\tarea.style.columnWidth = Math.round(size.width) + \"px\";\n\t\tarea.style.columnGap = \"calc(var(--pagedjs-margin-right) + var(--pagedjs-margin-left) + var(--pagedjs-bleed-right) + var(--pagedjs-bleed-left) + var(--pagedjs-column-gap-offset))\";\n\t\t// area.style.overflow = \"scroll\";\n\n\t\tthis.width = Math.round(size.width);\n\t\tthis.height = Math.round(size.height);\n\n\t\tthis.element = page;\n\t\tthis.pagebox = pagebox;\n\t\tthis.area = area;\n\t\tthis.footnotesArea = footnotesArea;\n\n\t\treturn page;\n\t}\n\n\tcreateWrapper() {\n\t\tlet wrapper = document.createElement(\"div\");\n\n\t\tthis.area.appendChild(wrapper);\n\n\t\tthis.wrapper = wrapper;\n\n\t\treturn wrapper;\n\t}\n\n\tindex(pgnum) {\n\t\tthis.position = pgnum;\n\n\t\tlet page = this.element;\n\t\t// let pagebox = this.pagebox;\n\n\t\tlet index = pgnum + 1;\n\n\t\tlet id = `page-${index}`;\n\n\t\tthis.id = id;\n\n\t\t// page.dataset.pageNumber = index;\n\n\t\tpage.dataset.pageNumber = index;\n\t\tpage.setAttribute(\"id\", id);\n\n\t\tif (this.name) {\n\t\t\tpage.classList.add(\"pagedjs_\" + this.name + \"_page\");\n\t\t}\n\n\t\tif (this.blank) {\n\t\t\tpage.classList.add(\"pagedjs_blank_page\");\n\t\t}\n\n\t\tif (pgnum === 0) {\n\t\t\tpage.classList.add(\"pagedjs_first_page\");\n\t\t}\n\n\t\tif (pgnum % 2 !== 1) {\n\t\t\tpage.classList.remove(\"pagedjs_left_page\");\n\t\t\tpage.classList.add(\"pagedjs_right_page\");\n\t\t} else {\n\t\t\tpage.classList.remove(\"pagedjs_right_page\");\n\t\t\tpage.classList.add(\"pagedjs_left_page\");\n\t\t}\n\t}\n\n\t/*\n\tsize(width, height) {\n\t\tif (width === this.width && height === this.height) {\n\t\t\treturn;\n\t\t}\n\t\tthis.width = width;\n\t\tthis.height = height;\n\n\t\tthis.element.style.width = Math.round(width) + \"px\";\n\t\tthis.element.style.height = Math.round(height) + \"px\";\n\t\tthis.element.style.columnWidth = Math.round(width) + \"px\";\n\t}\n\t*/\n\n\tasync layout(contents, breakToken, maxChars) {\n\n\t\tthis.clear();\n\n\t\tthis.startToken = breakToken;\n\n\t\tlet settings = this.settings;\n\t\tif (!settings.maxChars && maxChars) {\n\t\t\tsettings.maxChars = maxChars;\n\t\t}\n\n\t\tthis.layoutMethod = new Layout(this.area, this.hooks, settings);\n\n\t\tlet renderResult = await this.layoutMethod.renderTo(this.wrapper, contents, breakToken);\n\t\tlet newBreakToken = renderResult.breakToken;\n\n\t\tthis.addListeners(contents);\n\n\t\tthis.endToken = newBreakToken;\n\n\t\treturn newBreakToken;\n\t}\n\n\tasync append(contents, breakToken) {\n\n\t\tif (!this.layoutMethod) {\n\t\t\treturn this.layout(contents, breakToken);\n\t\t}\n\n\t\tlet renderResult = await this.layoutMethod.renderTo(this.wrapper, contents, breakToken);\n\t\tlet newBreakToken = renderResult.breakToken;\n\n\t\tthis.endToken = newBreakToken;\n\n\t\treturn newBreakToken;\n\t}\n\n\tgetByParent(ref, entries) {\n\t\tlet e;\n\t\tfor (var i = 0; i < entries.length; i++) {\n\t\t\te = entries[i];\n\t\t\tif (e.dataset.ref === ref) {\n\t\t\t\treturn e;\n\t\t\t}\n\t\t}\n\t}\n\n\tonOverflow(func) {\n\t\tthis._onOverflow = func;\n\t}\n\n\tonUnderflow(func) {\n\t\tthis._onUnderflow = func;\n\t}\n\n\tclear() {\n\t\tthis.removeListeners();\n\t\tthis.wrapper && this.wrapper.remove();\n\t\tthis.createWrapper();\n\t}\n\n\taddListeners(contents) {\n\t\tif (typeof ResizeObserver !== \"undefined\") {\n\t\t\tthis.addResizeObserver(contents);\n\t\t} else {\n\t\t\tthis._checkOverflowAfterResize = this.checkOverflowAfterResize.bind(this, contents);\n\t\t\tthis.element.addEventListener(\"overflow\", this._checkOverflowAfterResize, false);\n\t\t\tthis.element.addEventListener(\"underflow\", this._checkOverflowAfterResize, false);\n\t\t}\n\t\t// TODO: fall back to mutation observer?\n\n\t\tthis._onScroll = function () {\n\t\t\tif (this.listening) {\n\t\t\t\tthis.element.scrollLeft = 0;\n\t\t\t}\n\t\t}.bind(this);\n\n\t\t// Keep scroll left from changing\n\t\tthis.element.addEventListener(\"scroll\", this._onScroll);\n\n\t\tthis.listening = true;\n\n\t\treturn true;\n\t}\n\n\tremoveListeners() {\n\t\tthis.listening = false;\n\n\t\tif (typeof ResizeObserver !== \"undefined\" && this.ro) {\n\t\t\tthis.ro.disconnect();\n\t\t} else if (this.element) {\n\t\t\tthis.element.removeEventListener(\"overflow\", this._checkOverflowAfterResize, false);\n\t\t\tthis.element.removeEventListener(\"underflow\", this._checkOverflowAfterResize, false);\n\t\t}\n\n\t\tthis.element && this.element.removeEventListener(\"scroll\", this._onScroll);\n\n\t}\n\n\taddResizeObserver(contents) {\n\t\tlet wrapper = this.wrapper;\n\t\tlet prevHeight = wrapper.getBoundingClientRect().height;\n\t\tthis.ro = new ResizeObserver(entries => {\n\n\t\t\tif (!this.listening) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tfor (let entry of entries) {\n\t\t\t\t\tconst cr = entry.contentRect;\n\n\t\t\t\t\tif (cr.height > prevHeight) {\n\t\t\t\t\t\tthis.checkOverflowAfterResize(contents);\n\t\t\t\t\t\tprevHeight = wrapper.getBoundingClientRect().height;\n\t\t\t\t\t} else if (cr.height < prevHeight) { // TODO: calc line height && (prevHeight - cr.height) >= 22\n\t\t\t\t\t\tthis.checkUnderflowAfterResize(contents);\n\t\t\t\t\t\tprevHeight = cr.height;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tthis.ro.observe(wrapper);\n\t}\n\n\tcheckOverflowAfterResize(contents) {\n\t\tif (!this.listening || !this.layoutMethod) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet newBreakToken = this.layoutMethod.findBreakToken(this.wrapper, contents, this.startToken);\n\n\t\tif (newBreakToken) {\n\t\t\tthis.endToken = newBreakToken;\n\t\t\tthis._onOverflow && this._onOverflow(newBreakToken);\n\t\t}\n\t}\n\n\tcheckUnderflowAfterResize(contents) {\n\t\tif (!this.listening || !this.layoutMethod) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet endToken = this.layoutMethod.findEndToken(this.wrapper, contents);\n\n\t\tif (endToken) {\n\t\t\tthis._onUnderflow && this._onUnderflow(endToken);\n\t\t}\n\t}\n\n\n\tdestroy() {\n\t\tthis.removeListeners();\n\n\t\tthis.element.remove();\n\n\t\tthis.element = undefined;\n\t\tthis.wrapper = undefined;\n\t}\n}\n\nEventEmitter(Page.prototype);\n\n\nexport default Page;\n","import {UUID} from \"../utils/utils.js\";\n\n/**\n * Render a flow of text offscreen\n * @class\n */\nclass ContentParser {\n\n\tconstructor(content, cb) {\n\t\tif (content && content.nodeType) {\n\t\t\t// handle dom\n\t\t\tthis.dom = this.add(content);\n\t\t} else if (typeof content === \"string\") {\n\t\t\tthis.dom = this.parse(content);\n\t\t}\n\n\t\treturn this.dom;\n\t}\n\n\tparse(markup, mime) {\n\t\tlet range = document.createRange();\n\t\tlet fragment = range.createContextualFragment(markup);\n\n\t\tthis.addRefs(fragment);\n\n\t\treturn fragment;\n\t}\n\n\tadd(contents) {\n\t\t// let fragment = document.createDocumentFragment();\n\t\t//\n\t\t// let children = [...contents.childNodes];\n\t\t// for (let child of children) {\n\t\t// \tlet clone = child.cloneNode(true);\n\t\t// \tfragment.appendChild(clone);\n\t\t// }\n\n\t\tthis.addRefs(contents);\n\n\t\treturn contents;\n\t}\n\n\taddRefs(content) {\n\t\tvar treeWalker = document.createTreeWalker(\n\t\t\tcontent,\n\t\t\tNodeFilter.SHOW_ELEMENT,\n\t\t\tnull,\n\t\t\tfalse\n\t\t);\n\n\t\tlet node = treeWalker.nextNode();\n\t\twhile(node) {\n\n\t\t\tif (!node.hasAttribute(\"data-ref\")) {\n\t\t\t\tlet uuid = UUID();\n\t\t\t\tnode.setAttribute(\"data-ref\", uuid);\n\t\t\t}\n\n\t\t\tif (node.id) {\n\t\t\t\tnode.setAttribute(\"data-id\", node.id);\n\t\t\t}\n\n\t\t\t// node.setAttribute(\"data-children\", node.childNodes.length);\n\n\t\t\t// node.setAttribute(\"data-text\", node.textContent.trim().length);\n\t\t\tnode = treeWalker.nextNode();\n\t\t}\n\t}\n\n\tfind(ref) {\n\t\treturn this.refs[ref];\n\t}\n\n\tdestroy() {\n\t\tthis.refs = undefined;\n\t\tthis.dom = undefined;\n\t}\n}\n\nexport default ContentParser;\n","import {defer} from \"./utils.js\";\n\n/**\n * Queue for handling tasks one at a time\n * @class\n * @param {scope} context what this will resolve to in the tasks\n */\nclass Queue {\n\tconstructor(context){\n\t\tthis._q = [];\n\t\tthis.context = context;\n\t\tthis.tick = requestAnimationFrame;\n\t\tthis.running = false;\n\t\tthis.paused = false;\n\t}\n\n\t/**\n\t * Add an item to the queue\n\t * @return {Promise} enqueued\n\t */\n\tenqueue() {\n\t\tvar deferred, promise;\n\t\tvar queued;\n\t\tvar task = [].shift.call(arguments);\n\t\tvar args = arguments;\n\n\t\t// Handle single args without context\n\t\t// if(args && !Array.isArray(args)) {\n\t\t//   args = [args];\n\t\t// }\n\t\tif(!task) {\n\t\t\tthrow new Error(\"No Task Provided\");\n\t\t}\n\n\t\tif(typeof task === \"function\"){\n\n\t\t\tdeferred = new defer();\n\t\t\tpromise = deferred.promise;\n\n\t\t\tqueued = {\n\t\t\t\t\"task\" : task,\n\t\t\t\t\"args\"     : args,\n\t\t\t\t//\"context\"  : context,\n\t\t\t\t\"deferred\" : deferred,\n\t\t\t\t\"promise\" : promise\n\t\t\t};\n\n\t\t} else {\n\t\t\t// Task is a promise\n\t\t\tqueued = {\n\t\t\t\t\"promise\" : task\n\t\t\t};\n\n\t\t}\n\n\t\tthis._q.push(queued);\n\n\t\t// Wait to start queue flush\n\t\tif (this.paused == false && !this.running) {\n\t\t\tthis.run();\n\t\t}\n\n\t\treturn queued.promise;\n\t}\n\n\t/**\n\t * Run one item\n\t * @return {Promise} dequeued\n\t */\n\tdequeue(){\n\t\tvar inwait, task, result;\n\n\t\tif(this._q.length && !this.paused) {\n\t\t\tinwait = this._q.shift();\n\t\t\ttask = inwait.task;\n\t\t\tif(task){\n\t\t\t\t// console.log(task)\n\n\t\t\t\tresult = task.apply(this.context, inwait.args);\n\n\t\t\t\tif(result && typeof result[\"then\"] === \"function\") {\n\t\t\t\t\t// Task is a function that returns a promise\n\t\t\t\t\treturn result.then(function(){\n\t\t\t\t\t\tinwait.deferred.resolve.apply(this.context, arguments);\n\t\t\t\t\t}.bind(this), function() {\n\t\t\t\t\t\tinwait.deferred.reject.apply(this.context, arguments);\n\t\t\t\t\t}.bind(this));\n\t\t\t\t} else {\n\t\t\t\t\t// Task resolves immediately\n\t\t\t\t\tinwait.deferred.resolve.apply(this.context, result);\n\t\t\t\t\treturn inwait.promise;\n\t\t\t\t}\n\n\n\n\t\t\t} else if(inwait.promise) {\n\t\t\t\t// Task is a promise\n\t\t\t\treturn inwait.promise;\n\t\t\t}\n\n\t\t} else {\n\t\t\tinwait = new defer();\n\t\t\tinwait.deferred.resolve();\n\t\t\treturn inwait.promise;\n\t\t}\n\n\t}\n\n\t// Run All Immediately\n\tdump(){\n\t\twhile(this._q.length) {\n\t\t\tthis.dequeue();\n\t\t}\n\t}\n\n\t/**\n\t * Run all tasks sequentially, at convince\n\t * @return {Promise} all run\n\t */\n\trun(){\n\n\t\tif(!this.running){\n\t\t\tthis.running = true;\n\t\t\tthis.defered = new defer();\n\t\t}\n\n\t\tthis.tick.call(window, () => {\n\n\t\t\tif(this._q.length) {\n\n\t\t\t\tthis.dequeue()\n\t\t\t\t\t.then(function(){\n\t\t\t\t\t\tthis.run();\n\t\t\t\t\t}.bind(this));\n\n\t\t\t} else {\n\t\t\t\tthis.defered.resolve();\n\t\t\t\tthis.running = undefined;\n\t\t\t}\n\n\t\t});\n\n\t\t// Unpause\n\t\tif(this.paused == true) {\n\t\t\tthis.paused = false;\n\t\t}\n\n\t\treturn this.defered.promise;\n\t}\n\n\t/**\n\t * Flush all, as quickly as possible\n\t * @return {Promise} ran\n\t */\n\tflush(){\n\n\t\tif(this.running){\n\t\t\treturn this.running;\n\t\t}\n\n\t\tif(this._q.length) {\n\t\t\tthis.running = this.dequeue()\n\t\t\t\t.then(function(){\n\t\t\t\t\tthis.running = undefined;\n\t\t\t\t\treturn this.flush();\n\t\t\t\t}.bind(this));\n\n\t\t\treturn this.running;\n\t\t}\n\n\t}\n\n\t/**\n\t * Clear all items in wait\n\t * @return {void}\n\t */\n\tclear(){\n\t\tthis._q = [];\n\t}\n\n\t/**\n\t * Get the number of tasks in the queue\n\t * @return {number} tasks\n\t */\n\tlength(){\n\t\treturn this._q.length;\n\t}\n\n\t/**\n\t * Pause a running queue\n\t * @return {void}\n\t */\n\tpause(){\n\t\tthis.paused = true;\n\t}\n\n\t/**\n\t * End the queue\n\t * @return {void}\n\t */\n\tstop(){\n\t\tthis._q = [];\n\t\tthis.running = false;\n\t\tthis.paused = true;\n\t}\n}\n\n\n/**\n * Create a new task from a callback\n * @class\n * @private\n * @param {function} task task to complete\n * @param {array} args arguments for the task\n * @param {scope} context scope of the task\n * @return {function} task\n */\nclass Task {\n\tconstructor(task, args, context){\n\n\t\treturn function(){\n\t\t\tvar toApply = arguments || [];\n\n\t\t\treturn new Promise( (resolve, reject) => {\n\t\t\t\tvar callback = function(value, err){\n\t\t\t\t\tif (!value && err) {\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresolve(value);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\t// Add the callback to the arguments list\n\t\t\t\ttoApply.push(callback);\n\n\t\t\t\t// Apply all arguments to the functions\n\t\t\t\ttask.apply(context || this, toApply);\n\n\t\t\t});\n\n\t\t};\n\n\t}\n}\n\n\nexport default Queue;\nexport { Task };\n","import Page from \"./page.js\";\nimport ContentParser from \"./parser.js\";\nimport EventEmitter from \"event-emitter\";\nimport Hook from \"../utils/hook.js\";\nimport Queue from \"../utils/queue.js\";\nimport {\n\trequestIdleCallback\n} from \"../utils/utils.js\";\nimport { OverflowContentError } from \"./renderresult.js\";\n\nconst MAX_PAGES = false;\nconst MAX_LAYOUTS = false;\n\nconst TEMPLATE = `\n<div class=\"pagedjs_page\">\n\t<div class=\"pagedjs_sheet\">\n\t\t<div class=\"pagedjs_bleed pagedjs_bleed-top\">\n\t\t\t<div class=\"pagedjs_marks-crop\"></div>\n\t\t\t<div class=\"pagedjs_marks-middle\">\n\t\t\t\t<div class=\"pagedjs_marks-cross\"></div>\n\t\t\t</div>\n\t\t\t<div class=\"pagedjs_marks-crop\"></div>\n\t\t</div>\n\t\t<div class=\"pagedjs_bleed pagedjs_bleed-bottom\">\n\t\t\t<div class=\"pagedjs_marks-crop\"></div>\n\t\t\t<div class=\"pagedjs_marks-middle\">\n\t\t\t\t<div class=\"pagedjs_marks-cross\"></div>\n\t\t\t</div>\t\t<div class=\"pagedjs_marks-crop\"></div>\n\t\t</div>\n\t\t<div class=\"pagedjs_bleed pagedjs_bleed-left\">\n\t\t\t<div class=\"pagedjs_marks-crop\"></div>\n\t\t\t<div class=\"pagedjs_marks-middle\">\n\t\t\t\t<div class=\"pagedjs_marks-cross\"></div>\n\t\t\t</div>\t\t<div class=\"pagedjs_marks-crop\"></div>\n\t\t</div>\n\t\t<div class=\"pagedjs_bleed pagedjs_bleed-right\">\n\t\t\t<div class=\"pagedjs_marks-crop\"></div>\n\t\t\t<div class=\"pagedjs_marks-middle\">\n\t\t\t\t<div class=\"pagedjs_marks-cross\"></div>\n\t\t\t</div>\n\t\t\t<div class=\"pagedjs_marks-crop\"></div>\n\t\t</div>\n\t\t<div class=\"pagedjs_pagebox\">\n\t\t\t<div class=\"pagedjs_margin-top-left-corner-holder\">\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-top-left-corner\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t</div>\n\t\t\t<div class=\"pagedjs_margin-top\">\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-top-left\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-top-center\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-top-right\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t</div>\n\t\t\t<div class=\"pagedjs_margin-top-right-corner-holder\">\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-top-right-corner\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t</div>\n\t\t\t<div class=\"pagedjs_margin-right\">\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-right-top\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-right-middle\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-right-bottom\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t</div>\n\t\t\t<div class=\"pagedjs_margin-left\">\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-left-top\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-left-middle\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-left-bottom\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t</div>\n\t\t\t<div class=\"pagedjs_margin-bottom-left-corner-holder\">\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-bottom-left-corner\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t</div>\n\t\t\t<div class=\"pagedjs_margin-bottom\">\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-bottom-left\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-bottom-center\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-bottom-right\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t</div>\n\t\t\t<div class=\"pagedjs_margin-bottom-right-corner-holder\">\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-bottom-right-corner\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t</div>\n\t\t\t<div class=\"pagedjs_area\">\n\t\t\t\t<div class=\"pagedjs_page_content\"></div>\n\t\t\t\t<div class=\"pagedjs_footnote_area\">\n\t\t\t\t\t<div class=\"pagedjs_footnote_content pagedjs_footnote_empty\">\n\t\t\t\t\t\t<div class=\"pagedjs_footnote_inner_content\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>`;\n\n/**\n * Chop up text into flows\n * @class\n */\nclass Chunker {\n\tconstructor(content, renderTo, options) {\n\t\t// this.preview = preview;\n\n\t\tthis.settings = options || {};\n\n\t\tthis.hooks = {};\n\t\tthis.hooks.beforeParsed = new Hook(this);\n\t\tthis.hooks.filter = new Hook(this);\n\t\tthis.hooks.afterParsed = new Hook(this);\n\t\tthis.hooks.beforePageLayout = new Hook(this);\n\t\tthis.hooks.onPageLayout = new Hook(this);\n\t\tthis.hooks.layout = new Hook(this);\n\t\tthis.hooks.renderNode = new Hook(this);\n\t\tthis.hooks.layoutNode = new Hook(this);\n\t\tthis.hooks.onOverflow = new Hook(this);\n\t\tthis.hooks.afterOverflowRemoved = new Hook(this);\n\t\tthis.hooks.onBreakToken = new Hook();\n\t\tthis.hooks.beforeRenderResult = new Hook(this);\n\t\tthis.hooks.afterPageLayout = new Hook(this);\n\t\tthis.hooks.finalizePage = new Hook(this);\n\t\tthis.hooks.afterRendered = new Hook(this);\n\n\t\tthis.pages = [];\n\t\tthis.total = 0;\n\n\t\tthis.q = new Queue(this);\n\t\tthis.stopped = false;\n\t\tthis.rendered = false;\n\n\t\tthis.content = content;\n\n\t\tthis.charsPerBreak = [];\n\t\tthis.maxChars;\n\n\t\tif (content) {\n\t\t\tthis.flow(content, renderTo);\n\t\t}\n\t}\n\n\tsetup(renderTo) {\n\t\tthis.pagesArea = document.createElement(\"div\");\n\t\tthis.pagesArea.classList.add(\"pagedjs_pages\");\n\n\t\tif (renderTo) {\n\t\t\trenderTo.appendChild(this.pagesArea);\n\t\t} else {\n\t\t\tdocument.querySelector(\"body\").appendChild(this.pagesArea);\n\t\t}\n\n\t\tthis.pageTemplate = document.createElement(\"template\");\n\t\tthis.pageTemplate.innerHTML = TEMPLATE;\n\n\t}\n\n\tasync flow(content, renderTo) {\n\t\tlet parsed;\n\n\t\tawait this.hooks.beforeParsed.trigger(content, this);\n\n\t\tparsed = new ContentParser(content);\n\n\t\tthis.hooks.filter.triggerSync(parsed);\n\n\t\tthis.source = parsed;\n\t\tthis.breakToken = undefined;\n\n\t\tif (this.pagesArea && this.pageTemplate) {\n\t\t\tthis.q.clear();\n\t\t\tthis.removePages();\n\t\t} else {\n\t\t\tthis.setup(renderTo);\n\t\t}\n\n\t\tthis.emit(\"rendering\", parsed);\n\n\t\tawait this.hooks.afterParsed.trigger(parsed, this);\n\n\t\tawait this.loadFonts();\n\n\t\tlet rendered = await this.render(parsed, this.breakToken);\n\t\twhile (rendered.canceled) {\n\t\t\tthis.start();\n\t\t\trendered = await this.render(parsed, this.breakToken);\n\t\t}\n\n\t\tthis.rendered = true;\n\t\tthis.pagesArea.style.setProperty(\"--pagedjs-page-count\", this.total);\n\n\t\tawait this.hooks.afterRendered.trigger(this.pages, this);\n\n\t\tthis.emit(\"rendered\", this.pages);\n\n\n\n\t\treturn this;\n\t}\n\n\t// oversetPages() {\n\t// \tlet overset = [];\n\t// \tfor (let i = 0; i < this.pages.length; i++) {\n\t// \t\tlet page = this.pages[i];\n\t// \t\tif (page.overset) {\n\t// \t\t\toverset.push(page);\n\t// \t\t\t// page.overset = false;\n\t// \t\t}\n\t// \t}\n\t// \treturn overset;\n\t// }\n\t//\n\t// async handleOverset(parsed) {\n\t// \tlet overset = this.oversetPages();\n\t// \tif (overset.length) {\n\t// \t\tconsole.log(\"overset\", overset);\n\t// \t\tlet index = this.pages.indexOf(overset[0]) + 1;\n\t// \t\tconsole.log(\"INDEX\", index);\n\t//\n\t// \t\t// Remove pages\n\t// \t\t// this.removePages(index);\n\t//\n\t// \t\t// await this.render(parsed, overset[0].overset);\n\t//\n\t// \t\t// return this.handleOverset(parsed);\n\t// \t}\n\t// }\n\n\tasync render(parsed, startAt) {\n\t\tlet renderer = this.layout(parsed, startAt);\n\n\t\tlet done = false;\n\t\tlet result;\n\n\t\tlet loops = 0;\n\t\twhile (!done) {\n\t\t\tresult = await this.q.enqueue(() => { return this.renderAsync(renderer); });\n\t\t\tdone = result.done;\n\t\t\tif(MAX_LAYOUTS) {\n\t\t\t\tloops += 1;\n\t\t\t\tif (loops >= MAX_LAYOUTS) {\n\t\t\t\t\tthis.stop();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tstart() {\n\t\tthis.rendered = false;\n\t\tthis.stopped = false;\n\t}\n\n\tstop() {\n\t\tthis.stopped = true;\n\t\t// this.q.clear();\n\t}\n\n\trenderOnIdle(renderer) {\n\t\treturn new Promise(resolve => {\n\t\t\trequestIdleCallback(async () => {\n\t\t\t\tif (this.stopped) {\n\t\t\t\t\treturn resolve({ done: true, canceled: true });\n\t\t\t\t}\n\t\t\t\tlet result = await renderer.next();\n\t\t\t\tif (this.stopped) {\n\t\t\t\t\tresolve({ done: true, canceled: true });\n\t\t\t\t} else {\n\t\t\t\t\tresolve(result);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tasync renderAsync(renderer) {\n\t\tif (this.stopped) {\n\t\t\treturn { done: true, canceled: true };\n\t\t}\n\t\tlet result = await renderer.next();\n\t\tif (this.stopped) {\n\t\t\treturn { done: true, canceled: true };\n\t\t} else {\n\t\t\treturn result;\n\t\t}\n\t}\n\n\tasync handleBreaks(node, force) {\n\t\tlet currentPage = this.total + 1;\n\t\tlet currentPosition = currentPage % 2 === 0 ? \"left\" : \"right\";\n\t\t// TODO: Recto and Verso should reverse for rtl languages\n\t\tlet currentSide = currentPage % 2 === 0 ? \"verso\" : \"recto\";\n\t\tlet previousBreakAfter;\n\t\tlet breakBefore;\n\t\tlet page;\n\n\t\tif (currentPage === 1) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (node &&\n\t\t\t\ttypeof node.dataset !== \"undefined\" &&\n\t\t\t\ttypeof node.dataset.previousBreakAfter !== \"undefined\") {\n\t\t\tpreviousBreakAfter = node.dataset.previousBreakAfter;\n\t\t}\n\n\t\tif (node &&\n\t\t\t\ttypeof node.dataset !== \"undefined\" &&\n\t\t\t\ttypeof node.dataset.breakBefore !== \"undefined\") {\n\t\t\tbreakBefore = node.dataset.breakBefore;\n\t\t}\n\n\t\tif (force) {\n\t\t\tpage = this.addPage(true);\n\t\t} else if( previousBreakAfter &&\n\t\t\t\t(previousBreakAfter === \"left\" || previousBreakAfter === \"right\") &&\n\t\t\t\tpreviousBreakAfter !== currentPosition) {\n\t\t\tpage = this.addPage(true);\n\t\t} else if( previousBreakAfter &&\n\t\t\t\t(previousBreakAfter === \"verso\" || previousBreakAfter === \"recto\") &&\n\t\t\t\tpreviousBreakAfter !== currentSide) {\n\t\t\tpage = this.addPage(true);\n\t\t} else if( breakBefore &&\n\t\t\t\t(breakBefore === \"left\" || breakBefore === \"right\") &&\n\t\t\t\tbreakBefore !== currentPosition) {\n\t\t\tpage = this.addPage(true);\n\t\t} else if( breakBefore &&\n\t\t\t\t(breakBefore === \"verso\" || breakBefore === \"recto\") &&\n\t\t\t\tbreakBefore !== currentSide) {\n\t\t\tpage = this.addPage(true);\n\t\t}\n\n\t\tif (page) {\n\t\t\tawait this.hooks.beforePageLayout.trigger(page, undefined, undefined, this);\n\t\t\tthis.emit(\"page\", page);\n\t\t\t// await this.hooks.layout.trigger(page.element, page, undefined, this);\n\t\t\tawait this.hooks.afterPageLayout.trigger(page.element, page, undefined, this);\n\t\t\tawait this.hooks.finalizePage.trigger(page.element, page, undefined, this);\n\t\t\tthis.emit(\"renderedPage\", page);\n\t\t}\n\t}\n\n\tasync *layout(content, startAt) {\n\t\tlet breakToken = startAt || false;\n\t\tlet tokens = [];\n\n\t\twhile (breakToken !== undefined && (MAX_PAGES ? this.total < MAX_PAGES : true)) {\n\n\t\t\tif (breakToken && breakToken.node) {\n\t\t\t\tawait this.handleBreaks(breakToken.node);\n\t\t\t} else {\n\t\t\t\tawait this.handleBreaks(content.firstChild);\n\t\t\t}\n\n\t\t\tlet page = this.addPage();\n\n\t\t\tawait this.hooks.beforePageLayout.trigger(page, content, breakToken, this);\n\t\t\tthis.emit(\"page\", page);\n\n\t\t\t// Layout content in the page, starting from the breakToken\n\t\t\tbreakToken = await page.layout(content, breakToken, this.maxChars);\n\n\t\t\tif (breakToken) {\n\t\t\t\tlet newToken = breakToken.toJSON(true);\n\t\t\t\tif (tokens.lastIndexOf(newToken) > -1) {\n\t\t\t\t\t// loop\n\t\t\t\t\tlet err = new OverflowContentError(\"Layout repeated\", [breakToken.node]);\n\t\t\t\t\tconsole.error(\"Layout repeated at: \", breakToken.node);\n\t\t\t\t\treturn err;\n\t\t\t\t} else {\n\t\t\t\t\ttokens.push(newToken);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tawait this.hooks.afterPageLayout.trigger(page.element, page, breakToken, this);\n\t\t\tawait this.hooks.finalizePage.trigger(page.element, page, undefined, this);\n\t\t\tthis.emit(\"renderedPage\", page);\n\n\t\t\tthis.recoredCharLength(page.wrapper.textContent.length);\n\n\t\t\tyield breakToken;\n\n\t\t\t// Stop if we get undefined, showing we have reached the end of the content\n\t\t}\n\n\n\t}\n\n\trecoredCharLength(length) {\n\t\tif (length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.charsPerBreak.push(length);\n\n\t\t// Keep the length of the last few breaks\n\t\tif (this.charsPerBreak.length > 4) {\n\t\t\tthis.charsPerBreak.shift();\n\t\t}\n\n\t\tthis.maxChars = this.charsPerBreak.reduce((a, b) => a + b, 0) / (this.charsPerBreak.length);\n\t}\n\n\tremovePages(fromIndex=0) {\n\n\t\tif (fromIndex >= this.pages.length) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Remove pages\n\t\tfor (let i = fromIndex; i < this.pages.length; i++) {\n\t\t\tthis.pages[i].destroy();\n\t\t}\n\n\t\tif (fromIndex > 0) {\n\t\t\tthis.pages.splice(fromIndex);\n\t\t} else {\n\t\t\tthis.pages = [];\n\t\t}\n\n\t\tthis.total = this.pages.length;\n\t}\n\n\taddPage(blank) {\n\t\tlet lastPage = this.pages[this.pages.length - 1];\n\t\t// Create a new page from the template\n\t\tlet page = new Page(this.pagesArea, this.pageTemplate, blank, this.hooks, this.settings);\n\n\t\tthis.pages.push(page);\n\n\t\t// Create the pages\n\t\tpage.create(undefined, lastPage && lastPage.element);\n\n\t\tpage.index(this.total);\n\n\t\tif (!blank) {\n\t\t\t// Listen for page overflow\n\t\t\tpage.onOverflow((overflowToken) => {\n\t\t\t\tconsole.warn(\"overflow on\", page.id, overflowToken);\n\n\t\t\t\t// Only reflow while rendering\n\t\t\t\tif (this.rendered) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet index = this.pages.indexOf(page) + 1;\n\n\t\t\t\t// Stop the rendering\n\t\t\t\tthis.stop();\n\n\t\t\t\t// Set the breakToken to resume at\n\t\t\t\tthis.breakToken = overflowToken;\n\n\t\t\t\t// Remove pages\n\t\t\t\tthis.removePages(index);\n\n\t\t\t\tif (this.rendered === true) {\n\t\t\t\t\tthis.rendered = false;\n\n\t\t\t\t\tthis.q.enqueue(async () => {\n\n\t\t\t\t\t\tthis.start();\n\n\t\t\t\t\t\tawait this.render(this.source, this.breakToken);\n\n\t\t\t\t\t\tthis.rendered = true;\n\n\t\t\t\t\t});\n\t\t\t\t}\n\n\n\t\t\t});\n\n\t\t\tpage.onUnderflow((overflowToken) => {\n\t\t\t\t// console.log(\"underflow on\", page.id, overflowToken);\n\n\t\t\t\t// page.append(this.source, overflowToken);\n\n\t\t\t});\n\t\t}\n\n\t\tthis.total = this.pages.length;\n\n\t\treturn page;\n\t}\n\t/*\n\tinsertPage(index, blank) {\n\t\tlet lastPage = this.pages[index];\n\t\t// Create a new page from the template\n\t\tlet page = new Page(this.pagesArea, this.pageTemplate, blank, this.hooks);\n\n\t\tlet total = this.pages.splice(index, 0, page);\n\n\t\t// Create the pages\n\t\tpage.create(undefined, lastPage && lastPage.element);\n\n\t\tpage.index(index + 1);\n\n\t\tfor (let i = index + 2; i < this.pages.length; i++) {\n\t\t\tthis.pages[i].index(i);\n\t\t}\n\n\t\tif (!blank) {\n\t\t\t// Listen for page overflow\n\t\t\tpage.onOverflow((overflowToken) => {\n\t\t\t\tif (total < this.pages.length) {\n\t\t\t\t\tthis.pages[total].layout(this.source, overflowToken);\n\t\t\t\t} else {\n\t\t\t\t\tlet newPage = this.addPage();\n\t\t\t\t\tnewPage.layout(this.source, overflowToken);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tpage.onUnderflow(() => {\n\t\t\t\t// console.log(\"underflow on\", page.id);\n\t\t\t});\n\t\t}\n\n\t\tthis.total += 1;\n\n\t\treturn page;\n\t}\n\t*/\n\n\tasync clonePage(originalPage) {\n\t\tlet lastPage = this.pages[this.pages.length - 1];\n\n\t\tlet page = new Page(this.pagesArea, this.pageTemplate, false, this.hooks);\n\n\t\tthis.pages.push(page);\n\n\t\t// Create the pages\n\t\tpage.create(undefined, lastPage && lastPage.element);\n\n\t\tpage.index(this.total);\n\n\t\tawait this.hooks.beforePageLayout.trigger(page, undefined, undefined, this);\n\t\tthis.emit(\"page\", page);\n\n\t\tfor (const className of originalPage.element.classList) {\n\t\t\tif (className !== \"pagedjs_left_page\" && className !== \"pagedjs_right_page\") {\n\t\t\t\tpage.element.classList.add(className);\n\t\t\t}\n\t\t}\n\n\t\tawait this.hooks.afterPageLayout.trigger(page.element, page, undefined, this);\n\t\tawait this.hooks.finalizePage.trigger(page.element, page, undefined, this);\n\t\tthis.emit(\"renderedPage\", page);\n\t}\n\n\tloadFonts() {\n\t\tlet fontPromises = [];\n\t\t(document.fonts || []).forEach((fontFace) => {\n\t\t\tif (fontFace.status !== \"loaded\") {\n\t\t\t\tlet fontLoaded = fontFace.load().then((r) => {\n\t\t\t\t\treturn fontFace.family;\n\t\t\t\t}, (r) => {\n\t\t\t\t\tconsole.warn(\"Failed to preload font-family:\", fontFace.family);\n\t\t\t\t\treturn fontFace.family;\n\t\t\t\t});\n\t\t\t\tfontPromises.push(fontLoaded);\n\t\t\t}\n\t\t});\n\t\treturn Promise.all(fontPromises).catch((err) => {\n\t\t\tconsole.warn(err);\n\t\t});\n\t}\n\n\tdestroy() {\n\t\tthis.pagesArea.remove();\n\t\tthis.pageTemplate.remove();\n\t}\n\n}\n\nEventEmitter(Chunker.prototype);\n\nexport default Chunker;\n","//\n//                              list\n//                            ┌──────┐\n//             ┌──────────────┼─head │\n//             │              │ tail─┼──────────────┐\n//             │              └──────┘              │\n//             ▼                                    ▼\n//            item        item        item        item\n//          ┌──────┐    ┌──────┐    ┌──────┐    ┌──────┐\n//  null ◀──┼─prev │◀───┼─prev │◀───┼─prev │◀───┼─prev │\n//          │ next─┼───▶│ next─┼───▶│ next─┼───▶│ next─┼──▶ null\n//          ├──────┤    ├──────┤    ├──────┤    ├──────┤\n//          │ data │    │ data │    │ data │    │ data │\n//          └──────┘    └──────┘    └──────┘    └──────┘\n//\n\nfunction createItem(data) {\n    return {\n        prev: null,\n        next: null,\n        data: data\n    };\n}\n\nfunction allocateCursor(node, prev, next) {\n    var cursor;\n\n    if (cursors !== null) {\n        cursor = cursors;\n        cursors = cursors.cursor;\n        cursor.prev = prev;\n        cursor.next = next;\n        cursor.cursor = node.cursor;\n    } else {\n        cursor = {\n            prev: prev,\n            next: next,\n            cursor: node.cursor\n        };\n    }\n\n    node.cursor = cursor;\n\n    return cursor;\n}\n\nfunction releaseCursor(node) {\n    var cursor = node.cursor;\n\n    node.cursor = cursor.cursor;\n    cursor.prev = null;\n    cursor.next = null;\n    cursor.cursor = cursors;\n    cursors = cursor;\n}\n\nvar cursors = null;\nvar List = function() {\n    this.cursor = null;\n    this.head = null;\n    this.tail = null;\n};\n\nList.createItem = createItem;\nList.prototype.createItem = createItem;\n\nList.prototype.updateCursors = function(prevOld, prevNew, nextOld, nextNew) {\n    var cursor = this.cursor;\n\n    while (cursor !== null) {\n        if (cursor.prev === prevOld) {\n            cursor.prev = prevNew;\n        }\n\n        if (cursor.next === nextOld) {\n            cursor.next = nextNew;\n        }\n\n        cursor = cursor.cursor;\n    }\n};\n\nList.prototype.getSize = function() {\n    var size = 0;\n    var cursor = this.head;\n\n    while (cursor) {\n        size++;\n        cursor = cursor.next;\n    }\n\n    return size;\n};\n\nList.prototype.fromArray = function(array) {\n    var cursor = null;\n\n    this.head = null;\n\n    for (var i = 0; i < array.length; i++) {\n        var item = createItem(array[i]);\n\n        if (cursor !== null) {\n            cursor.next = item;\n        } else {\n            this.head = item;\n        }\n\n        item.prev = cursor;\n        cursor = item;\n    }\n\n    this.tail = cursor;\n\n    return this;\n};\n\nList.prototype.toArray = function() {\n    var cursor = this.head;\n    var result = [];\n\n    while (cursor) {\n        result.push(cursor.data);\n        cursor = cursor.next;\n    }\n\n    return result;\n};\n\nList.prototype.toJSON = List.prototype.toArray;\n\nList.prototype.isEmpty = function() {\n    return this.head === null;\n};\n\nList.prototype.first = function() {\n    return this.head && this.head.data;\n};\n\nList.prototype.last = function() {\n    return this.tail && this.tail.data;\n};\n\nList.prototype.each = function(fn, context) {\n    var item;\n\n    if (context === undefined) {\n        context = this;\n    }\n\n    // push cursor\n    var cursor = allocateCursor(this, null, this.head);\n\n    while (cursor.next !== null) {\n        item = cursor.next;\n        cursor.next = item.next;\n\n        fn.call(context, item.data, item, this);\n    }\n\n    // pop cursor\n    releaseCursor(this);\n};\n\nList.prototype.forEach = List.prototype.each;\n\nList.prototype.eachRight = function(fn, context) {\n    var item;\n\n    if (context === undefined) {\n        context = this;\n    }\n\n    // push cursor\n    var cursor = allocateCursor(this, this.tail, null);\n\n    while (cursor.prev !== null) {\n        item = cursor.prev;\n        cursor.prev = item.prev;\n\n        fn.call(context, item.data, item, this);\n    }\n\n    // pop cursor\n    releaseCursor(this);\n};\n\nList.prototype.forEachRight = List.prototype.eachRight;\n\nList.prototype.reduce = function(fn, initialValue, context) {\n    var item;\n\n    if (context === undefined) {\n        context = this;\n    }\n\n    // push cursor\n    var cursor = allocateCursor(this, null, this.head);\n    var acc = initialValue;\n\n    while (cursor.next !== null) {\n        item = cursor.next;\n        cursor.next = item.next;\n\n        acc = fn.call(context, acc, item.data, item, this);\n    }\n\n    // pop cursor\n    releaseCursor(this);\n\n    return acc;\n};\n\nList.prototype.reduceRight = function(fn, initialValue, context) {\n    var item;\n\n    if (context === undefined) {\n        context = this;\n    }\n\n    // push cursor\n    var cursor = allocateCursor(this, this.tail, null);\n    var acc = initialValue;\n\n    while (cursor.prev !== null) {\n        item = cursor.prev;\n        cursor.prev = item.prev;\n\n        acc = fn.call(context, acc, item.data, item, this);\n    }\n\n    // pop cursor\n    releaseCursor(this);\n\n    return acc;\n};\n\nList.prototype.nextUntil = function(start, fn, context) {\n    if (start === null) {\n        return;\n    }\n\n    var item;\n\n    if (context === undefined) {\n        context = this;\n    }\n\n    // push cursor\n    var cursor = allocateCursor(this, null, start);\n\n    while (cursor.next !== null) {\n        item = cursor.next;\n        cursor.next = item.next;\n\n        if (fn.call(context, item.data, item, this)) {\n            break;\n        }\n    }\n\n    // pop cursor\n    releaseCursor(this);\n};\n\nList.prototype.prevUntil = function(start, fn, context) {\n    if (start === null) {\n        return;\n    }\n\n    var item;\n\n    if (context === undefined) {\n        context = this;\n    }\n\n    // push cursor\n    var cursor = allocateCursor(this, start, null);\n\n    while (cursor.prev !== null) {\n        item = cursor.prev;\n        cursor.prev = item.prev;\n\n        if (fn.call(context, item.data, item, this)) {\n            break;\n        }\n    }\n\n    // pop cursor\n    releaseCursor(this);\n};\n\nList.prototype.some = function(fn, context) {\n    var cursor = this.head;\n\n    if (context === undefined) {\n        context = this;\n    }\n\n    while (cursor !== null) {\n        if (fn.call(context, cursor.data, cursor, this)) {\n            return true;\n        }\n\n        cursor = cursor.next;\n    }\n\n    return false;\n};\n\nList.prototype.map = function(fn, context) {\n    var result = new List();\n    var cursor = this.head;\n\n    if (context === undefined) {\n        context = this;\n    }\n\n    while (cursor !== null) {\n        result.appendData(fn.call(context, cursor.data, cursor, this));\n        cursor = cursor.next;\n    }\n\n    return result;\n};\n\nList.prototype.filter = function(fn, context) {\n    var result = new List();\n    var cursor = this.head;\n\n    if (context === undefined) {\n        context = this;\n    }\n\n    while (cursor !== null) {\n        if (fn.call(context, cursor.data, cursor, this)) {\n            result.appendData(cursor.data);\n        }\n        cursor = cursor.next;\n    }\n\n    return result;\n};\n\nList.prototype.clear = function() {\n    this.head = null;\n    this.tail = null;\n};\n\nList.prototype.copy = function() {\n    var result = new List();\n    var cursor = this.head;\n\n    while (cursor !== null) {\n        result.insert(createItem(cursor.data));\n        cursor = cursor.next;\n    }\n\n    return result;\n};\n\nList.prototype.prepend = function(item) {\n    //      head\n    //    ^\n    // item\n    this.updateCursors(null, item, this.head, item);\n\n    // insert to the beginning of the list\n    if (this.head !== null) {\n        // new item <- first item\n        this.head.prev = item;\n\n        // new item -> first item\n        item.next = this.head;\n    } else {\n        // if list has no head, then it also has no tail\n        // in this case tail points to the new item\n        this.tail = item;\n    }\n\n    // head always points to new item\n    this.head = item;\n\n    return this;\n};\n\nList.prototype.prependData = function(data) {\n    return this.prepend(createItem(data));\n};\n\nList.prototype.append = function(item) {\n    return this.insert(item);\n};\n\nList.prototype.appendData = function(data) {\n    return this.insert(createItem(data));\n};\n\nList.prototype.insert = function(item, before) {\n    if (before !== undefined && before !== null) {\n        // prev   before\n        //      ^\n        //     item\n        this.updateCursors(before.prev, item, before, item);\n\n        if (before.prev === null) {\n            // insert to the beginning of list\n            if (this.head !== before) {\n                throw new Error('before doesn\\'t belong to list');\n            }\n\n            // since head points to before therefore list doesn't empty\n            // no need to check tail\n            this.head = item;\n            before.prev = item;\n            item.next = before;\n\n            this.updateCursors(null, item);\n        } else {\n\n            // insert between two items\n            before.prev.next = item;\n            item.prev = before.prev;\n\n            before.prev = item;\n            item.next = before;\n        }\n    } else {\n        // tail\n        //      ^\n        //      item\n        this.updateCursors(this.tail, item, null, item);\n\n        // insert to the ending of the list\n        if (this.tail !== null) {\n            // last item -> new item\n            this.tail.next = item;\n\n            // last item <- new item\n            item.prev = this.tail;\n        } else {\n            // if list has no tail, then it also has no head\n            // in this case head points to new item\n            this.head = item;\n        }\n\n        // tail always points to new item\n        this.tail = item;\n    }\n\n    return this;\n};\n\nList.prototype.insertData = function(data, before) {\n    return this.insert(createItem(data), before);\n};\n\nList.prototype.remove = function(item) {\n    //      item\n    //       ^\n    // prev     next\n    this.updateCursors(item, item.prev, item, item.next);\n\n    if (item.prev !== null) {\n        item.prev.next = item.next;\n    } else {\n        if (this.head !== item) {\n            throw new Error('item doesn\\'t belong to list');\n        }\n\n        this.head = item.next;\n    }\n\n    if (item.next !== null) {\n        item.next.prev = item.prev;\n    } else {\n        if (this.tail !== item) {\n            throw new Error('item doesn\\'t belong to list');\n        }\n\n        this.tail = item.prev;\n    }\n\n    item.prev = null;\n    item.next = null;\n\n    return item;\n};\n\nList.prototype.push = function(data) {\n    this.insert(createItem(data));\n};\n\nList.prototype.pop = function() {\n    if (this.tail !== null) {\n        return this.remove(this.tail);\n    }\n};\n\nList.prototype.unshift = function(data) {\n    this.prepend(createItem(data));\n};\n\nList.prototype.shift = function() {\n    if (this.head !== null) {\n        return this.remove(this.head);\n    }\n};\n\nList.prototype.prependList = function(list) {\n    return this.insertList(list, this.head);\n};\n\nList.prototype.appendList = function(list) {\n    return this.insertList(list);\n};\n\nList.prototype.insertList = function(list, before) {\n    // ignore empty lists\n    if (list.head === null) {\n        return this;\n    }\n\n    if (before !== undefined && before !== null) {\n        this.updateCursors(before.prev, list.tail, before, list.head);\n\n        // insert in the middle of dist list\n        if (before.prev !== null) {\n            // before.prev <-> list.head\n            before.prev.next = list.head;\n            list.head.prev = before.prev;\n        } else {\n            this.head = list.head;\n        }\n\n        before.prev = list.tail;\n        list.tail.next = before;\n    } else {\n        this.updateCursors(this.tail, list.tail, null, list.head);\n\n        // insert to end of the list\n        if (this.tail !== null) {\n            // if destination list has a tail, then it also has a head,\n            // but head doesn't change\n\n            // dest tail -> source head\n            this.tail.next = list.head;\n\n            // dest tail <- source head\n            list.head.prev = this.tail;\n        } else {\n            // if list has no a tail, then it also has no a head\n            // in this case points head to new item\n            this.head = list.head;\n        }\n\n        // tail always start point to new item\n        this.tail = list.tail;\n    }\n\n    list.head = null;\n    list.tail = null;\n\n    return this;\n};\n\nList.prototype.replace = function(oldItem, newItemOrList) {\n    if ('head' in newItemOrList) {\n        this.insertList(newItemOrList, oldItem);\n    } else {\n        this.insert(newItemOrList, oldItem);\n    }\n\n    this.remove(oldItem);\n};\n\nmodule.exports = List;\n","module.exports = function createCustomError(name, message) {\n    // use Object.create(), because some VMs prevent setting line/column otherwise\n    // (iOS Safari 10 even throws an exception)\n    var error = Object.create(SyntaxError.prototype);\n    var errorStack = new Error();\n\n    error.name = name;\n    error.message = message;\n\n    Object.defineProperty(error, 'stack', {\n        get: function() {\n            return (errorStack.stack || '').replace(/^(.+\\n){1,3}/, name + ': ' + message + '\\n');\n        }\n    });\n\n    return error;\n};\n","var createCustomError = require('../utils/createCustomError');\nvar MAX_LINE_LENGTH = 100;\nvar OFFSET_CORRECTION = 60;\nvar TAB_REPLACEMENT = '    ';\n\nfunction sourceFragment(error, extraLines) {\n    function processLines(start, end) {\n        return lines.slice(start, end).map(function(line, idx) {\n            var num = String(start + idx + 1);\n\n            while (num.length < maxNumLength) {\n                num = ' ' + num;\n            }\n\n            return num + ' |' + line;\n        }).join('\\n');\n    }\n\n    var lines = error.source.split(/\\r\\n?|\\n|\\f/);\n    var line = error.line;\n    var column = error.column;\n    var startLine = Math.max(1, line - extraLines) - 1;\n    var endLine = Math.min(line + extraLines, lines.length + 1);\n    var maxNumLength = Math.max(4, String(endLine).length) + 1;\n    var cutLeft = 0;\n\n    // column correction according to replaced tab before column\n    column += (TAB_REPLACEMENT.length - 1) * (lines[line - 1].substr(0, column - 1).match(/\\t/g) || []).length;\n\n    if (column > MAX_LINE_LENGTH) {\n        cutLeft = column - OFFSET_CORRECTION + 3;\n        column = OFFSET_CORRECTION - 2;\n    }\n\n    for (var i = startLine; i <= endLine; i++) {\n        if (i >= 0 && i < lines.length) {\n            lines[i] = lines[i].replace(/\\t/g, TAB_REPLACEMENT);\n            lines[i] =\n                (cutLeft > 0 && lines[i].length > cutLeft ? '\\u2026' : '') +\n                lines[i].substr(cutLeft, MAX_LINE_LENGTH - 2) +\n                (lines[i].length > cutLeft + MAX_LINE_LENGTH - 1 ? '\\u2026' : '');\n        }\n    }\n\n    return [\n        processLines(startLine, line),\n        new Array(column + maxNumLength + 2).join('-') + '^',\n        processLines(line, endLine)\n    ].filter(Boolean).join('\\n');\n}\n\nvar SyntaxError = function(message, source, offset, line, column) {\n    var error = createCustomError('SyntaxError', message);\n\n    error.source = source;\n    error.offset = offset;\n    error.line = line;\n    error.column = column;\n\n    error.sourceFragment = function(extraLines) {\n        return sourceFragment(error, isNaN(extraLines) ? 0 : extraLines);\n    };\n    Object.defineProperty(error, 'formattedMessage', {\n        get: function() {\n            return (\n                'Parse error: ' + error.message + '\\n' +\n                sourceFragment(error, 2)\n            );\n        }\n    });\n\n    // for backward capability\n    error.parseError = {\n        offset: offset,\n        line: line,\n        column: column\n    };\n\n    return error;\n};\n\nmodule.exports = SyntaxError;\n","// CSS Syntax Module Level 3\n// https://www.w3.org/TR/css-syntax-3/\nvar TYPE = {\n    EOF: 0,                 // <EOF-token>\n    Ident: 1,               // <ident-token>\n    Function: 2,            // <function-token>\n    AtKeyword: 3,           // <at-keyword-token>\n    Hash: 4,                // <hash-token>\n    String: 5,              // <string-token>\n    BadString: 6,           // <bad-string-token>\n    Url: 7,                 // <url-token>\n    BadUrl: 8,              // <bad-url-token>\n    Delim: 9,               // <delim-token>\n    Number: 10,             // <number-token>\n    Percentage: 11,         // <percentage-token>\n    Dimension: 12,          // <dimension-token>\n    WhiteSpace: 13,         // <whitespace-token>\n    CDO: 14,                // <CDO-token>\n    CDC: 15,                // <CDC-token>\n    Colon: 16,              // <colon-token>     :\n    Semicolon: 17,          // <semicolon-token> ;\n    Comma: 18,              // <comma-token>     ,\n    LeftSquareBracket: 19,  // <[-token>\n    RightSquareBracket: 20, // <]-token>\n    LeftParenthesis: 21,    // <(-token>\n    RightParenthesis: 22,   // <)-token>\n    LeftCurlyBracket: 23,   // <{-token>\n    RightCurlyBracket: 24,  // <}-token>\n    Comment: 25\n};\n\nvar NAME = Object.keys(TYPE).reduce(function(result, key) {\n    result[TYPE[key]] = key;\n    return result;\n}, {});\n\nmodule.exports = {\n    TYPE: TYPE,\n    NAME: NAME\n};\n","var EOF = 0;\n\n// https://drafts.csswg.org/css-syntax-3/\n// § 4.2. Definitions\n\n// digit\n// A code point between U+0030 DIGIT ZERO (0) and U+0039 DIGIT NINE (9).\nfunction isDigit(code) {\n    return code >= 0x0030 && code <= 0x0039;\n}\n\n// hex digit\n// A digit, or a code point between U+0041 LATIN CAPITAL LETTER A (A) and U+0046 LATIN CAPITAL LETTER F (F),\n// or a code point between U+0061 LATIN SMALL LETTER A (a) and U+0066 LATIN SMALL LETTER F (f).\nfunction isHexDigit(code) {\n    return (\n        isDigit(code) || // 0 .. 9\n        (code >= 0x0041 && code <= 0x0046) || // A .. F\n        (code >= 0x0061 && code <= 0x0066)    // a .. f\n    );\n}\n\n// uppercase letter\n// A code point between U+0041 LATIN CAPITAL LETTER A (A) and U+005A LATIN CAPITAL LETTER Z (Z).\nfunction isUppercaseLetter(code) {\n    return code >= 0x0041 && code <= 0x005A;\n}\n\n// lowercase letter\n// A code point between U+0061 LATIN SMALL LETTER A (a) and U+007A LATIN SMALL LETTER Z (z).\nfunction isLowercaseLetter(code) {\n    return code >= 0x0061 && code <= 0x007A;\n}\n\n// letter\n// An uppercase letter or a lowercase letter.\nfunction isLetter(code) {\n    return isUppercaseLetter(code) || isLowercaseLetter(code);\n}\n\n// non-ASCII code point\n// A code point with a value equal to or greater than U+0080 <control>.\nfunction isNonAscii(code) {\n    return code >= 0x0080;\n}\n\n// name-start code point\n// A letter, a non-ASCII code point, or U+005F LOW LINE (_).\nfunction isNameStart(code) {\n    return isLetter(code) || isNonAscii(code) || code === 0x005F;\n}\n\n// name code point\n// A name-start code point, a digit, or U+002D HYPHEN-MINUS (-).\nfunction isName(code) {\n    return isNameStart(code) || isDigit(code) || code === 0x002D;\n}\n\n// non-printable code point\n// A code point between U+0000 NULL and U+0008 BACKSPACE, or U+000B LINE TABULATION,\n// or a code point between U+000E SHIFT OUT and U+001F INFORMATION SEPARATOR ONE, or U+007F DELETE.\nfunction isNonPrintable(code) {\n    return (\n        (code >= 0x0000 && code <= 0x0008) ||\n        (code === 0x000B) ||\n        (code >= 0x000E && code <= 0x001F) ||\n        (code === 0x007F)\n    );\n}\n\n// newline\n// U+000A LINE FEED. Note that U+000D CARRIAGE RETURN and U+000C FORM FEED are not included in this definition,\n// as they are converted to U+000A LINE FEED during preprocessing.\n// TODO: we doesn't do a preprocessing, so check a code point for U+000D CARRIAGE RETURN and U+000C FORM FEED\nfunction isNewline(code) {\n    return code === 0x000A || code === 0x000D || code === 0x000C;\n}\n\n// whitespace\n// A newline, U+0009 CHARACTER TABULATION, or U+0020 SPACE.\nfunction isWhiteSpace(code) {\n    return isNewline(code) || code === 0x0020 || code === 0x0009;\n}\n\n// § 4.3.8. Check if two code points are a valid escape\nfunction isValidEscape(first, second) {\n    // If the first code point is not U+005C REVERSE SOLIDUS (\\), return false.\n    if (first !== 0x005C) {\n        return false;\n    }\n\n    // Otherwise, if the second code point is a newline or EOF, return false.\n    if (isNewline(second) || second === EOF) {\n        return false;\n    }\n\n    // Otherwise, return true.\n    return true;\n}\n\n// § 4.3.9. Check if three code points would start an identifier\nfunction isIdentifierStart(first, second, third) {\n    // Look at the first code point:\n\n    // U+002D HYPHEN-MINUS\n    if (first === 0x002D) {\n        // If the second code point is a name-start code point or a U+002D HYPHEN-MINUS,\n        // or the second and third code points are a valid escape, return true. Otherwise, return false.\n        return (\n            isNameStart(second) ||\n            second === 0x002D ||\n            isValidEscape(second, third)\n        );\n    }\n\n    // name-start code point\n    if (isNameStart(first)) {\n        // Return true.\n        return true;\n    }\n\n    // U+005C REVERSE SOLIDUS (\\)\n    if (first === 0x005C) {\n        // If the first and second code points are a valid escape, return true. Otherwise, return false.\n        return isValidEscape(first, second);\n    }\n\n    // anything else\n    // Return false.\n    return false;\n}\n\n// § 4.3.10. Check if three code points would start a number\nfunction isNumberStart(first, second, third) {\n    // Look at the first code point:\n\n    // U+002B PLUS SIGN (+)\n    // U+002D HYPHEN-MINUS (-)\n    if (first === 0x002B || first === 0x002D) {\n        // If the second code point is a digit, return true.\n        if (isDigit(second)) {\n            return 2;\n        }\n\n        // Otherwise, if the second code point is a U+002E FULL STOP (.)\n        // and the third code point is a digit, return true.\n        // Otherwise, return false.\n        return second === 0x002E && isDigit(third) ? 3 : 0;\n    }\n\n    // U+002E FULL STOP (.)\n    if (first === 0x002E) {\n        // If the second code point is a digit, return true. Otherwise, return false.\n        return isDigit(second) ? 2 : 0;\n    }\n\n    // digit\n    if (isDigit(first)) {\n        // Return true.\n        return 1;\n    }\n\n    // anything else\n    // Return false.\n    return 0;\n}\n\n//\n// Misc\n//\n\n// detect BOM (https://en.wikipedia.org/wiki/Byte_order_mark)\nfunction isBOM(code) {\n    // UTF-16BE\n    if (code === 0xFEFF) {\n        return 1;\n    }\n\n    // UTF-16LE\n    if (code === 0xFFFE) {\n        return 1;\n    }\n\n    return 0;\n}\n\n// Fast code category\n//\n// https://drafts.csswg.org/css-syntax/#tokenizer-definitions\n// > non-ASCII code point\n// >   A code point with a value equal to or greater than U+0080 <control>\n// > name-start code point\n// >   A letter, a non-ASCII code point, or U+005F LOW LINE (_).\n// > name code point\n// >   A name-start code point, a digit, or U+002D HYPHEN-MINUS (-)\n// That means only ASCII code points has a special meaning and we define a maps for 0..127 codes only\nvar CATEGORY = new Array(0x80);\ncharCodeCategory.Eof = 0x80;\ncharCodeCategory.WhiteSpace = 0x82;\ncharCodeCategory.Digit = 0x83;\ncharCodeCategory.NameStart = 0x84;\ncharCodeCategory.NonPrintable = 0x85;\n\nfor (var i = 0; i < CATEGORY.length; i++) {\n    switch (true) {\n        case isWhiteSpace(i):\n            CATEGORY[i] = charCodeCategory.WhiteSpace;\n            break;\n\n        case isDigit(i):\n            CATEGORY[i] = charCodeCategory.Digit;\n            break;\n\n        case isNameStart(i):\n            CATEGORY[i] = charCodeCategory.NameStart;\n            break;\n\n        case isNonPrintable(i):\n            CATEGORY[i] = charCodeCategory.NonPrintable;\n            break;\n\n        default:\n            CATEGORY[i] = i || charCodeCategory.Eof;\n    }\n}\n\nfunction charCodeCategory(code) {\n    return code < 0x80 ? CATEGORY[code] : charCodeCategory.NameStart;\n};\n\nmodule.exports = {\n    isDigit: isDigit,\n    isHexDigit: isHexDigit,\n    isUppercaseLetter: isUppercaseLetter,\n    isLowercaseLetter: isLowercaseLetter,\n    isLetter: isLetter,\n    isNonAscii: isNonAscii,\n    isNameStart: isNameStart,\n    isName: isName,\n    isNonPrintable: isNonPrintable,\n    isNewline: isNewline,\n    isWhiteSpace: isWhiteSpace,\n    isValidEscape: isValidEscape,\n    isIdentifierStart: isIdentifierStart,\n    isNumberStart: isNumberStart,\n\n    isBOM: isBOM,\n    charCodeCategory: charCodeCategory\n};\n","var charCodeDef = require('./char-code-definitions');\nvar isDigit = charCodeDef.isDigit;\nvar isHexDigit = charCodeDef.isHexDigit;\nvar isUppercaseLetter = charCodeDef.isUppercaseLetter;\nvar isName = charCodeDef.isName;\nvar isWhiteSpace = charCodeDef.isWhiteSpace;\nvar isValidEscape = charCodeDef.isValidEscape;\n\nfunction getCharCode(source, offset) {\n    return offset < source.length ? source.charCodeAt(offset) : 0;\n}\n\nfunction getNewlineLength(source, offset, code) {\n    if (code === 13 /* \\r */ && getCharCode(source, offset + 1) === 10 /* \\n */) {\n        return 2;\n    }\n\n    return 1;\n}\n\nfunction cmpChar(testStr, offset, referenceCode) {\n    var code = testStr.charCodeAt(offset);\n\n    // code.toLowerCase() for A..Z\n    if (isUppercaseLetter(code)) {\n        code = code | 32;\n    }\n\n    return code === referenceCode;\n}\n\nfunction cmpStr(testStr, start, end, referenceStr) {\n    if (end - start !== referenceStr.length) {\n        return false;\n    }\n\n    if (start < 0 || end > testStr.length) {\n        return false;\n    }\n\n    for (var i = start; i < end; i++) {\n        var testCode = testStr.charCodeAt(i);\n        var referenceCode = referenceStr.charCodeAt(i - start);\n\n        // testCode.toLowerCase() for A..Z\n        if (isUppercaseLetter(testCode)) {\n            testCode = testCode | 32;\n        }\n\n        if (testCode !== referenceCode) {\n            return false;\n        }\n    }\n\n    return true;\n}\n\nfunction findWhiteSpaceStart(source, offset) {\n    for (; offset >= 0; offset--) {\n        if (!isWhiteSpace(source.charCodeAt(offset))) {\n            break;\n        }\n    }\n\n    return offset + 1;\n}\n\nfunction findWhiteSpaceEnd(source, offset) {\n    for (; offset < source.length; offset++) {\n        if (!isWhiteSpace(source.charCodeAt(offset))) {\n            break;\n        }\n    }\n\n    return offset;\n}\n\nfunction findDecimalNumberEnd(source, offset) {\n    for (; offset < source.length; offset++) {\n        if (!isDigit(source.charCodeAt(offset))) {\n            break;\n        }\n    }\n\n    return offset;\n}\n\n// § 4.3.7. Consume an escaped code point\nfunction consumeEscaped(source, offset) {\n    // It assumes that the U+005C REVERSE SOLIDUS (\\) has already been consumed and\n    // that the next input code point has already been verified to be part of a valid escape.\n    offset += 2;\n\n    // hex digit\n    if (isHexDigit(getCharCode(source, offset - 1))) {\n        // Consume as many hex digits as possible, but no more than 5.\n        // Note that this means 1-6 hex digits have been consumed in total.\n        for (var maxOffset = Math.min(source.length, offset + 5); offset < maxOffset; offset++) {\n            if (!isHexDigit(getCharCode(source, offset))) {\n                break;\n            }\n        }\n\n        // If the next input code point is whitespace, consume it as well.\n        var code = getCharCode(source, offset);\n        if (isWhiteSpace(code)) {\n            offset += getNewlineLength(source, offset, code);\n        }\n    }\n\n    return offset;\n}\n\n// §4.3.11. Consume a name\n// Note: This algorithm does not do the verification of the first few code points that are necessary\n// to ensure the returned code points would constitute an <ident-token>. If that is the intended use,\n// ensure that the stream starts with an identifier before calling this algorithm.\nfunction consumeName(source, offset) {\n    // Let result initially be an empty string.\n    // Repeatedly consume the next input code point from the stream:\n    for (; offset < source.length; offset++) {\n        var code = source.charCodeAt(offset);\n\n        // name code point\n        if (isName(code)) {\n            // Append the code point to result.\n            continue;\n        }\n\n        // the stream starts with a valid escape\n        if (isValidEscape(code, getCharCode(source, offset + 1))) {\n            // Consume an escaped code point. Append the returned code point to result.\n            offset = consumeEscaped(source, offset) - 1;\n            continue;\n        }\n\n        // anything else\n        // Reconsume the current input code point. Return result.\n        break;\n    }\n\n    return offset;\n}\n\n// §4.3.12. Consume a number\nfunction consumeNumber(source, offset) {\n    var code = source.charCodeAt(offset);\n\n    // 2. If the next input code point is U+002B PLUS SIGN (+) or U+002D HYPHEN-MINUS (-),\n    // consume it and append it to repr.\n    if (code === 0x002B || code === 0x002D) {\n        code = source.charCodeAt(offset += 1);\n    }\n\n    // 3. While the next input code point is a digit, consume it and append it to repr.\n    if (isDigit(code)) {\n        offset = findDecimalNumberEnd(source, offset + 1);\n        code = source.charCodeAt(offset);\n    }\n\n    // 4. If the next 2 input code points are U+002E FULL STOP (.) followed by a digit, then:\n    if (code === 0x002E && isDigit(source.charCodeAt(offset + 1))) {\n        // 4.1 Consume them.\n        // 4.2 Append them to repr.\n        code = source.charCodeAt(offset += 2);\n\n        // 4.3 Set type to \"number\".\n        // TODO\n\n        // 4.4 While the next input code point is a digit, consume it and append it to repr.\n\n        offset = findDecimalNumberEnd(source, offset);\n    }\n\n    // 5. If the next 2 or 3 input code points are U+0045 LATIN CAPITAL LETTER E (E)\n    // or U+0065 LATIN SMALL LETTER E (e), ... , followed by a digit, then:\n    if (cmpChar(source, offset, 101 /* e */)) {\n        var sign = 0;\n        code = source.charCodeAt(offset + 1);\n\n        // ... optionally followed by U+002D HYPHEN-MINUS (-) or U+002B PLUS SIGN (+) ...\n        if (code === 0x002D || code === 0x002B) {\n            sign = 1;\n            code = source.charCodeAt(offset + 2);\n        }\n\n        // ... followed by a digit\n        if (isDigit(code)) {\n            // 5.1 Consume them.\n            // 5.2 Append them to repr.\n\n            // 5.3 Set type to \"number\".\n            // TODO\n\n            // 5.4 While the next input code point is a digit, consume it and append it to repr.\n            offset = findDecimalNumberEnd(source, offset + 1 + sign + 1);\n        }\n    }\n\n    return offset;\n}\n\n// § 4.3.14. Consume the remnants of a bad url\n// ... its sole use is to consume enough of the input stream to reach a recovery point\n// where normal tokenizing can resume.\nfunction consumeBadUrlRemnants(source, offset) {\n    // Repeatedly consume the next input code point from the stream:\n    for (; offset < source.length; offset++) {\n        var code = source.charCodeAt(offset);\n\n        // U+0029 RIGHT PARENTHESIS ())\n        // EOF\n        if (code === 0x0029) {\n            // Return.\n            offset++;\n            break;\n        }\n\n        if (isValidEscape(code, getCharCode(source, offset + 1))) {\n            // Consume an escaped code point.\n            // Note: This allows an escaped right parenthesis (\"\\)\") to be encountered\n            // without ending the <bad-url-token>. This is otherwise identical to\n            // the \"anything else\" clause.\n            offset = consumeEscaped(source, offset);\n        }\n    }\n\n    return offset;\n}\n\nmodule.exports = {\n    consumeEscaped: consumeEscaped,\n    consumeName: consumeName,\n    consumeNumber: consumeNumber,\n    consumeBadUrlRemnants: consumeBadUrlRemnants,\n\n    cmpChar: cmpChar,\n    cmpStr: cmpStr,\n\n    getNewlineLength: getNewlineLength,\n    findWhiteSpaceStart: findWhiteSpaceStart,\n    findWhiteSpaceEnd: findWhiteSpaceEnd\n};\n","var constants = require('../tokenizer/const');\nvar TYPE = constants.TYPE;\nvar NAME = constants.NAME;\n\nvar utils = require('../tokenizer/utils');\nvar cmpStr = utils.cmpStr;\n\nvar EOF = TYPE.EOF;\nvar WHITESPACE = TYPE.WhiteSpace;\nvar COMMENT = TYPE.Comment;\n\nvar OFFSET_MASK = 0x00FFFFFF;\nvar TYPE_SHIFT = 24;\n\nvar TokenStream = function() {\n    this.offsetAndType = null;\n    this.balance = null;\n\n    this.reset();\n};\n\nTokenStream.prototype = {\n    reset: function() {\n        this.eof = false;\n        this.tokenIndex = -1;\n        this.tokenType = 0;\n        this.tokenStart = this.firstCharOffset;\n        this.tokenEnd = this.firstCharOffset;\n    },\n\n    lookupType: function(offset) {\n        offset += this.tokenIndex;\n\n        if (offset < this.tokenCount) {\n            return this.offsetAndType[offset] >> TYPE_SHIFT;\n        }\n\n        return EOF;\n    },\n    lookupOffset: function(offset) {\n        offset += this.tokenIndex;\n\n        if (offset < this.tokenCount) {\n            return this.offsetAndType[offset - 1] & OFFSET_MASK;\n        }\n\n        return this.source.length;\n    },\n    lookupValue: function(offset, referenceStr) {\n        offset += this.tokenIndex;\n\n        if (offset < this.tokenCount) {\n            return cmpStr(\n                this.source,\n                this.offsetAndType[offset - 1] & OFFSET_MASK,\n                this.offsetAndType[offset] & OFFSET_MASK,\n                referenceStr\n            );\n        }\n\n        return false;\n    },\n    getTokenStart: function(tokenIndex) {\n        if (tokenIndex === this.tokenIndex) {\n            return this.tokenStart;\n        }\n\n        if (tokenIndex > 0) {\n            return tokenIndex < this.tokenCount\n                ? this.offsetAndType[tokenIndex - 1] & OFFSET_MASK\n                : this.offsetAndType[this.tokenCount] & OFFSET_MASK;\n        }\n\n        return this.firstCharOffset;\n    },\n\n    // TODO: -> skipUntilBalanced\n    getRawLength: function(startToken, mode) {\n        var cursor = startToken;\n        var balanceEnd;\n        var offset = this.offsetAndType[Math.max(cursor - 1, 0)] & OFFSET_MASK;\n        var type;\n\n        loop:\n        for (; cursor < this.tokenCount; cursor++) {\n            balanceEnd = this.balance[cursor];\n\n            // stop scanning on balance edge that points to offset before start token\n            if (balanceEnd < startToken) {\n                break loop;\n            }\n\n            type = this.offsetAndType[cursor] >> TYPE_SHIFT;\n\n            // check token is stop type\n            switch (mode(type, this.source, offset)) {\n                case 1:\n                    break loop;\n\n                case 2:\n                    cursor++;\n                    break loop;\n\n                default:\n                    // fast forward to the end of balanced block\n                    if (this.balance[balanceEnd] === cursor) {\n                        cursor = balanceEnd;\n                    }\n\n                    offset = this.offsetAndType[cursor] & OFFSET_MASK;\n            }\n        }\n\n        return cursor - this.tokenIndex;\n    },\n    isBalanceEdge: function(pos) {\n        return this.balance[this.tokenIndex] < pos;\n    },\n    isDelim: function(code, offset) {\n        if (offset) {\n            return (\n                this.lookupType(offset) === TYPE.Delim &&\n                this.source.charCodeAt(this.lookupOffset(offset)) === code\n            );\n        }\n\n        return (\n            this.tokenType === TYPE.Delim &&\n            this.source.charCodeAt(this.tokenStart) === code\n        );\n    },\n\n    getTokenValue: function() {\n        return this.source.substring(this.tokenStart, this.tokenEnd);\n    },\n    getTokenLength: function() {\n        return this.tokenEnd - this.tokenStart;\n    },\n    substrToCursor: function(start) {\n        return this.source.substring(start, this.tokenStart);\n    },\n\n    skipWS: function() {\n        for (var i = this.tokenIndex, skipTokenCount = 0; i < this.tokenCount; i++, skipTokenCount++) {\n            if ((this.offsetAndType[i] >> TYPE_SHIFT) !== WHITESPACE) {\n                break;\n            }\n        }\n\n        if (skipTokenCount > 0) {\n            this.skip(skipTokenCount);\n        }\n    },\n    skipSC: function() {\n        while (this.tokenType === WHITESPACE || this.tokenType === COMMENT) {\n            this.next();\n        }\n    },\n    skip: function(tokenCount) {\n        var next = this.tokenIndex + tokenCount;\n\n        if (next < this.tokenCount) {\n            this.tokenIndex = next;\n            this.tokenStart = this.offsetAndType[next - 1] & OFFSET_MASK;\n            next = this.offsetAndType[next];\n            this.tokenType = next >> TYPE_SHIFT;\n            this.tokenEnd = next & OFFSET_MASK;\n        } else {\n            this.tokenIndex = this.tokenCount;\n            this.next();\n        }\n    },\n    next: function() {\n        var next = this.tokenIndex + 1;\n\n        if (next < this.tokenCount) {\n            this.tokenIndex = next;\n            this.tokenStart = this.tokenEnd;\n            next = this.offsetAndType[next];\n            this.tokenType = next >> TYPE_SHIFT;\n            this.tokenEnd = next & OFFSET_MASK;\n        } else {\n            this.tokenIndex = this.tokenCount;\n            this.eof = true;\n            this.tokenType = EOF;\n            this.tokenStart = this.tokenEnd = this.source.length;\n        }\n    },\n\n    forEachToken(fn) {\n        for (var i = 0, offset = this.firstCharOffset; i < this.tokenCount; i++) {\n            var start = offset;\n            var item = this.offsetAndType[i];\n            var end = item & OFFSET_MASK;\n            var type = item >> TYPE_SHIFT;\n\n            offset = end;\n\n            fn(type, start, end, i);\n        }\n    },\n\n    dump() {\n        var tokens = new Array(this.tokenCount);\n\n        this.forEachToken((type, start, end, index) => {\n            tokens[index] = {\n                idx: index,\n                type: NAME[type],\n                chunk: this.source.substring(start, end),\n                balance: this.balance[index]\n            };\n        });\n\n        return tokens;\n    }\n};\n\nmodule.exports = TokenStream;\n","function noop(value) {\n    return value;\n}\n\nfunction generateMultiplier(multiplier) {\n    if (multiplier.min === 0 && multiplier.max === 0) {\n        return '*';\n    }\n\n    if (multiplier.min === 0 && multiplier.max === 1) {\n        return '?';\n    }\n\n    if (multiplier.min === 1 && multiplier.max === 0) {\n        return multiplier.comma ? '#' : '+';\n    }\n\n    if (multiplier.min === 1 && multiplier.max === 1) {\n        return '';\n    }\n\n    return (\n        (multiplier.comma ? '#' : '') +\n        (multiplier.min === multiplier.max\n            ? '{' + multiplier.min + '}'\n            : '{' + multiplier.min + ',' + (multiplier.max !== 0 ? multiplier.max : '') + '}'\n        )\n    );\n}\n\nfunction generateTypeOpts(node) {\n    switch (node.type) {\n        case 'Range':\n            return (\n                ' [' +\n                (node.min === null ? '-∞' : node.min) +\n                ',' +\n                (node.max === null ? '∞' : node.max) +\n                ']'\n            );\n\n        default:\n            throw new Error('Unknown node type `' + node.type + '`');\n    }\n}\n\nfunction generateSequence(node, decorate, forceBraces, compact) {\n    var combinator = node.combinator === ' ' || compact ? node.combinator : ' ' + node.combinator + ' ';\n    var result = node.terms.map(function(term) {\n        return generate(term, decorate, forceBraces, compact);\n    }).join(combinator);\n\n    if (node.explicit || forceBraces) {\n        result = (compact || result[0] === ',' ? '[' : '[ ') + result + (compact ? ']' : ' ]');\n    }\n\n    return result;\n}\n\nfunction generate(node, decorate, forceBraces, compact) {\n    var result;\n\n    switch (node.type) {\n        case 'Group':\n            result =\n                generateSequence(node, decorate, forceBraces, compact) +\n                (node.disallowEmpty ? '!' : '');\n            break;\n\n        case 'Multiplier':\n            // return since node is a composition\n            return (\n                generate(node.term, decorate, forceBraces, compact) +\n                decorate(generateMultiplier(node), node)\n            );\n\n        case 'Type':\n            result = '<' + node.name + (node.opts ? decorate(generateTypeOpts(node.opts), node.opts) : '') + '>';\n            break;\n\n        case 'Property':\n            result = '<\\'' + node.name + '\\'>';\n            break;\n\n        case 'Keyword':\n            result = node.name;\n            break;\n\n        case 'AtKeyword':\n            result = '@' + node.name;\n            break;\n\n        case 'Function':\n            result = node.name + '(';\n            break;\n\n        case 'String':\n        case 'Token':\n            result = node.value;\n            break;\n\n        case 'Comma':\n            result = ',';\n            break;\n\n        default:\n            throw new Error('Unknown node type `' + node.type + '`');\n    }\n\n    return decorate(result, node);\n}\n\nmodule.exports = function(node, options) {\n    var decorate = noop;\n    var forceBraces = false;\n    var compact = false;\n\n    if (typeof options === 'function') {\n        decorate = options;\n    } else if (options) {\n        forceBraces = Boolean(options.forceBraces);\n        compact = Boolean(options.compact);\n        if (typeof options.decorate === 'function') {\n            decorate = options.decorate;\n        }\n    }\n\n    return generate(node, decorate, forceBraces, compact);\n};\n","const createCustomError = require('../utils/createCustomError');\nconst generate = require('../definition-syntax/generate');\nconst defaultLoc = { offset: 0, line: 1, column: 1 };\n\nfunction locateMismatch(matchResult, node) {\n    const tokens = matchResult.tokens;\n    const longestMatch = matchResult.longestMatch;\n    const mismatchNode = longestMatch < tokens.length ? tokens[longestMatch].node || null : null;\n    const badNode = mismatchNode !== node ? mismatchNode : null;\n    let mismatchOffset = 0;\n    let mismatchLength = 0;\n    let entries = 0;\n    let css = '';\n    let start;\n    let end;\n\n    for (let i = 0; i < tokens.length; i++) {\n        const token = tokens[i].value;\n\n        if (i === longestMatch) {\n            mismatchLength = token.length;\n            mismatchOffset = css.length;\n        }\n\n        if (badNode !== null && tokens[i].node === badNode) {\n            if (i <= longestMatch) {\n                entries++;\n            } else {\n                entries = 0;\n            }\n        }\n\n        css += token;\n    }\n\n    if (longestMatch === tokens.length || entries > 1) { // last\n        start = fromLoc(badNode || node, 'end') || buildLoc(defaultLoc, css);\n        end = buildLoc(start);\n    } else {\n        start = fromLoc(badNode, 'start') ||\n            buildLoc(fromLoc(node, 'start') || defaultLoc, css.slice(0, mismatchOffset));\n        end = fromLoc(badNode, 'end') ||\n            buildLoc(start, css.substr(mismatchOffset, mismatchLength));\n    }\n\n    return {\n        css,\n        mismatchOffset,\n        mismatchLength,\n        start,\n        end\n    };\n}\n\nfunction fromLoc(node, point) {\n    const value = node && node.loc && node.loc[point];\n\n    if (value) {\n        return 'line' in value ? buildLoc(value) : value;\n    }\n\n    return null;\n}\n\nfunction buildLoc({ offset, line, column }, extra) {\n    const loc = {\n        offset,\n        line,\n        column\n    };\n\n    if (extra) {\n        const lines = extra.split(/\\n|\\r\\n?|\\f/);\n\n        loc.offset += extra.length;\n        loc.line += lines.length - 1;\n        loc.column = lines.length === 1 ? loc.column + extra.length : lines.pop().length + 1;\n    }\n\n    return loc;\n}\n\nconst SyntaxReferenceError = function(type, referenceName) {\n    const error = createCustomError(\n        'SyntaxReferenceError',\n        type + (referenceName ? ' `' + referenceName + '`' : '')\n    );\n\n    error.reference = referenceName;\n\n    return error;\n};\n\nconst SyntaxMatchError = function(message, syntax, node, matchResult) {\n    const error = createCustomError('SyntaxMatchError', message);\n    const {\n        css,\n        mismatchOffset,\n        mismatchLength,\n        start,\n        end\n    } = locateMismatch(matchResult, node);\n\n    error.rawMessage = message;\n    error.syntax = syntax ? generate(syntax) : '<generic>';\n    error.css = css;\n    error.mismatchOffset = mismatchOffset;\n    error.mismatchLength = mismatchLength;\n    error.message = message + '\\n' +\n        '  syntax: ' + error.syntax + '\\n' +\n        '   value: ' + (css || '<empty string>') + '\\n' +\n        '  --------' + new Array(error.mismatchOffset + 1).join('-') + '^';\n\n    Object.assign(error, start);\n    error.loc = {\n        source: (node && node.loc && node.loc.source) || '<unknown>',\n        start,\n        end\n    };\n\n    return error;\n};\n\nmodule.exports = {\n    SyntaxReferenceError,\n    SyntaxMatchError\n};\n","var hasOwnProperty = Object.prototype.hasOwnProperty;\nvar keywords = Object.create(null);\nvar properties = Object.create(null);\nvar HYPHENMINUS = 45; // '-'.charCodeAt()\n\nfunction isCustomProperty(str, offset) {\n    offset = offset || 0;\n\n    return str.length - offset >= 2 &&\n           str.charCodeAt(offset) === HYPHENMINUS &&\n           str.charCodeAt(offset + 1) === HYPHENMINUS;\n}\n\nfunction getVendorPrefix(str, offset) {\n    offset = offset || 0;\n\n    // verdor prefix should be at least 3 chars length\n    if (str.length - offset >= 3) {\n        // vendor prefix starts with hyper minus following non-hyper minus\n        if (str.charCodeAt(offset) === HYPHENMINUS &&\n            str.charCodeAt(offset + 1) !== HYPHENMINUS) {\n            // vendor prefix should contain a hyper minus at the ending\n            var secondDashIndex = str.indexOf('-', offset + 2);\n\n            if (secondDashIndex !== -1) {\n                return str.substring(offset, secondDashIndex + 1);\n            }\n        }\n    }\n\n    return '';\n}\n\nfunction getKeywordDescriptor(keyword) {\n    if (hasOwnProperty.call(keywords, keyword)) {\n        return keywords[keyword];\n    }\n\n    var name = keyword.toLowerCase();\n\n    if (hasOwnProperty.call(keywords, name)) {\n        return keywords[keyword] = keywords[name];\n    }\n\n    var custom = isCustomProperty(name, 0);\n    var vendor = !custom ? getVendorPrefix(name, 0) : '';\n\n    return keywords[keyword] = Object.freeze({\n        basename: name.substr(vendor.length),\n        name: name,\n        vendor: vendor,\n        prefix: vendor,\n        custom: custom\n    });\n}\n\nfunction getPropertyDescriptor(property) {\n    if (hasOwnProperty.call(properties, property)) {\n        return properties[property];\n    }\n\n    var name = property;\n    var hack = property[0];\n\n    if (hack === '/') {\n        hack = property[1] === '/' ? '//' : '/';\n    } else if (hack !== '_' &&\n               hack !== '*' &&\n               hack !== '$' &&\n               hack !== '#' &&\n               hack !== '+' &&\n               hack !== '&') {\n        hack = '';\n    }\n\n    var custom = isCustomProperty(name, hack.length);\n\n    // re-use result when possible (the same as for lower case)\n    if (!custom) {\n        name = name.toLowerCase();\n        if (hasOwnProperty.call(properties, name)) {\n            return properties[property] = properties[name];\n        }\n    }\n\n    var vendor = !custom ? getVendorPrefix(name, hack.length) : '';\n    var prefix = name.substr(0, hack.length + vendor.length);\n\n    return properties[property] = Object.freeze({\n        basename: name.substr(prefix.length),\n        name: name.substr(hack.length),\n        hack: hack,\n        vendor: vendor,\n        prefix: prefix,\n        custom: custom\n    });\n}\n\nmodule.exports = {\n    keyword: getKeywordDescriptor,\n    property: getPropertyDescriptor,\n    isCustomProperty: isCustomProperty,\n    vendorPrefix: getVendorPrefix\n};\n","var MIN_SIZE = 16 * 1024;\nvar SafeUint32Array = typeof Uint32Array !== 'undefined' ? Uint32Array : Array; // fallback on Array when TypedArray is not supported\n\nmodule.exports = function adoptBuffer(buffer, size) {\n    if (buffer === null || buffer.length < size) {\n        return new SafeUint32Array(Math.max(size + 1024, MIN_SIZE));\n    }\n\n    return buffer;\n};\n","var TokenStream = require('../common/TokenStream');\nvar adoptBuffer = require('../common/adopt-buffer');\n\nvar constants = require('./const');\nvar TYPE = constants.TYPE;\n\nvar charCodeDefinitions = require('./char-code-definitions');\nvar isNewline = charCodeDefinitions.isNewline;\nvar isName = charCodeDefinitions.isName;\nvar isValidEscape = charCodeDefinitions.isValidEscape;\nvar isNumberStart = charCodeDefinitions.isNumberStart;\nvar isIdentifierStart = charCodeDefinitions.isIdentifierStart;\nvar charCodeCategory = charCodeDefinitions.charCodeCategory;\nvar isBOM = charCodeDefinitions.isBOM;\n\nvar utils = require('./utils');\nvar cmpStr = utils.cmpStr;\nvar getNewlineLength = utils.getNewlineLength;\nvar findWhiteSpaceEnd = utils.findWhiteSpaceEnd;\nvar consumeEscaped = utils.consumeEscaped;\nvar consumeName = utils.consumeName;\nvar consumeNumber = utils.consumeNumber;\nvar consumeBadUrlRemnants = utils.consumeBadUrlRemnants;\n\nvar OFFSET_MASK = 0x00FFFFFF;\nvar TYPE_SHIFT = 24;\n\nfunction tokenize(source, stream) {\n    function getCharCode(offset) {\n        return offset < sourceLength ? source.charCodeAt(offset) : 0;\n    }\n\n    // § 4.3.3. Consume a numeric token\n    function consumeNumericToken() {\n        // Consume a number and let number be the result.\n        offset = consumeNumber(source, offset);\n\n        // If the next 3 input code points would start an identifier, then:\n        if (isIdentifierStart(getCharCode(offset), getCharCode(offset + 1), getCharCode(offset + 2))) {\n            // Create a <dimension-token> with the same value and type flag as number, and a unit set initially to the empty string.\n            // Consume a name. Set the <dimension-token>’s unit to the returned value.\n            // Return the <dimension-token>.\n            type = TYPE.Dimension;\n            offset = consumeName(source, offset);\n            return;\n        }\n\n        // Otherwise, if the next input code point is U+0025 PERCENTAGE SIGN (%), consume it.\n        if (getCharCode(offset) === 0x0025) {\n            // Create a <percentage-token> with the same value as number, and return it.\n            type = TYPE.Percentage;\n            offset++;\n            return;\n        }\n\n        // Otherwise, create a <number-token> with the same value and type flag as number, and return it.\n        type = TYPE.Number;\n    }\n\n    // § 4.3.4. Consume an ident-like token\n    function consumeIdentLikeToken() {\n        const nameStartOffset = offset;\n\n        // Consume a name, and let string be the result.\n        offset = consumeName(source, offset);\n\n        // If string’s value is an ASCII case-insensitive match for \"url\",\n        // and the next input code point is U+0028 LEFT PARENTHESIS ((), consume it.\n        if (cmpStr(source, nameStartOffset, offset, 'url') && getCharCode(offset) === 0x0028) {\n            // While the next two input code points are whitespace, consume the next input code point.\n            offset = findWhiteSpaceEnd(source, offset + 1);\n\n            // If the next one or two input code points are U+0022 QUOTATION MARK (\"), U+0027 APOSTROPHE ('),\n            // or whitespace followed by U+0022 QUOTATION MARK (\") or U+0027 APOSTROPHE ('),\n            // then create a <function-token> with its value set to string and return it.\n            if (getCharCode(offset) === 0x0022 ||\n                getCharCode(offset) === 0x0027) {\n                type = TYPE.Function;\n                offset = nameStartOffset + 4;\n                return;\n            }\n\n            // Otherwise, consume a url token, and return it.\n            consumeUrlToken();\n            return;\n        }\n\n        // Otherwise, if the next input code point is U+0028 LEFT PARENTHESIS ((), consume it.\n        // Create a <function-token> with its value set to string and return it.\n        if (getCharCode(offset) === 0x0028) {\n            type = TYPE.Function;\n            offset++;\n            return;\n        }\n\n        // Otherwise, create an <ident-token> with its value set to string and return it.\n        type = TYPE.Ident;\n    }\n\n    // § 4.3.5. Consume a string token\n    function consumeStringToken(endingCodePoint) {\n        // This algorithm may be called with an ending code point, which denotes the code point\n        // that ends the string. If an ending code point is not specified,\n        // the current input code point is used.\n        if (!endingCodePoint) {\n            endingCodePoint = getCharCode(offset++);\n        }\n\n        // Initially create a <string-token> with its value set to the empty string.\n        type = TYPE.String;\n\n        // Repeatedly consume the next input code point from the stream:\n        for (; offset < source.length; offset++) {\n            var code = source.charCodeAt(offset);\n\n            switch (charCodeCategory(code)) {\n                // ending code point\n                case endingCodePoint:\n                    // Return the <string-token>.\n                    offset++;\n                    return;\n\n                // EOF\n                case charCodeCategory.Eof:\n                    // This is a parse error. Return the <string-token>.\n                    return;\n\n                // newline\n                case charCodeCategory.WhiteSpace:\n                    if (isNewline(code)) {\n                        // This is a parse error. Reconsume the current input code point,\n                        // create a <bad-string-token>, and return it.\n                        offset += getNewlineLength(source, offset, code);\n                        type = TYPE.BadString;\n                        return;\n                    }\n                    break;\n\n                // U+005C REVERSE SOLIDUS (\\)\n                case 0x005C:\n                    // If the next input code point is EOF, do nothing.\n                    if (offset === source.length - 1) {\n                        break;\n                    }\n\n                    var nextCode = getCharCode(offset + 1);\n\n                    // Otherwise, if the next input code point is a newline, consume it.\n                    if (isNewline(nextCode)) {\n                        offset += getNewlineLength(source, offset + 1, nextCode);\n                    } else if (isValidEscape(code, nextCode)) {\n                        // Otherwise, (the stream starts with a valid escape) consume\n                        // an escaped code point and append the returned code point to\n                        // the <string-token>’s value.\n                        offset = consumeEscaped(source, offset) - 1;\n                    }\n                    break;\n\n                // anything else\n                // Append the current input code point to the <string-token>’s value.\n            }\n        }\n    }\n\n    // § 4.3.6. Consume a url token\n    // Note: This algorithm assumes that the initial \"url(\" has already been consumed.\n    // This algorithm also assumes that it’s being called to consume an \"unquoted\" value, like url(foo).\n    // A quoted value, like url(\"foo\"), is parsed as a <function-token>. Consume an ident-like token\n    // automatically handles this distinction; this algorithm shouldn’t be called directly otherwise.\n    function consumeUrlToken() {\n        // Initially create a <url-token> with its value set to the empty string.\n        type = TYPE.Url;\n\n        // Consume as much whitespace as possible.\n        offset = findWhiteSpaceEnd(source, offset);\n\n        // Repeatedly consume the next input code point from the stream:\n        for (; offset < source.length; offset++) {\n            var code = source.charCodeAt(offset);\n\n            switch (charCodeCategory(code)) {\n                // U+0029 RIGHT PARENTHESIS ())\n                case 0x0029:\n                    // Return the <url-token>.\n                    offset++;\n                    return;\n\n                // EOF\n                case charCodeCategory.Eof:\n                    // This is a parse error. Return the <url-token>.\n                    return;\n\n                // whitespace\n                case charCodeCategory.WhiteSpace:\n                    // Consume as much whitespace as possible.\n                    offset = findWhiteSpaceEnd(source, offset);\n\n                    // If the next input code point is U+0029 RIGHT PARENTHESIS ()) or EOF,\n                    // consume it and return the <url-token>\n                    // (if EOF was encountered, this is a parse error);\n                    if (getCharCode(offset) === 0x0029 || offset >= source.length) {\n                        if (offset < source.length) {\n                            offset++;\n                        }\n                        return;\n                    }\n\n                    // otherwise, consume the remnants of a bad url, create a <bad-url-token>,\n                    // and return it.\n                    offset = consumeBadUrlRemnants(source, offset);\n                    type = TYPE.BadUrl;\n                    return;\n\n                // U+0022 QUOTATION MARK (\")\n                // U+0027 APOSTROPHE (')\n                // U+0028 LEFT PARENTHESIS (()\n                // non-printable code point\n                case 0x0022:\n                case 0x0027:\n                case 0x0028:\n                case charCodeCategory.NonPrintable:\n                    // This is a parse error. Consume the remnants of a bad url,\n                    // create a <bad-url-token>, and return it.\n                    offset = consumeBadUrlRemnants(source, offset);\n                    type = TYPE.BadUrl;\n                    return;\n\n                // U+005C REVERSE SOLIDUS (\\)\n                case 0x005C:\n                    // If the stream starts with a valid escape, consume an escaped code point and\n                    // append the returned code point to the <url-token>’s value.\n                    if (isValidEscape(code, getCharCode(offset + 1))) {\n                        offset = consumeEscaped(source, offset) - 1;\n                        break;\n                    }\n\n                    // Otherwise, this is a parse error. Consume the remnants of a bad url,\n                    // create a <bad-url-token>, and return it.\n                    offset = consumeBadUrlRemnants(source, offset);\n                    type = TYPE.BadUrl;\n                    return;\n\n                // anything else\n                // Append the current input code point to the <url-token>’s value.\n            }\n        }\n    }\n\n    if (!stream) {\n        stream = new TokenStream();\n    }\n\n    // ensure source is a string\n    source = String(source || '');\n\n    var sourceLength = source.length;\n    var offsetAndType = adoptBuffer(stream.offsetAndType, sourceLength + 1); // +1 because of eof-token\n    var balance = adoptBuffer(stream.balance, sourceLength + 1);\n    var tokenCount = 0;\n    var start = isBOM(getCharCode(0));\n    var offset = start;\n    var balanceCloseType = 0;\n    var balanceStart = 0;\n    var balancePrev = 0;\n\n    // https://drafts.csswg.org/css-syntax-3/#consume-token\n    // § 4.3.1. Consume a token\n    while (offset < sourceLength) {\n        var code = source.charCodeAt(offset);\n        var type = 0;\n\n        balance[tokenCount] = sourceLength;\n\n        switch (charCodeCategory(code)) {\n            // whitespace\n            case charCodeCategory.WhiteSpace:\n                // Consume as much whitespace as possible. Return a <whitespace-token>.\n                type = TYPE.WhiteSpace;\n                offset = findWhiteSpaceEnd(source, offset + 1);\n                break;\n\n            // U+0022 QUOTATION MARK (\")\n            case 0x0022:\n                // Consume a string token and return it.\n                consumeStringToken();\n                break;\n\n            // U+0023 NUMBER SIGN (#)\n            case 0x0023:\n                // If the next input code point is a name code point or the next two input code points are a valid escape, then:\n                if (isName(getCharCode(offset + 1)) || isValidEscape(getCharCode(offset + 1), getCharCode(offset + 2))) {\n                    // Create a <hash-token>.\n                    type = TYPE.Hash;\n\n                    // If the next 3 input code points would start an identifier, set the <hash-token>’s type flag to \"id\".\n                    // if (isIdentifierStart(getCharCode(offset + 1), getCharCode(offset + 2), getCharCode(offset + 3))) {\n                    //     // TODO: set id flag\n                    // }\n\n                    // Consume a name, and set the <hash-token>’s value to the returned string.\n                    offset = consumeName(source, offset + 1);\n\n                    // Return the <hash-token>.\n                } else {\n                    // Otherwise, return a <delim-token> with its value set to the current input code point.\n                    type = TYPE.Delim;\n                    offset++;\n                }\n\n                break;\n\n            // U+0027 APOSTROPHE (')\n            case 0x0027:\n                // Consume a string token and return it.\n                consumeStringToken();\n                break;\n\n            // U+0028 LEFT PARENTHESIS (()\n            case 0x0028:\n                // Return a <(-token>.\n                type = TYPE.LeftParenthesis;\n                offset++;\n                break;\n\n            // U+0029 RIGHT PARENTHESIS ())\n            case 0x0029:\n                // Return a <)-token>.\n                type = TYPE.RightParenthesis;\n                offset++;\n                break;\n\n            // U+002B PLUS SIGN (+)\n            case 0x002B:\n                // If the input stream starts with a number, ...\n                if (isNumberStart(code, getCharCode(offset + 1), getCharCode(offset + 2))) {\n                    // ... reconsume the current input code point, consume a numeric token, and return it.\n                    consumeNumericToken();\n                } else {\n                    // Otherwise, return a <delim-token> with its value set to the current input code point.\n                    type = TYPE.Delim;\n                    offset++;\n                }\n                break;\n\n            // U+002C COMMA (,)\n            case 0x002C:\n                // Return a <comma-token>.\n                type = TYPE.Comma;\n                offset++;\n                break;\n\n            // U+002D HYPHEN-MINUS (-)\n            case 0x002D:\n                // If the input stream starts with a number, reconsume the current input code point, consume a numeric token, and return it.\n                if (isNumberStart(code, getCharCode(offset + 1), getCharCode(offset + 2))) {\n                    consumeNumericToken();\n                } else {\n                    // Otherwise, if the next 2 input code points are U+002D HYPHEN-MINUS U+003E GREATER-THAN SIGN (->), consume them and return a <CDC-token>.\n                    if (getCharCode(offset + 1) === 0x002D &&\n                        getCharCode(offset + 2) === 0x003E) {\n                        type = TYPE.CDC;\n                        offset = offset + 3;\n                    } else {\n                        // Otherwise, if the input stream starts with an identifier, ...\n                        if (isIdentifierStart(code, getCharCode(offset + 1), getCharCode(offset + 2))) {\n                            // ... reconsume the current input code point, consume an ident-like token, and return it.\n                            consumeIdentLikeToken();\n                        } else {\n                            // Otherwise, return a <delim-token> with its value set to the current input code point.\n                            type = TYPE.Delim;\n                            offset++;\n                        }\n                    }\n                }\n                break;\n\n            // U+002E FULL STOP (.)\n            case 0x002E:\n                // If the input stream starts with a number, ...\n                if (isNumberStart(code, getCharCode(offset + 1), getCharCode(offset + 2))) {\n                    // ... reconsume the current input code point, consume a numeric token, and return it.\n                    consumeNumericToken();\n                } else {\n                    // Otherwise, return a <delim-token> with its value set to the current input code point.\n                    type = TYPE.Delim;\n                    offset++;\n                }\n\n                break;\n\n            // U+002F SOLIDUS (/)\n            case 0x002F:\n                // If the next two input code point are U+002F SOLIDUS (/) followed by a U+002A ASTERISK (*),\n                if (getCharCode(offset + 1) === 0x002A) {\n                    // ... consume them and all following code points up to and including the first U+002A ASTERISK (*)\n                    // followed by a U+002F SOLIDUS (/), or up to an EOF code point.\n                    type = TYPE.Comment;\n                    offset = source.indexOf('*/', offset + 2) + 2;\n                    if (offset === 1) {\n                        offset = source.length;\n                    }\n                } else {\n                    type = TYPE.Delim;\n                    offset++;\n                }\n                break;\n\n            // U+003A COLON (:)\n            case 0x003A:\n                // Return a <colon-token>.\n                type = TYPE.Colon;\n                offset++;\n                break;\n\n            // U+003B SEMICOLON (;)\n            case 0x003B:\n                // Return a <semicolon-token>.\n                type = TYPE.Semicolon;\n                offset++;\n                break;\n\n            // U+003C LESS-THAN SIGN (<)\n            case 0x003C:\n                // If the next 3 input code points are U+0021 EXCLAMATION MARK U+002D HYPHEN-MINUS U+002D HYPHEN-MINUS (!--), ...\n                if (getCharCode(offset + 1) === 0x0021 &&\n                    getCharCode(offset + 2) === 0x002D &&\n                    getCharCode(offset + 3) === 0x002D) {\n                    // ... consume them and return a <CDO-token>.\n                    type = TYPE.CDO;\n                    offset = offset + 4;\n                } else {\n                    // Otherwise, return a <delim-token> with its value set to the current input code point.\n                    type = TYPE.Delim;\n                    offset++;\n                }\n\n                break;\n\n            // U+0040 COMMERCIAL AT (@)\n            case 0x0040:\n                // If the next 3 input code points would start an identifier, ...\n                if (isIdentifierStart(getCharCode(offset + 1), getCharCode(offset + 2), getCharCode(offset + 3))) {\n                    // ... consume a name, create an <at-keyword-token> with its value set to the returned value, and return it.\n                    type = TYPE.AtKeyword;\n                    offset = consumeName(source, offset + 1);\n                } else {\n                    // Otherwise, return a <delim-token> with its value set to the current input code point.\n                    type = TYPE.Delim;\n                    offset++;\n                }\n\n                break;\n\n            // U+005B LEFT SQUARE BRACKET ([)\n            case 0x005B:\n                // Return a <[-token>.\n                type = TYPE.LeftSquareBracket;\n                offset++;\n                break;\n\n            // U+005C REVERSE SOLIDUS (\\)\n            case 0x005C:\n                // If the input stream starts with a valid escape, ...\n                if (isValidEscape(code, getCharCode(offset + 1))) {\n                    // ... reconsume the current input code point, consume an ident-like token, and return it.\n                    consumeIdentLikeToken();\n                } else {\n                    // Otherwise, this is a parse error. Return a <delim-token> with its value set to the current input code point.\n                    type = TYPE.Delim;\n                    offset++;\n                }\n                break;\n\n            // U+005D RIGHT SQUARE BRACKET (])\n            case 0x005D:\n                // Return a <]-token>.\n                type = TYPE.RightSquareBracket;\n                offset++;\n                break;\n\n            // U+007B LEFT CURLY BRACKET ({)\n            case 0x007B:\n                // Return a <{-token>.\n                type = TYPE.LeftCurlyBracket;\n                offset++;\n                break;\n\n            // U+007D RIGHT CURLY BRACKET (})\n            case 0x007D:\n                // Return a <}-token>.\n                type = TYPE.RightCurlyBracket;\n                offset++;\n                break;\n\n            // digit\n            case charCodeCategory.Digit:\n                // Reconsume the current input code point, consume a numeric token, and return it.\n                consumeNumericToken();\n                break;\n\n            // name-start code point\n            case charCodeCategory.NameStart:\n                // Reconsume the current input code point, consume an ident-like token, and return it.\n                consumeIdentLikeToken();\n                break;\n\n            // EOF\n            case charCodeCategory.Eof:\n                // Return an <EOF-token>.\n                break;\n\n            // anything else\n            default:\n                // Return a <delim-token> with its value set to the current input code point.\n                type = TYPE.Delim;\n                offset++;\n        }\n\n        switch (type) {\n            case balanceCloseType:\n                balancePrev = balanceStart & OFFSET_MASK;\n                balanceStart = balance[balancePrev];\n                balanceCloseType = balanceStart >> TYPE_SHIFT;\n                balance[tokenCount] = balancePrev;\n                balance[balancePrev++] = tokenCount;\n                for (; balancePrev < tokenCount; balancePrev++) {\n                    if (balance[balancePrev] === sourceLength) {\n                        balance[balancePrev] = tokenCount;\n                    }\n                }\n                break;\n\n            case TYPE.LeftParenthesis:\n            case TYPE.Function:\n                balance[tokenCount] = balanceStart;\n                balanceCloseType = TYPE.RightParenthesis;\n                balanceStart = (balanceCloseType << TYPE_SHIFT) | tokenCount;\n                break;\n\n            case TYPE.LeftSquareBracket:\n                balance[tokenCount] = balanceStart;\n                balanceCloseType = TYPE.RightSquareBracket;\n                balanceStart = (balanceCloseType << TYPE_SHIFT) | tokenCount;\n                break;\n\n            case TYPE.LeftCurlyBracket:\n                balance[tokenCount] = balanceStart;\n                balanceCloseType = TYPE.RightCurlyBracket;\n                balanceStart = (balanceCloseType << TYPE_SHIFT) | tokenCount;\n                break;\n        }\n\n        offsetAndType[tokenCount++] = (type << TYPE_SHIFT) | offset;\n    }\n\n    // finalize buffers\n    offsetAndType[tokenCount] = (TYPE.EOF << TYPE_SHIFT) | offset; // <EOF-token>\n    balance[tokenCount] = sourceLength;\n    balance[sourceLength] = sourceLength; // prevents false positive balance match with any token\n    while (balanceStart !== 0) {\n        balancePrev = balanceStart & OFFSET_MASK;\n        balanceStart = balance[balancePrev];\n        balance[balancePrev] = sourceLength;\n    }\n\n    // update stream\n    stream.source = source;\n    stream.firstCharOffset = start;\n    stream.offsetAndType = offsetAndType;\n    stream.tokenCount = tokenCount;\n    stream.balance = balance;\n    stream.reset();\n    stream.next();\n\n    return stream;\n}\n\n// extend tokenizer with constants\nObject.keys(constants).forEach(function(key) {\n    tokenize[key] = constants[key];\n});\n\n// extend tokenizer with static methods from utils\nObject.keys(charCodeDefinitions).forEach(function(key) {\n    tokenize[key] = charCodeDefinitions[key];\n});\nObject.keys(utils).forEach(function(key) {\n    tokenize[key] = utils[key];\n});\n\nmodule.exports = tokenize;\n","var isDigit = require('../tokenizer').isDigit;\nvar cmpChar = require('../tokenizer').cmpChar;\nvar TYPE = require('../tokenizer').TYPE;\n\nvar DELIM = TYPE.Delim;\nvar WHITESPACE = TYPE.WhiteSpace;\nvar COMMENT = TYPE.Comment;\nvar IDENT = TYPE.Ident;\nvar NUMBER = TYPE.Number;\nvar DIMENSION = TYPE.Dimension;\nvar PLUSSIGN = 0x002B;    // U+002B PLUS SIGN (+)\nvar HYPHENMINUS = 0x002D; // U+002D HYPHEN-MINUS (-)\nvar N = 0x006E;           // U+006E LATIN SMALL LETTER N (n)\nvar DISALLOW_SIGN = true;\nvar ALLOW_SIGN = false;\n\nfunction isDelim(token, code) {\n    return token !== null && token.type === DELIM && token.value.charCodeAt(0) === code;\n}\n\nfunction skipSC(token, offset, getNextToken) {\n    while (token !== null && (token.type === WHITESPACE || token.type === COMMENT)) {\n        token = getNextToken(++offset);\n    }\n\n    return offset;\n}\n\nfunction checkInteger(token, valueOffset, disallowSign, offset) {\n    if (!token) {\n        return 0;\n    }\n\n    var code = token.value.charCodeAt(valueOffset);\n\n    if (code === PLUSSIGN || code === HYPHENMINUS) {\n        if (disallowSign) {\n            // Number sign is not allowed\n            return 0;\n        }\n        valueOffset++;\n    }\n\n    for (; valueOffset < token.value.length; valueOffset++) {\n        if (!isDigit(token.value.charCodeAt(valueOffset))) {\n            // Integer is expected\n            return 0;\n        }\n    }\n\n    return offset + 1;\n}\n\n// ... <signed-integer>\n// ... ['+' | '-'] <signless-integer>\nfunction consumeB(token, offset_, getNextToken) {\n    var sign = false;\n    var offset = skipSC(token, offset_, getNextToken);\n\n    token = getNextToken(offset);\n\n    if (token === null) {\n        return offset_;\n    }\n\n    if (token.type !== NUMBER) {\n        if (isDelim(token, PLUSSIGN) || isDelim(token, HYPHENMINUS)) {\n            sign = true;\n            offset = skipSC(getNextToken(++offset), offset, getNextToken);\n            token = getNextToken(offset);\n\n            if (token === null && token.type !== NUMBER) {\n                return 0;\n            }\n        } else {\n            return offset_;\n        }\n    }\n\n    if (!sign) {\n        var code = token.value.charCodeAt(0);\n        if (code !== PLUSSIGN && code !== HYPHENMINUS) {\n            // Number sign is expected\n            return 0;\n        }\n    }\n\n    return checkInteger(token, sign ? 0 : 1, sign, offset);\n}\n\n// An+B microsyntax https://www.w3.org/TR/css-syntax-3/#anb\nmodule.exports = function anPlusB(token, getNextToken) {\n    /* eslint-disable brace-style*/\n    var offset = 0;\n\n    if (!token) {\n        return 0;\n    }\n\n    // <integer>\n    if (token.type === NUMBER) {\n        return checkInteger(token, 0, ALLOW_SIGN, offset); // b\n    }\n\n    // -n\n    // -n <signed-integer>\n    // -n ['+' | '-'] <signless-integer>\n    // -n- <signless-integer>\n    // <dashndashdigit-ident>\n    else if (token.type === IDENT && token.value.charCodeAt(0) === HYPHENMINUS) {\n        // expect 1st char is N\n        if (!cmpChar(token.value, 1, N)) {\n            return 0;\n        }\n\n        switch (token.value.length) {\n            // -n\n            // -n <signed-integer>\n            // -n ['+' | '-'] <signless-integer>\n            case 2:\n                return consumeB(getNextToken(++offset), offset, getNextToken);\n\n            // -n- <signless-integer>\n            case 3:\n                if (token.value.charCodeAt(2) !== HYPHENMINUS) {\n                    return 0;\n                }\n\n                offset = skipSC(getNextToken(++offset), offset, getNextToken);\n                token = getNextToken(offset);\n\n                return checkInteger(token, 0, DISALLOW_SIGN, offset);\n\n            // <dashndashdigit-ident>\n            default:\n                if (token.value.charCodeAt(2) !== HYPHENMINUS) {\n                    return 0;\n                }\n\n                return checkInteger(token, 3, DISALLOW_SIGN, offset);\n        }\n    }\n\n    // '+'? n\n    // '+'? n <signed-integer>\n    // '+'? n ['+' | '-'] <signless-integer>\n    // '+'? n- <signless-integer>\n    // '+'? <ndashdigit-ident>\n    else if (token.type === IDENT || (isDelim(token, PLUSSIGN) && getNextToken(offset + 1).type === IDENT)) {\n        // just ignore a plus\n        if (token.type !== IDENT) {\n            token = getNextToken(++offset);\n        }\n\n        if (token === null || !cmpChar(token.value, 0, N)) {\n            return 0;\n        }\n\n        switch (token.value.length) {\n            // '+'? n\n            // '+'? n <signed-integer>\n            // '+'? n ['+' | '-'] <signless-integer>\n            case 1:\n                return consumeB(getNextToken(++offset), offset, getNextToken);\n\n            // '+'? n- <signless-integer>\n            case 2:\n                if (token.value.charCodeAt(1) !== HYPHENMINUS) {\n                    return 0;\n                }\n\n                offset = skipSC(getNextToken(++offset), offset, getNextToken);\n                token = getNextToken(offset);\n\n                return checkInteger(token, 0, DISALLOW_SIGN, offset);\n\n            // '+'? <ndashdigit-ident>\n            default:\n                if (token.value.charCodeAt(1) !== HYPHENMINUS) {\n                    return 0;\n                }\n\n                return checkInteger(token, 2, DISALLOW_SIGN, offset);\n        }\n    }\n\n    // <ndashdigit-dimension>\n    // <ndash-dimension> <signless-integer>\n    // <n-dimension>\n    // <n-dimension> <signed-integer>\n    // <n-dimension> ['+' | '-'] <signless-integer>\n    else if (token.type === DIMENSION) {\n        var code = token.value.charCodeAt(0);\n        var sign = code === PLUSSIGN || code === HYPHENMINUS ? 1 : 0;\n\n        for (var i = sign; i < token.value.length; i++) {\n            if (!isDigit(token.value.charCodeAt(i))) {\n                break;\n            }\n        }\n\n        if (i === sign) {\n            // Integer is expected\n            return 0;\n        }\n\n        if (!cmpChar(token.value, i, N)) {\n            return 0;\n        }\n\n        // <n-dimension>\n        // <n-dimension> <signed-integer>\n        // <n-dimension> ['+' | '-'] <signless-integer>\n        if (i + 1 === token.value.length) {\n            return consumeB(getNextToken(++offset), offset, getNextToken);\n        } else {\n            if (token.value.charCodeAt(i + 1) !== HYPHENMINUS) {\n                return 0;\n            }\n\n            // <ndash-dimension> <signless-integer>\n            if (i + 2 === token.value.length) {\n                offset = skipSC(getNextToken(++offset), offset, getNextToken);\n                token = getNextToken(offset);\n\n                return checkInteger(token, 0, DISALLOW_SIGN, offset);\n            }\n            // <ndashdigit-dimension>\n            else {\n                return checkInteger(token, i + 2, DISALLOW_SIGN, offset);\n            }\n        }\n    }\n\n    return 0;\n};\n","var isHexDigit = require('../tokenizer').isHexDigit;\nvar cmpChar = require('../tokenizer').cmpChar;\nvar TYPE = require('../tokenizer').TYPE;\n\nvar IDENT = TYPE.Ident;\nvar DELIM = TYPE.Delim;\nvar NUMBER = TYPE.Number;\nvar DIMENSION = TYPE.Dimension;\nvar PLUSSIGN = 0x002B;     // U+002B PLUS SIGN (+)\nvar HYPHENMINUS = 0x002D;  // U+002D HYPHEN-MINUS (-)\nvar QUESTIONMARK = 0x003F; // U+003F QUESTION MARK (?)\nvar U = 0x0075;            // U+0075 LATIN SMALL LETTER U (u)\n\nfunction isDelim(token, code) {\n    return token !== null && token.type === DELIM && token.value.charCodeAt(0) === code;\n}\n\nfunction startsWith(token, code) {\n    return token.value.charCodeAt(0) === code;\n}\n\nfunction hexSequence(token, offset, allowDash) {\n    for (var pos = offset, hexlen = 0; pos < token.value.length; pos++) {\n        var code = token.value.charCodeAt(pos);\n\n        if (code === HYPHENMINUS && allowDash && hexlen !== 0) {\n            if (hexSequence(token, offset + hexlen + 1, false) > 0) {\n                return 6; // dissallow following question marks\n            }\n\n            return 0; // dash at the ending of a hex sequence is not allowed\n        }\n\n        if (!isHexDigit(code)) {\n            return 0; // not a hex digit\n        }\n\n        if (++hexlen > 6) {\n            return 0; // too many hex digits\n        };\n    }\n\n    return hexlen;\n}\n\nfunction withQuestionMarkSequence(consumed, length, getNextToken) {\n    if (!consumed) {\n        return 0; // nothing consumed\n    }\n\n    while (isDelim(getNextToken(length), QUESTIONMARK)) {\n        if (++consumed > 6) {\n            return 0; // too many question marks\n        }\n\n        length++;\n    }\n\n    return length;\n}\n\n// https://drafts.csswg.org/css-syntax/#urange\n// Informally, the <urange> production has three forms:\n// U+0001\n//      Defines a range consisting of a single code point, in this case the code point \"1\".\n// U+0001-00ff\n//      Defines a range of codepoints between the first and the second value, in this case\n//      the range between \"1\" and \"ff\" (255 in decimal) inclusive.\n// U+00??\n//      Defines a range of codepoints where the \"?\" characters range over all hex digits,\n//      in this case defining the same as the value U+0000-00ff.\n// In each form, a maximum of 6 digits is allowed for each hexadecimal number (if you treat \"?\" as a hexadecimal digit).\n//\n// <urange> =\n//   u '+' <ident-token> '?'* |\n//   u <dimension-token> '?'* |\n//   u <number-token> '?'* |\n//   u <number-token> <dimension-token> |\n//   u <number-token> <number-token> |\n//   u '+' '?'+\nmodule.exports = function urange(token, getNextToken) {\n    var length = 0;\n\n    // should start with `u` or `U`\n    if (token === null || token.type !== IDENT || !cmpChar(token.value, 0, U)) {\n        return 0;\n    }\n\n    token = getNextToken(++length);\n    if (token === null) {\n        return 0;\n    }\n\n    // u '+' <ident-token> '?'*\n    // u '+' '?'+\n    if (isDelim(token, PLUSSIGN)) {\n        token = getNextToken(++length);\n        if (token === null) {\n            return 0;\n        }\n\n        if (token.type === IDENT) {\n            // u '+' <ident-token> '?'*\n            return withQuestionMarkSequence(hexSequence(token, 0, true), ++length, getNextToken);\n        }\n\n        if (isDelim(token, QUESTIONMARK)) {\n            // u '+' '?'+\n            return withQuestionMarkSequence(1, ++length, getNextToken);\n        }\n\n        // Hex digit or question mark is expected\n        return 0;\n    }\n\n    // u <number-token> '?'*\n    // u <number-token> <dimension-token>\n    // u <number-token> <number-token>\n    if (token.type === NUMBER) {\n        if (!startsWith(token, PLUSSIGN)) {\n            return 0;\n        }\n\n        var consumedHexLength = hexSequence(token, 1, true);\n        if (consumedHexLength === 0) {\n            return 0;\n        }\n\n        token = getNextToken(++length);\n        if (token === null) {\n            // u <number-token> <eof>\n            return length;\n        }\n\n        if (token.type === DIMENSION || token.type === NUMBER) {\n            // u <number-token> <dimension-token>\n            // u <number-token> <number-token>\n            if (!startsWith(token, HYPHENMINUS) || !hexSequence(token, 1, false)) {\n                return 0;\n            }\n\n            return length + 1;\n        }\n\n        // u <number-token> '?'*\n        return withQuestionMarkSequence(consumedHexLength, length, getNextToken);\n    }\n\n    // u <dimension-token> '?'*\n    if (token.type === DIMENSION) {\n        if (!startsWith(token, PLUSSIGN)) {\n            return 0;\n        }\n\n        return withQuestionMarkSequence(hexSequence(token, 1, true), ++length, getNextToken);\n    }\n\n    return 0;\n};\n","var tokenizer = require('../tokenizer');\nvar isIdentifierStart = tokenizer.isIdentifierStart;\nvar isHexDigit = tokenizer.isHexDigit;\nvar isDigit = tokenizer.isDigit;\nvar cmpStr = tokenizer.cmpStr;\nvar consumeNumber = tokenizer.consumeNumber;\nvar TYPE = tokenizer.TYPE;\nvar anPlusB = require('./generic-an-plus-b');\nvar urange = require('./generic-urange');\n\nvar cssWideKeywords = ['unset', 'initial', 'inherit'];\nvar calcFunctionNames = ['calc(', '-moz-calc(', '-webkit-calc('];\n\n// https://www.w3.org/TR/css-values-3/#lengths\nvar LENGTH = {\n    // absolute length units\n    'px': true,\n    'mm': true,\n    'cm': true,\n    'in': true,\n    'pt': true,\n    'pc': true,\n    'q': true,\n\n    // relative length units\n    'em': true,\n    'ex': true,\n    'ch': true,\n    'rem': true,\n\n    // viewport-percentage lengths\n    'vh': true,\n    'vw': true,\n    'vmin': true,\n    'vmax': true,\n    'vm': true\n};\n\nvar ANGLE = {\n    'deg': true,\n    'grad': true,\n    'rad': true,\n    'turn': true\n};\n\nvar TIME = {\n    's': true,\n    'ms': true\n};\n\nvar FREQUENCY = {\n    'hz': true,\n    'khz': true\n};\n\n// https://www.w3.org/TR/css-values-3/#resolution (https://drafts.csswg.org/css-values/#resolution)\nvar RESOLUTION = {\n    'dpi': true,\n    'dpcm': true,\n    'dppx': true,\n    'x': true      // https://github.com/w3c/csswg-drafts/issues/461\n};\n\n// https://drafts.csswg.org/css-grid/#fr-unit\nvar FLEX = {\n    'fr': true\n};\n\n// https://www.w3.org/TR/css3-speech/#mixing-props-voice-volume\nvar DECIBEL = {\n    'db': true\n};\n\n// https://www.w3.org/TR/css3-speech/#voice-props-voice-pitch\nvar SEMITONES = {\n    'st': true\n};\n\n// safe char code getter\nfunction charCode(str, index) {\n    return index < str.length ? str.charCodeAt(index) : 0;\n}\n\nfunction eqStr(actual, expected) {\n    return cmpStr(actual, 0, actual.length, expected);\n}\n\nfunction eqStrAny(actual, expected) {\n    for (var i = 0; i < expected.length; i++) {\n        if (eqStr(actual, expected[i])) {\n            return true;\n        }\n    }\n\n    return false;\n}\n\n// IE postfix hack, i.e. 123\\0 or 123px\\9\nfunction isPostfixIeHack(str, offset) {\n    if (offset !== str.length - 2) {\n        return false;\n    }\n\n    return (\n        str.charCodeAt(offset) === 0x005C &&  // U+005C REVERSE SOLIDUS (\\)\n        isDigit(str.charCodeAt(offset + 1))\n    );\n}\n\nfunction outOfRange(opts, value, numEnd) {\n    if (opts && opts.type === 'Range') {\n        var num = Number(\n            numEnd !== undefined && numEnd !== value.length\n                ? value.substr(0, numEnd)\n                : value\n        );\n\n        if (isNaN(num)) {\n            return true;\n        }\n\n        if (opts.min !== null && num < opts.min) {\n            return true;\n        }\n\n        if (opts.max !== null && num > opts.max) {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nfunction consumeFunction(token, getNextToken) {\n    var startIdx = token.index;\n    var length = 0;\n\n    // balanced token consuming\n    do {\n        length++;\n\n        if (token.balance <= startIdx) {\n            break;\n        }\n    } while (token = getNextToken(length));\n\n    return length;\n}\n\n// TODO: implement\n// can be used wherever <length>, <frequency>, <angle>, <time>, <percentage>, <number>, or <integer> values are allowed\n// https://drafts.csswg.org/css-values/#calc-notation\nfunction calc(next) {\n    return function(token, getNextToken, opts) {\n        if (token === null) {\n            return 0;\n        }\n\n        if (token.type === TYPE.Function && eqStrAny(token.value, calcFunctionNames)) {\n            return consumeFunction(token, getNextToken);\n        }\n\n        return next(token, getNextToken, opts);\n    };\n}\n\nfunction tokenType(expectedTokenType) {\n    return function(token) {\n        if (token === null || token.type !== expectedTokenType) {\n            return 0;\n        }\n\n        return 1;\n    };\n}\n\nfunction func(name) {\n    name = name + '(';\n\n    return function(token, getNextToken) {\n        if (token !== null && eqStr(token.value, name)) {\n            return consumeFunction(token, getNextToken);\n        }\n\n        return 0;\n    };\n}\n\n// =========================\n// Complex types\n//\n\n// https://drafts.csswg.org/css-values-4/#custom-idents\n// 4.2. Author-defined Identifiers: the <custom-ident> type\n// Some properties accept arbitrary author-defined identifiers as a component value.\n// This generic data type is denoted by <custom-ident>, and represents any valid CSS identifier\n// that would not be misinterpreted as a pre-defined keyword in that property’s value definition.\n//\n// See also: https://developer.mozilla.org/en-US/docs/Web/CSS/custom-ident\nfunction customIdent(token) {\n    if (token === null || token.type !== TYPE.Ident) {\n        return 0;\n    }\n\n    var name = token.value.toLowerCase();\n\n    // The CSS-wide keywords are not valid <custom-ident>s\n    if (eqStrAny(name, cssWideKeywords)) {\n        return 0;\n    }\n\n    // The default keyword is reserved and is also not a valid <custom-ident>\n    if (eqStr(name, 'default')) {\n        return 0;\n    }\n\n    // TODO: ignore property specific keywords (as described https://developer.mozilla.org/en-US/docs/Web/CSS/custom-ident)\n    // Specifications using <custom-ident> must specify clearly what other keywords\n    // are excluded from <custom-ident>, if any—for example by saying that any pre-defined keywords\n    // in that property’s value definition are excluded. Excluded keywords are excluded\n    // in all ASCII case permutations.\n\n    return 1;\n}\n\n// https://drafts.csswg.org/css-variables/#typedef-custom-property-name\n// A custom property is any property whose name starts with two dashes (U+002D HYPHEN-MINUS), like --foo.\n// The <custom-property-name> production corresponds to this: it’s defined as any valid identifier\n// that starts with two dashes, except -- itself, which is reserved for future use by CSS.\n// NOTE: Current implementation treat `--` as a valid name since most (all?) major browsers treat it as valid.\nfunction customPropertyName(token) {\n    // ... defined as any valid identifier\n    if (token === null || token.type !== TYPE.Ident) {\n        return 0;\n    }\n\n    // ... that starts with two dashes (U+002D HYPHEN-MINUS)\n    if (charCode(token.value, 0) !== 0x002D || charCode(token.value, 1) !== 0x002D) {\n        return 0;\n    }\n\n    return 1;\n}\n\n// https://drafts.csswg.org/css-color-4/#hex-notation\n// The syntax of a <hex-color> is a <hash-token> token whose value consists of 3, 4, 6, or 8 hexadecimal digits.\n// In other words, a hex color is written as a hash character, \"#\", followed by some number of digits 0-9 or\n// letters a-f (the case of the letters doesn’t matter - #00ff00 is identical to #00FF00).\nfunction hexColor(token) {\n    if (token === null || token.type !== TYPE.Hash) {\n        return 0;\n    }\n\n    var length = token.value.length;\n\n    // valid values (length): #rgb (4), #rgba (5), #rrggbb (7), #rrggbbaa (9)\n    if (length !== 4 && length !== 5 && length !== 7 && length !== 9) {\n        return 0;\n    }\n\n    for (var i = 1; i < length; i++) {\n        if (!isHexDigit(token.value.charCodeAt(i))) {\n            return 0;\n        }\n    }\n\n    return 1;\n}\n\nfunction idSelector(token) {\n    if (token === null || token.type !== TYPE.Hash) {\n        return 0;\n    }\n\n    if (!isIdentifierStart(charCode(token.value, 1), charCode(token.value, 2), charCode(token.value, 3))) {\n        return 0;\n    }\n\n    return 1;\n}\n\n// https://drafts.csswg.org/css-syntax/#any-value\n// It represents the entirety of what a valid declaration can have as its value.\nfunction declarationValue(token, getNextToken) {\n    if (!token) {\n        return 0;\n    }\n\n    var length = 0;\n    var level = 0;\n    var startIdx = token.index;\n\n    // The <declaration-value> production matches any sequence of one or more tokens,\n    // so long as the sequence ...\n    scan:\n    do {\n        switch (token.type) {\n            // ... does not contain <bad-string-token>, <bad-url-token>,\n            case TYPE.BadString:\n            case TYPE.BadUrl:\n                break scan;\n\n            // ... unmatched <)-token>, <]-token>, or <}-token>,\n            case TYPE.RightCurlyBracket:\n            case TYPE.RightParenthesis:\n            case TYPE.RightSquareBracket:\n                if (token.balance > token.index || token.balance < startIdx) {\n                    break scan;\n                }\n\n                level--;\n                break;\n\n            // ... or top-level <semicolon-token> tokens\n            case TYPE.Semicolon:\n                if (level === 0) {\n                    break scan;\n                }\n\n                break;\n\n            // ... or <delim-token> tokens with a value of \"!\"\n            case TYPE.Delim:\n                if (token.value === '!' && level === 0) {\n                    break scan;\n                }\n\n                break;\n\n            case TYPE.Function:\n            case TYPE.LeftParenthesis:\n            case TYPE.LeftSquareBracket:\n            case TYPE.LeftCurlyBracket:\n                level++;\n                break;\n        }\n\n        length++;\n\n        // until balance closing\n        if (token.balance <= startIdx) {\n            break;\n        }\n    } while (token = getNextToken(length));\n\n    return length;\n}\n\n// https://drafts.csswg.org/css-syntax/#any-value\n// The <any-value> production is identical to <declaration-value>, but also\n// allows top-level <semicolon-token> tokens and <delim-token> tokens\n// with a value of \"!\". It represents the entirety of what valid CSS can be in any context.\nfunction anyValue(token, getNextToken) {\n    if (!token) {\n        return 0;\n    }\n\n    var startIdx = token.index;\n    var length = 0;\n\n    // The <any-value> production matches any sequence of one or more tokens,\n    // so long as the sequence ...\n    scan:\n    do {\n        switch (token.type) {\n            // ... does not contain <bad-string-token>, <bad-url-token>,\n            case TYPE.BadString:\n            case TYPE.BadUrl:\n                break scan;\n\n            // ... unmatched <)-token>, <]-token>, or <}-token>,\n            case TYPE.RightCurlyBracket:\n            case TYPE.RightParenthesis:\n            case TYPE.RightSquareBracket:\n                if (token.balance > token.index || token.balance < startIdx) {\n                    break scan;\n                }\n\n                break;\n        }\n\n        length++;\n\n        // until balance closing\n        if (token.balance <= startIdx) {\n            break;\n        }\n    } while (token = getNextToken(length));\n\n    return length;\n}\n\n// =========================\n// Dimensions\n//\n\nfunction dimension(type) {\n    return function(token, getNextToken, opts) {\n        if (token === null || token.type !== TYPE.Dimension) {\n            return 0;\n        }\n\n        var numberEnd = consumeNumber(token.value, 0);\n\n        // check unit\n        if (type !== null) {\n            // check for IE postfix hack, i.e. 123px\\0 or 123px\\9\n            var reverseSolidusOffset = token.value.indexOf('\\\\', numberEnd);\n            var unit = reverseSolidusOffset === -1 || !isPostfixIeHack(token.value, reverseSolidusOffset)\n                ? token.value.substr(numberEnd)\n                : token.value.substring(numberEnd, reverseSolidusOffset);\n\n            if (type.hasOwnProperty(unit.toLowerCase()) === false) {\n                return 0;\n            }\n        }\n\n        // check range if specified\n        if (outOfRange(opts, token.value, numberEnd)) {\n            return 0;\n        }\n\n        return 1;\n    };\n}\n\n// =========================\n// Percentage\n//\n\n// §5.5. Percentages: the <percentage> type\n// https://drafts.csswg.org/css-values-4/#percentages\nfunction percentage(token, getNextToken, opts) {\n    // ... corresponds to the <percentage-token> production\n    if (token === null || token.type !== TYPE.Percentage) {\n        return 0;\n    }\n\n    // check range if specified\n    if (outOfRange(opts, token.value, token.value.length - 1)) {\n        return 0;\n    }\n\n    return 1;\n}\n\n// =========================\n// Numeric\n//\n\n// https://drafts.csswg.org/css-values-4/#numbers\n// The value <zero> represents a literal number with the value 0. Expressions that merely\n// evaluate to a <number> with the value 0 (for example, calc(0)) do not match <zero>;\n// only literal <number-token>s do.\nfunction zero(next) {\n    if (typeof next !== 'function') {\n        next = function() {\n            return 0;\n        };\n    }\n\n    return function(token, getNextToken, opts) {\n        if (token !== null && token.type === TYPE.Number) {\n            if (Number(token.value) === 0) {\n                return 1;\n            }\n        }\n\n        return next(token, getNextToken, opts);\n    };\n}\n\n// § 5.3. Real Numbers: the <number> type\n// https://drafts.csswg.org/css-values-4/#numbers\n// Number values are denoted by <number>, and represent real numbers, possibly with a fractional component.\n// ... It corresponds to the <number-token> production\nfunction number(token, getNextToken, opts) {\n    if (token === null) {\n        return 0;\n    }\n\n    var numberEnd = consumeNumber(token.value, 0);\n    var isNumber = numberEnd === token.value.length;\n    if (!isNumber && !isPostfixIeHack(token.value, numberEnd)) {\n        return 0;\n    }\n\n    // check range if specified\n    if (outOfRange(opts, token.value, numberEnd)) {\n        return 0;\n    }\n\n    return 1;\n}\n\n// §5.2. Integers: the <integer> type\n// https://drafts.csswg.org/css-values-4/#integers\nfunction integer(token, getNextToken, opts) {\n    // ... corresponds to a subset of the <number-token> production\n    if (token === null || token.type !== TYPE.Number) {\n        return 0;\n    }\n\n    // The first digit of an integer may be immediately preceded by `-` or `+` to indicate the integer’s sign.\n    var i = token.value.charCodeAt(0) === 0x002B ||       // U+002B PLUS SIGN (+)\n            token.value.charCodeAt(0) === 0x002D ? 1 : 0; // U+002D HYPHEN-MINUS (-)\n\n    // When written literally, an integer is one or more decimal digits 0 through 9 ...\n    for (; i < token.value.length; i++) {\n        if (!isDigit(token.value.charCodeAt(i))) {\n            return 0;\n        }\n    }\n\n    // check range if specified\n    if (outOfRange(opts, token.value, i)) {\n        return 0;\n    }\n\n    return 1;\n}\n\nmodule.exports = {\n    // token types\n    'ident-token': tokenType(TYPE.Ident),\n    'function-token': tokenType(TYPE.Function),\n    'at-keyword-token': tokenType(TYPE.AtKeyword),\n    'hash-token': tokenType(TYPE.Hash),\n    'string-token': tokenType(TYPE.String),\n    'bad-string-token': tokenType(TYPE.BadString),\n    'url-token': tokenType(TYPE.Url),\n    'bad-url-token': tokenType(TYPE.BadUrl),\n    'delim-token': tokenType(TYPE.Delim),\n    'number-token': tokenType(TYPE.Number),\n    'percentage-token': tokenType(TYPE.Percentage),\n    'dimension-token': tokenType(TYPE.Dimension),\n    'whitespace-token': tokenType(TYPE.WhiteSpace),\n    'CDO-token': tokenType(TYPE.CDO),\n    'CDC-token': tokenType(TYPE.CDC),\n    'colon-token': tokenType(TYPE.Colon),\n    'semicolon-token': tokenType(TYPE.Semicolon),\n    'comma-token': tokenType(TYPE.Comma),\n    '[-token': tokenType(TYPE.LeftSquareBracket),\n    ']-token': tokenType(TYPE.RightSquareBracket),\n    '(-token': tokenType(TYPE.LeftParenthesis),\n    ')-token': tokenType(TYPE.RightParenthesis),\n    '{-token': tokenType(TYPE.LeftCurlyBracket),\n    '}-token': tokenType(TYPE.RightCurlyBracket),\n\n    // token type aliases\n    'string': tokenType(TYPE.String),\n    'ident': tokenType(TYPE.Ident),\n\n    // complex types\n    'custom-ident': customIdent,\n    'custom-property-name': customPropertyName,\n    'hex-color': hexColor,\n    'id-selector': idSelector, // element( <id-selector> )\n    'an-plus-b': anPlusB,\n    'urange': urange,\n    'declaration-value': declarationValue,\n    'any-value': anyValue,\n\n    // dimensions\n    'dimension': calc(dimension(null)),\n    'angle': calc(dimension(ANGLE)),\n    'decibel': calc(dimension(DECIBEL)),\n    'frequency': calc(dimension(FREQUENCY)),\n    'flex': calc(dimension(FLEX)),\n    'length': calc(zero(dimension(LENGTH))),\n    'resolution': calc(dimension(RESOLUTION)),\n    'semitones': calc(dimension(SEMITONES)),\n    'time': calc(dimension(TIME)),\n\n    // percentage\n    'percentage': calc(percentage),\n\n    // numeric\n    'zero': zero(),\n    'number': calc(number),\n    'integer': calc(integer),\n\n    // old IE stuff\n    '-ms-legacy-expression': func('expression')\n};\n","var createCustomError = require('../utils/createCustomError');\n\nmodule.exports = function SyntaxError(message, input, offset) {\n    var error = createCustomError('SyntaxError', message);\n\n    error.input = input;\n    error.offset = offset;\n    error.rawMessage = message;\n    error.message = error.rawMessage + '\\n' +\n        '  ' + error.input + '\\n' +\n        '--' + new Array((error.offset || error.input.length) + 1).join('-') + '^';\n\n    return error;\n};\n","var SyntaxError = require('./SyntaxError');\n\nvar TAB = 9;\nvar N = 10;\nvar F = 12;\nvar R = 13;\nvar SPACE = 32;\n\nvar Tokenizer = function(str) {\n    this.str = str;\n    this.pos = 0;\n};\n\nTokenizer.prototype = {\n    charCodeAt: function(pos) {\n        return pos < this.str.length ? this.str.charCodeAt(pos) : 0;\n    },\n    charCode: function() {\n        return this.charCodeAt(this.pos);\n    },\n    nextCharCode: function() {\n        return this.charCodeAt(this.pos + 1);\n    },\n    nextNonWsCode: function(pos) {\n        return this.charCodeAt(this.findWsEnd(pos));\n    },\n    findWsEnd: function(pos) {\n        for (; pos < this.str.length; pos++) {\n            var code = this.str.charCodeAt(pos);\n            if (code !== R && code !== N && code !== F && code !== SPACE && code !== TAB) {\n                break;\n            }\n        }\n\n        return pos;\n    },\n    substringToPos: function(end) {\n        return this.str.substring(this.pos, this.pos = end);\n    },\n    eat: function(code) {\n        if (this.charCode() !== code) {\n            this.error('Expect `' + String.fromCharCode(code) + '`');\n        }\n\n        this.pos++;\n    },\n    peek: function() {\n        return this.pos < this.str.length ? this.str.charAt(this.pos++) : '';\n    },\n    error: function(message) {\n        throw new SyntaxError(message, this.str, this.pos);\n    }\n};\n\nmodule.exports = Tokenizer;\n","var Tokenizer = require('./tokenizer');\nvar TAB = 9;\nvar N = 10;\nvar F = 12;\nvar R = 13;\nvar SPACE = 32;\nvar EXCLAMATIONMARK = 33;    // !\nvar NUMBERSIGN = 35;         // #\nvar AMPERSAND = 38;          // &\nvar APOSTROPHE = 39;         // '\nvar LEFTPARENTHESIS = 40;    // (\nvar RIGHTPARENTHESIS = 41;   // )\nvar ASTERISK = 42;           // *\nvar PLUSSIGN = 43;           // +\nvar COMMA = 44;              // ,\nvar HYPERMINUS = 45;         // -\nvar LESSTHANSIGN = 60;       // <\nvar GREATERTHANSIGN = 62;    // >\nvar QUESTIONMARK = 63;       // ?\nvar COMMERCIALAT = 64;       // @\nvar LEFTSQUAREBRACKET = 91;  // [\nvar RIGHTSQUAREBRACKET = 93; // ]\nvar LEFTCURLYBRACKET = 123;  // {\nvar VERTICALLINE = 124;      // |\nvar RIGHTCURLYBRACKET = 125; // }\nvar INFINITY = 8734;         // ∞\nvar NAME_CHAR = createCharMap(function(ch) {\n    return /[a-zA-Z0-9\\-]/.test(ch);\n});\nvar COMBINATOR_PRECEDENCE = {\n    ' ': 1,\n    '&&': 2,\n    '||': 3,\n    '|': 4\n};\n\nfunction createCharMap(fn) {\n    var array = typeof Uint32Array === 'function' ? new Uint32Array(128) : new Array(128);\n    for (var i = 0; i < 128; i++) {\n        array[i] = fn(String.fromCharCode(i)) ? 1 : 0;\n    }\n    return array;\n}\n\nfunction scanSpaces(tokenizer) {\n    return tokenizer.substringToPos(\n        tokenizer.findWsEnd(tokenizer.pos)\n    );\n}\n\nfunction scanWord(tokenizer) {\n    var end = tokenizer.pos;\n\n    for (; end < tokenizer.str.length; end++) {\n        var code = tokenizer.str.charCodeAt(end);\n        if (code >= 128 || NAME_CHAR[code] === 0) {\n            break;\n        }\n    }\n\n    if (tokenizer.pos === end) {\n        tokenizer.error('Expect a keyword');\n    }\n\n    return tokenizer.substringToPos(end);\n}\n\nfunction scanNumber(tokenizer) {\n    var end = tokenizer.pos;\n\n    for (; end < tokenizer.str.length; end++) {\n        var code = tokenizer.str.charCodeAt(end);\n        if (code < 48 || code > 57) {\n            break;\n        }\n    }\n\n    if (tokenizer.pos === end) {\n        tokenizer.error('Expect a number');\n    }\n\n    return tokenizer.substringToPos(end);\n}\n\nfunction scanString(tokenizer) {\n    var end = tokenizer.str.indexOf('\\'', tokenizer.pos + 1);\n\n    if (end === -1) {\n        tokenizer.pos = tokenizer.str.length;\n        tokenizer.error('Expect an apostrophe');\n    }\n\n    return tokenizer.substringToPos(end + 1);\n}\n\nfunction readMultiplierRange(tokenizer) {\n    var min = null;\n    var max = null;\n\n    tokenizer.eat(LEFTCURLYBRACKET);\n\n    min = scanNumber(tokenizer);\n\n    if (tokenizer.charCode() === COMMA) {\n        tokenizer.pos++;\n        if (tokenizer.charCode() !== RIGHTCURLYBRACKET) {\n            max = scanNumber(tokenizer);\n        }\n    } else {\n        max = min;\n    }\n\n    tokenizer.eat(RIGHTCURLYBRACKET);\n\n    return {\n        min: Number(min),\n        max: max ? Number(max) : 0\n    };\n}\n\nfunction readMultiplier(tokenizer) {\n    var range = null;\n    var comma = false;\n\n    switch (tokenizer.charCode()) {\n        case ASTERISK:\n            tokenizer.pos++;\n\n            range = {\n                min: 0,\n                max: 0\n            };\n\n            break;\n\n        case PLUSSIGN:\n            tokenizer.pos++;\n\n            range = {\n                min: 1,\n                max: 0\n            };\n\n            break;\n\n        case QUESTIONMARK:\n            tokenizer.pos++;\n\n            range = {\n                min: 0,\n                max: 1\n            };\n\n            break;\n\n        case NUMBERSIGN:\n            tokenizer.pos++;\n\n            comma = true;\n\n            if (tokenizer.charCode() === LEFTCURLYBRACKET) {\n                range = readMultiplierRange(tokenizer);\n            } else {\n                range = {\n                    min: 1,\n                    max: 0\n                };\n            }\n\n            break;\n\n        case LEFTCURLYBRACKET:\n            range = readMultiplierRange(tokenizer);\n            break;\n\n        default:\n            return null;\n    }\n\n    return {\n        type: 'Multiplier',\n        comma: comma,\n        min: range.min,\n        max: range.max,\n        term: null\n    };\n}\n\nfunction maybeMultiplied(tokenizer, node) {\n    var multiplier = readMultiplier(tokenizer);\n\n    if (multiplier !== null) {\n        multiplier.term = node;\n        return multiplier;\n    }\n\n    return node;\n}\n\nfunction maybeToken(tokenizer) {\n    var ch = tokenizer.peek();\n\n    if (ch === '') {\n        return null;\n    }\n\n    return {\n        type: 'Token',\n        value: ch\n    };\n}\n\nfunction readProperty(tokenizer) {\n    var name;\n\n    tokenizer.eat(LESSTHANSIGN);\n    tokenizer.eat(APOSTROPHE);\n\n    name = scanWord(tokenizer);\n\n    tokenizer.eat(APOSTROPHE);\n    tokenizer.eat(GREATERTHANSIGN);\n\n    return maybeMultiplied(tokenizer, {\n        type: 'Property',\n        name: name\n    });\n}\n\n// https://drafts.csswg.org/css-values-3/#numeric-ranges\n// 4.1. Range Restrictions and Range Definition Notation\n//\n// Range restrictions can be annotated in the numeric type notation using CSS bracketed\n// range notation—[min,max]—within the angle brackets, after the identifying keyword,\n// indicating a closed range between (and including) min and max.\n// For example, <integer [0, 10]> indicates an integer between 0 and 10, inclusive.\nfunction readTypeRange(tokenizer) {\n    // use null for Infinity to make AST format JSON serializable/deserializable\n    var min = null; // -Infinity\n    var max = null; // Infinity\n    var sign = 1;\n\n    tokenizer.eat(LEFTSQUAREBRACKET);\n\n    if (tokenizer.charCode() === HYPERMINUS) {\n        tokenizer.peek();\n        sign = -1;\n    }\n\n    if (sign == -1 && tokenizer.charCode() === INFINITY) {\n        tokenizer.peek();\n    } else {\n        min = sign * Number(scanNumber(tokenizer));\n    }\n\n    scanSpaces(tokenizer);\n    tokenizer.eat(COMMA);\n    scanSpaces(tokenizer);\n\n    if (tokenizer.charCode() === INFINITY) {\n        tokenizer.peek();\n    } else {\n        sign = 1;\n\n        if (tokenizer.charCode() === HYPERMINUS) {\n            tokenizer.peek();\n            sign = -1;\n        }\n\n        max = sign * Number(scanNumber(tokenizer));\n    }\n\n    tokenizer.eat(RIGHTSQUAREBRACKET);\n\n    // If no range is indicated, either by using the bracketed range notation\n    // or in the property description, then [−∞,∞] is assumed.\n    if (min === null && max === null) {\n        return null;\n    }\n\n    return {\n        type: 'Range',\n        min: min,\n        max: max\n    };\n}\n\nfunction readType(tokenizer) {\n    var name;\n    var opts = null;\n\n    tokenizer.eat(LESSTHANSIGN);\n    name = scanWord(tokenizer);\n\n    if (tokenizer.charCode() === LEFTPARENTHESIS &&\n        tokenizer.nextCharCode() === RIGHTPARENTHESIS) {\n        tokenizer.pos += 2;\n        name += '()';\n    }\n\n    if (tokenizer.charCodeAt(tokenizer.findWsEnd(tokenizer.pos)) === LEFTSQUAREBRACKET) {\n        scanSpaces(tokenizer);\n        opts = readTypeRange(tokenizer);\n    }\n\n    tokenizer.eat(GREATERTHANSIGN);\n\n    return maybeMultiplied(tokenizer, {\n        type: 'Type',\n        name: name,\n        opts: opts\n    });\n}\n\nfunction readKeywordOrFunction(tokenizer) {\n    var name;\n\n    name = scanWord(tokenizer);\n\n    if (tokenizer.charCode() === LEFTPARENTHESIS) {\n        tokenizer.pos++;\n\n        return {\n            type: 'Function',\n            name: name\n        };\n    }\n\n    return maybeMultiplied(tokenizer, {\n        type: 'Keyword',\n        name: name\n    });\n}\n\nfunction regroupTerms(terms, combinators) {\n    function createGroup(terms, combinator) {\n        return {\n            type: 'Group',\n            terms: terms,\n            combinator: combinator,\n            disallowEmpty: false,\n            explicit: false\n        };\n    }\n\n    combinators = Object.keys(combinators).sort(function(a, b) {\n        return COMBINATOR_PRECEDENCE[a] - COMBINATOR_PRECEDENCE[b];\n    });\n\n    while (combinators.length > 0) {\n        var combinator = combinators.shift();\n        for (var i = 0, subgroupStart = 0; i < terms.length; i++) {\n            var term = terms[i];\n            if (term.type === 'Combinator') {\n                if (term.value === combinator) {\n                    if (subgroupStart === -1) {\n                        subgroupStart = i - 1;\n                    }\n                    terms.splice(i, 1);\n                    i--;\n                } else {\n                    if (subgroupStart !== -1 && i - subgroupStart > 1) {\n                        terms.splice(\n                            subgroupStart,\n                            i - subgroupStart,\n                            createGroup(terms.slice(subgroupStart, i), combinator)\n                        );\n                        i = subgroupStart + 1;\n                    }\n                    subgroupStart = -1;\n                }\n            }\n        }\n\n        if (subgroupStart !== -1 && combinators.length) {\n            terms.splice(\n                subgroupStart,\n                i - subgroupStart,\n                createGroup(terms.slice(subgroupStart, i), combinator)\n            );\n        }\n    }\n\n    return combinator;\n}\n\nfunction readImplicitGroup(tokenizer) {\n    var terms = [];\n    var combinators = {};\n    var token;\n    var prevToken = null;\n    var prevTokenPos = tokenizer.pos;\n\n    while (token = peek(tokenizer)) {\n        if (token.type !== 'Spaces') {\n            if (token.type === 'Combinator') {\n                // check for combinator in group beginning and double combinator sequence\n                if (prevToken === null || prevToken.type === 'Combinator') {\n                    tokenizer.pos = prevTokenPos;\n                    tokenizer.error('Unexpected combinator');\n                }\n\n                combinators[token.value] = true;\n            } else if (prevToken !== null && prevToken.type !== 'Combinator') {\n                combinators[' '] = true;  // a b\n                terms.push({\n                    type: 'Combinator',\n                    value: ' '\n                });\n            }\n\n            terms.push(token);\n            prevToken = token;\n            prevTokenPos = tokenizer.pos;\n        }\n    }\n\n    // check for combinator in group ending\n    if (prevToken !== null && prevToken.type === 'Combinator') {\n        tokenizer.pos -= prevTokenPos;\n        tokenizer.error('Unexpected combinator');\n    }\n\n    return {\n        type: 'Group',\n        terms: terms,\n        combinator: regroupTerms(terms, combinators) || ' ',\n        disallowEmpty: false,\n        explicit: false\n    };\n}\n\nfunction readGroup(tokenizer) {\n    var result;\n\n    tokenizer.eat(LEFTSQUAREBRACKET);\n    result = readImplicitGroup(tokenizer);\n    tokenizer.eat(RIGHTSQUAREBRACKET);\n\n    result.explicit = true;\n\n    if (tokenizer.charCode() === EXCLAMATIONMARK) {\n        tokenizer.pos++;\n        result.disallowEmpty = true;\n    }\n\n    return result;\n}\n\nfunction peek(tokenizer) {\n    var code = tokenizer.charCode();\n\n    if (code < 128 && NAME_CHAR[code] === 1) {\n        return readKeywordOrFunction(tokenizer);\n    }\n\n    switch (code) {\n        case RIGHTSQUAREBRACKET:\n            // don't eat, stop scan a group\n            break;\n\n        case LEFTSQUAREBRACKET:\n            return maybeMultiplied(tokenizer, readGroup(tokenizer));\n\n        case LESSTHANSIGN:\n            return tokenizer.nextCharCode() === APOSTROPHE\n                ? readProperty(tokenizer)\n                : readType(tokenizer);\n\n        case VERTICALLINE:\n            return {\n                type: 'Combinator',\n                value: tokenizer.substringToPos(\n                    tokenizer.nextCharCode() === VERTICALLINE\n                        ? tokenizer.pos + 2\n                        : tokenizer.pos + 1\n                )\n            };\n\n        case AMPERSAND:\n            tokenizer.pos++;\n            tokenizer.eat(AMPERSAND);\n\n            return {\n                type: 'Combinator',\n                value: '&&'\n            };\n\n        case COMMA:\n            tokenizer.pos++;\n            return {\n                type: 'Comma'\n            };\n\n        case APOSTROPHE:\n            return maybeMultiplied(tokenizer, {\n                type: 'String',\n                value: scanString(tokenizer)\n            });\n\n        case SPACE:\n        case TAB:\n        case N:\n        case R:\n        case F:\n            return {\n                type: 'Spaces',\n                value: scanSpaces(tokenizer)\n            };\n\n        case COMMERCIALAT:\n            code = tokenizer.nextCharCode();\n\n            if (code < 128 && NAME_CHAR[code] === 1) {\n                tokenizer.pos++;\n                return {\n                    type: 'AtKeyword',\n                    name: scanWord(tokenizer)\n                };\n            }\n\n            return maybeToken(tokenizer);\n\n        case ASTERISK:\n        case PLUSSIGN:\n        case QUESTIONMARK:\n        case NUMBERSIGN:\n        case EXCLAMATIONMARK:\n            // prohibited tokens (used as a multiplier start)\n            break;\n\n        case LEFTCURLYBRACKET:\n            // LEFTCURLYBRACKET is allowed since mdn/data uses it w/o quoting\n            // check next char isn't a number, because it's likely a disjoined multiplier\n            code = tokenizer.nextCharCode();\n\n            if (code < 48 || code > 57) {\n                return maybeToken(tokenizer);\n            }\n\n            break;\n\n        default:\n            return maybeToken(tokenizer);\n    }\n}\n\nfunction parse(source) {\n    var tokenizer = new Tokenizer(source);\n    var result = readImplicitGroup(tokenizer);\n\n    if (tokenizer.pos !== source.length) {\n        tokenizer.error('Unexpected input');\n    }\n\n    // reduce redundant groups with single group term\n    if (result.terms.length === 1 && result.terms[0].type === 'Group') {\n        result = result.terms[0];\n    }\n\n    return result;\n}\n\n// warm up parse to elimitate code branches that never execute\n// fix soft deoptimizations (insufficient type feedback)\nparse('[a&&<b>#|<\\'c\\'>*||e() f{2} /,(% g#{1,2} h{2,})]!');\n\nmodule.exports = parse;\n","var noop = function() {};\n\nfunction ensureFunction(value) {\n    return typeof value === 'function' ? value : noop;\n}\n\nmodule.exports = function(node, options, context) {\n    function walk(node) {\n        enter.call(context, node);\n\n        switch (node.type) {\n            case 'Group':\n                node.terms.forEach(walk);\n                break;\n\n            case 'Multiplier':\n                walk(node.term);\n                break;\n\n            case 'Type':\n            case 'Property':\n            case 'Keyword':\n            case 'AtKeyword':\n            case 'Function':\n            case 'String':\n            case 'Token':\n            case 'Comma':\n                break;\n\n            default:\n                throw new Error('Unknown type: ' + node.type);\n        }\n\n        leave.call(context, node);\n    }\n\n    var enter = noop;\n    var leave = noop;\n\n    if (typeof options === 'function') {\n        enter = options;\n    } else if (options) {\n        enter = ensureFunction(options.enter);\n        leave = ensureFunction(options.leave);\n    }\n\n    if (enter === noop && leave === noop) {\n        throw new Error('Neither `enter` nor `leave` walker handler is set or both aren\\'t a function');\n    }\n\n    walk(node, context);\n};\n","var tokenize = require('../tokenizer');\nvar TokenStream = require('../common/TokenStream');\nvar tokenStream = new TokenStream();\nvar astToTokens = {\n    decorator: function(handlers) {\n        var curNode = null;\n        var prev = { len: 0, node: null };\n        var nodes = [prev];\n        var buffer = '';\n\n        return {\n            children: handlers.children,\n            node: function(node) {\n                var tmp = curNode;\n                curNode = node;\n                handlers.node.call(this, node);\n                curNode = tmp;\n            },\n            chunk: function(chunk) {\n                buffer += chunk;\n                if (prev.node !== curNode) {\n                    nodes.push({\n                        len: chunk.length,\n                        node: curNode\n                    });\n                } else {\n                    prev.len += chunk.length;\n                }\n            },\n            result: function() {\n                return prepareTokens(buffer, nodes);\n            }\n        };\n    }\n};\n\nfunction prepareTokens(str, nodes) {\n    var tokens = [];\n    var nodesOffset = 0;\n    var nodesIndex = 0;\n    var currentNode = nodes ? nodes[nodesIndex].node : null;\n\n    tokenize(str, tokenStream);\n\n    while (!tokenStream.eof) {\n        if (nodes) {\n            while (nodesIndex < nodes.length && nodesOffset + nodes[nodesIndex].len <= tokenStream.tokenStart) {\n                nodesOffset += nodes[nodesIndex++].len;\n                currentNode = nodes[nodesIndex].node;\n            }\n        }\n\n        tokens.push({\n            type: tokenStream.tokenType,\n            value: tokenStream.getTokenValue(),\n            index: tokenStream.tokenIndex, // TODO: remove it, temporary solution\n            balance: tokenStream.balance[tokenStream.tokenIndex], // TODO: remove it, temporary solution\n            node: currentNode\n        });\n        tokenStream.next();\n        // console.log({ ...tokens[tokens.length - 1], node: undefined });\n    }\n\n    return tokens;\n}\n\nmodule.exports = function(value, syntax) {\n    if (typeof value === 'string') {\n        return prepareTokens(value, null);\n    }\n\n    return syntax.generate(value, astToTokens);\n};\n","var parse = require('../definition-syntax/parse');\n\nvar MATCH = { type: 'Match' };\nvar MISMATCH = { type: 'Mismatch' };\nvar DISALLOW_EMPTY = { type: 'DisallowEmpty' };\nvar LEFTPARENTHESIS = 40;  // (\nvar RIGHTPARENTHESIS = 41; // )\n\nfunction createCondition(match, thenBranch, elseBranch) {\n    // reduce node count\n    if (thenBranch === MATCH && elseBranch === MISMATCH) {\n        return match;\n    }\n\n    if (match === MATCH && thenBranch === MATCH && elseBranch === MATCH) {\n        return match;\n    }\n\n    if (match.type === 'If' && match.else === MISMATCH && thenBranch === MATCH) {\n        thenBranch = match.then;\n        match = match.match;\n    }\n\n    return {\n        type: 'If',\n        match: match,\n        then: thenBranch,\n        else: elseBranch\n    };\n}\n\nfunction isFunctionType(name) {\n    return (\n        name.length > 2 &&\n        name.charCodeAt(name.length - 2) === LEFTPARENTHESIS &&\n        name.charCodeAt(name.length - 1) === RIGHTPARENTHESIS\n    );\n}\n\nfunction isEnumCapatible(term) {\n    return (\n        term.type === 'Keyword' ||\n        term.type === 'AtKeyword' ||\n        term.type === 'Function' ||\n        term.type === 'Type' && isFunctionType(term.name)\n    );\n}\n\nfunction buildGroupMatchGraph(combinator, terms, atLeastOneTermMatched) {\n    switch (combinator) {\n        case ' ':\n            // Juxtaposing components means that all of them must occur, in the given order.\n            //\n            // a b c\n            // =\n            // match a\n            //   then match b\n            //     then match c\n            //       then MATCH\n            //       else MISMATCH\n            //     else MISMATCH\n            //   else MISMATCH\n            var result = MATCH;\n\n            for (var i = terms.length - 1; i >= 0; i--) {\n                var term = terms[i];\n\n                result = createCondition(\n                    term,\n                    result,\n                    MISMATCH\n                );\n            };\n\n            return result;\n\n        case '|':\n            // A bar (|) separates two or more alternatives: exactly one of them must occur.\n            //\n            // a | b | c\n            // =\n            // match a\n            //   then MATCH\n            //   else match b\n            //     then MATCH\n            //     else match c\n            //       then MATCH\n            //       else MISMATCH\n\n            var result = MISMATCH;\n            var map = null;\n\n            for (var i = terms.length - 1; i >= 0; i--) {\n                var term = terms[i];\n\n                // reduce sequence of keywords into a Enum\n                if (isEnumCapatible(term)) {\n                    if (map === null && i > 0 && isEnumCapatible(terms[i - 1])) {\n                        map = Object.create(null);\n                        result = createCondition(\n                            {\n                                type: 'Enum',\n                                map: map\n                            },\n                            MATCH,\n                            result\n                        );\n                    }\n\n                    if (map !== null) {\n                        var key = (isFunctionType(term.name) ? term.name.slice(0, -1) : term.name).toLowerCase();\n                        if (key in map === false) {\n                            map[key] = term;\n                            continue;\n                        }\n                    }\n                }\n\n                map = null;\n\n                // create a new conditonal node\n                result = createCondition(\n                    term,\n                    MATCH,\n                    result\n                );\n            };\n\n            return result;\n\n        case '&&':\n            // A double ampersand (&&) separates two or more components,\n            // all of which must occur, in any order.\n\n            // Use MatchOnce for groups with a large number of terms,\n            // since &&-groups produces at least N!-node trees\n            if (terms.length > 5) {\n                return {\n                    type: 'MatchOnce',\n                    terms: terms,\n                    all: true\n                };\n            }\n\n            // Use a combination tree for groups with small number of terms\n            //\n            // a && b && c\n            // =\n            // match a\n            //   then [b && c]\n            //   else match b\n            //     then [a && c]\n            //     else match c\n            //       then [a && b]\n            //       else MISMATCH\n            //\n            // a && b\n            // =\n            // match a\n            //   then match b\n            //     then MATCH\n            //     else MISMATCH\n            //   else match b\n            //     then match a\n            //       then MATCH\n            //       else MISMATCH\n            //     else MISMATCH\n            var result = MISMATCH;\n\n            for (var i = terms.length - 1; i >= 0; i--) {\n                var term = terms[i];\n                var thenClause;\n\n                if (terms.length > 1) {\n                    thenClause = buildGroupMatchGraph(\n                        combinator,\n                        terms.filter(function(newGroupTerm) {\n                            return newGroupTerm !== term;\n                        }),\n                        false\n                    );\n                } else {\n                    thenClause = MATCH;\n                }\n\n                result = createCondition(\n                    term,\n                    thenClause,\n                    result\n                );\n            };\n\n            return result;\n\n        case '||':\n            // A double bar (||) separates two or more options:\n            // one or more of them must occur, in any order.\n\n            // Use MatchOnce for groups with a large number of terms,\n            // since ||-groups produces at least N!-node trees\n            if (terms.length > 5) {\n                return {\n                    type: 'MatchOnce',\n                    terms: terms,\n                    all: false\n                };\n            }\n\n            // Use a combination tree for groups with small number of terms\n            //\n            // a || b || c\n            // =\n            // match a\n            //   then [b || c]\n            //   else match b\n            //     then [a || c]\n            //     else match c\n            //       then [a || b]\n            //       else MISMATCH\n            //\n            // a || b\n            // =\n            // match a\n            //   then match b\n            //     then MATCH\n            //     else MATCH\n            //   else match b\n            //     then match a\n            //       then MATCH\n            //       else MATCH\n            //     else MISMATCH\n            var result = atLeastOneTermMatched ? MATCH : MISMATCH;\n\n            for (var i = terms.length - 1; i >= 0; i--) {\n                var term = terms[i];\n                var thenClause;\n\n                if (terms.length > 1) {\n                    thenClause = buildGroupMatchGraph(\n                        combinator,\n                        terms.filter(function(newGroupTerm) {\n                            return newGroupTerm !== term;\n                        }),\n                        true\n                    );\n                } else {\n                    thenClause = MATCH;\n                }\n\n                result = createCondition(\n                    term,\n                    thenClause,\n                    result\n                );\n            };\n\n            return result;\n    }\n}\n\nfunction buildMultiplierMatchGraph(node) {\n    var result = MATCH;\n    var matchTerm = buildMatchGraph(node.term);\n\n    if (node.max === 0) {\n        // disable repeating of empty match to prevent infinite loop\n        matchTerm = createCondition(\n            matchTerm,\n            DISALLOW_EMPTY,\n            MISMATCH\n        );\n\n        // an occurrence count is not limited, make a cycle;\n        // to collect more terms on each following matching mismatch\n        result = createCondition(\n            matchTerm,\n            null, // will be a loop\n            MISMATCH\n        );\n\n        result.then = createCondition(\n            MATCH,\n            MATCH,\n            result // make a loop\n        );\n\n        if (node.comma) {\n            result.then.else = createCondition(\n                { type: 'Comma', syntax: node },\n                result,\n                MISMATCH\n            );\n        }\n    } else {\n        // create a match node chain for [min .. max] interval with optional matches\n        for (var i = node.min || 1; i <= node.max; i++) {\n            if (node.comma && result !== MATCH) {\n                result = createCondition(\n                    { type: 'Comma', syntax: node },\n                    result,\n                    MISMATCH\n                );\n            }\n\n            result = createCondition(\n                matchTerm,\n                createCondition(\n                    MATCH,\n                    MATCH,\n                    result\n                ),\n                MISMATCH\n            );\n        }\n    }\n\n    if (node.min === 0) {\n        // allow zero match\n        result = createCondition(\n            MATCH,\n            MATCH,\n            result\n        );\n    } else {\n        // create a match node chain to collect [0 ... min - 1] required matches\n        for (var i = 0; i < node.min - 1; i++) {\n            if (node.comma && result !== MATCH) {\n                result = createCondition(\n                    { type: 'Comma', syntax: node },\n                    result,\n                    MISMATCH\n                );\n            }\n\n            result = createCondition(\n                matchTerm,\n                result,\n                MISMATCH\n            );\n        }\n    }\n\n    return result;\n}\n\nfunction buildMatchGraph(node) {\n    if (typeof node === 'function') {\n        return {\n            type: 'Generic',\n            fn: node\n        };\n    }\n\n    switch (node.type) {\n        case 'Group':\n            var result = buildGroupMatchGraph(\n                node.combinator,\n                node.terms.map(buildMatchGraph),\n                false\n            );\n\n            if (node.disallowEmpty) {\n                result = createCondition(\n                    result,\n                    DISALLOW_EMPTY,\n                    MISMATCH\n                );\n            }\n\n            return result;\n\n        case 'Multiplier':\n            return buildMultiplierMatchGraph(node);\n\n        case 'Type':\n        case 'Property':\n            return {\n                type: node.type,\n                name: node.name,\n                syntax: node\n            };\n\n        case 'Keyword':\n            return {\n                type: node.type,\n                name: node.name.toLowerCase(),\n                syntax: node\n            };\n\n        case 'AtKeyword':\n            return {\n                type: node.type,\n                name: '@' + node.name.toLowerCase(),\n                syntax: node\n            };\n\n        case 'Function':\n            return {\n                type: node.type,\n                name: node.name.toLowerCase() + '(',\n                syntax: node\n            };\n\n        case 'String':\n            // convert a one char length String to a Token\n            if (node.value.length === 3) {\n                return {\n                    type: 'Token',\n                    value: node.value.charAt(1),\n                    syntax: node\n                };\n            }\n\n            // otherwise use it as is\n            return {\n                type: node.type,\n                value: node.value.substr(1, node.value.length - 2).replace(/\\\\'/g, '\\''),\n                syntax: node\n            };\n\n        case 'Token':\n            return {\n                type: node.type,\n                value: node.value,\n                syntax: node\n            };\n\n        case 'Comma':\n            return {\n                type: node.type,\n                syntax: node\n            };\n\n        default:\n            throw new Error('Unknown node type:', node.type);\n    }\n}\n\nmodule.exports = {\n    MATCH: MATCH,\n    MISMATCH: MISMATCH,\n    DISALLOW_EMPTY: DISALLOW_EMPTY,\n    buildMatchGraph: function(syntaxTree, ref) {\n        if (typeof syntaxTree === 'string') {\n            syntaxTree = parse(syntaxTree);\n        }\n\n        return {\n            type: 'MatchGraph',\n            match: buildMatchGraph(syntaxTree),\n            syntax: ref || null,\n            source: syntaxTree\n        };\n    }\n};\n","var hasOwnProperty = Object.prototype.hasOwnProperty;\nvar matchGraph = require('./match-graph');\nvar MATCH = matchGraph.MATCH;\nvar MISMATCH = matchGraph.MISMATCH;\nvar DISALLOW_EMPTY = matchGraph.DISALLOW_EMPTY;\nvar TYPE = require('../tokenizer/const').TYPE;\n\nvar STUB = 0;\nvar TOKEN = 1;\nvar OPEN_SYNTAX = 2;\nvar CLOSE_SYNTAX = 3;\n\nvar EXIT_REASON_MATCH = 'Match';\nvar EXIT_REASON_MISMATCH = 'Mismatch';\nvar EXIT_REASON_ITERATION_LIMIT = 'Maximum iteration number exceeded (please fill an issue on https://github.com/csstree/csstree/issues)';\n\nvar ITERATION_LIMIT = 15000;\nvar totalIterationCount = 0;\n\nfunction reverseList(list) {\n    var prev = null;\n    var next = null;\n    var item = list;\n\n    while (item !== null) {\n        next = item.prev;\n        item.prev = prev;\n        prev = item;\n        item = next;\n    }\n\n    return prev;\n}\n\nfunction areStringsEqualCaseInsensitive(testStr, referenceStr) {\n    if (testStr.length !== referenceStr.length) {\n        return false;\n    }\n\n    for (var i = 0; i < testStr.length; i++) {\n        var testCode = testStr.charCodeAt(i);\n        var referenceCode = referenceStr.charCodeAt(i);\n\n        // testCode.toLowerCase() for U+0041 LATIN CAPITAL LETTER A (A) .. U+005A LATIN CAPITAL LETTER Z (Z).\n        if (testCode >= 0x0041 && testCode <= 0x005A) {\n            testCode = testCode | 32;\n        }\n\n        if (testCode !== referenceCode) {\n            return false;\n        }\n    }\n\n    return true;\n}\n\nfunction isContextEdgeDelim(token) {\n    if (token.type !== TYPE.Delim) {\n        return false;\n    }\n\n    // Fix matching for unicode-range: U+30??, U+FF00-FF9F\n    // Probably we need to check out previous match instead\n    return token.value !== '?';\n}\n\nfunction isCommaContextStart(token) {\n    if (token === null) {\n        return true;\n    }\n\n    return (\n        token.type === TYPE.Comma ||\n        token.type === TYPE.Function ||\n        token.type === TYPE.LeftParenthesis ||\n        token.type === TYPE.LeftSquareBracket ||\n        token.type === TYPE.LeftCurlyBracket ||\n        isContextEdgeDelim(token)\n    );\n}\n\nfunction isCommaContextEnd(token) {\n    if (token === null) {\n        return true;\n    }\n\n    return (\n        token.type === TYPE.RightParenthesis ||\n        token.type === TYPE.RightSquareBracket ||\n        token.type === TYPE.RightCurlyBracket ||\n        token.type === TYPE.Delim\n    );\n}\n\nfunction internalMatch(tokens, state, syntaxes) {\n    function moveToNextToken() {\n        do {\n            tokenIndex++;\n            token = tokenIndex < tokens.length ? tokens[tokenIndex] : null;\n        } while (token !== null && (token.type === TYPE.WhiteSpace || token.type === TYPE.Comment));\n    }\n\n    function getNextToken(offset) {\n        var nextIndex = tokenIndex + offset;\n\n        return nextIndex < tokens.length ? tokens[nextIndex] : null;\n    }\n\n    function stateSnapshotFromSyntax(nextState, prev) {\n        return {\n            nextState: nextState,\n            matchStack: matchStack,\n            syntaxStack: syntaxStack,\n            thenStack: thenStack,\n            tokenIndex: tokenIndex,\n            prev: prev\n        };\n    }\n\n    function pushThenStack(nextState) {\n        thenStack = {\n            nextState: nextState,\n            matchStack: matchStack,\n            syntaxStack: syntaxStack,\n            prev: thenStack\n        };\n    }\n\n    function pushElseStack(nextState) {\n        elseStack = stateSnapshotFromSyntax(nextState, elseStack);\n    }\n\n    function addTokenToMatch() {\n        matchStack = {\n            type: TOKEN,\n            syntax: state.syntax,\n            token: token,\n            prev: matchStack\n        };\n\n        moveToNextToken();\n        syntaxStash = null;\n\n        if (tokenIndex > longestMatch) {\n            longestMatch = tokenIndex;\n        }\n    }\n\n    function openSyntax() {\n        syntaxStack = {\n            syntax: state.syntax,\n            opts: state.syntax.opts || (syntaxStack !== null && syntaxStack.opts) || null,\n            prev: syntaxStack\n        };\n\n        matchStack = {\n            type: OPEN_SYNTAX,\n            syntax: state.syntax,\n            token: matchStack.token,\n            prev: matchStack\n        };\n    }\n\n    function closeSyntax() {\n        if (matchStack.type === OPEN_SYNTAX) {\n            matchStack = matchStack.prev;\n        } else {\n            matchStack = {\n                type: CLOSE_SYNTAX,\n                syntax: syntaxStack.syntax,\n                token: matchStack.token,\n                prev: matchStack\n            };\n        }\n\n        syntaxStack = syntaxStack.prev;\n    }\n\n    var syntaxStack = null;\n    var thenStack = null;\n    var elseStack = null;\n\n    // null – stashing allowed, nothing stashed\n    // false – stashing disabled, nothing stashed\n    // anithing else – fail stashable syntaxes, some syntax stashed\n    var syntaxStash = null;\n\n    var iterationCount = 0; // count iterations and prevent infinite loop\n    var exitReason = null;\n\n    var token = null;\n    var tokenIndex = -1;\n    var longestMatch = 0;\n    var matchStack = {\n        type: STUB,\n        syntax: null,\n        token: null,\n        prev: null\n    };\n\n    moveToNextToken();\n\n    while (exitReason === null && ++iterationCount < ITERATION_LIMIT) {\n        // function mapList(list, fn) {\n        //     var result = [];\n        //     while (list) {\n        //         result.unshift(fn(list));\n        //         list = list.prev;\n        //     }\n        //     return result;\n        // }\n        // console.log('--\\n',\n        //     '#' + iterationCount,\n        //     require('util').inspect({\n        //         match: mapList(matchStack, x => x.type === TOKEN ? x.token && x.token.value : x.syntax ? ({ [OPEN_SYNTAX]: '<', [CLOSE_SYNTAX]: '</' }[x.type] || x.type) + '!' + x.syntax.name : null),\n        //         token: token && token.value,\n        //         tokenIndex,\n        //         syntax: syntax.type + (syntax.id ? ' #' + syntax.id : '')\n        //     }, { depth: null })\n        // );\n        switch (state.type) {\n            case 'Match':\n                if (thenStack === null) {\n                    // turn to MISMATCH when some tokens left unmatched\n                    if (token !== null) {\n                        // doesn't mismatch if just one token left and it's an IE hack\n                        if (tokenIndex !== tokens.length - 1 || (token.value !== '\\\\0' && token.value !== '\\\\9')) {\n                            state = MISMATCH;\n                            break;\n                        }\n                    }\n\n                    // break the main loop, return a result - MATCH\n                    exitReason = EXIT_REASON_MATCH;\n                    break;\n                }\n\n                // go to next syntax (`then` branch)\n                state = thenStack.nextState;\n\n                // check match is not empty\n                if (state === DISALLOW_EMPTY) {\n                    if (thenStack.matchStack === matchStack) {\n                        state = MISMATCH;\n                        break;\n                    } else {\n                        state = MATCH;\n                    }\n                }\n\n                // close syntax if needed\n                while (thenStack.syntaxStack !== syntaxStack) {\n                    closeSyntax();\n                }\n\n                // pop stack\n                thenStack = thenStack.prev;\n                break;\n\n            case 'Mismatch':\n                // when some syntax is stashed\n                if (syntaxStash !== null && syntaxStash !== false) {\n                    // there is no else branches or a branch reduce match stack\n                    if (elseStack === null || tokenIndex > elseStack.tokenIndex) {\n                        // restore state from the stash\n                        elseStack = syntaxStash;\n                        syntaxStash = false; // disable stashing\n                    }\n                } else if (elseStack === null) {\n                    // no else branches -> break the main loop\n                    // return a result - MISMATCH\n                    exitReason = EXIT_REASON_MISMATCH;\n                    break;\n                }\n\n                // go to next syntax (`else` branch)\n                state = elseStack.nextState;\n\n                // restore all the rest stack states\n                thenStack = elseStack.thenStack;\n                syntaxStack = elseStack.syntaxStack;\n                matchStack = elseStack.matchStack;\n                tokenIndex = elseStack.tokenIndex;\n                token = tokenIndex < tokens.length ? tokens[tokenIndex] : null;\n\n                // pop stack\n                elseStack = elseStack.prev;\n                break;\n\n            case 'MatchGraph':\n                state = state.match;\n                break;\n\n            case 'If':\n                // IMPORTANT: else stack push must go first,\n                // since it stores the state of thenStack before changes\n                if (state.else !== MISMATCH) {\n                    pushElseStack(state.else);\n                }\n\n                if (state.then !== MATCH) {\n                    pushThenStack(state.then);\n                }\n\n                state = state.match;\n                break;\n\n            case 'MatchOnce':\n                state = {\n                    type: 'MatchOnceBuffer',\n                    syntax: state,\n                    index: 0,\n                    mask: 0\n                };\n                break;\n\n            case 'MatchOnceBuffer':\n                var terms = state.syntax.terms;\n\n                if (state.index === terms.length) {\n                    // no matches at all or it's required all terms to be matched\n                    if (state.mask === 0 || state.syntax.all) {\n                        state = MISMATCH;\n                        break;\n                    }\n\n                    // a partial match is ok\n                    state = MATCH;\n                    break;\n                }\n\n                // all terms are matched\n                if (state.mask === (1 << terms.length) - 1) {\n                    state = MATCH;\n                    break;\n                }\n\n                for (; state.index < terms.length; state.index++) {\n                    var matchFlag = 1 << state.index;\n\n                    if ((state.mask & matchFlag) === 0) {\n                        // IMPORTANT: else stack push must go first,\n                        // since it stores the state of thenStack before changes\n                        pushElseStack(state);\n                        pushThenStack({\n                            type: 'AddMatchOnce',\n                            syntax: state.syntax,\n                            mask: state.mask | matchFlag\n                        });\n\n                        // match\n                        state = terms[state.index++];\n                        break;\n                    }\n                }\n                break;\n\n            case 'AddMatchOnce':\n                state = {\n                    type: 'MatchOnceBuffer',\n                    syntax: state.syntax,\n                    index: 0,\n                    mask: state.mask\n                };\n                break;\n\n            case 'Enum':\n                if (token !== null) {\n                    var name = token.value.toLowerCase();\n\n                    // drop \\0 and \\9 hack from keyword name\n                    if (name.indexOf('\\\\') !== -1) {\n                        name = name.replace(/\\\\[09].*$/, '');\n                    }\n\n                    if (hasOwnProperty.call(state.map, name)) {\n                        state = state.map[name];\n                        break;\n                    }\n                }\n\n                state = MISMATCH;\n                break;\n\n            case 'Generic':\n                var opts = syntaxStack !== null ? syntaxStack.opts : null;\n                var lastTokenIndex = tokenIndex + Math.floor(state.fn(token, getNextToken, opts));\n\n                if (!isNaN(lastTokenIndex) && lastTokenIndex > tokenIndex) {\n                    while (tokenIndex < lastTokenIndex) {\n                        addTokenToMatch();\n                    }\n\n                    state = MATCH;\n                } else {\n                    state = MISMATCH;\n                }\n\n                break;\n\n            case 'Type':\n            case 'Property':\n                var syntaxDict = state.type === 'Type' ? 'types' : 'properties';\n                var dictSyntax = hasOwnProperty.call(syntaxes, syntaxDict) ? syntaxes[syntaxDict][state.name] : null;\n\n                if (!dictSyntax || !dictSyntax.match) {\n                    throw new Error(\n                        'Bad syntax reference: ' +\n                        (state.type === 'Type'\n                            ? '<' + state.name + '>'\n                            : '<\\'' + state.name + '\\'>')\n                    );\n                }\n\n                // stash a syntax for types with low priority\n                if (syntaxStash !== false && token !== null && state.type === 'Type') {\n                    var lowPriorityMatching =\n                        // https://drafts.csswg.org/css-values-4/#custom-idents\n                        // When parsing positionally-ambiguous keywords in a property value, a <custom-ident> production\n                        // can only claim the keyword if no other unfulfilled production can claim it.\n                        (state.name === 'custom-ident' && token.type === TYPE.Ident) ||\n\n                        // https://drafts.csswg.org/css-values-4/#lengths\n                        // ... if a `0` could be parsed as either a <number> or a <length> in a property (such as line-height),\n                        // it must parse as a <number>\n                        (state.name === 'length' && token.value === '0');\n\n                    if (lowPriorityMatching) {\n                        if (syntaxStash === null) {\n                            syntaxStash = stateSnapshotFromSyntax(state, elseStack);\n                        }\n\n                        state = MISMATCH;\n                        break;\n                    }\n                }\n\n                openSyntax();\n                state = dictSyntax.match;\n                break;\n\n            case 'Keyword':\n                var name = state.name;\n\n                if (token !== null) {\n                    var keywordName = token.value;\n\n                    // drop \\0 and \\9 hack from keyword name\n                    if (keywordName.indexOf('\\\\') !== -1) {\n                        keywordName = keywordName.replace(/\\\\[09].*$/, '');\n                    }\n\n                    if (areStringsEqualCaseInsensitive(keywordName, name)) {\n                        addTokenToMatch();\n                        state = MATCH;\n                        break;\n                    }\n                }\n\n                state = MISMATCH;\n                break;\n\n            case 'AtKeyword':\n            case 'Function':\n                if (token !== null && areStringsEqualCaseInsensitive(token.value, state.name)) {\n                    addTokenToMatch();\n                    state = MATCH;\n                    break;\n                }\n\n                state = MISMATCH;\n                break;\n\n            case 'Token':\n                if (token !== null && token.value === state.value) {\n                    addTokenToMatch();\n                    state = MATCH;\n                    break;\n                }\n\n                state = MISMATCH;\n                break;\n\n            case 'Comma':\n                if (token !== null && token.type === TYPE.Comma) {\n                    if (isCommaContextStart(matchStack.token)) {\n                        state = MISMATCH;\n                    } else {\n                        addTokenToMatch();\n                        state = isCommaContextEnd(token) ? MISMATCH : MATCH;\n                    }\n                } else {\n                    state = isCommaContextStart(matchStack.token) || isCommaContextEnd(token) ? MATCH : MISMATCH;\n                }\n\n                break;\n\n            case 'String':\n                var string = '';\n\n                for (var lastTokenIndex = tokenIndex; lastTokenIndex < tokens.length && string.length < state.value.length; lastTokenIndex++) {\n                    string += tokens[lastTokenIndex].value;\n                }\n\n                if (areStringsEqualCaseInsensitive(string, state.value)) {\n                    while (tokenIndex < lastTokenIndex) {\n                        addTokenToMatch();\n                    }\n\n                    state = MATCH;\n                } else {\n                    state = MISMATCH;\n                }\n\n                break;\n\n            default:\n                throw new Error('Unknown node type: ' + state.type);\n        }\n    }\n\n    totalIterationCount += iterationCount;\n\n    switch (exitReason) {\n        case null:\n            console.warn('[csstree-match] BREAK after ' + ITERATION_LIMIT + ' iterations');\n            exitReason = EXIT_REASON_ITERATION_LIMIT;\n            matchStack = null;\n            break;\n\n        case EXIT_REASON_MATCH:\n            while (syntaxStack !== null) {\n                closeSyntax();\n            }\n            break;\n\n        default:\n            matchStack = null;\n    }\n\n    return {\n        tokens: tokens,\n        reason: exitReason,\n        iterations: iterationCount,\n        match: matchStack,\n        longestMatch: longestMatch\n    };\n}\n\nfunction matchAsList(tokens, matchGraph, syntaxes) {\n    var matchResult = internalMatch(tokens, matchGraph, syntaxes || {});\n\n    if (matchResult.match !== null) {\n        var item = reverseList(matchResult.match).prev;\n\n        matchResult.match = [];\n\n        while (item !== null) {\n            switch (item.type) {\n                case STUB:\n                    break;\n\n                case OPEN_SYNTAX:\n                case CLOSE_SYNTAX:\n                    matchResult.match.push({\n                        type: item.type,\n                        syntax: item.syntax\n                    });\n                    break;\n\n                default:\n                    matchResult.match.push({\n                        token: item.token.value,\n                        node: item.token.node\n                    });\n                    break;\n            }\n\n            item = item.prev;\n        }\n    }\n\n    return matchResult;\n}\n\nfunction matchAsTree(tokens, matchGraph, syntaxes) {\n    var matchResult = internalMatch(tokens, matchGraph, syntaxes || {});\n\n    if (matchResult.match === null) {\n        return matchResult;\n    }\n\n    var item = matchResult.match;\n    var host = matchResult.match = {\n        syntax: matchGraph.syntax || null,\n        match: []\n    };\n    var hostStack = [host];\n\n    // revert a list and start with 2nd item since 1st is a stub item\n    item = reverseList(item).prev;\n\n    // build a tree\n    while (item !== null) {\n        switch (item.type) {\n            case OPEN_SYNTAX:\n                host.match.push(host = {\n                    syntax: item.syntax,\n                    match: []\n                });\n                hostStack.push(host);\n                break;\n\n            case CLOSE_SYNTAX:\n                hostStack.pop();\n                host = hostStack[hostStack.length - 1];\n                break;\n\n            default:\n                host.match.push({\n                    syntax: item.syntax || null,\n                    token: item.token.value,\n                    node: item.token.node\n                });\n        }\n\n        item = item.prev;\n    }\n\n    return matchResult;\n}\n\nmodule.exports = {\n    matchAsList: matchAsList,\n    matchAsTree: matchAsTree,\n    getTotalIterationCount: function() {\n        return totalIterationCount;\n    }\n};\n","function getTrace(node) {\n    function shouldPutToTrace(syntax) {\n        if (syntax === null) {\n            return false;\n        }\n\n        return (\n            syntax.type === 'Type' ||\n            syntax.type === 'Property' ||\n            syntax.type === 'Keyword'\n        );\n    }\n\n    function hasMatch(matchNode) {\n        if (Array.isArray(matchNode.match)) {\n            // use for-loop for better perfomance\n            for (var i = 0; i < matchNode.match.length; i++) {\n                if (hasMatch(matchNode.match[i])) {\n                    if (shouldPutToTrace(matchNode.syntax)) {\n                        result.unshift(matchNode.syntax);\n                    }\n\n                    return true;\n                }\n            }\n        } else if (matchNode.node === node) {\n            result = shouldPutToTrace(matchNode.syntax)\n                ? [matchNode.syntax]\n                : [];\n\n            return true;\n        }\n\n        return false;\n    }\n\n    var result = null;\n\n    if (this.matched !== null) {\n        hasMatch(this.matched);\n    }\n\n    return result;\n}\n\nfunction testNode(match, node, fn) {\n    var trace = getTrace.call(match, node);\n\n    if (trace === null) {\n        return false;\n    }\n\n    return trace.some(fn);\n}\n\nfunction isType(node, type) {\n    return testNode(this, node, function(matchNode) {\n        return matchNode.type === 'Type' && matchNode.name === type;\n    });\n}\n\nfunction isProperty(node, property) {\n    return testNode(this, node, function(matchNode) {\n        return matchNode.type === 'Property' && matchNode.name === property;\n    });\n}\n\nfunction isKeyword(node) {\n    return testNode(this, node, function(matchNode) {\n        return matchNode.type === 'Keyword';\n    });\n}\n\nmodule.exports = {\n    getTrace: getTrace,\n    isType: isType,\n    isProperty: isProperty,\n    isKeyword: isKeyword\n};\n","var List = require('../common/List');\n\nfunction getFirstMatchNode(matchNode) {\n    if ('node' in matchNode) {\n        return matchNode.node;\n    }\n\n    return getFirstMatchNode(matchNode.match[0]);\n}\n\nfunction getLastMatchNode(matchNode) {\n    if ('node' in matchNode) {\n        return matchNode.node;\n    }\n\n    return getLastMatchNode(matchNode.match[matchNode.match.length - 1]);\n}\n\nfunction matchFragments(lexer, ast, match, type, name) {\n    function findFragments(matchNode) {\n        if (matchNode.syntax !== null &&\n            matchNode.syntax.type === type &&\n            matchNode.syntax.name === name) {\n            var start = getFirstMatchNode(matchNode);\n            var end = getLastMatchNode(matchNode);\n\n            lexer.syntax.walk(ast, function(node, item, list) {\n                if (node === start) {\n                    var nodes = new List();\n\n                    do {\n                        nodes.appendData(item.data);\n\n                        if (item.data === end) {\n                            break;\n                        }\n\n                        item = item.next;\n                    } while (item !== null);\n\n                    fragments.push({\n                        parent: list,\n                        nodes: nodes\n                    });\n                }\n            });\n        }\n\n        if (Array.isArray(matchNode.match)) {\n            matchNode.match.forEach(findFragments);\n        }\n    }\n\n    var fragments = [];\n\n    if (match.matched !== null) {\n        findFragments(match.matched);\n    }\n\n    return fragments;\n}\n\nmodule.exports = {\n    matchFragments: matchFragments\n};\n","var List = require('../common/List');\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction isValidNumber(value) {\n    // Number.isInteger(value) && value >= 0\n    return (\n        typeof value === 'number' &&\n        isFinite(value) &&\n        Math.floor(value) === value &&\n        value >= 0\n    );\n}\n\nfunction isValidLocation(loc) {\n    return (\n        Boolean(loc) &&\n        isValidNumber(loc.offset) &&\n        isValidNumber(loc.line) &&\n        isValidNumber(loc.column)\n    );\n}\n\nfunction createNodeStructureChecker(type, fields) {\n    return function checkNode(node, warn) {\n        if (!node || node.constructor !== Object) {\n            return warn(node, 'Type of node should be an Object');\n        }\n\n        for (var key in node) {\n            var valid = true;\n\n            if (hasOwnProperty.call(node, key) === false) {\n                continue;\n            }\n\n            if (key === 'type') {\n                if (node.type !== type) {\n                    warn(node, 'Wrong node type `' + node.type + '`, expected `' + type + '`');\n                }\n            } else if (key === 'loc') {\n                if (node.loc === null) {\n                    continue;\n                } else if (node.loc && node.loc.constructor === Object) {\n                    if (typeof node.loc.source !== 'string') {\n                        key += '.source';\n                    } else if (!isValidLocation(node.loc.start)) {\n                        key += '.start';\n                    } else if (!isValidLocation(node.loc.end)) {\n                        key += '.end';\n                    } else {\n                        continue;\n                    }\n                }\n\n                valid = false;\n            } else if (fields.hasOwnProperty(key)) {\n                for (var i = 0, valid = false; !valid && i < fields[key].length; i++) {\n                    var fieldType = fields[key][i];\n\n                    switch (fieldType) {\n                        case String:\n                            valid = typeof node[key] === 'string';\n                            break;\n\n                        case Boolean:\n                            valid = typeof node[key] === 'boolean';\n                            break;\n\n                        case null:\n                            valid = node[key] === null;\n                            break;\n\n                        default:\n                            if (typeof fieldType === 'string') {\n                                valid = node[key] && node[key].type === fieldType;\n                            } else if (Array.isArray(fieldType)) {\n                                valid = node[key] instanceof List;\n                            }\n                    }\n                }\n            } else {\n                warn(node, 'Unknown field `' + key + '` for ' + type + ' node type');\n            }\n\n            if (!valid) {\n                warn(node, 'Bad value for `' + type + '.' + key + '`');\n            }\n        }\n\n        for (var key in fields) {\n            if (hasOwnProperty.call(fields, key) &&\n                hasOwnProperty.call(node, key) === false) {\n                warn(node, 'Field `' + type + '.' + key + '` is missed');\n            }\n        }\n    };\n}\n\nfunction processStructure(name, nodeType) {\n    var structure = nodeType.structure;\n    var fields = {\n        type: String,\n        loc: true\n    };\n    var docs = {\n        type: '\"' + name + '\"'\n    };\n\n    for (var key in structure) {\n        if (hasOwnProperty.call(structure, key) === false) {\n            continue;\n        }\n\n        var docsTypes = [];\n        var fieldTypes = fields[key] = Array.isArray(structure[key])\n            ? structure[key].slice()\n            : [structure[key]];\n\n        for (var i = 0; i < fieldTypes.length; i++) {\n            var fieldType = fieldTypes[i];\n            if (fieldType === String || fieldType === Boolean) {\n                docsTypes.push(fieldType.name);\n            } else if (fieldType === null) {\n                docsTypes.push('null');\n            } else if (typeof fieldType === 'string') {\n                docsTypes.push('<' + fieldType + '>');\n            } else if (Array.isArray(fieldType)) {\n                docsTypes.push('List'); // TODO: use type enum\n            } else {\n                throw new Error('Wrong value `' + fieldType + '` in `' + name + '.' + key + '` structure definition');\n            }\n        }\n\n        docs[key] = docsTypes.join(' | ');\n    }\n\n    return {\n        docs: docs,\n        check: createNodeStructureChecker(name, fields)\n    };\n}\n\nmodule.exports = {\n    getStructureFromConfig: function(config) {\n        var structure = {};\n\n        if (config.node) {\n            for (var name in config.node) {\n                if (hasOwnProperty.call(config.node, name)) {\n                    var nodeType = config.node[name];\n\n                    if (nodeType.structure) {\n                        structure[name] = processStructure(name, nodeType);\n                    } else {\n                        throw new Error('Missed `structure` field in `' + name + '` node type definition');\n                    }\n                }\n            }\n        }\n\n        return structure;\n    }\n};\n","var SyntaxReferenceError = require('./error').SyntaxReferenceError;\nvar SyntaxMatchError = require('./error').SyntaxMatchError;\nvar names = require('../utils/names');\nvar generic = require('./generic');\nvar parse = require('../definition-syntax/parse');\nvar generate = require('../definition-syntax/generate');\nvar walk = require('../definition-syntax/walk');\nvar prepareTokens = require('./prepare-tokens');\nvar buildMatchGraph = require('./match-graph').buildMatchGraph;\nvar matchAsTree = require('./match').matchAsTree;\nvar trace = require('./trace');\nvar search = require('./search');\nvar getStructureFromConfig = require('./structure').getStructureFromConfig;\nvar cssWideKeywords = buildMatchGraph('inherit | initial | unset');\nvar cssWideKeywordsWithExpression = buildMatchGraph('inherit | initial | unset | <-ms-legacy-expression>');\n\nfunction dumpMapSyntax(map, compact, syntaxAsAst) {\n    var result = {};\n\n    for (var name in map) {\n        if (map[name].syntax) {\n            result[name] = syntaxAsAst\n                ? map[name].syntax\n                : generate(map[name].syntax, { compact: compact });\n        }\n    }\n\n    return result;\n}\n\nfunction dumpAtruleMapSyntax(map, compact, syntaxAsAst) {\n    const result = {};\n\n    for (const [name, atrule] of Object.entries(map)) {\n        result[name] = {\n            prelude: atrule.prelude && (\n                syntaxAsAst\n                    ? atrule.prelude.syntax\n                    : generate(atrule.prelude.syntax, { compact })\n            ),\n            descriptors: atrule.descriptors && dumpMapSyntax(atrule.descriptors, compact, syntaxAsAst)\n        };\n    }\n\n    return result;\n}\n\nfunction valueHasVar(tokens) {\n    for (var i = 0; i < tokens.length; i++) {\n        if (tokens[i].value.toLowerCase() === 'var(') {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nfunction buildMatchResult(match, error, iterations) {\n    return {\n        matched: match,\n        iterations: iterations,\n        error: error,\n        getTrace: trace.getTrace,\n        isType: trace.isType,\n        isProperty: trace.isProperty,\n        isKeyword: trace.isKeyword\n    };\n}\n\nfunction matchSyntax(lexer, syntax, value, useCommon) {\n    var tokens = prepareTokens(value, lexer.syntax);\n    var result;\n\n    if (valueHasVar(tokens)) {\n        return buildMatchResult(null, new Error('Matching for a tree with var() is not supported'));\n    }\n\n    if (useCommon) {\n        result = matchAsTree(tokens, lexer.valueCommonSyntax, lexer);\n    }\n\n    if (!useCommon || !result.match) {\n        result = matchAsTree(tokens, syntax.match, lexer);\n        if (!result.match) {\n            return buildMatchResult(\n                null,\n                new SyntaxMatchError(result.reason, syntax.syntax, value, result),\n                result.iterations\n            );\n        }\n    }\n\n    return buildMatchResult(result.match, null, result.iterations);\n}\n\nvar Lexer = function(config, syntax, structure) {\n    this.valueCommonSyntax = cssWideKeywords;\n    this.syntax = syntax;\n    this.generic = false;\n    this.atrules = {};\n    this.properties = {};\n    this.types = {};\n    this.structure = structure || getStructureFromConfig(config);\n\n    if (config) {\n        if (config.types) {\n            for (var name in config.types) {\n                this.addType_(name, config.types[name]);\n            }\n        }\n\n        if (config.generic) {\n            this.generic = true;\n            for (var name in generic) {\n                this.addType_(name, generic[name]);\n            }\n        }\n\n        if (config.atrules) {\n            for (var name in config.atrules) {\n                this.addAtrule_(name, config.atrules[name]);\n            }\n        }\n\n        if (config.properties) {\n            for (var name in config.properties) {\n                this.addProperty_(name, config.properties[name]);\n            }\n        }\n    }\n};\n\nLexer.prototype = {\n    structure: {},\n    checkStructure: function(ast) {\n        function collectWarning(node, message) {\n            warns.push({\n                node: node,\n                message: message\n            });\n        }\n\n        var structure = this.structure;\n        var warns = [];\n\n        this.syntax.walk(ast, function(node) {\n            if (structure.hasOwnProperty(node.type)) {\n                structure[node.type].check(node, collectWarning);\n            } else {\n                collectWarning(node, 'Unknown node type `' + node.type + '`');\n            }\n        });\n\n        return warns.length ? warns : false;\n    },\n\n    createDescriptor: function(syntax, type, name, parent = null) {\n        var ref = {\n            type: type,\n            name: name\n        };\n        var descriptor = {\n            type: type,\n            name: name,\n            parent: parent,\n            syntax: null,\n            match: null\n        };\n\n        if (typeof syntax === 'function') {\n            descriptor.match = buildMatchGraph(syntax, ref);\n        } else {\n            if (typeof syntax === 'string') {\n                // lazy parsing on first access\n                Object.defineProperty(descriptor, 'syntax', {\n                    get: function() {\n                        Object.defineProperty(descriptor, 'syntax', {\n                            value: parse(syntax)\n                        });\n\n                        return descriptor.syntax;\n                    }\n                });\n            } else {\n                descriptor.syntax = syntax;\n            }\n\n            // lazy graph build on first access\n            Object.defineProperty(descriptor, 'match', {\n                get: function() {\n                    Object.defineProperty(descriptor, 'match', {\n                        value: buildMatchGraph(descriptor.syntax, ref)\n                    });\n\n                    return descriptor.match;\n                }\n            });\n        }\n\n        return descriptor;\n    },\n    addAtrule_: function(name, syntax) {\n        if (!syntax) {\n            return;\n        }\n\n        this.atrules[name] = {\n            type: 'Atrule',\n            name: name,\n            prelude: syntax.prelude ? this.createDescriptor(syntax.prelude, 'AtrulePrelude', name) : null,\n            descriptors: syntax.descriptors\n                ? Object.keys(syntax.descriptors).reduce((res, descName) => {\n                    res[descName] = this.createDescriptor(syntax.descriptors[descName], 'AtruleDescriptor', descName, name);\n                    return res;\n                }, {})\n                : null\n        };\n    },\n    addProperty_: function(name, syntax) {\n        if (!syntax) {\n            return;\n        }\n\n        this.properties[name] = this.createDescriptor(syntax, 'Property', name);\n    },\n    addType_: function(name, syntax) {\n        if (!syntax) {\n            return;\n        }\n\n        this.types[name] = this.createDescriptor(syntax, 'Type', name);\n\n        if (syntax === generic['-ms-legacy-expression']) {\n            this.valueCommonSyntax = cssWideKeywordsWithExpression;\n        }\n    },\n\n    checkAtruleName: function(atruleName) {\n        if (!this.getAtrule(atruleName)) {\n            return new SyntaxReferenceError('Unknown at-rule', '@' + atruleName);\n        }\n    },\n    checkAtrulePrelude: function(atruleName, prelude) {\n        let error = this.checkAtruleName(atruleName);\n\n        if (error) {\n            return error;\n        }\n\n        var atrule = this.getAtrule(atruleName);\n\n        if (!atrule.prelude && prelude) {\n            return new SyntaxError('At-rule `@' + atruleName + '` should not contain a prelude');\n        }\n\n        if (atrule.prelude && !prelude) {\n            return new SyntaxError('At-rule `@' + atruleName + '` should contain a prelude');\n        }\n    },\n    checkAtruleDescriptorName: function(atruleName, descriptorName) {\n        let error = this.checkAtruleName(atruleName);\n\n        if (error) {\n            return error;\n        }\n\n        var atrule = this.getAtrule(atruleName);\n        var descriptor = names.keyword(descriptorName);\n\n        if (!atrule.descriptors) {\n            return new SyntaxError('At-rule `@' + atruleName + '` has no known descriptors');\n        }\n\n        if (!atrule.descriptors[descriptor.name] &&\n            !atrule.descriptors[descriptor.basename]) {\n            return new SyntaxReferenceError('Unknown at-rule descriptor', descriptorName);\n        }\n    },\n    checkPropertyName: function(propertyName) {\n        var property = names.property(propertyName);\n\n        // don't match syntax for a custom property\n        if (property.custom) {\n            return new Error('Lexer matching doesn\\'t applicable for custom properties');\n        }\n\n        if (!this.getProperty(propertyName)) {\n            return new SyntaxReferenceError('Unknown property', propertyName);\n        }\n    },\n\n    matchAtrulePrelude: function(atruleName, prelude) {\n        var error = this.checkAtrulePrelude(atruleName, prelude);\n\n        if (error) {\n            return buildMatchResult(null, error);\n        }\n\n        if (!prelude) {\n            return buildMatchResult(null, null);\n        }\n\n        return matchSyntax(this, this.getAtrule(atruleName).prelude, prelude, false);\n    },\n    matchAtruleDescriptor: function(atruleName, descriptorName, value) {\n        var error = this.checkAtruleDescriptorName(atruleName, descriptorName);\n\n        if (error) {\n            return buildMatchResult(null, error);\n        }\n\n        var atrule = this.getAtrule(atruleName);\n        var descriptor = names.keyword(descriptorName);\n\n        return matchSyntax(this, atrule.descriptors[descriptor.name] || atrule.descriptors[descriptor.basename], value, false);\n    },\n    matchDeclaration: function(node) {\n        if (node.type !== 'Declaration') {\n            return buildMatchResult(null, new Error('Not a Declaration node'));\n        }\n\n        return this.matchProperty(node.property, node.value);\n    },\n    matchProperty: function(propertyName, value) {\n        var error = this.checkPropertyName(propertyName);\n\n        if (error) {\n            return buildMatchResult(null, error);\n        }\n\n        return matchSyntax(this, this.getProperty(propertyName), value, true);\n    },\n    matchType: function(typeName, value) {\n        var typeSyntax = this.getType(typeName);\n\n        if (!typeSyntax) {\n            return buildMatchResult(null, new SyntaxReferenceError('Unknown type', typeName));\n        }\n\n        return matchSyntax(this, typeSyntax, value, false);\n    },\n    match: function(syntax, value) {\n        if (typeof syntax !== 'string' && (!syntax || !syntax.type)) {\n            return buildMatchResult(null, new SyntaxReferenceError('Bad syntax'));\n        }\n\n        if (typeof syntax === 'string' || !syntax.match) {\n            syntax = this.createDescriptor(syntax, 'Type', 'anonymous');\n        }\n\n        return matchSyntax(this, syntax, value, false);\n    },\n\n    findValueFragments: function(propertyName, value, type, name) {\n        return search.matchFragments(this, value, this.matchProperty(propertyName, value), type, name);\n    },\n    findDeclarationValueFragments: function(declaration, type, name) {\n        return search.matchFragments(this, declaration.value, this.matchDeclaration(declaration), type, name);\n    },\n    findAllFragments: function(ast, type, name) {\n        var result = [];\n\n        this.syntax.walk(ast, {\n            visit: 'Declaration',\n            enter: function(declaration) {\n                result.push.apply(result, this.findDeclarationValueFragments(declaration, type, name));\n            }.bind(this)\n        });\n\n        return result;\n    },\n\n    getAtrule: function(atruleName, fallbackBasename = true) {\n        var atrule = names.keyword(atruleName);\n        var atruleEntry = atrule.vendor && fallbackBasename\n            ? this.atrules[atrule.name] || this.atrules[atrule.basename]\n            : this.atrules[atrule.name];\n\n        return atruleEntry || null;\n    },\n    getAtrulePrelude: function(atruleName, fallbackBasename = true) {\n        const atrule = this.getAtrule(atruleName, fallbackBasename);\n\n        return atrule && atrule.prelude || null;\n    },\n    getAtruleDescriptor: function(atruleName, name) {\n        return this.atrules.hasOwnProperty(atruleName) && this.atrules.declarators\n            ? this.atrules[atruleName].declarators[name] || null\n            : null;\n    },\n    getProperty: function(propertyName, fallbackBasename = true) {\n        var property = names.property(propertyName);\n        var propertyEntry = property.vendor && fallbackBasename\n            ? this.properties[property.name] || this.properties[property.basename]\n            : this.properties[property.name];\n\n        return propertyEntry || null;\n    },\n    getType: function(name) {\n        return this.types.hasOwnProperty(name) ? this.types[name] : null;\n    },\n\n    validate: function() {\n        function validate(syntax, name, broken, descriptor) {\n            if (broken.hasOwnProperty(name)) {\n                return broken[name];\n            }\n\n            broken[name] = false;\n            if (descriptor.syntax !== null) {\n                walk(descriptor.syntax, function(node) {\n                    if (node.type !== 'Type' && node.type !== 'Property') {\n                        return;\n                    }\n\n                    var map = node.type === 'Type' ? syntax.types : syntax.properties;\n                    var brokenMap = node.type === 'Type' ? brokenTypes : brokenProperties;\n\n                    if (!map.hasOwnProperty(node.name) || validate(syntax, node.name, brokenMap, map[node.name])) {\n                        broken[name] = true;\n                    }\n                }, this);\n            }\n        }\n\n        var brokenTypes = {};\n        var brokenProperties = {};\n\n        for (var key in this.types) {\n            validate(this, key, brokenTypes, this.types[key]);\n        }\n\n        for (var key in this.properties) {\n            validate(this, key, brokenProperties, this.properties[key]);\n        }\n\n        brokenTypes = Object.keys(brokenTypes).filter(function(name) {\n            return brokenTypes[name];\n        });\n        brokenProperties = Object.keys(brokenProperties).filter(function(name) {\n            return brokenProperties[name];\n        });\n\n        if (brokenTypes.length || brokenProperties.length) {\n            return {\n                types: brokenTypes,\n                properties: brokenProperties\n            };\n        }\n\n        return null;\n    },\n    dump: function(syntaxAsAst, pretty) {\n        return {\n            generic: this.generic,\n            types: dumpMapSyntax(this.types, !pretty, syntaxAsAst),\n            properties: dumpMapSyntax(this.properties, !pretty, syntaxAsAst),\n            atrules: dumpAtruleMapSyntax(this.atrules, !pretty, syntaxAsAst)\n        };\n    },\n    toString: function() {\n        return JSON.stringify(this.dump());\n    }\n};\n\nmodule.exports = Lexer;\n","module.exports = {\n    SyntaxError: require('./SyntaxError'),\n    parse: require('./parse'),\n    generate: require('./generate'),\n    walk: require('./walk')\n};\n","var adoptBuffer = require('./adopt-buffer');\nvar isBOM = require('../tokenizer').isBOM;\n\nvar N = 10;\nvar F = 12;\nvar R = 13;\n\nfunction computeLinesAndColumns(host, source) {\n    var sourceLength = source.length;\n    var lines = adoptBuffer(host.lines, sourceLength); // +1\n    var line = host.startLine;\n    var columns = adoptBuffer(host.columns, sourceLength);\n    var column = host.startColumn;\n    var startOffset = source.length > 0 ? isBOM(source.charCodeAt(0)) : 0;\n\n    for (var i = startOffset; i < sourceLength; i++) { // -1\n        var code = source.charCodeAt(i);\n\n        lines[i] = line;\n        columns[i] = column++;\n\n        if (code === N || code === R || code === F) {\n            if (code === R && i + 1 < sourceLength && source.charCodeAt(i + 1) === N) {\n                i++;\n                lines[i] = line;\n                columns[i] = column;\n            }\n\n            line++;\n            column = 1;\n        }\n    }\n\n    lines[i] = line;\n    columns[i] = column;\n\n    host.lines = lines;\n    host.columns = columns;\n}\n\nvar OffsetToLocation = function() {\n    this.lines = null;\n    this.columns = null;\n    this.linesAndColumnsComputed = false;\n};\n\nOffsetToLocation.prototype = {\n    setSource: function(source, startOffset, startLine, startColumn) {\n        this.source = source;\n        this.startOffset = typeof startOffset === 'undefined' ? 0 : startOffset;\n        this.startLine = typeof startLine === 'undefined' ? 1 : startLine;\n        this.startColumn = typeof startColumn === 'undefined' ? 1 : startColumn;\n        this.linesAndColumnsComputed = false;\n    },\n\n    ensureLinesAndColumnsComputed: function() {\n        if (!this.linesAndColumnsComputed) {\n            computeLinesAndColumns(this, this.source);\n            this.linesAndColumnsComputed = true;\n        }\n    },\n    getLocation: function(offset, filename) {\n        this.ensureLinesAndColumnsComputed();\n\n        return {\n            source: filename,\n            offset: this.startOffset + offset,\n            line: this.lines[offset],\n            column: this.columns[offset]\n        };\n    },\n    getLocationRange: function(start, end, filename) {\n        this.ensureLinesAndColumnsComputed();\n\n        return {\n            source: filename,\n            start: {\n                offset: this.startOffset + start,\n                line: this.lines[start],\n                column: this.columns[start]\n            },\n            end: {\n                offset: this.startOffset + end,\n                line: this.lines[end],\n                column: this.columns[end]\n            }\n        };\n    }\n};\n\nmodule.exports = OffsetToLocation;\n","var TYPE = require('../tokenizer').TYPE;\nvar WHITESPACE = TYPE.WhiteSpace;\nvar COMMENT = TYPE.Comment;\n\nmodule.exports = function readSequence(recognizer) {\n    var children = this.createList();\n    var child = null;\n    var context = {\n        recognizer: recognizer,\n        space: null,\n        ignoreWS: false,\n        ignoreWSAfter: false\n    };\n\n    this.scanner.skipSC();\n\n    while (!this.scanner.eof) {\n        switch (this.scanner.tokenType) {\n            case COMMENT:\n                this.scanner.next();\n                continue;\n\n            case WHITESPACE:\n                if (context.ignoreWS) {\n                    this.scanner.next();\n                } else {\n                    context.space = this.WhiteSpace();\n                }\n                continue;\n        }\n\n        child = recognizer.getNode.call(this, context);\n\n        if (child === undefined) {\n            break;\n        }\n\n        if (context.space !== null) {\n            children.push(context.space);\n            context.space = null;\n        }\n\n        children.push(child);\n\n        if (context.ignoreWSAfter) {\n            context.ignoreWSAfter = false;\n            context.ignoreWS = true;\n        } else {\n            context.ignoreWS = false;\n        }\n    }\n\n    return children;\n};\n","var OffsetToLocation = require('../common/OffsetToLocation');\nvar SyntaxError = require('../common/SyntaxError');\nvar TokenStream = require('../common/TokenStream');\nvar List = require('../common/List');\nvar tokenize = require('../tokenizer');\nvar constants = require('../tokenizer/const');\nvar { findWhiteSpaceStart, cmpStr } = require('../tokenizer/utils');\nvar sequence = require('./sequence');\nvar noop = function() {};\n\nvar TYPE = constants.TYPE;\nvar NAME = constants.NAME;\nvar WHITESPACE = TYPE.WhiteSpace;\nvar COMMENT = TYPE.Comment;\nvar IDENT = TYPE.Ident;\nvar FUNCTION = TYPE.Function;\nvar URL = TYPE.Url;\nvar HASH = TYPE.Hash;\nvar PERCENTAGE = TYPE.Percentage;\nvar NUMBER = TYPE.Number;\nvar NUMBERSIGN = 0x0023; // U+0023 NUMBER SIGN (#)\nvar NULL = 0;\n\nfunction createParseContext(name) {\n    return function() {\n        return this[name]();\n    };\n}\n\nfunction processConfig(config) {\n    var parserConfig = {\n        context: {},\n        scope: {},\n        atrule: {},\n        pseudo: {}\n    };\n\n    if (config.parseContext) {\n        for (var name in config.parseContext) {\n            switch (typeof config.parseContext[name]) {\n                case 'function':\n                    parserConfig.context[name] = config.parseContext[name];\n                    break;\n\n                case 'string':\n                    parserConfig.context[name] = createParseContext(config.parseContext[name]);\n                    break;\n            }\n        }\n    }\n\n    if (config.scope) {\n        for (var name in config.scope) {\n            parserConfig.scope[name] = config.scope[name];\n        }\n    }\n\n    if (config.atrule) {\n        for (var name in config.atrule) {\n            var atrule = config.atrule[name];\n\n            if (atrule.parse) {\n                parserConfig.atrule[name] = atrule.parse;\n            }\n        }\n    }\n\n    if (config.pseudo) {\n        for (var name in config.pseudo) {\n            var pseudo = config.pseudo[name];\n\n            if (pseudo.parse) {\n                parserConfig.pseudo[name] = pseudo.parse;\n            }\n        }\n    }\n\n    if (config.node) {\n        for (var name in config.node) {\n            parserConfig[name] = config.node[name].parse;\n        }\n    }\n\n    return parserConfig;\n}\n\nmodule.exports = function createParser(config) {\n    var parser = {\n        scanner: new TokenStream(),\n        locationMap: new OffsetToLocation(),\n\n        filename: '<unknown>',\n        needPositions: false,\n        onParseError: noop,\n        onParseErrorThrow: false,\n        parseAtrulePrelude: true,\n        parseRulePrelude: true,\n        parseValue: true,\n        parseCustomProperty: false,\n\n        readSequence: sequence,\n\n        createList: function() {\n            return new List();\n        },\n        createSingleNodeList: function(node) {\n            return new List().appendData(node);\n        },\n        getFirstListNode: function(list) {\n            return list && list.first();\n        },\n        getLastListNode: function(list) {\n            return list.last();\n        },\n\n        parseWithFallback: function(consumer, fallback) {\n            var startToken = this.scanner.tokenIndex;\n\n            try {\n                return consumer.call(this);\n            } catch (e) {\n                if (this.onParseErrorThrow) {\n                    throw e;\n                }\n\n                var fallbackNode = fallback.call(this, startToken);\n\n                this.onParseErrorThrow = true;\n                this.onParseError(e, fallbackNode);\n                this.onParseErrorThrow = false;\n\n                return fallbackNode;\n            }\n        },\n\n        lookupNonWSType: function(offset) {\n            do {\n                var type = this.scanner.lookupType(offset++);\n                if (type !== WHITESPACE) {\n                    return type;\n                }\n            } while (type !== NULL);\n\n            return NULL;\n        },\n\n        eat: function(tokenType) {\n            if (this.scanner.tokenType !== tokenType) {\n                var offset = this.scanner.tokenStart;\n                var message = NAME[tokenType] + ' is expected';\n\n                // tweak message and offset\n                switch (tokenType) {\n                    case IDENT:\n                        // when identifier is expected but there is a function or url\n                        if (this.scanner.tokenType === FUNCTION || this.scanner.tokenType === URL) {\n                            offset = this.scanner.tokenEnd - 1;\n                            message = 'Identifier is expected but function found';\n                        } else {\n                            message = 'Identifier is expected';\n                        }\n                        break;\n\n                    case HASH:\n                        if (this.scanner.isDelim(NUMBERSIGN)) {\n                            this.scanner.next();\n                            offset++;\n                            message = 'Name is expected';\n                        }\n                        break;\n\n                    case PERCENTAGE:\n                        if (this.scanner.tokenType === NUMBER) {\n                            offset = this.scanner.tokenEnd;\n                            message = 'Percent sign is expected';\n                        }\n                        break;\n\n                    default:\n                        // when test type is part of another token show error for current position + 1\n                        // e.g. eat(HYPHENMINUS) will fail on \"-foo\", but pointing on \"-\" is odd\n                        if (this.scanner.source.charCodeAt(this.scanner.tokenStart) === tokenType) {\n                            offset = offset + 1;\n                        }\n                }\n\n                this.error(message, offset);\n            }\n\n            this.scanner.next();\n        },\n\n        consume: function(tokenType) {\n            var value = this.scanner.getTokenValue();\n\n            this.eat(tokenType);\n\n            return value;\n        },\n        consumeFunctionName: function() {\n            var name = this.scanner.source.substring(this.scanner.tokenStart, this.scanner.tokenEnd - 1);\n\n            this.eat(FUNCTION);\n\n            return name;\n        },\n\n        getLocation: function(start, end) {\n            if (this.needPositions) {\n                return this.locationMap.getLocationRange(\n                    start,\n                    end,\n                    this.filename\n                );\n            }\n\n            return null;\n        },\n        getLocationFromList: function(list) {\n            if (this.needPositions) {\n                var head = this.getFirstListNode(list);\n                var tail = this.getLastListNode(list);\n                return this.locationMap.getLocationRange(\n                    head !== null ? head.loc.start.offset - this.locationMap.startOffset : this.scanner.tokenStart,\n                    tail !== null ? tail.loc.end.offset - this.locationMap.startOffset : this.scanner.tokenStart,\n                    this.filename\n                );\n            }\n\n            return null;\n        },\n\n        error: function(message, offset) {\n            var location = typeof offset !== 'undefined' && offset < this.scanner.source.length\n                ? this.locationMap.getLocation(offset)\n                : this.scanner.eof\n                    ? this.locationMap.getLocation(findWhiteSpaceStart(this.scanner.source, this.scanner.source.length - 1))\n                    : this.locationMap.getLocation(this.scanner.tokenStart);\n\n            throw new SyntaxError(\n                message || 'Unexpected input',\n                this.scanner.source,\n                location.offset,\n                location.line,\n                location.column\n            );\n        }\n    };\n\n    config = processConfig(config || {});\n    for (var key in config) {\n        parser[key] = config[key];\n    }\n\n    return function(source, options) {\n        options = options || {};\n\n        var context = options.context || 'default';\n        var onComment = options.onComment;\n        var ast;\n\n        tokenize(source, parser.scanner);\n        parser.locationMap.setSource(\n            source,\n            options.offset,\n            options.line,\n            options.column\n        );\n\n        parser.filename = options.filename || '<unknown>';\n        parser.needPositions = Boolean(options.positions);\n        parser.onParseError = typeof options.onParseError === 'function' ? options.onParseError : noop;\n        parser.onParseErrorThrow = false;\n        parser.parseAtrulePrelude = 'parseAtrulePrelude' in options ? Boolean(options.parseAtrulePrelude) : true;\n        parser.parseRulePrelude = 'parseRulePrelude' in options ? Boolean(options.parseRulePrelude) : true;\n        parser.parseValue = 'parseValue' in options ? Boolean(options.parseValue) : true;\n        parser.parseCustomProperty = 'parseCustomProperty' in options ? Boolean(options.parseCustomProperty) : false;\n\n        if (!parser.context.hasOwnProperty(context)) {\n            throw new Error('Unknown context `' + context + '`');\n        }\n\n        if (typeof onComment === 'function') {\n            parser.scanner.forEachToken((type, start, end) => {\n                if (type === COMMENT) {\n                    const loc = parser.getLocation(start, end);\n                    const value = cmpStr(source, end - 2, end, '*/')\n                        ? source.slice(start + 2, end - 2)\n                        : source.slice(start + 2, end);\n\n                    onComment(value, loc);\n                }\n            });\n        }\n\n        ast = parser.context[context].call(parser, options);\n\n        if (!parser.scanner.eof) {\n            parser.error();\n        }\n\n        return ast;\n    };\n};\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\nvar intToCharMap = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'.split('');\n\n/**\n * Encode an integer in the range of 0 to 63 to a single base 64 digit.\n */\nexports.encode = function (number) {\n  if (0 <= number && number < intToCharMap.length) {\n    return intToCharMap[number];\n  }\n  throw new TypeError(\"Must be between 0 and 63: \" + number);\n};\n\n/**\n * Decode a single base 64 character code digit to an integer. Returns -1 on\n * failure.\n */\nexports.decode = function (charCode) {\n  var bigA = 65;     // 'A'\n  var bigZ = 90;     // 'Z'\n\n  var littleA = 97;  // 'a'\n  var littleZ = 122; // 'z'\n\n  var zero = 48;     // '0'\n  var nine = 57;     // '9'\n\n  var plus = 43;     // '+'\n  var slash = 47;    // '/'\n\n  var littleOffset = 26;\n  var numberOffset = 52;\n\n  // 0 - 25: ABCDEFGHIJKLMNOPQRSTUVWXYZ\n  if (bigA <= charCode && charCode <= bigZ) {\n    return (charCode - bigA);\n  }\n\n  // 26 - 51: abcdefghijklmnopqrstuvwxyz\n  if (littleA <= charCode && charCode <= littleZ) {\n    return (charCode - littleA + littleOffset);\n  }\n\n  // 52 - 61: 0123456789\n  if (zero <= charCode && charCode <= nine) {\n    return (charCode - zero + numberOffset);\n  }\n\n  // 62: +\n  if (charCode == plus) {\n    return 62;\n  }\n\n  // 63: /\n  if (charCode == slash) {\n    return 63;\n  }\n\n  // Invalid base64 digit.\n  return -1;\n};\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n *\n * Based on the Base 64 VLQ implementation in Closure Compiler:\n * https://code.google.com/p/closure-compiler/source/browse/trunk/src/com/google/debugging/sourcemap/Base64VLQ.java\n *\n * Copyright 2011 The Closure Compiler Authors. All rights reserved.\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are\n * met:\n *\n *  * Redistributions of source code must retain the above copyright\n *    notice, this list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above\n *    copyright notice, this list of conditions and the following\n *    disclaimer in the documentation and/or other materials provided\n *    with the distribution.\n *  * Neither the name of Google Inc. nor the names of its\n *    contributors may be used to endorse or promote products derived\n *    from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nvar base64 = require('./base64');\n\n// A single base 64 digit can contain 6 bits of data. For the base 64 variable\n// length quantities we use in the source map spec, the first bit is the sign,\n// the next four bits are the actual value, and the 6th bit is the\n// continuation bit. The continuation bit tells us whether there are more\n// digits in this value following this digit.\n//\n//   Continuation\n//   |    Sign\n//   |    |\n//   V    V\n//   101011\n\nvar VLQ_BASE_SHIFT = 5;\n\n// binary: 100000\nvar VLQ_BASE = 1 << VLQ_BASE_SHIFT;\n\n// binary: 011111\nvar VLQ_BASE_MASK = VLQ_BASE - 1;\n\n// binary: 100000\nvar VLQ_CONTINUATION_BIT = VLQ_BASE;\n\n/**\n * Converts from a two-complement value to a value where the sign bit is\n * placed in the least significant bit.  For example, as decimals:\n *   1 becomes 2 (10 binary), -1 becomes 3 (11 binary)\n *   2 becomes 4 (100 binary), -2 becomes 5 (101 binary)\n */\nfunction toVLQSigned(aValue) {\n  return aValue < 0\n    ? ((-aValue) << 1) + 1\n    : (aValue << 1) + 0;\n}\n\n/**\n * Converts to a two-complement value from a value where the sign bit is\n * placed in the least significant bit.  For example, as decimals:\n *   2 (10 binary) becomes 1, 3 (11 binary) becomes -1\n *   4 (100 binary) becomes 2, 5 (101 binary) becomes -2\n */\nfunction fromVLQSigned(aValue) {\n  var isNegative = (aValue & 1) === 1;\n  var shifted = aValue >> 1;\n  return isNegative\n    ? -shifted\n    : shifted;\n}\n\n/**\n * Returns the base 64 VLQ encoded value.\n */\nexports.encode = function base64VLQ_encode(aValue) {\n  var encoded = \"\";\n  var digit;\n\n  var vlq = toVLQSigned(aValue);\n\n  do {\n    digit = vlq & VLQ_BASE_MASK;\n    vlq >>>= VLQ_BASE_SHIFT;\n    if (vlq > 0) {\n      // There are still more digits in this value, so we must make sure the\n      // continuation bit is marked.\n      digit |= VLQ_CONTINUATION_BIT;\n    }\n    encoded += base64.encode(digit);\n  } while (vlq > 0);\n\n  return encoded;\n};\n\n/**\n * Decodes the next base 64 VLQ value from the given string and returns the\n * value and the rest of the string via the out parameter.\n */\nexports.decode = function base64VLQ_decode(aStr, aIndex, aOutParam) {\n  var strLen = aStr.length;\n  var result = 0;\n  var shift = 0;\n  var continuation, digit;\n\n  do {\n    if (aIndex >= strLen) {\n      throw new Error(\"Expected more digits in base 64 VLQ value.\");\n    }\n\n    digit = base64.decode(aStr.charCodeAt(aIndex++));\n    if (digit === -1) {\n      throw new Error(\"Invalid base64 digit: \" + aStr.charAt(aIndex - 1));\n    }\n\n    continuation = !!(digit & VLQ_CONTINUATION_BIT);\n    digit &= VLQ_BASE_MASK;\n    result = result + (digit << shift);\n    shift += VLQ_BASE_SHIFT;\n  } while (continuation);\n\n  aOutParam.value = fromVLQSigned(result);\n  aOutParam.rest = aIndex;\n};\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\n/**\n * This is a helper function for getting values from parameter/options\n * objects.\n *\n * @param args The object we are extracting values from\n * @param name The name of the property we are getting.\n * @param defaultValue An optional value to return if the property is missing\n * from the object. If this is not specified and the property is missing, an\n * error will be thrown.\n */\nfunction getArg(aArgs, aName, aDefaultValue) {\n  if (aName in aArgs) {\n    return aArgs[aName];\n  } else if (arguments.length === 3) {\n    return aDefaultValue;\n  } else {\n    throw new Error('\"' + aName + '\" is a required argument.');\n  }\n}\nexports.getArg = getArg;\n\nvar urlRegexp = /^(?:([\\w+\\-.]+):)?\\/\\/(?:(\\w+:\\w+)@)?([\\w.-]*)(?::(\\d+))?(.*)$/;\nvar dataUrlRegexp = /^data:.+\\,.+$/;\n\nfunction urlParse(aUrl) {\n  var match = aUrl.match(urlRegexp);\n  if (!match) {\n    return null;\n  }\n  return {\n    scheme: match[1],\n    auth: match[2],\n    host: match[3],\n    port: match[4],\n    path: match[5]\n  };\n}\nexports.urlParse = urlParse;\n\nfunction urlGenerate(aParsedUrl) {\n  var url = '';\n  if (aParsedUrl.scheme) {\n    url += aParsedUrl.scheme + ':';\n  }\n  url += '//';\n  if (aParsedUrl.auth) {\n    url += aParsedUrl.auth + '@';\n  }\n  if (aParsedUrl.host) {\n    url += aParsedUrl.host;\n  }\n  if (aParsedUrl.port) {\n    url += \":\" + aParsedUrl.port\n  }\n  if (aParsedUrl.path) {\n    url += aParsedUrl.path;\n  }\n  return url;\n}\nexports.urlGenerate = urlGenerate;\n\n/**\n * Normalizes a path, or the path portion of a URL:\n *\n * - Replaces consecutive slashes with one slash.\n * - Removes unnecessary '.' parts.\n * - Removes unnecessary '<dir>/..' parts.\n *\n * Based on code in the Node.js 'path' core module.\n *\n * @param aPath The path or url to normalize.\n */\nfunction normalize(aPath) {\n  var path = aPath;\n  var url = urlParse(aPath);\n  if (url) {\n    if (!url.path) {\n      return aPath;\n    }\n    path = url.path;\n  }\n  var isAbsolute = exports.isAbsolute(path);\n\n  var parts = path.split(/\\/+/);\n  for (var part, up = 0, i = parts.length - 1; i >= 0; i--) {\n    part = parts[i];\n    if (part === '.') {\n      parts.splice(i, 1);\n    } else if (part === '..') {\n      up++;\n    } else if (up > 0) {\n      if (part === '') {\n        // The first part is blank if the path is absolute. Trying to go\n        // above the root is a no-op. Therefore we can remove all '..' parts\n        // directly after the root.\n        parts.splice(i + 1, up);\n        up = 0;\n      } else {\n        parts.splice(i, 2);\n        up--;\n      }\n    }\n  }\n  path = parts.join('/');\n\n  if (path === '') {\n    path = isAbsolute ? '/' : '.';\n  }\n\n  if (url) {\n    url.path = path;\n    return urlGenerate(url);\n  }\n  return path;\n}\nexports.normalize = normalize;\n\n/**\n * Joins two paths/URLs.\n *\n * @param aRoot The root path or URL.\n * @param aPath The path or URL to be joined with the root.\n *\n * - If aPath is a URL or a data URI, aPath is returned, unless aPath is a\n *   scheme-relative URL: Then the scheme of aRoot, if any, is prepended\n *   first.\n * - Otherwise aPath is a path. If aRoot is a URL, then its path portion\n *   is updated with the result and aRoot is returned. Otherwise the result\n *   is returned.\n *   - If aPath is absolute, the result is aPath.\n *   - Otherwise the two paths are joined with a slash.\n * - Joining for example 'http://' and 'www.example.com' is also supported.\n */\nfunction join(aRoot, aPath) {\n  if (aRoot === \"\") {\n    aRoot = \".\";\n  }\n  if (aPath === \"\") {\n    aPath = \".\";\n  }\n  var aPathUrl = urlParse(aPath);\n  var aRootUrl = urlParse(aRoot);\n  if (aRootUrl) {\n    aRoot = aRootUrl.path || '/';\n  }\n\n  // `join(foo, '//www.example.org')`\n  if (aPathUrl && !aPathUrl.scheme) {\n    if (aRootUrl) {\n      aPathUrl.scheme = aRootUrl.scheme;\n    }\n    return urlGenerate(aPathUrl);\n  }\n\n  if (aPathUrl || aPath.match(dataUrlRegexp)) {\n    return aPath;\n  }\n\n  // `join('http://', 'www.example.com')`\n  if (aRootUrl && !aRootUrl.host && !aRootUrl.path) {\n    aRootUrl.host = aPath;\n    return urlGenerate(aRootUrl);\n  }\n\n  var joined = aPath.charAt(0) === '/'\n    ? aPath\n    : normalize(aRoot.replace(/\\/+$/, '') + '/' + aPath);\n\n  if (aRootUrl) {\n    aRootUrl.path = joined;\n    return urlGenerate(aRootUrl);\n  }\n  return joined;\n}\nexports.join = join;\n\nexports.isAbsolute = function (aPath) {\n  return aPath.charAt(0) === '/' || urlRegexp.test(aPath);\n};\n\n/**\n * Make a path relative to a URL or another path.\n *\n * @param aRoot The root path or URL.\n * @param aPath The path or URL to be made relative to aRoot.\n */\nfunction relative(aRoot, aPath) {\n  if (aRoot === \"\") {\n    aRoot = \".\";\n  }\n\n  aRoot = aRoot.replace(/\\/$/, '');\n\n  // It is possible for the path to be above the root. In this case, simply\n  // checking whether the root is a prefix of the path won't work. Instead, we\n  // need to remove components from the root one by one, until either we find\n  // a prefix that fits, or we run out of components to remove.\n  var level = 0;\n  while (aPath.indexOf(aRoot + '/') !== 0) {\n    var index = aRoot.lastIndexOf(\"/\");\n    if (index < 0) {\n      return aPath;\n    }\n\n    // If the only part of the root that is left is the scheme (i.e. http://,\n    // file:///, etc.), one or more slashes (/), or simply nothing at all, we\n    // have exhausted all components, so the path is not relative to the root.\n    aRoot = aRoot.slice(0, index);\n    if (aRoot.match(/^([^\\/]+:\\/)?\\/*$/)) {\n      return aPath;\n    }\n\n    ++level;\n  }\n\n  // Make sure we add a \"../\" for each component we removed from the root.\n  return Array(level + 1).join(\"../\") + aPath.substr(aRoot.length + 1);\n}\nexports.relative = relative;\n\nvar supportsNullProto = (function () {\n  var obj = Object.create(null);\n  return !('__proto__' in obj);\n}());\n\nfunction identity (s) {\n  return s;\n}\n\n/**\n * Because behavior goes wacky when you set `__proto__` on objects, we\n * have to prefix all the strings in our set with an arbitrary character.\n *\n * See https://github.com/mozilla/source-map/pull/31 and\n * https://github.com/mozilla/source-map/issues/30\n *\n * @param String aStr\n */\nfunction toSetString(aStr) {\n  if (isProtoString(aStr)) {\n    return '$' + aStr;\n  }\n\n  return aStr;\n}\nexports.toSetString = supportsNullProto ? identity : toSetString;\n\nfunction fromSetString(aStr) {\n  if (isProtoString(aStr)) {\n    return aStr.slice(1);\n  }\n\n  return aStr;\n}\nexports.fromSetString = supportsNullProto ? identity : fromSetString;\n\nfunction isProtoString(s) {\n  if (!s) {\n    return false;\n  }\n\n  var length = s.length;\n\n  if (length < 9 /* \"__proto__\".length */) {\n    return false;\n  }\n\n  if (s.charCodeAt(length - 1) !== 95  /* '_' */ ||\n      s.charCodeAt(length - 2) !== 95  /* '_' */ ||\n      s.charCodeAt(length - 3) !== 111 /* 'o' */ ||\n      s.charCodeAt(length - 4) !== 116 /* 't' */ ||\n      s.charCodeAt(length - 5) !== 111 /* 'o' */ ||\n      s.charCodeAt(length - 6) !== 114 /* 'r' */ ||\n      s.charCodeAt(length - 7) !== 112 /* 'p' */ ||\n      s.charCodeAt(length - 8) !== 95  /* '_' */ ||\n      s.charCodeAt(length - 9) !== 95  /* '_' */) {\n    return false;\n  }\n\n  for (var i = length - 10; i >= 0; i--) {\n    if (s.charCodeAt(i) !== 36 /* '$' */) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Comparator between two mappings where the original positions are compared.\n *\n * Optionally pass in `true` as `onlyCompareGenerated` to consider two\n * mappings with the same original source/line/column, but different generated\n * line and column the same. Useful when searching for a mapping with a\n * stubbed out mapping.\n */\nfunction compareByOriginalPositions(mappingA, mappingB, onlyCompareOriginal) {\n  var cmp = strcmp(mappingA.source, mappingB.source);\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalLine - mappingB.originalLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalColumn - mappingB.originalColumn;\n  if (cmp !== 0 || onlyCompareOriginal) {\n    return cmp;\n  }\n\n  cmp = mappingA.generatedColumn - mappingB.generatedColumn;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.generatedLine - mappingB.generatedLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  return strcmp(mappingA.name, mappingB.name);\n}\nexports.compareByOriginalPositions = compareByOriginalPositions;\n\n/**\n * Comparator between two mappings with deflated source and name indices where\n * the generated positions are compared.\n *\n * Optionally pass in `true` as `onlyCompareGenerated` to consider two\n * mappings with the same generated line and column, but different\n * source/name/original line and column the same. Useful when searching for a\n * mapping with a stubbed out mapping.\n */\nfunction compareByGeneratedPositionsDeflated(mappingA, mappingB, onlyCompareGenerated) {\n  var cmp = mappingA.generatedLine - mappingB.generatedLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.generatedColumn - mappingB.generatedColumn;\n  if (cmp !== 0 || onlyCompareGenerated) {\n    return cmp;\n  }\n\n  cmp = strcmp(mappingA.source, mappingB.source);\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalLine - mappingB.originalLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalColumn - mappingB.originalColumn;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  return strcmp(mappingA.name, mappingB.name);\n}\nexports.compareByGeneratedPositionsDeflated = compareByGeneratedPositionsDeflated;\n\nfunction strcmp(aStr1, aStr2) {\n  if (aStr1 === aStr2) {\n    return 0;\n  }\n\n  if (aStr1 === null) {\n    return 1; // aStr2 !== null\n  }\n\n  if (aStr2 === null) {\n    return -1; // aStr1 !== null\n  }\n\n  if (aStr1 > aStr2) {\n    return 1;\n  }\n\n  return -1;\n}\n\n/**\n * Comparator between two mappings with inflated source and name strings where\n * the generated positions are compared.\n */\nfunction compareByGeneratedPositionsInflated(mappingA, mappingB) {\n  var cmp = mappingA.generatedLine - mappingB.generatedLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.generatedColumn - mappingB.generatedColumn;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = strcmp(mappingA.source, mappingB.source);\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalLine - mappingB.originalLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalColumn - mappingB.originalColumn;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  return strcmp(mappingA.name, mappingB.name);\n}\nexports.compareByGeneratedPositionsInflated = compareByGeneratedPositionsInflated;\n\n/**\n * Strip any JSON XSSI avoidance prefix from the string (as documented\n * in the source maps specification), and then parse the string as\n * JSON.\n */\nfunction parseSourceMapInput(str) {\n  return JSON.parse(str.replace(/^\\)]}'[^\\n]*\\n/, ''));\n}\nexports.parseSourceMapInput = parseSourceMapInput;\n\n/**\n * Compute the URL of a source given the the source root, the source's\n * URL, and the source map's URL.\n */\nfunction computeSourceURL(sourceRoot, sourceURL, sourceMapURL) {\n  sourceURL = sourceURL || '';\n\n  if (sourceRoot) {\n    // This follows what Chrome does.\n    if (sourceRoot[sourceRoot.length - 1] !== '/' && sourceURL[0] !== '/') {\n      sourceRoot += '/';\n    }\n    // The spec says:\n    //   Line 4: An optional source root, useful for relocating source\n    //   files on a server or removing repeated values in the\n    //   “sources” entry.  This value is prepended to the individual\n    //   entries in the “source” field.\n    sourceURL = sourceRoot + sourceURL;\n  }\n\n  // Historically, SourceMapConsumer did not take the sourceMapURL as\n  // a parameter.  This mode is still somewhat supported, which is why\n  // this code block is conditional.  However, it's preferable to pass\n  // the source map URL to SourceMapConsumer, so that this function\n  // can implement the source URL resolution algorithm as outlined in\n  // the spec.  This block is basically the equivalent of:\n  //    new URL(sourceURL, sourceMapURL).toString()\n  // ... except it avoids using URL, which wasn't available in the\n  // older releases of node still supported by this library.\n  //\n  // The spec says:\n  //   If the sources are not absolute URLs after prepending of the\n  //   “sourceRoot”, the sources are resolved relative to the\n  //   SourceMap (like resolving script src in a html document).\n  if (sourceMapURL) {\n    var parsed = urlParse(sourceMapURL);\n    if (!parsed) {\n      throw new Error(\"sourceMapURL could not be parsed\");\n    }\n    if (parsed.path) {\n      // Strip the last path component, but keep the \"/\".\n      var index = parsed.path.lastIndexOf('/');\n      if (index >= 0) {\n        parsed.path = parsed.path.substring(0, index + 1);\n      }\n    }\n    sourceURL = join(urlGenerate(parsed), sourceURL);\n  }\n\n  return normalize(sourceURL);\n}\nexports.computeSourceURL = computeSourceURL;\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\nvar util = require('./util');\nvar has = Object.prototype.hasOwnProperty;\nvar hasNativeMap = typeof Map !== \"undefined\";\n\n/**\n * A data structure which is a combination of an array and a set. Adding a new\n * member is O(1), testing for membership is O(1), and finding the index of an\n * element is O(1). Removing elements from the set is not supported. Only\n * strings are supported for membership.\n */\nfunction ArraySet() {\n  this._array = [];\n  this._set = hasNativeMap ? new Map() : Object.create(null);\n}\n\n/**\n * Static method for creating ArraySet instances from an existing array.\n */\nArraySet.fromArray = function ArraySet_fromArray(aArray, aAllowDuplicates) {\n  var set = new ArraySet();\n  for (var i = 0, len = aArray.length; i < len; i++) {\n    set.add(aArray[i], aAllowDuplicates);\n  }\n  return set;\n};\n\n/**\n * Return how many unique items are in this ArraySet. If duplicates have been\n * added, than those do not count towards the size.\n *\n * @returns Number\n */\nArraySet.prototype.size = function ArraySet_size() {\n  return hasNativeMap ? this._set.size : Object.getOwnPropertyNames(this._set).length;\n};\n\n/**\n * Add the given string to this set.\n *\n * @param String aStr\n */\nArraySet.prototype.add = function ArraySet_add(aStr, aAllowDuplicates) {\n  var sStr = hasNativeMap ? aStr : util.toSetString(aStr);\n  var isDuplicate = hasNativeMap ? this.has(aStr) : has.call(this._set, sStr);\n  var idx = this._array.length;\n  if (!isDuplicate || aAllowDuplicates) {\n    this._array.push(aStr);\n  }\n  if (!isDuplicate) {\n    if (hasNativeMap) {\n      this._set.set(aStr, idx);\n    } else {\n      this._set[sStr] = idx;\n    }\n  }\n};\n\n/**\n * Is the given string a member of this set?\n *\n * @param String aStr\n */\nArraySet.prototype.has = function ArraySet_has(aStr) {\n  if (hasNativeMap) {\n    return this._set.has(aStr);\n  } else {\n    var sStr = util.toSetString(aStr);\n    return has.call(this._set, sStr);\n  }\n};\n\n/**\n * What is the index of the given string in the array?\n *\n * @param String aStr\n */\nArraySet.prototype.indexOf = function ArraySet_indexOf(aStr) {\n  if (hasNativeMap) {\n    var idx = this._set.get(aStr);\n    if (idx >= 0) {\n        return idx;\n    }\n  } else {\n    var sStr = util.toSetString(aStr);\n    if (has.call(this._set, sStr)) {\n      return this._set[sStr];\n    }\n  }\n\n  throw new Error('\"' + aStr + '\" is not in the set.');\n};\n\n/**\n * What is the element at the given index?\n *\n * @param Number aIdx\n */\nArraySet.prototype.at = function ArraySet_at(aIdx) {\n  if (aIdx >= 0 && aIdx < this._array.length) {\n    return this._array[aIdx];\n  }\n  throw new Error('No element indexed by ' + aIdx);\n};\n\n/**\n * Returns the array representation of this set (which has the proper indices\n * indicated by indexOf). Note that this is a copy of the internal array used\n * for storing the members so that no one can mess with internal state.\n */\nArraySet.prototype.toArray = function ArraySet_toArray() {\n  return this._array.slice();\n};\n\nexports.ArraySet = ArraySet;\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2014 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\nvar util = require('./util');\n\n/**\n * Determine whether mappingB is after mappingA with respect to generated\n * position.\n */\nfunction generatedPositionAfter(mappingA, mappingB) {\n  // Optimized for most common case\n  var lineA = mappingA.generatedLine;\n  var lineB = mappingB.generatedLine;\n  var columnA = mappingA.generatedColumn;\n  var columnB = mappingB.generatedColumn;\n  return lineB > lineA || lineB == lineA && columnB >= columnA ||\n         util.compareByGeneratedPositionsInflated(mappingA, mappingB) <= 0;\n}\n\n/**\n * A data structure to provide a sorted view of accumulated mappings in a\n * performance conscious manner. It trades a neglibable overhead in general\n * case for a large speedup in case of mappings being added in order.\n */\nfunction MappingList() {\n  this._array = [];\n  this._sorted = true;\n  // Serves as infimum\n  this._last = {generatedLine: -1, generatedColumn: 0};\n}\n\n/**\n * Iterate through internal items. This method takes the same arguments that\n * `Array.prototype.forEach` takes.\n *\n * NOTE: The order of the mappings is NOT guaranteed.\n */\nMappingList.prototype.unsortedForEach =\n  function MappingList_forEach(aCallback, aThisArg) {\n    this._array.forEach(aCallback, aThisArg);\n  };\n\n/**\n * Add the given source mapping.\n *\n * @param Object aMapping\n */\nMappingList.prototype.add = function MappingList_add(aMapping) {\n  if (generatedPositionAfter(this._last, aMapping)) {\n    this._last = aMapping;\n    this._array.push(aMapping);\n  } else {\n    this._sorted = false;\n    this._array.push(aMapping);\n  }\n};\n\n/**\n * Returns the flat, sorted array of mappings. The mappings are sorted by\n * generated position.\n *\n * WARNING: This method returns internal data without copying, for\n * performance. The return value must NOT be mutated, and should be treated as\n * an immutable borrow. If you want to take ownership, you must make your own\n * copy.\n */\nMappingList.prototype.toArray = function MappingList_toArray() {\n  if (!this._sorted) {\n    this._array.sort(util.compareByGeneratedPositionsInflated);\n    this._sorted = true;\n  }\n  return this._array;\n};\n\nexports.MappingList = MappingList;\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\nvar base64VLQ = require('./base64-vlq');\nvar util = require('./util');\nvar ArraySet = require('./array-set').ArraySet;\nvar MappingList = require('./mapping-list').MappingList;\n\n/**\n * An instance of the SourceMapGenerator represents a source map which is\n * being built incrementally. You may pass an object with the following\n * properties:\n *\n *   - file: The filename of the generated source.\n *   - sourceRoot: A root for all relative URLs in this source map.\n */\nfunction SourceMapGenerator(aArgs) {\n  if (!aArgs) {\n    aArgs = {};\n  }\n  this._file = util.getArg(aArgs, 'file', null);\n  this._sourceRoot = util.getArg(aArgs, 'sourceRoot', null);\n  this._skipValidation = util.getArg(aArgs, 'skipValidation', false);\n  this._sources = new ArraySet();\n  this._names = new ArraySet();\n  this._mappings = new MappingList();\n  this._sourcesContents = null;\n}\n\nSourceMapGenerator.prototype._version = 3;\n\n/**\n * Creates a new SourceMapGenerator based on a SourceMapConsumer\n *\n * @param aSourceMapConsumer The SourceMap.\n */\nSourceMapGenerator.fromSourceMap =\n  function SourceMapGenerator_fromSourceMap(aSourceMapConsumer) {\n    var sourceRoot = aSourceMapConsumer.sourceRoot;\n    var generator = new SourceMapGenerator({\n      file: aSourceMapConsumer.file,\n      sourceRoot: sourceRoot\n    });\n    aSourceMapConsumer.eachMapping(function (mapping) {\n      var newMapping = {\n        generated: {\n          line: mapping.generatedLine,\n          column: mapping.generatedColumn\n        }\n      };\n\n      if (mapping.source != null) {\n        newMapping.source = mapping.source;\n        if (sourceRoot != null) {\n          newMapping.source = util.relative(sourceRoot, newMapping.source);\n        }\n\n        newMapping.original = {\n          line: mapping.originalLine,\n          column: mapping.originalColumn\n        };\n\n        if (mapping.name != null) {\n          newMapping.name = mapping.name;\n        }\n      }\n\n      generator.addMapping(newMapping);\n    });\n    aSourceMapConsumer.sources.forEach(function (sourceFile) {\n      var sourceRelative = sourceFile;\n      if (sourceRoot !== null) {\n        sourceRelative = util.relative(sourceRoot, sourceFile);\n      }\n\n      if (!generator._sources.has(sourceRelative)) {\n        generator._sources.add(sourceRelative);\n      }\n\n      var content = aSourceMapConsumer.sourceContentFor(sourceFile);\n      if (content != null) {\n        generator.setSourceContent(sourceFile, content);\n      }\n    });\n    return generator;\n  };\n\n/**\n * Add a single mapping from original source line and column to the generated\n * source's line and column for this source map being created. The mapping\n * object should have the following properties:\n *\n *   - generated: An object with the generated line and column positions.\n *   - original: An object with the original line and column positions.\n *   - source: The original source file (relative to the sourceRoot).\n *   - name: An optional original token name for this mapping.\n */\nSourceMapGenerator.prototype.addMapping =\n  function SourceMapGenerator_addMapping(aArgs) {\n    var generated = util.getArg(aArgs, 'generated');\n    var original = util.getArg(aArgs, 'original', null);\n    var source = util.getArg(aArgs, 'source', null);\n    var name = util.getArg(aArgs, 'name', null);\n\n    if (!this._skipValidation) {\n      this._validateMapping(generated, original, source, name);\n    }\n\n    if (source != null) {\n      source = String(source);\n      if (!this._sources.has(source)) {\n        this._sources.add(source);\n      }\n    }\n\n    if (name != null) {\n      name = String(name);\n      if (!this._names.has(name)) {\n        this._names.add(name);\n      }\n    }\n\n    this._mappings.add({\n      generatedLine: generated.line,\n      generatedColumn: generated.column,\n      originalLine: original != null && original.line,\n      originalColumn: original != null && original.column,\n      source: source,\n      name: name\n    });\n  };\n\n/**\n * Set the source content for a source file.\n */\nSourceMapGenerator.prototype.setSourceContent =\n  function SourceMapGenerator_setSourceContent(aSourceFile, aSourceContent) {\n    var source = aSourceFile;\n    if (this._sourceRoot != null) {\n      source = util.relative(this._sourceRoot, source);\n    }\n\n    if (aSourceContent != null) {\n      // Add the source content to the _sourcesContents map.\n      // Create a new _sourcesContents map if the property is null.\n      if (!this._sourcesContents) {\n        this._sourcesContents = Object.create(null);\n      }\n      this._sourcesContents[util.toSetString(source)] = aSourceContent;\n    } else if (this._sourcesContents) {\n      // Remove the source file from the _sourcesContents map.\n      // If the _sourcesContents map is empty, set the property to null.\n      delete this._sourcesContents[util.toSetString(source)];\n      if (Object.keys(this._sourcesContents).length === 0) {\n        this._sourcesContents = null;\n      }\n    }\n  };\n\n/**\n * Applies the mappings of a sub-source-map for a specific source file to the\n * source map being generated. Each mapping to the supplied source file is\n * rewritten using the supplied source map. Note: The resolution for the\n * resulting mappings is the minimium of this map and the supplied map.\n *\n * @param aSourceMapConsumer The source map to be applied.\n * @param aSourceFile Optional. The filename of the source file.\n *        If omitted, SourceMapConsumer's file property will be used.\n * @param aSourceMapPath Optional. The dirname of the path to the source map\n *        to be applied. If relative, it is relative to the SourceMapConsumer.\n *        This parameter is needed when the two source maps aren't in the same\n *        directory, and the source map to be applied contains relative source\n *        paths. If so, those relative source paths need to be rewritten\n *        relative to the SourceMapGenerator.\n */\nSourceMapGenerator.prototype.applySourceMap =\n  function SourceMapGenerator_applySourceMap(aSourceMapConsumer, aSourceFile, aSourceMapPath) {\n    var sourceFile = aSourceFile;\n    // If aSourceFile is omitted, we will use the file property of the SourceMap\n    if (aSourceFile == null) {\n      if (aSourceMapConsumer.file == null) {\n        throw new Error(\n          'SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, ' +\n          'or the source map\\'s \"file\" property. Both were omitted.'\n        );\n      }\n      sourceFile = aSourceMapConsumer.file;\n    }\n    var sourceRoot = this._sourceRoot;\n    // Make \"sourceFile\" relative if an absolute Url is passed.\n    if (sourceRoot != null) {\n      sourceFile = util.relative(sourceRoot, sourceFile);\n    }\n    // Applying the SourceMap can add and remove items from the sources and\n    // the names array.\n    var newSources = new ArraySet();\n    var newNames = new ArraySet();\n\n    // Find mappings for the \"sourceFile\"\n    this._mappings.unsortedForEach(function (mapping) {\n      if (mapping.source === sourceFile && mapping.originalLine != null) {\n        // Check if it can be mapped by the source map, then update the mapping.\n        var original = aSourceMapConsumer.originalPositionFor({\n          line: mapping.originalLine,\n          column: mapping.originalColumn\n        });\n        if (original.source != null) {\n          // Copy mapping\n          mapping.source = original.source;\n          if (aSourceMapPath != null) {\n            mapping.source = util.join(aSourceMapPath, mapping.source)\n          }\n          if (sourceRoot != null) {\n            mapping.source = util.relative(sourceRoot, mapping.source);\n          }\n          mapping.originalLine = original.line;\n          mapping.originalColumn = original.column;\n          if (original.name != null) {\n            mapping.name = original.name;\n          }\n        }\n      }\n\n      var source = mapping.source;\n      if (source != null && !newSources.has(source)) {\n        newSources.add(source);\n      }\n\n      var name = mapping.name;\n      if (name != null && !newNames.has(name)) {\n        newNames.add(name);\n      }\n\n    }, this);\n    this._sources = newSources;\n    this._names = newNames;\n\n    // Copy sourcesContents of applied map.\n    aSourceMapConsumer.sources.forEach(function (sourceFile) {\n      var content = aSourceMapConsumer.sourceContentFor(sourceFile);\n      if (content != null) {\n        if (aSourceMapPath != null) {\n          sourceFile = util.join(aSourceMapPath, sourceFile);\n        }\n        if (sourceRoot != null) {\n          sourceFile = util.relative(sourceRoot, sourceFile);\n        }\n        this.setSourceContent(sourceFile, content);\n      }\n    }, this);\n  };\n\n/**\n * A mapping can have one of the three levels of data:\n *\n *   1. Just the generated position.\n *   2. The Generated position, original position, and original source.\n *   3. Generated and original position, original source, as well as a name\n *      token.\n *\n * To maintain consistency, we validate that any new mapping being added falls\n * in to one of these categories.\n */\nSourceMapGenerator.prototype._validateMapping =\n  function SourceMapGenerator_validateMapping(aGenerated, aOriginal, aSource,\n                                              aName) {\n    // When aOriginal is truthy but has empty values for .line and .column,\n    // it is most likely a programmer error. In this case we throw a very\n    // specific error message to try to guide them the right way.\n    // For example: https://github.com/Polymer/polymer-bundler/pull/519\n    if (aOriginal && typeof aOriginal.line !== 'number' && typeof aOriginal.column !== 'number') {\n        throw new Error(\n            'original.line and original.column are not numbers -- you probably meant to omit ' +\n            'the original mapping entirely and only map the generated position. If so, pass ' +\n            'null for the original mapping instead of an object with empty or null values.'\n        );\n    }\n\n    if (aGenerated && 'line' in aGenerated && 'column' in aGenerated\n        && aGenerated.line > 0 && aGenerated.column >= 0\n        && !aOriginal && !aSource && !aName) {\n      // Case 1.\n      return;\n    }\n    else if (aGenerated && 'line' in aGenerated && 'column' in aGenerated\n             && aOriginal && 'line' in aOriginal && 'column' in aOriginal\n             && aGenerated.line > 0 && aGenerated.column >= 0\n             && aOriginal.line > 0 && aOriginal.column >= 0\n             && aSource) {\n      // Cases 2 and 3.\n      return;\n    }\n    else {\n      throw new Error('Invalid mapping: ' + JSON.stringify({\n        generated: aGenerated,\n        source: aSource,\n        original: aOriginal,\n        name: aName\n      }));\n    }\n  };\n\n/**\n * Serialize the accumulated mappings in to the stream of base 64 VLQs\n * specified by the source map format.\n */\nSourceMapGenerator.prototype._serializeMappings =\n  function SourceMapGenerator_serializeMappings() {\n    var previousGeneratedColumn = 0;\n    var previousGeneratedLine = 1;\n    var previousOriginalColumn = 0;\n    var previousOriginalLine = 0;\n    var previousName = 0;\n    var previousSource = 0;\n    var result = '';\n    var next;\n    var mapping;\n    var nameIdx;\n    var sourceIdx;\n\n    var mappings = this._mappings.toArray();\n    for (var i = 0, len = mappings.length; i < len; i++) {\n      mapping = mappings[i];\n      next = ''\n\n      if (mapping.generatedLine !== previousGeneratedLine) {\n        previousGeneratedColumn = 0;\n        while (mapping.generatedLine !== previousGeneratedLine) {\n          next += ';';\n          previousGeneratedLine++;\n        }\n      }\n      else {\n        if (i > 0) {\n          if (!util.compareByGeneratedPositionsInflated(mapping, mappings[i - 1])) {\n            continue;\n          }\n          next += ',';\n        }\n      }\n\n      next += base64VLQ.encode(mapping.generatedColumn\n                                 - previousGeneratedColumn);\n      previousGeneratedColumn = mapping.generatedColumn;\n\n      if (mapping.source != null) {\n        sourceIdx = this._sources.indexOf(mapping.source);\n        next += base64VLQ.encode(sourceIdx - previousSource);\n        previousSource = sourceIdx;\n\n        // lines are stored 0-based in SourceMap spec version 3\n        next += base64VLQ.encode(mapping.originalLine - 1\n                                   - previousOriginalLine);\n        previousOriginalLine = mapping.originalLine - 1;\n\n        next += base64VLQ.encode(mapping.originalColumn\n                                   - previousOriginalColumn);\n        previousOriginalColumn = mapping.originalColumn;\n\n        if (mapping.name != null) {\n          nameIdx = this._names.indexOf(mapping.name);\n          next += base64VLQ.encode(nameIdx - previousName);\n          previousName = nameIdx;\n        }\n      }\n\n      result += next;\n    }\n\n    return result;\n  };\n\nSourceMapGenerator.prototype._generateSourcesContent =\n  function SourceMapGenerator_generateSourcesContent(aSources, aSourceRoot) {\n    return aSources.map(function (source) {\n      if (!this._sourcesContents) {\n        return null;\n      }\n      if (aSourceRoot != null) {\n        source = util.relative(aSourceRoot, source);\n      }\n      var key = util.toSetString(source);\n      return Object.prototype.hasOwnProperty.call(this._sourcesContents, key)\n        ? this._sourcesContents[key]\n        : null;\n    }, this);\n  };\n\n/**\n * Externalize the source map.\n */\nSourceMapGenerator.prototype.toJSON =\n  function SourceMapGenerator_toJSON() {\n    var map = {\n      version: this._version,\n      sources: this._sources.toArray(),\n      names: this._names.toArray(),\n      mappings: this._serializeMappings()\n    };\n    if (this._file != null) {\n      map.file = this._file;\n    }\n    if (this._sourceRoot != null) {\n      map.sourceRoot = this._sourceRoot;\n    }\n    if (this._sourcesContents) {\n      map.sourcesContent = this._generateSourcesContent(map.sources, map.sourceRoot);\n    }\n\n    return map;\n  };\n\n/**\n * Render the source map being generated to a string.\n */\nSourceMapGenerator.prototype.toString =\n  function SourceMapGenerator_toString() {\n    return JSON.stringify(this.toJSON());\n  };\n\nexports.SourceMapGenerator = SourceMapGenerator;\n","var SourceMapGenerator = require('source-map/lib/source-map-generator').SourceMapGenerator;\nvar trackNodes = {\n    Atrule: true,\n    Selector: true,\n    Declaration: true\n};\n\nmodule.exports = function generateSourceMap(handlers) {\n    var map = new SourceMapGenerator();\n    var line = 1;\n    var column = 0;\n    var generated = {\n        line: 1,\n        column: 0\n    };\n    var original = {\n        line: 0, // should be zero to add first mapping\n        column: 0\n    };\n    var sourceMappingActive = false;\n    var activatedGenerated = {\n        line: 1,\n        column: 0\n    };\n    var activatedMapping = {\n        generated: activatedGenerated\n    };\n\n    var handlersNode = handlers.node;\n    handlers.node = function(node) {\n        if (node.loc && node.loc.start && trackNodes.hasOwnProperty(node.type)) {\n            var nodeLine = node.loc.start.line;\n            var nodeColumn = node.loc.start.column - 1;\n\n            if (original.line !== nodeLine ||\n                original.column !== nodeColumn) {\n                original.line = nodeLine;\n                original.column = nodeColumn;\n\n                generated.line = line;\n                generated.column = column;\n\n                if (sourceMappingActive) {\n                    sourceMappingActive = false;\n                    if (generated.line !== activatedGenerated.line ||\n                        generated.column !== activatedGenerated.column) {\n                        map.addMapping(activatedMapping);\n                    }\n                }\n\n                sourceMappingActive = true;\n                map.addMapping({\n                    source: node.loc.source,\n                    original: original,\n                    generated: generated\n                });\n            }\n        }\n\n        handlersNode.call(this, node);\n\n        if (sourceMappingActive && trackNodes.hasOwnProperty(node.type)) {\n            activatedGenerated.line = line;\n            activatedGenerated.column = column;\n        }\n    };\n\n    var handlersChunk = handlers.chunk;\n    handlers.chunk = function(chunk) {\n        for (var i = 0; i < chunk.length; i++) {\n            if (chunk.charCodeAt(i) === 10) { // \\n\n                line++;\n                column = 0;\n            } else {\n                column++;\n            }\n        }\n\n        handlersChunk(chunk);\n    };\n\n    var handlersResult = handlers.result;\n    handlers.result = function() {\n        if (sourceMappingActive) {\n            map.addMapping(activatedMapping);\n        }\n\n        return {\n            css: handlersResult(),\n            map: map\n        };\n    };\n\n    return handlers;\n};\n","var sourceMap = require('./sourceMap');\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction processChildren(node, delimeter) {\n    var list = node.children;\n    var prev = null;\n\n    if (typeof delimeter !== 'function') {\n        list.forEach(this.node, this);\n    } else {\n        list.forEach(function(node) {\n            if (prev !== null) {\n                delimeter.call(this, prev);\n            }\n\n            this.node(node);\n            prev = node;\n        }, this);\n    }\n}\n\nmodule.exports = function createGenerator(config) {\n    function processNode(node) {\n        if (hasOwnProperty.call(types, node.type)) {\n            types[node.type].call(this, node);\n        } else {\n            throw new Error('Unknown node type: ' + node.type);\n        }\n    }\n\n    var types = {};\n\n    if (config.node) {\n        for (var name in config.node) {\n            types[name] = config.node[name].generate;\n        }\n    }\n\n    return function(node, options) {\n        var buffer = '';\n        var handlers = {\n            children: processChildren,\n            node: processNode,\n            chunk: function(chunk) {\n                buffer += chunk;\n            },\n            result: function() {\n                return buffer;\n            }\n        };\n\n        if (options) {\n            if (typeof options.decorator === 'function') {\n                handlers = options.decorator(handlers);\n            }\n\n            if (options.sourceMap) {\n                handlers = sourceMap(handlers);\n            }\n        }\n\n        handlers.node(node);\n\n        return handlers.result();\n    };\n};\n","var List = require('../common/List');\n\nmodule.exports = function createConvertors(walk) {\n    return {\n        fromPlainObject: function(ast) {\n            walk(ast, {\n                enter: function(node) {\n                    if (node.children && node.children instanceof List === false) {\n                        node.children = new List().fromArray(node.children);\n                    }\n                }\n            });\n\n            return ast;\n        },\n        toPlainObject: function(ast) {\n            walk(ast, {\n                leave: function(node) {\n                    if (node.children && node.children instanceof List) {\n                        node.children = node.children.toArray();\n                    }\n                }\n            });\n\n            return ast;\n        }\n    };\n};\n","var hasOwnProperty = Object.prototype.hasOwnProperty;\nvar noop = function() {};\n\nfunction ensureFunction(value) {\n    return typeof value === 'function' ? value : noop;\n}\n\nfunction invokeForType(fn, type) {\n    return function(node, item, list) {\n        if (node.type === type) {\n            fn.call(this, node, item, list);\n        }\n    };\n}\n\nfunction getWalkersFromStructure(name, nodeType) {\n    var structure = nodeType.structure;\n    var walkers = [];\n\n    for (var key in structure) {\n        if (hasOwnProperty.call(structure, key) === false) {\n            continue;\n        }\n\n        var fieldTypes = structure[key];\n        var walker = {\n            name: key,\n            type: false,\n            nullable: false\n        };\n\n        if (!Array.isArray(structure[key])) {\n            fieldTypes = [structure[key]];\n        }\n\n        for (var i = 0; i < fieldTypes.length; i++) {\n            var fieldType = fieldTypes[i];\n            if (fieldType === null) {\n                walker.nullable = true;\n            } else if (typeof fieldType === 'string') {\n                walker.type = 'node';\n            } else if (Array.isArray(fieldType)) {\n                walker.type = 'list';\n            }\n        }\n\n        if (walker.type) {\n            walkers.push(walker);\n        }\n    }\n\n    if (walkers.length) {\n        return {\n            context: nodeType.walkContext,\n            fields: walkers\n        };\n    }\n\n    return null;\n}\n\nfunction getTypesFromConfig(config) {\n    var types = {};\n\n    for (var name in config.node) {\n        if (hasOwnProperty.call(config.node, name)) {\n            var nodeType = config.node[name];\n\n            if (!nodeType.structure) {\n                throw new Error('Missed `structure` field in `' + name + '` node type definition');\n            }\n\n            types[name] = getWalkersFromStructure(name, nodeType);\n        }\n    }\n\n    return types;\n}\n\nfunction createTypeIterator(config, reverse) {\n    var fields = config.fields.slice();\n    var contextName = config.context;\n    var useContext = typeof contextName === 'string';\n\n    if (reverse) {\n        fields.reverse();\n    }\n\n    return function(node, context, walk, walkReducer) {\n        var prevContextValue;\n\n        if (useContext) {\n            prevContextValue = context[contextName];\n            context[contextName] = node;\n        }\n\n        for (var i = 0; i < fields.length; i++) {\n            var field = fields[i];\n            var ref = node[field.name];\n\n            if (!field.nullable || ref) {\n                if (field.type === 'list') {\n                    var breakWalk = reverse\n                        ? ref.reduceRight(walkReducer, false)\n                        : ref.reduce(walkReducer, false);\n\n                    if (breakWalk) {\n                        return true;\n                    }\n                } else if (walk(ref)) {\n                    return true;\n                }\n            }\n        }\n\n        if (useContext) {\n            context[contextName] = prevContextValue;\n        }\n    };\n}\n\nfunction createFastTraveralMap(iterators) {\n    return {\n        Atrule: {\n            StyleSheet: iterators.StyleSheet,\n            Atrule: iterators.Atrule,\n            Rule: iterators.Rule,\n            Block: iterators.Block\n        },\n        Rule: {\n            StyleSheet: iterators.StyleSheet,\n            Atrule: iterators.Atrule,\n            Rule: iterators.Rule,\n            Block: iterators.Block\n        },\n        Declaration: {\n            StyleSheet: iterators.StyleSheet,\n            Atrule: iterators.Atrule,\n            Rule: iterators.Rule,\n            Block: iterators.Block,\n            DeclarationList: iterators.DeclarationList\n        }\n    };\n}\n\nmodule.exports = function createWalker(config) {\n    var types = getTypesFromConfig(config);\n    var iteratorsNatural = {};\n    var iteratorsReverse = {};\n    var breakWalk = Symbol('break-walk');\n    var skipNode = Symbol('skip-node');\n\n    for (var name in types) {\n        if (hasOwnProperty.call(types, name) && types[name] !== null) {\n            iteratorsNatural[name] = createTypeIterator(types[name], false);\n            iteratorsReverse[name] = createTypeIterator(types[name], true);\n        }\n    }\n\n    var fastTraversalIteratorsNatural = createFastTraveralMap(iteratorsNatural);\n    var fastTraversalIteratorsReverse = createFastTraveralMap(iteratorsReverse);\n\n    var walk = function(root, options) {\n        function walkNode(node, item, list) {\n            var enterRet = enter.call(context, node, item, list);\n\n            if (enterRet === breakWalk) {\n                debugger;\n                return true;\n            }\n\n            if (enterRet === skipNode) {\n                return false;\n            }\n\n            if (iterators.hasOwnProperty(node.type)) {\n                if (iterators[node.type](node, context, walkNode, walkReducer)) {\n                    return true;\n                }\n            }\n\n            if (leave.call(context, node, item, list) === breakWalk) {\n                return true;\n            }\n\n            return false;\n        }\n\n        var walkReducer = (ret, data, item, list) => ret || walkNode(data, item, list);\n        var enter = noop;\n        var leave = noop;\n        var iterators = iteratorsNatural;\n        var context = {\n            break: breakWalk,\n            skip: skipNode,\n\n            root: root,\n            stylesheet: null,\n            atrule: null,\n            atrulePrelude: null,\n            rule: null,\n            selector: null,\n            block: null,\n            declaration: null,\n            function: null\n        };\n\n        if (typeof options === 'function') {\n            enter = options;\n        } else if (options) {\n            enter = ensureFunction(options.enter);\n            leave = ensureFunction(options.leave);\n\n            if (options.reverse) {\n                iterators = iteratorsReverse;\n            }\n\n            if (options.visit) {\n                if (fastTraversalIteratorsNatural.hasOwnProperty(options.visit)) {\n                    iterators = options.reverse\n                        ? fastTraversalIteratorsReverse[options.visit]\n                        : fastTraversalIteratorsNatural[options.visit];\n                } else if (!types.hasOwnProperty(options.visit)) {\n                    throw new Error('Bad value `' + options.visit + '` for `visit` option (should be: ' + Object.keys(types).join(', ') + ')');\n                }\n\n                enter = invokeForType(enter, options.visit);\n                leave = invokeForType(leave, options.visit);\n            }\n        }\n\n        if (enter === noop && leave === noop) {\n            throw new Error('Neither `enter` nor `leave` walker handler is set or both aren\\'t a function');\n        }\n\n        walkNode(root);\n    };\n\n    walk.break = breakWalk;\n    walk.skip = skipNode;\n\n    walk.find = function(ast, fn) {\n        var found = null;\n\n        walk(ast, function(node, item, list) {\n            if (fn.call(this, node, item, list)) {\n                found = node;\n                return breakWalk;\n            }\n        });\n\n        return found;\n    };\n\n    walk.findLast = function(ast, fn) {\n        var found = null;\n\n        walk(ast, {\n            reverse: true,\n            enter: function(node, item, list) {\n                if (fn.call(this, node, item, list)) {\n                    found = node;\n                    return breakWalk;\n                }\n            }\n        });\n\n        return found;\n    };\n\n    walk.findAll = function(ast, fn) {\n        var found = [];\n\n        walk(ast, function(node, item, list) {\n            if (fn.call(this, node, item, list)) {\n                found.push(node);\n            }\n        });\n\n        return found;\n    };\n\n    return walk;\n};\n","var List = require('../common/List');\n\nmodule.exports = function clone(node) {\n    var result = {};\n\n    for (var key in node) {\n        var value = node[key];\n\n        if (value) {\n            if (Array.isArray(value) || value instanceof List) {\n                value = value.map(clone);\n            } else if (value.constructor === Object) {\n                value = clone(value);\n            }\n        }\n\n        result[key] = value;\n    }\n\n    return result;\n};\n","const hasOwnProperty = Object.prototype.hasOwnProperty;\nconst shape = {\n    generic: true,\n    types: appendOrAssign,\n    atrules: {\n        prelude: appendOrAssignOrNull,\n        descriptors: appendOrAssignOrNull\n    },\n    properties: appendOrAssign,\n    parseContext: assign,\n    scope: deepAssign,\n    atrule: ['parse'],\n    pseudo: ['parse'],\n    node: ['name', 'structure', 'parse', 'generate', 'walkContext']\n};\n\nfunction isObject(value) {\n    return value && value.constructor === Object;\n}\n\nfunction copy(value) {\n    return isObject(value)\n        ? Object.assign({}, value)\n        : value;\n}\n\nfunction assign(dest, src) {\n    return Object.assign(dest, src);\n}\n\nfunction deepAssign(dest, src) {\n    for (const key in src) {\n        if (hasOwnProperty.call(src, key)) {\n            if (isObject(dest[key])) {\n                deepAssign(dest[key], copy(src[key]));\n            } else {\n                dest[key] = copy(src[key]);\n            }\n        }\n    }\n\n    return dest;\n}\n\nfunction append(a, b) {\n    if (typeof b === 'string' && /^\\s*\\|/.test(b)) {\n        return typeof a === 'string'\n            ? a + b\n            : b.replace(/^\\s*\\|\\s*/, '');\n    }\n\n    return b || null;\n}\n\nfunction appendOrAssign(a, b) {\n    if (typeof b === 'string') {\n        return append(a, b);\n    }\n\n    const result = Object.assign({}, a);\n    for (let key in b) {\n        if (hasOwnProperty.call(b, key)) {\n            result[key] = append(hasOwnProperty.call(a, key) ? a[key] : undefined, b[key]);\n        }\n    }\n\n    return result;\n}\n\nfunction appendOrAssignOrNull(a, b) {\n    const result = appendOrAssign(a, b);\n\n    return !isObject(result) || Object.keys(result).length\n        ? result\n        : null;\n}\n\nfunction mix(dest, src, shape) {\n    for (const key in shape) {\n        if (hasOwnProperty.call(shape, key) === false) {\n            continue;\n        }\n\n        if (shape[key] === true) {\n            if (key in src) {\n                if (hasOwnProperty.call(src, key)) {\n                    dest[key] = copy(src[key]);\n                }\n            }\n        } else if (shape[key]) {\n            if (typeof shape[key] === 'function') {\n                const fn = shape[key];\n                dest[key] = fn({}, dest[key]);\n                dest[key] = fn(dest[key] || {}, src[key]);\n            } else if (isObject(shape[key])) {\n                const result = {};\n\n                for (let name in dest[key]) {\n                    result[name] = mix({}, dest[key][name], shape[key]);\n                }\n\n                for (let name in src[key]) {\n                    result[name] = mix(result[name] || {}, src[key][name], shape[key]);\n                }\n\n                dest[key] = result;\n            } else if (Array.isArray(shape[key])) {\n                const res = {};\n                const innerShape = shape[key].reduce(function(s, k) {\n                    s[k] = true;\n                    return s;\n                }, {});\n\n                for (const [name, value] of Object.entries(dest[key] || {})) {\n                    res[name] = {};\n                    if (value) {\n                        mix(res[name], value, innerShape);\n                    }\n                }\n\n                for (const name in src[key]) {\n                    if (hasOwnProperty.call(src[key], name)) {\n                        if (!res[name]) {\n                            res[name] = {};\n                        }\n\n                        if (src[key] && src[key][name]) {\n                            mix(res[name], src[key][name], innerShape);\n                        }\n                    }\n                }\n\n                dest[key] = res;\n            }\n        }\n    }\n    return dest;\n}\n\nmodule.exports = (dest, src) => mix(dest, src, shape);\n","var List = require('../common/List');\nvar SyntaxError = require('../common/SyntaxError');\nvar TokenStream = require('../common/TokenStream');\nvar Lexer = require('../lexer/Lexer');\nvar definitionSyntax = require('../definition-syntax');\nvar tokenize = require('../tokenizer');\nvar createParser = require('../parser/create');\nvar createGenerator = require('../generator/create');\nvar createConvertor = require('../convertor/create');\nvar createWalker = require('../walker/create');\nvar clone = require('../utils/clone');\nvar names = require('../utils/names');\nvar mix = require('./config/mix');\n\nfunction createSyntax(config) {\n    var parse = createParser(config);\n    var walk = createWalker(config);\n    var generate = createGenerator(config);\n    var convert = createConvertor(walk);\n\n    var syntax = {\n        List: List,\n        SyntaxError: SyntaxError,\n        TokenStream: TokenStream,\n        Lexer: Lexer,\n\n        vendorPrefix: names.vendorPrefix,\n        keyword: names.keyword,\n        property: names.property,\n        isCustomProperty: names.isCustomProperty,\n\n        definitionSyntax: definitionSyntax,\n        lexer: null,\n        createLexer: function(config) {\n            return new Lexer(config, syntax, syntax.lexer.structure);\n        },\n\n        tokenize: tokenize,\n        parse: parse,\n        walk: walk,\n        generate: generate,\n\n        find: walk.find,\n        findLast: walk.findLast,\n        findAll: walk.findAll,\n\n        clone: clone,\n        fromPlainObject: convert.fromPlainObject,\n        toPlainObject: convert.toPlainObject,\n\n        createSyntax: function(config) {\n            return createSyntax(mix({}, config));\n        },\n        fork: function(extension) {\n            var base = mix({}, config); // copy of config\n            return createSyntax(\n                typeof extension === 'function'\n                    ? extension(base, Object.assign)\n                    : mix(base, extension)\n            );\n        }\n    };\n\n    syntax.lexer = new Lexer({\n        generic: true,\n        types: config.types,\n        atrules: config.atrules,\n        properties: config.properties,\n        node: config.node\n    }, syntax);\n\n    return syntax;\n};\n\nexports.create = function(config) {\n    return createSyntax(mix({}, config));\n};\n","const mdnAtrules = require('mdn-data/css/at-rules.json');\nconst mdnProperties = require('mdn-data/css/properties.json');\nconst mdnSyntaxes = require('mdn-data/css/syntaxes.json');\nconst patch = require('./patch.json');\nconst extendSyntax = /^\\s*\\|\\s*/;\n\nfunction preprocessAtrules(dict) {\n    const result = Object.create(null);\n\n    for (const atruleName in dict) {\n        const atrule = dict[atruleName];\n        let descriptors = null;\n\n        if (atrule.descriptors) {\n            descriptors = Object.create(null);\n\n            for (const descriptor in atrule.descriptors) {\n                descriptors[descriptor] = atrule.descriptors[descriptor].syntax;\n            }\n        }\n\n        result[atruleName.substr(1)] = {\n            prelude: atrule.syntax.trim().match(/^@\\S+\\s+([^;\\{]*)/)[1].trim() || null,\n            descriptors\n        };\n    }\n\n    return result;\n}\n\nfunction patchDictionary(dict, patchDict) {\n    const result = {};\n\n    // copy all syntaxes for an original dict\n    for (const key in dict) {\n        result[key] = dict[key].syntax || dict[key];\n    }\n\n    // apply a patch\n    for (const key in patchDict) {\n        if (key in dict) {\n            if (patchDict[key].syntax) {\n                result[key] = extendSyntax.test(patchDict[key].syntax)\n                    ? result[key] + ' ' + patchDict[key].syntax.trim()\n                    : patchDict[key].syntax;\n            } else {\n                delete result[key];\n            }\n        } else {\n            if (patchDict[key].syntax) {\n                result[key] = patchDict[key].syntax.replace(extendSyntax, '');\n            }\n        }\n    }\n\n    return result;\n}\n\nfunction unpackSyntaxes(dict) {\n    const result = {};\n\n    for (const key in dict) {\n        result[key] = dict[key].syntax;\n    }\n\n    return result;\n}\n\nfunction patchAtrules(dict, patchDict) {\n    const result = {};\n\n    // copy all syntaxes for an original dict\n    for (const key in dict) {\n        const patchDescriptors = (patchDict[key] && patchDict[key].descriptors) || null;\n\n        result[key] = {\n            prelude: key in patchDict && 'prelude' in patchDict[key]\n                ? patchDict[key].prelude\n                : dict[key].prelude || null,\n            descriptors: dict[key].descriptors\n                ? patchDictionary(dict[key].descriptors, patchDescriptors || {})\n                : patchDescriptors && unpackSyntaxes(patchDescriptors)\n        };\n    }\n\n    // apply a patch\n    for (const key in patchDict) {\n        if (!hasOwnProperty.call(dict, key)) {\n            result[key] = {\n                prelude: patchDict[key].prelude || null,\n                descriptors: patchDict[key].descriptors && unpackSyntaxes(patchDict[key].descriptors)\n            };\n        }\n    }\n\n    return result;\n}\n\nmodule.exports = {\n    types: patchDictionary(mdnSyntaxes, patch.syntaxes),\n    atrules: patchAtrules(preprocessAtrules(mdnAtrules), patch.atrules),\n    properties: patchDictionary(mdnProperties, patch.properties)\n};\n","var cmpChar = require('../../tokenizer').cmpChar;\nvar isDigit = require('../../tokenizer').isDigit;\nvar TYPE = require('../../tokenizer').TYPE;\n\nvar WHITESPACE = TYPE.WhiteSpace;\nvar COMMENT = TYPE.Comment;\nvar IDENT = TYPE.Ident;\nvar NUMBER = TYPE.Number;\nvar DIMENSION = TYPE.Dimension;\nvar PLUSSIGN = 0x002B;    // U+002B PLUS SIGN (+)\nvar HYPHENMINUS = 0x002D; // U+002D HYPHEN-MINUS (-)\nvar N = 0x006E;           // U+006E LATIN SMALL LETTER N (n)\nvar DISALLOW_SIGN = true;\nvar ALLOW_SIGN = false;\n\nfunction checkInteger(offset, disallowSign) {\n    var pos = this.scanner.tokenStart + offset;\n    var code = this.scanner.source.charCodeAt(pos);\n\n    if (code === PLUSSIGN || code === HYPHENMINUS) {\n        if (disallowSign) {\n            this.error('Number sign is not allowed');\n        }\n        pos++;\n    }\n\n    for (; pos < this.scanner.tokenEnd; pos++) {\n        if (!isDigit(this.scanner.source.charCodeAt(pos))) {\n            this.error('Integer is expected', pos);\n        }\n    }\n}\n\nfunction checkTokenIsInteger(disallowSign) {\n    return checkInteger.call(this, 0, disallowSign);\n}\n\nfunction expectCharCode(offset, code) {\n    if (!cmpChar(this.scanner.source, this.scanner.tokenStart + offset, code)) {\n        var msg = '';\n\n        switch (code) {\n            case N:\n                msg = 'N is expected';\n                break;\n            case HYPHENMINUS:\n                msg = 'HyphenMinus is expected';\n                break;\n        }\n\n        this.error(msg, this.scanner.tokenStart + offset);\n    }\n}\n\n// ... <signed-integer>\n// ... ['+' | '-'] <signless-integer>\nfunction consumeB() {\n    var offset = 0;\n    var sign = 0;\n    var type = this.scanner.tokenType;\n\n    while (type === WHITESPACE || type === COMMENT) {\n        type = this.scanner.lookupType(++offset);\n    }\n\n    if (type !== NUMBER) {\n        if (this.scanner.isDelim(PLUSSIGN, offset) ||\n            this.scanner.isDelim(HYPHENMINUS, offset)) {\n            sign = this.scanner.isDelim(PLUSSIGN, offset) ? PLUSSIGN : HYPHENMINUS;\n\n            do {\n                type = this.scanner.lookupType(++offset);\n            } while (type === WHITESPACE || type === COMMENT);\n\n            if (type !== NUMBER) {\n                this.scanner.skip(offset);\n                checkTokenIsInteger.call(this, DISALLOW_SIGN);\n            }\n        } else {\n            return null;\n        }\n    }\n\n    if (offset > 0) {\n        this.scanner.skip(offset);\n    }\n\n    if (sign === 0) {\n        type = this.scanner.source.charCodeAt(this.scanner.tokenStart);\n        if (type !== PLUSSIGN && type !== HYPHENMINUS) {\n            this.error('Number sign is expected');\n        }\n    }\n\n    checkTokenIsInteger.call(this, sign !== 0);\n    return sign === HYPHENMINUS ? '-' + this.consume(NUMBER) : this.consume(NUMBER);\n}\n\n// An+B microsyntax https://www.w3.org/TR/css-syntax-3/#anb\nmodule.exports = {\n    name: 'AnPlusB',\n    structure: {\n        a: [String, null],\n        b: [String, null]\n    },\n    parse: function() {\n        /* eslint-disable brace-style*/\n        var start = this.scanner.tokenStart;\n        var a = null;\n        var b = null;\n\n        // <integer>\n        if (this.scanner.tokenType === NUMBER) {\n            checkTokenIsInteger.call(this, ALLOW_SIGN);\n            b = this.consume(NUMBER);\n        }\n\n        // -n\n        // -n <signed-integer>\n        // -n ['+' | '-'] <signless-integer>\n        // -n- <signless-integer>\n        // <dashndashdigit-ident>\n        else if (this.scanner.tokenType === IDENT && cmpChar(this.scanner.source, this.scanner.tokenStart, HYPHENMINUS)) {\n            a = '-1';\n\n            expectCharCode.call(this, 1, N);\n\n            switch (this.scanner.getTokenLength()) {\n                // -n\n                // -n <signed-integer>\n                // -n ['+' | '-'] <signless-integer>\n                case 2:\n                    this.scanner.next();\n                    b = consumeB.call(this);\n                    break;\n\n                // -n- <signless-integer>\n                case 3:\n                    expectCharCode.call(this, 2, HYPHENMINUS);\n\n                    this.scanner.next();\n                    this.scanner.skipSC();\n\n                    checkTokenIsInteger.call(this, DISALLOW_SIGN);\n\n                    b = '-' + this.consume(NUMBER);\n                    break;\n\n                // <dashndashdigit-ident>\n                default:\n                    expectCharCode.call(this, 2, HYPHENMINUS);\n                    checkInteger.call(this, 3, DISALLOW_SIGN);\n                    this.scanner.next();\n\n                    b = this.scanner.substrToCursor(start + 2);\n            }\n        }\n\n        // '+'? n\n        // '+'? n <signed-integer>\n        // '+'? n ['+' | '-'] <signless-integer>\n        // '+'? n- <signless-integer>\n        // '+'? <ndashdigit-ident>\n        else if (this.scanner.tokenType === IDENT || (this.scanner.isDelim(PLUSSIGN) && this.scanner.lookupType(1) === IDENT)) {\n            var sign = 0;\n            a = '1';\n\n            // just ignore a plus\n            if (this.scanner.isDelim(PLUSSIGN)) {\n                sign = 1;\n                this.scanner.next();\n            }\n\n            expectCharCode.call(this, 0, N);\n\n            switch (this.scanner.getTokenLength()) {\n                // '+'? n\n                // '+'? n <signed-integer>\n                // '+'? n ['+' | '-'] <signless-integer>\n                case 1:\n                    this.scanner.next();\n                    b = consumeB.call(this);\n                    break;\n\n                // '+'? n- <signless-integer>\n                case 2:\n                    expectCharCode.call(this, 1, HYPHENMINUS);\n\n                    this.scanner.next();\n                    this.scanner.skipSC();\n\n                    checkTokenIsInteger.call(this, DISALLOW_SIGN);\n\n                    b = '-' + this.consume(NUMBER);\n                    break;\n\n                // '+'? <ndashdigit-ident>\n                default:\n                    expectCharCode.call(this, 1, HYPHENMINUS);\n                    checkInteger.call(this, 2, DISALLOW_SIGN);\n                    this.scanner.next();\n\n                    b = this.scanner.substrToCursor(start + sign + 1);\n            }\n        }\n\n        // <ndashdigit-dimension>\n        // <ndash-dimension> <signless-integer>\n        // <n-dimension>\n        // <n-dimension> <signed-integer>\n        // <n-dimension> ['+' | '-'] <signless-integer>\n        else if (this.scanner.tokenType === DIMENSION) {\n            var code = this.scanner.source.charCodeAt(this.scanner.tokenStart);\n            var sign = code === PLUSSIGN || code === HYPHENMINUS;\n\n            for (var i = this.scanner.tokenStart + sign; i < this.scanner.tokenEnd; i++) {\n                if (!isDigit(this.scanner.source.charCodeAt(i))) {\n                    break;\n                }\n            }\n\n            if (i === this.scanner.tokenStart + sign) {\n                this.error('Integer is expected', this.scanner.tokenStart + sign);\n            }\n\n            expectCharCode.call(this, i - this.scanner.tokenStart, N);\n            a = this.scanner.source.substring(start, i);\n\n            // <n-dimension>\n            // <n-dimension> <signed-integer>\n            // <n-dimension> ['+' | '-'] <signless-integer>\n            if (i + 1 === this.scanner.tokenEnd) {\n                this.scanner.next();\n                b = consumeB.call(this);\n            } else {\n                expectCharCode.call(this, i - this.scanner.tokenStart + 1, HYPHENMINUS);\n\n                // <ndash-dimension> <signless-integer>\n                if (i + 2 === this.scanner.tokenEnd) {\n                    this.scanner.next();\n                    this.scanner.skipSC();\n                    checkTokenIsInteger.call(this, DISALLOW_SIGN);\n                    b = '-' + this.consume(NUMBER);\n                }\n                // <ndashdigit-dimension>\n                else {\n                    checkInteger.call(this, i - this.scanner.tokenStart + 2, DISALLOW_SIGN);\n                    this.scanner.next();\n                    b = this.scanner.substrToCursor(i + 1);\n                }\n            }\n        } else {\n            this.error();\n        }\n\n        if (a !== null && a.charCodeAt(0) === PLUSSIGN) {\n            a = a.substr(1);\n        }\n\n        if (b !== null && b.charCodeAt(0) === PLUSSIGN) {\n            b = b.substr(1);\n        }\n\n        return {\n            type: 'AnPlusB',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            a: a,\n            b: b\n        };\n    },\n    generate: function(node) {\n        var a = node.a !== null && node.a !== undefined;\n        var b = node.b !== null && node.b !== undefined;\n\n        if (a) {\n            this.chunk(\n                node.a === '+1' ? '+n' : // eslint-disable-line operator-linebreak, indent\n                node.a ===  '1' ?  'n' : // eslint-disable-line operator-linebreak, indent\n                node.a === '-1' ? '-n' : // eslint-disable-line operator-linebreak, indent\n                node.a + 'n'             // eslint-disable-line operator-linebreak, indent\n            );\n\n            if (b) {\n                b = String(node.b);\n                if (b.charAt(0) === '-' || b.charAt(0) === '+') {\n                    this.chunk(b.charAt(0));\n                    this.chunk(b.substr(1));\n                } else {\n                    this.chunk('+');\n                    this.chunk(b);\n                }\n            }\n        } else {\n            this.chunk(String(node.b));\n        }\n    }\n};\n","var tokenizer = require('../../tokenizer');\nvar TYPE = tokenizer.TYPE;\n\nvar WhiteSpace = TYPE.WhiteSpace;\nvar Semicolon = TYPE.Semicolon;\nvar LeftCurlyBracket = TYPE.LeftCurlyBracket;\nvar Delim = TYPE.Delim;\nvar EXCLAMATIONMARK = 0x0021; // U+0021 EXCLAMATION MARK (!)\n\nfunction getOffsetExcludeWS() {\n    if (this.scanner.tokenIndex > 0) {\n        if (this.scanner.lookupType(-1) === WhiteSpace) {\n            return this.scanner.tokenIndex > 1\n                ? this.scanner.getTokenStart(this.scanner.tokenIndex - 1)\n                : this.scanner.firstCharOffset;\n        }\n    }\n\n    return this.scanner.tokenStart;\n}\n\n// 0, 0, false\nfunction balanceEnd() {\n    return 0;\n}\n\n// LEFTCURLYBRACKET, 0, false\nfunction leftCurlyBracket(tokenType) {\n    return tokenType === LeftCurlyBracket ? 1 : 0;\n}\n\n// LEFTCURLYBRACKET, SEMICOLON, false\nfunction leftCurlyBracketOrSemicolon(tokenType) {\n    return tokenType === LeftCurlyBracket || tokenType === Semicolon ? 1 : 0;\n}\n\n// EXCLAMATIONMARK, SEMICOLON, false\nfunction exclamationMarkOrSemicolon(tokenType, source, offset) {\n    if (tokenType === Delim && source.charCodeAt(offset) === EXCLAMATIONMARK) {\n        return 1;\n    }\n\n    return tokenType === Semicolon ? 1 : 0;\n}\n\n// 0, SEMICOLON, true\nfunction semicolonIncluded(tokenType) {\n    return tokenType === Semicolon ? 2 : 0;\n}\n\nmodule.exports = {\n    name: 'Raw',\n    structure: {\n        value: String\n    },\n    parse: function(startToken, mode, excludeWhiteSpace) {\n        var startOffset = this.scanner.getTokenStart(startToken);\n        var endOffset;\n\n        this.scanner.skip(\n            this.scanner.getRawLength(startToken, mode || balanceEnd)\n        );\n\n        if (excludeWhiteSpace && this.scanner.tokenStart > startOffset) {\n            endOffset = getOffsetExcludeWS.call(this);\n        } else {\n            endOffset = this.scanner.tokenStart;\n        }\n\n        return {\n            type: 'Raw',\n            loc: this.getLocation(startOffset, endOffset),\n            value: this.scanner.source.substring(startOffset, endOffset)\n        };\n    },\n    generate: function(node) {\n        this.chunk(node.value);\n    },\n\n    mode: {\n        default: balanceEnd,\n        leftCurlyBracket: leftCurlyBracket,\n        leftCurlyBracketOrSemicolon: leftCurlyBracketOrSemicolon,\n        exclamationMarkOrSemicolon: exclamationMarkOrSemicolon,\n        semicolonIncluded: semicolonIncluded\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\nvar rawMode = require('./Raw').mode;\n\nvar ATKEYWORD = TYPE.AtKeyword;\nvar SEMICOLON = TYPE.Semicolon;\nvar LEFTCURLYBRACKET = TYPE.LeftCurlyBracket;\nvar RIGHTCURLYBRACKET = TYPE.RightCurlyBracket;\n\nfunction consumeRaw(startToken) {\n    return this.Raw(startToken, rawMode.leftCurlyBracketOrSemicolon, true);\n}\n\nfunction isDeclarationBlockAtrule() {\n    for (var offset = 1, type; type = this.scanner.lookupType(offset); offset++) {\n        if (type === RIGHTCURLYBRACKET) {\n            return true;\n        }\n\n        if (type === LEFTCURLYBRACKET ||\n            type === ATKEYWORD) {\n            return false;\n        }\n    }\n\n    return false;\n}\n\nmodule.exports = {\n    name: 'Atrule',\n    structure: {\n        name: String,\n        prelude: ['AtrulePrelude', 'Raw', null],\n        block: ['Block', null]\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var name;\n        var nameLowerCase;\n        var prelude = null;\n        var block = null;\n\n        this.eat(ATKEYWORD);\n\n        name = this.scanner.substrToCursor(start + 1);\n        nameLowerCase = name.toLowerCase();\n        this.scanner.skipSC();\n\n        // parse prelude\n        if (this.scanner.eof === false &&\n            this.scanner.tokenType !== LEFTCURLYBRACKET &&\n            this.scanner.tokenType !== SEMICOLON) {\n            if (this.parseAtrulePrelude) {\n                prelude = this.parseWithFallback(this.AtrulePrelude.bind(this, name), consumeRaw);\n\n                // turn empty AtrulePrelude into null\n                if (prelude.type === 'AtrulePrelude' && prelude.children.head === null) {\n                    prelude = null;\n                }\n            } else {\n                prelude = consumeRaw.call(this, this.scanner.tokenIndex);\n            }\n\n            this.scanner.skipSC();\n        }\n\n        switch (this.scanner.tokenType) {\n            case SEMICOLON:\n                this.scanner.next();\n                break;\n\n            case LEFTCURLYBRACKET:\n                if (this.atrule.hasOwnProperty(nameLowerCase) &&\n                    typeof this.atrule[nameLowerCase].block === 'function') {\n                    block = this.atrule[nameLowerCase].block.call(this);\n                } else {\n                    // TODO: should consume block content as Raw?\n                    block = this.Block(isDeclarationBlockAtrule.call(this));\n                }\n\n                break;\n        }\n\n        return {\n            type: 'Atrule',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            name: name,\n            prelude: prelude,\n            block: block\n        };\n    },\n    generate: function(node) {\n        this.chunk('@');\n        this.chunk(node.name);\n\n        if (node.prelude !== null) {\n            this.chunk(' ');\n            this.node(node.prelude);\n        }\n\n        if (node.block) {\n            this.node(node.block);\n        } else {\n            this.chunk(';');\n        }\n    },\n    walkContext: 'atrule'\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar SEMICOLON = TYPE.Semicolon;\nvar LEFTCURLYBRACKET = TYPE.LeftCurlyBracket;\n\nmodule.exports = {\n    name: 'AtrulePrelude',\n    structure: {\n        children: [[]]\n    },\n    parse: function(name) {\n        var children = null;\n\n        if (name !== null) {\n            name = name.toLowerCase();\n        }\n\n        this.scanner.skipSC();\n\n        if (this.atrule.hasOwnProperty(name) &&\n            typeof this.atrule[name].prelude === 'function') {\n            // custom consumer\n            children = this.atrule[name].prelude.call(this);\n        } else {\n            // default consumer\n            children = this.readSequence(this.scope.AtrulePrelude);\n        }\n\n        this.scanner.skipSC();\n\n        if (this.scanner.eof !== true &&\n            this.scanner.tokenType !== LEFTCURLYBRACKET &&\n            this.scanner.tokenType !== SEMICOLON) {\n            this.error('Semicolon or block is expected');\n        }\n\n        if (children === null) {\n            children = this.createList();\n        }\n\n        return {\n            type: 'AtrulePrelude',\n            loc: this.getLocationFromList(children),\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.children(node);\n    },\n    walkContext: 'atrulePrelude'\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar IDENT = TYPE.Ident;\nvar STRING = TYPE.String;\nvar COLON = TYPE.Colon;\nvar LEFTSQUAREBRACKET = TYPE.LeftSquareBracket;\nvar RIGHTSQUAREBRACKET = TYPE.RightSquareBracket;\nvar DOLLARSIGN = 0x0024;       // U+0024 DOLLAR SIGN ($)\nvar ASTERISK = 0x002A;         // U+002A ASTERISK (*)\nvar EQUALSSIGN = 0x003D;       // U+003D EQUALS SIGN (=)\nvar CIRCUMFLEXACCENT = 0x005E; // U+005E (^)\nvar VERTICALLINE = 0x007C;     // U+007C VERTICAL LINE (|)\nvar TILDE = 0x007E;            // U+007E TILDE (~)\n\nfunction getAttributeName() {\n    if (this.scanner.eof) {\n        this.error('Unexpected end of input');\n    }\n\n    var start = this.scanner.tokenStart;\n    var expectIdent = false;\n    var checkColon = true;\n\n    if (this.scanner.isDelim(ASTERISK)) {\n        expectIdent = true;\n        checkColon = false;\n        this.scanner.next();\n    } else if (!this.scanner.isDelim(VERTICALLINE)) {\n        this.eat(IDENT);\n    }\n\n    if (this.scanner.isDelim(VERTICALLINE)) {\n        if (this.scanner.source.charCodeAt(this.scanner.tokenStart + 1) !== EQUALSSIGN) {\n            this.scanner.next();\n            this.eat(IDENT);\n        } else if (expectIdent) {\n            this.error('Identifier is expected', this.scanner.tokenEnd);\n        }\n    } else if (expectIdent) {\n        this.error('Vertical line is expected');\n    }\n\n    if (checkColon && this.scanner.tokenType === COLON) {\n        this.scanner.next();\n        this.eat(IDENT);\n    }\n\n    return {\n        type: 'Identifier',\n        loc: this.getLocation(start, this.scanner.tokenStart),\n        name: this.scanner.substrToCursor(start)\n    };\n}\n\nfunction getOperator() {\n    var start = this.scanner.tokenStart;\n    var code = this.scanner.source.charCodeAt(start);\n\n    if (code !== EQUALSSIGN &&        // =\n        code !== TILDE &&             // ~=\n        code !== CIRCUMFLEXACCENT &&  // ^=\n        code !== DOLLARSIGN &&        // $=\n        code !== ASTERISK &&          // *=\n        code !== VERTICALLINE         // |=\n    ) {\n        this.error('Attribute selector (=, ~=, ^=, $=, *=, |=) is expected');\n    }\n\n    this.scanner.next();\n\n    if (code !== EQUALSSIGN) {\n        if (!this.scanner.isDelim(EQUALSSIGN)) {\n            this.error('Equal sign is expected');\n        }\n\n        this.scanner.next();\n    }\n\n    return this.scanner.substrToCursor(start);\n}\n\n// '[' <wq-name> ']'\n// '[' <wq-name> <attr-matcher> [ <string-token> | <ident-token> ] <attr-modifier>? ']'\nmodule.exports = {\n    name: 'AttributeSelector',\n    structure: {\n        name: 'Identifier',\n        matcher: [String, null],\n        value: ['String', 'Identifier', null],\n        flags: [String, null]\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var name;\n        var matcher = null;\n        var value = null;\n        var flags = null;\n\n        this.eat(LEFTSQUAREBRACKET);\n        this.scanner.skipSC();\n\n        name = getAttributeName.call(this);\n        this.scanner.skipSC();\n\n        if (this.scanner.tokenType !== RIGHTSQUAREBRACKET) {\n            // avoid case `[name i]`\n            if (this.scanner.tokenType !== IDENT) {\n                matcher = getOperator.call(this);\n\n                this.scanner.skipSC();\n\n                value = this.scanner.tokenType === STRING\n                    ? this.String()\n                    : this.Identifier();\n\n                this.scanner.skipSC();\n            }\n\n            // attribute flags\n            if (this.scanner.tokenType === IDENT) {\n                flags = this.scanner.getTokenValue();\n                this.scanner.next();\n\n                this.scanner.skipSC();\n            }\n        }\n\n        this.eat(RIGHTSQUAREBRACKET);\n\n        return {\n            type: 'AttributeSelector',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            name: name,\n            matcher: matcher,\n            value: value,\n            flags: flags\n        };\n    },\n    generate: function(node) {\n        var flagsPrefix = ' ';\n\n        this.chunk('[');\n        this.node(node.name);\n\n        if (node.matcher !== null) {\n            this.chunk(node.matcher);\n\n            if (node.value !== null) {\n                this.node(node.value);\n\n                // space between string and flags is not required\n                if (node.value.type === 'String') {\n                    flagsPrefix = '';\n                }\n            }\n        }\n\n        if (node.flags !== null) {\n            this.chunk(flagsPrefix);\n            this.chunk(node.flags);\n        }\n\n        this.chunk(']');\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\nvar rawMode = require('./Raw').mode;\n\nvar WHITESPACE = TYPE.WhiteSpace;\nvar COMMENT = TYPE.Comment;\nvar SEMICOLON = TYPE.Semicolon;\nvar ATKEYWORD = TYPE.AtKeyword;\nvar LEFTCURLYBRACKET = TYPE.LeftCurlyBracket;\nvar RIGHTCURLYBRACKET = TYPE.RightCurlyBracket;\n\nfunction consumeRaw(startToken) {\n    return this.Raw(startToken, null, true);\n}\nfunction consumeRule() {\n    return this.parseWithFallback(this.Rule, consumeRaw);\n}\nfunction consumeRawDeclaration(startToken) {\n    return this.Raw(startToken, rawMode.semicolonIncluded, true);\n}\nfunction consumeDeclaration() {\n    if (this.scanner.tokenType === SEMICOLON) {\n        return consumeRawDeclaration.call(this, this.scanner.tokenIndex);\n    }\n\n    var node = this.parseWithFallback(this.Declaration, consumeRawDeclaration);\n\n    if (this.scanner.tokenType === SEMICOLON) {\n        this.scanner.next();\n    }\n\n    return node;\n}\n\nmodule.exports = {\n    name: 'Block',\n    structure: {\n        children: [[\n            'Atrule',\n            'Rule',\n            'Declaration'\n        ]]\n    },\n    parse: function(isDeclaration) {\n        var consumer = isDeclaration ? consumeDeclaration : consumeRule;\n\n        var start = this.scanner.tokenStart;\n        var children = this.createList();\n\n        this.eat(LEFTCURLYBRACKET);\n\n        scan:\n        while (!this.scanner.eof) {\n            switch (this.scanner.tokenType) {\n                case RIGHTCURLYBRACKET:\n                    break scan;\n\n                case WHITESPACE:\n                case COMMENT:\n                    this.scanner.next();\n                    break;\n\n                case ATKEYWORD:\n                    children.push(this.parseWithFallback(this.Atrule, consumeRaw));\n                    break;\n\n                default:\n                    children.push(consumer.call(this));\n            }\n        }\n\n        if (!this.scanner.eof) {\n            this.eat(RIGHTCURLYBRACKET);\n        }\n\n        return {\n            type: 'Block',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.chunk('{');\n        this.children(node, function(prev) {\n            if (prev.type === 'Declaration') {\n                this.chunk(';');\n            }\n        });\n        this.chunk('}');\n    },\n    walkContext: 'block'\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar LEFTSQUAREBRACKET = TYPE.LeftSquareBracket;\nvar RIGHTSQUAREBRACKET = TYPE.RightSquareBracket;\n\nmodule.exports = {\n    name: 'Brackets',\n    structure: {\n        children: [[]]\n    },\n    parse: function(readSequence, recognizer) {\n        var start = this.scanner.tokenStart;\n        var children = null;\n\n        this.eat(LEFTSQUAREBRACKET);\n\n        children = readSequence.call(this, recognizer);\n\n        if (!this.scanner.eof) {\n            this.eat(RIGHTSQUAREBRACKET);\n        }\n\n        return {\n            type: 'Brackets',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.chunk('[');\n        this.children(node);\n        this.chunk(']');\n    }\n};\n","var CDC = require('../../tokenizer').TYPE.CDC;\n\nmodule.exports = {\n    name: 'CDC',\n    structure: [],\n    parse: function() {\n        var start = this.scanner.tokenStart;\n\n        this.eat(CDC); // -->\n\n        return {\n            type: 'CDC',\n            loc: this.getLocation(start, this.scanner.tokenStart)\n        };\n    },\n    generate: function() {\n        this.chunk('-->');\n    }\n};\n","var CDO = require('../../tokenizer').TYPE.CDO;\n\nmodule.exports = {\n    name: 'CDO',\n    structure: [],\n    parse: function() {\n        var start = this.scanner.tokenStart;\n\n        this.eat(CDO); // <!--\n\n        return {\n            type: 'CDO',\n            loc: this.getLocation(start, this.scanner.tokenStart)\n        };\n    },\n    generate: function() {\n        this.chunk('<!--');\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar IDENT = TYPE.Ident;\nvar FULLSTOP = 0x002E; // U+002E FULL STOP (.)\n\n// '.' ident\nmodule.exports = {\n    name: 'ClassSelector',\n    structure: {\n        name: String\n    },\n    parse: function() {\n        if (!this.scanner.isDelim(FULLSTOP)) {\n            this.error('Full stop is expected');\n        }\n\n        this.scanner.next();\n\n        return {\n            type: 'ClassSelector',\n            loc: this.getLocation(this.scanner.tokenStart - 1, this.scanner.tokenEnd),\n            name: this.consume(IDENT)\n        };\n    },\n    generate: function(node) {\n        this.chunk('.');\n        this.chunk(node.name);\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar IDENT = TYPE.Ident;\nvar PLUSSIGN = 0x002B;        // U+002B PLUS SIGN (+)\nvar SOLIDUS = 0x002F;         // U+002F SOLIDUS (/)\nvar GREATERTHANSIGN = 0x003E; // U+003E GREATER-THAN SIGN (>)\nvar TILDE = 0x007E;           // U+007E TILDE (~)\n\n// + | > | ~ | /deep/\nmodule.exports = {\n    name: 'Combinator',\n    structure: {\n        name: String\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var code = this.scanner.source.charCodeAt(this.scanner.tokenStart);\n\n        switch (code) {\n            case GREATERTHANSIGN:\n            case PLUSSIGN:\n            case TILDE:\n                this.scanner.next();\n                break;\n\n            case SOLIDUS:\n                this.scanner.next();\n\n                if (this.scanner.tokenType !== IDENT || this.scanner.lookupValue(0, 'deep') === false) {\n                    this.error('Identifier `deep` is expected');\n                }\n\n                this.scanner.next();\n\n                if (!this.scanner.isDelim(SOLIDUS)) {\n                    this.error('Solidus is expected');\n                }\n\n                this.scanner.next();\n                break;\n\n            default:\n                this.error('Combinator is expected');\n        }\n\n        return {\n            type: 'Combinator',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            name: this.scanner.substrToCursor(start)\n        };\n    },\n    generate: function(node) {\n        this.chunk(node.name);\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar COMMENT = TYPE.Comment;\nvar ASTERISK = 0x002A;        // U+002A ASTERISK (*)\nvar SOLIDUS = 0x002F;         // U+002F SOLIDUS (/)\n\n// '/*' .* '*/'\nmodule.exports = {\n    name: 'Comment',\n    structure: {\n        value: String\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var end = this.scanner.tokenEnd;\n\n        this.eat(COMMENT);\n\n        if ((end - start + 2) >= 2 &&\n            this.scanner.source.charCodeAt(end - 2) === ASTERISK &&\n            this.scanner.source.charCodeAt(end - 1) === SOLIDUS) {\n            end -= 2;\n        }\n\n        return {\n            type: 'Comment',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            value: this.scanner.source.substring(start + 2, end)\n        };\n    },\n    generate: function(node) {\n        this.chunk('/*');\n        this.chunk(node.value);\n        this.chunk('*/');\n    }\n};\n","var isCustomProperty = require('../../utils/names').isCustomProperty;\nvar TYPE = require('../../tokenizer').TYPE;\nvar rawMode = require('./Raw').mode;\n\nvar IDENT = TYPE.Ident;\nvar HASH = TYPE.Hash;\nvar COLON = TYPE.Colon;\nvar SEMICOLON = TYPE.Semicolon;\nvar DELIM = TYPE.Delim;\nvar WHITESPACE = TYPE.WhiteSpace;\nvar EXCLAMATIONMARK = 0x0021; // U+0021 EXCLAMATION MARK (!)\nvar NUMBERSIGN = 0x0023;      // U+0023 NUMBER SIGN (#)\nvar DOLLARSIGN = 0x0024;      // U+0024 DOLLAR SIGN ($)\nvar AMPERSAND = 0x0026;       // U+0026 ANPERSAND (&)\nvar ASTERISK = 0x002A;        // U+002A ASTERISK (*)\nvar PLUSSIGN = 0x002B;        // U+002B PLUS SIGN (+)\nvar SOLIDUS = 0x002F;         // U+002F SOLIDUS (/)\n\nfunction consumeValueRaw(startToken) {\n    return this.Raw(startToken, rawMode.exclamationMarkOrSemicolon, true);\n}\n\nfunction consumeCustomPropertyRaw(startToken) {\n    return this.Raw(startToken, rawMode.exclamationMarkOrSemicolon, false);\n}\n\nfunction consumeValue() {\n    var startValueToken = this.scanner.tokenIndex;\n    var value = this.Value();\n\n    if (value.type !== 'Raw' &&\n        this.scanner.eof === false &&\n        this.scanner.tokenType !== SEMICOLON &&\n        this.scanner.isDelim(EXCLAMATIONMARK) === false &&\n        this.scanner.isBalanceEdge(startValueToken) === false) {\n        this.error();\n    }\n\n    return value;\n}\n\nmodule.exports = {\n    name: 'Declaration',\n    structure: {\n        important: [Boolean, String],\n        property: String,\n        value: ['Value', 'Raw']\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var startToken = this.scanner.tokenIndex;\n        var property = readProperty.call(this);\n        var customProperty = isCustomProperty(property);\n        var parseValue = customProperty ? this.parseCustomProperty : this.parseValue;\n        var consumeRaw = customProperty ? consumeCustomPropertyRaw : consumeValueRaw;\n        var important = false;\n        var value;\n\n        this.scanner.skipSC();\n        this.eat(COLON);\n\n        const valueStart = this.scanner.tokenIndex;\n\n        if (!customProperty) {\n            this.scanner.skipSC();\n        }\n\n        if (parseValue) {\n            value = this.parseWithFallback(consumeValue, consumeRaw);\n        } else {\n            value = consumeRaw.call(this, this.scanner.tokenIndex);\n        }\n\n        if (customProperty && value.type === 'Value' && value.children.isEmpty()) {\n            for (let offset = valueStart - this.scanner.tokenIndex; offset <= 0; offset++) {\n                if (this.scanner.lookupType(offset) === WHITESPACE) {\n                    value.children.appendData({\n                        type: 'WhiteSpace',\n                        loc: null,\n                        value: ' '\n                    });\n                    break;\n                }\n            }\n        }\n\n        if (this.scanner.isDelim(EXCLAMATIONMARK)) {\n            important = getImportant.call(this);\n            this.scanner.skipSC();\n        }\n\n        // Do not include semicolon to range per spec\n        // https://drafts.csswg.org/css-syntax/#declaration-diagram\n\n        if (this.scanner.eof === false &&\n            this.scanner.tokenType !== SEMICOLON &&\n            this.scanner.isBalanceEdge(startToken) === false) {\n            this.error();\n        }\n\n        return {\n            type: 'Declaration',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            important: important,\n            property: property,\n            value: value\n        };\n    },\n    generate: function(node) {\n        this.chunk(node.property);\n        this.chunk(':');\n        this.node(node.value);\n\n        if (node.important) {\n            this.chunk(node.important === true ? '!important' : '!' + node.important);\n        }\n    },\n    walkContext: 'declaration'\n};\n\nfunction readProperty() {\n    var start = this.scanner.tokenStart;\n    var prefix = 0;\n\n    // hacks\n    if (this.scanner.tokenType === DELIM) {\n        switch (this.scanner.source.charCodeAt(this.scanner.tokenStart)) {\n            case ASTERISK:\n            case DOLLARSIGN:\n            case PLUSSIGN:\n            case NUMBERSIGN:\n            case AMPERSAND:\n                this.scanner.next();\n                break;\n\n            // TODO: not sure we should support this hack\n            case SOLIDUS:\n                this.scanner.next();\n                if (this.scanner.isDelim(SOLIDUS)) {\n                    this.scanner.next();\n                }\n                break;\n        }\n    }\n\n    if (prefix) {\n        this.scanner.skip(prefix);\n    }\n\n    if (this.scanner.tokenType === HASH) {\n        this.eat(HASH);\n    } else {\n        this.eat(IDENT);\n    }\n\n    return this.scanner.substrToCursor(start);\n}\n\n// ! ws* important\nfunction getImportant() {\n    this.eat(DELIM);\n    this.scanner.skipSC();\n\n    var important = this.consume(IDENT);\n\n    // store original value in case it differ from `important`\n    // for better original source restoring and hacks like `!ie` support\n    return important === 'important' ? true : important;\n}\n","var TYPE = require('../../tokenizer').TYPE;\nvar rawMode = require('./Raw').mode;\n\nvar WHITESPACE = TYPE.WhiteSpace;\nvar COMMENT = TYPE.Comment;\nvar SEMICOLON = TYPE.Semicolon;\n\nfunction consumeRaw(startToken) {\n    return this.Raw(startToken, rawMode.semicolonIncluded, true);\n}\n\nmodule.exports = {\n    name: 'DeclarationList',\n    structure: {\n        children: [[\n            'Declaration'\n        ]]\n    },\n    parse: function() {\n        var children = this.createList();\n\n        scan:\n        while (!this.scanner.eof) {\n            switch (this.scanner.tokenType) {\n                case WHITESPACE:\n                case COMMENT:\n                case SEMICOLON:\n                    this.scanner.next();\n                    break;\n\n                default:\n                    children.push(this.parseWithFallback(this.Declaration, consumeRaw));\n            }\n        }\n\n        return {\n            type: 'DeclarationList',\n            loc: this.getLocationFromList(children),\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.children(node, function(prev) {\n            if (prev.type === 'Declaration') {\n                this.chunk(';');\n            }\n        });\n    }\n};\n","var consumeNumber = require('../../tokenizer/utils').consumeNumber;\nvar TYPE = require('../../tokenizer').TYPE;\n\nvar DIMENSION = TYPE.Dimension;\n\nmodule.exports = {\n    name: 'Dimension',\n    structure: {\n        value: String,\n        unit: String\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var numberEnd = consumeNumber(this.scanner.source, start);\n\n        this.eat(DIMENSION);\n\n        return {\n            type: 'Dimension',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            value: this.scanner.source.substring(start, numberEnd),\n            unit: this.scanner.source.substring(numberEnd, this.scanner.tokenStart)\n        };\n    },\n    generate: function(node) {\n        this.chunk(node.value);\n        this.chunk(node.unit);\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar RIGHTPARENTHESIS = TYPE.RightParenthesis;\n\n// <function-token> <sequence> )\nmodule.exports = {\n    name: 'Function',\n    structure: {\n        name: String,\n        children: [[]]\n    },\n    parse: function(readSequence, recognizer) {\n        var start = this.scanner.tokenStart;\n        var name = this.consumeFunctionName();\n        var nameLowerCase = name.toLowerCase();\n        var children;\n\n        children = recognizer.hasOwnProperty(nameLowerCase)\n            ? recognizer[nameLowerCase].call(this, recognizer)\n            : readSequence.call(this, recognizer);\n\n        if (!this.scanner.eof) {\n            this.eat(RIGHTPARENTHESIS);\n        }\n\n        return {\n            type: 'Function',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            name: name,\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.chunk(node.name);\n        this.chunk('(');\n        this.children(node);\n        this.chunk(')');\n    },\n    walkContext: 'function'\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar HASH = TYPE.Hash;\n\n// '#' ident\nmodule.exports = {\n    name: 'Hash',\n    structure: {\n        value: String\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n\n        this.eat(HASH);\n\n        return {\n            type: 'Hash',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            value: this.scanner.substrToCursor(start + 1)\n        };\n    },\n    generate: function(node) {\n        this.chunk('#');\n        this.chunk(node.value);\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar IDENT = TYPE.Ident;\n\nmodule.exports = {\n    name: 'Identifier',\n    structure: {\n        name: String\n    },\n    parse: function() {\n        return {\n            type: 'Identifier',\n            loc: this.getLocation(this.scanner.tokenStart, this.scanner.tokenEnd),\n            name: this.consume(IDENT)\n        };\n    },\n    generate: function(node) {\n        this.chunk(node.name);\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar HASH = TYPE.Hash;\n\n// <hash-token>\nmodule.exports = {\n    name: 'IdSelector',\n    structure: {\n        name: String\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n\n        // TODO: check value is an ident\n        this.eat(HASH);\n\n        return {\n            type: 'IdSelector',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            name: this.scanner.substrToCursor(start + 1)\n        };\n    },\n    generate: function(node) {\n        this.chunk('#');\n        this.chunk(node.name);\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar IDENT = TYPE.Ident;\nvar NUMBER = TYPE.Number;\nvar DIMENSION = TYPE.Dimension;\nvar LEFTPARENTHESIS = TYPE.LeftParenthesis;\nvar RIGHTPARENTHESIS = TYPE.RightParenthesis;\nvar COLON = TYPE.Colon;\nvar DELIM = TYPE.Delim;\n\nmodule.exports = {\n    name: 'MediaFeature',\n    structure: {\n        name: String,\n        value: ['Identifier', 'Number', 'Dimension', 'Ratio', null]\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var name;\n        var value = null;\n\n        this.eat(LEFTPARENTHESIS);\n        this.scanner.skipSC();\n\n        name = this.consume(IDENT);\n        this.scanner.skipSC();\n\n        if (this.scanner.tokenType !== RIGHTPARENTHESIS) {\n            this.eat(COLON);\n            this.scanner.skipSC();\n\n            switch (this.scanner.tokenType) {\n                case NUMBER:\n                    if (this.lookupNonWSType(1) === DELIM) {\n                        value = this.Ratio();\n                    } else {\n                        value = this.Number();\n                    }\n\n                    break;\n\n                case DIMENSION:\n                    value = this.Dimension();\n                    break;\n\n                case IDENT:\n                    value = this.Identifier();\n\n                    break;\n\n                default:\n                    this.error('Number, dimension, ratio or identifier is expected');\n            }\n\n            this.scanner.skipSC();\n        }\n\n        this.eat(RIGHTPARENTHESIS);\n\n        return {\n            type: 'MediaFeature',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            name: name,\n            value: value\n        };\n    },\n    generate: function(node) {\n        this.chunk('(');\n        this.chunk(node.name);\n        if (node.value !== null) {\n            this.chunk(':');\n            this.node(node.value);\n        }\n        this.chunk(')');\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar WHITESPACE = TYPE.WhiteSpace;\nvar COMMENT = TYPE.Comment;\nvar IDENT = TYPE.Ident;\nvar LEFTPARENTHESIS = TYPE.LeftParenthesis;\n\nmodule.exports = {\n    name: 'MediaQuery',\n    structure: {\n        children: [[\n            'Identifier',\n            'MediaFeature',\n            'WhiteSpace'\n        ]]\n    },\n    parse: function() {\n        this.scanner.skipSC();\n\n        var children = this.createList();\n        var child = null;\n        var space = null;\n\n        scan:\n        while (!this.scanner.eof) {\n            switch (this.scanner.tokenType) {\n                case COMMENT:\n                    this.scanner.next();\n                    continue;\n\n                case WHITESPACE:\n                    space = this.WhiteSpace();\n                    continue;\n\n                case IDENT:\n                    child = this.Identifier();\n                    break;\n\n                case LEFTPARENTHESIS:\n                    child = this.MediaFeature();\n                    break;\n\n                default:\n                    break scan;\n            }\n\n            if (space !== null) {\n                children.push(space);\n                space = null;\n            }\n\n            children.push(child);\n        }\n\n        if (child === null) {\n            this.error('Identifier or parenthesis is expected');\n        }\n\n        return {\n            type: 'MediaQuery',\n            loc: this.getLocationFromList(children),\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.children(node);\n    }\n};\n","var COMMA = require('../../tokenizer').TYPE.Comma;\n\nmodule.exports = {\n    name: 'MediaQueryList',\n    structure: {\n        children: [[\n            'MediaQuery'\n        ]]\n    },\n    parse: function(relative) {\n        var children = this.createList();\n\n        this.scanner.skipSC();\n\n        while (!this.scanner.eof) {\n            children.push(this.MediaQuery(relative));\n\n            if (this.scanner.tokenType !== COMMA) {\n                break;\n            }\n\n            this.scanner.next();\n        }\n\n        return {\n            type: 'MediaQueryList',\n            loc: this.getLocationFromList(children),\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.children(node, function() {\n            this.chunk(',');\n        });\n    }\n};\n","module.exports = {\n    name: 'Nth',\n    structure: {\n        nth: ['AnPlusB', 'Identifier'],\n        selector: ['SelectorList', null]\n    },\n    parse: function(allowOfClause) {\n        this.scanner.skipSC();\n\n        var start = this.scanner.tokenStart;\n        var end = start;\n        var selector = null;\n        var query;\n\n        if (this.scanner.lookupValue(0, 'odd') || this.scanner.lookupValue(0, 'even')) {\n            query = this.Identifier();\n        } else {\n            query = this.AnPlusB();\n        }\n\n        this.scanner.skipSC();\n\n        if (allowOfClause && this.scanner.lookupValue(0, 'of')) {\n            this.scanner.next();\n\n            selector = this.SelectorList();\n\n            if (this.needPositions) {\n                end = this.getLastListNode(selector.children).loc.end.offset;\n            }\n        } else {\n            if (this.needPositions) {\n                end = query.loc.end.offset;\n            }\n        }\n\n        return {\n            type: 'Nth',\n            loc: this.getLocation(start, end),\n            nth: query,\n            selector: selector\n        };\n    },\n    generate: function(node) {\n        this.node(node.nth);\n        if (node.selector !== null) {\n            this.chunk(' of ');\n            this.node(node.selector);\n        }\n    }\n};\n","var NUMBER = require('../../tokenizer').TYPE.Number;\n\nmodule.exports = {\n    name: 'Number',\n    structure: {\n        value: String\n    },\n    parse: function() {\n        return {\n            type: 'Number',\n            loc: this.getLocation(this.scanner.tokenStart, this.scanner.tokenEnd),\n            value: this.consume(NUMBER)\n        };\n    },\n    generate: function(node) {\n        this.chunk(node.value);\n    }\n};\n","// '/' | '*' | ',' | ':' | '+' | '-'\nmodule.exports = {\n    name: 'Operator',\n    structure: {\n        value: String\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n\n        this.scanner.next();\n\n        return {\n            type: 'Operator',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            value: this.scanner.substrToCursor(start)\n        };\n    },\n    generate: function(node) {\n        this.chunk(node.value);\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar LEFTPARENTHESIS = TYPE.LeftParenthesis;\nvar RIGHTPARENTHESIS = TYPE.RightParenthesis;\n\nmodule.exports = {\n    name: 'Parentheses',\n    structure: {\n        children: [[]]\n    },\n    parse: function(readSequence, recognizer) {\n        var start = this.scanner.tokenStart;\n        var children = null;\n\n        this.eat(LEFTPARENTHESIS);\n\n        children = readSequence.call(this, recognizer);\n\n        if (!this.scanner.eof) {\n            this.eat(RIGHTPARENTHESIS);\n        }\n\n        return {\n            type: 'Parentheses',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.chunk('(');\n        this.children(node);\n        this.chunk(')');\n    }\n};\n","var consumeNumber = require('../../tokenizer/utils').consumeNumber;\nvar TYPE = require('../../tokenizer').TYPE;\n\nvar PERCENTAGE = TYPE.Percentage;\n\nmodule.exports = {\n    name: 'Percentage',\n    structure: {\n        value: String\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var numberEnd = consumeNumber(this.scanner.source, start);\n\n        this.eat(PERCENTAGE);\n\n        return {\n            type: 'Percentage',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            value: this.scanner.source.substring(start, numberEnd)\n        };\n    },\n    generate: function(node) {\n        this.chunk(node.value);\n        this.chunk('%');\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar IDENT = TYPE.Ident;\nvar FUNCTION = TYPE.Function;\nvar COLON = TYPE.Colon;\nvar RIGHTPARENTHESIS = TYPE.RightParenthesis;\n\n// : [ <ident> | <function-token> <any-value>? ) ]\nmodule.exports = {\n    name: 'PseudoClassSelector',\n    structure: {\n        name: String,\n        children: [['Raw'], null]\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var children = null;\n        var name;\n        var nameLowerCase;\n\n        this.eat(COLON);\n\n        if (this.scanner.tokenType === FUNCTION) {\n            name = this.consumeFunctionName();\n            nameLowerCase = name.toLowerCase();\n\n            if (this.pseudo.hasOwnProperty(nameLowerCase)) {\n                this.scanner.skipSC();\n                children = this.pseudo[nameLowerCase].call(this);\n                this.scanner.skipSC();\n            } else {\n                children = this.createList();\n                children.push(\n                    this.Raw(this.scanner.tokenIndex, null, false)\n                );\n            }\n\n            this.eat(RIGHTPARENTHESIS);\n        } else {\n            name = this.consume(IDENT);\n        }\n\n        return {\n            type: 'PseudoClassSelector',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            name: name,\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.chunk(':');\n        this.chunk(node.name);\n\n        if (node.children !== null) {\n            this.chunk('(');\n            this.children(node);\n            this.chunk(')');\n        }\n    },\n    walkContext: 'function'\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar IDENT = TYPE.Ident;\nvar FUNCTION = TYPE.Function;\nvar COLON = TYPE.Colon;\nvar RIGHTPARENTHESIS = TYPE.RightParenthesis;\n\n// :: [ <ident> | <function-token> <any-value>? ) ]\nmodule.exports = {\n    name: 'PseudoElementSelector',\n    structure: {\n        name: String,\n        children: [['Raw'], null]\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var children = null;\n        var name;\n        var nameLowerCase;\n\n        this.eat(COLON);\n        this.eat(COLON);\n\n        if (this.scanner.tokenType === FUNCTION) {\n            name = this.consumeFunctionName();\n            nameLowerCase = name.toLowerCase();\n\n            if (this.pseudo.hasOwnProperty(nameLowerCase)) {\n                this.scanner.skipSC();\n                children = this.pseudo[nameLowerCase].call(this);\n                this.scanner.skipSC();\n            } else {\n                children = this.createList();\n                children.push(\n                    this.Raw(this.scanner.tokenIndex, null, false)\n                );\n            }\n\n            this.eat(RIGHTPARENTHESIS);\n        } else {\n            name = this.consume(IDENT);\n        }\n\n        return {\n            type: 'PseudoElementSelector',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            name: name,\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.chunk('::');\n        this.chunk(node.name);\n\n        if (node.children !== null) {\n            this.chunk('(');\n            this.children(node);\n            this.chunk(')');\n        }\n    },\n    walkContext: 'function'\n};\n","var isDigit = require('../../tokenizer').isDigit;\nvar TYPE = require('../../tokenizer').TYPE;\n\nvar NUMBER = TYPE.Number;\nvar DELIM = TYPE.Delim;\nvar SOLIDUS = 0x002F;  // U+002F SOLIDUS (/)\nvar FULLSTOP = 0x002E; // U+002E FULL STOP (.)\n\n// Terms of <ratio> should be a positive numbers (not zero or negative)\n// (see https://drafts.csswg.org/mediaqueries-3/#values)\n// However, -o-min-device-pixel-ratio takes fractional values as a ratio's term\n// and this is using by various sites. Therefore we relax checking on parse\n// to test a term is unsigned number without an exponent part.\n// Additional checking may be applied on lexer validation.\nfunction consumeNumber() {\n    this.scanner.skipWS();\n\n    var value = this.consume(NUMBER);\n\n    for (var i = 0; i < value.length; i++) {\n        var code = value.charCodeAt(i);\n        if (!isDigit(code) && code !== FULLSTOP) {\n            this.error('Unsigned number is expected', this.scanner.tokenStart - value.length + i);\n        }\n    }\n\n    if (Number(value) === 0) {\n        this.error('Zero number is not allowed', this.scanner.tokenStart - value.length);\n    }\n\n    return value;\n}\n\n// <positive-integer> S* '/' S* <positive-integer>\nmodule.exports = {\n    name: 'Ratio',\n    structure: {\n        left: String,\n        right: String\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var left = consumeNumber.call(this);\n        var right;\n\n        this.scanner.skipWS();\n\n        if (!this.scanner.isDelim(SOLIDUS)) {\n            this.error('Solidus is expected');\n        }\n        this.eat(DELIM);\n        right = consumeNumber.call(this);\n\n        return {\n            type: 'Ratio',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            left: left,\n            right: right\n        };\n    },\n    generate: function(node) {\n        this.chunk(node.left);\n        this.chunk('/');\n        this.chunk(node.right);\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\nvar rawMode = require('./Raw').mode;\n\nvar LEFTCURLYBRACKET = TYPE.LeftCurlyBracket;\n\nfunction consumeRaw(startToken) {\n    return this.Raw(startToken, rawMode.leftCurlyBracket, true);\n}\n\nfunction consumePrelude() {\n    var prelude = this.SelectorList();\n\n    if (prelude.type !== 'Raw' &&\n        this.scanner.eof === false &&\n        this.scanner.tokenType !== LEFTCURLYBRACKET) {\n        this.error();\n    }\n\n    return prelude;\n}\n\nmodule.exports = {\n    name: 'Rule',\n    structure: {\n        prelude: ['SelectorList', 'Raw'],\n        block: ['Block']\n    },\n    parse: function() {\n        var startToken = this.scanner.tokenIndex;\n        var startOffset = this.scanner.tokenStart;\n        var prelude;\n        var block;\n\n        if (this.parseRulePrelude) {\n            prelude = this.parseWithFallback(consumePrelude, consumeRaw);\n        } else {\n            prelude = consumeRaw.call(this, startToken);\n        }\n\n        block = this.Block(true);\n\n        return {\n            type: 'Rule',\n            loc: this.getLocation(startOffset, this.scanner.tokenStart),\n            prelude: prelude,\n            block: block\n        };\n    },\n    generate: function(node) {\n        this.node(node.prelude);\n        this.node(node.block);\n    },\n    walkContext: 'rule'\n};\n","module.exports = {\n    name: 'Selector',\n    structure: {\n        children: [[\n            'TypeSelector',\n            'IdSelector',\n            'ClassSelector',\n            'AttributeSelector',\n            'PseudoClassSelector',\n            'PseudoElementSelector',\n            'Combinator',\n            'WhiteSpace'\n        ]]\n    },\n    parse: function() {\n        var children = this.readSequence(this.scope.Selector);\n\n        // nothing were consumed\n        if (this.getFirstListNode(children) === null) {\n            this.error('Selector is expected');\n        }\n\n        return {\n            type: 'Selector',\n            loc: this.getLocationFromList(children),\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.children(node);\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar COMMA = TYPE.Comma;\n\nmodule.exports = {\n    name: 'SelectorList',\n    structure: {\n        children: [[\n            'Selector',\n            'Raw'\n        ]]\n    },\n    parse: function() {\n        var children = this.createList();\n\n        while (!this.scanner.eof) {\n            children.push(this.Selector());\n\n            if (this.scanner.tokenType === COMMA) {\n                this.scanner.next();\n                continue;\n            }\n\n            break;\n        }\n\n        return {\n            type: 'SelectorList',\n            loc: this.getLocationFromList(children),\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.children(node, function() {\n            this.chunk(',');\n        });\n    },\n    walkContext: 'selector'\n};\n","var STRING = require('../../tokenizer').TYPE.String;\n\nmodule.exports = {\n    name: 'String',\n    structure: {\n        value: String\n    },\n    parse: function() {\n        return {\n            type: 'String',\n            loc: this.getLocation(this.scanner.tokenStart, this.scanner.tokenEnd),\n            value: this.consume(STRING)\n        };\n    },\n    generate: function(node) {\n        this.chunk(node.value);\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar WHITESPACE = TYPE.WhiteSpace;\nvar COMMENT = TYPE.Comment;\nvar ATKEYWORD = TYPE.AtKeyword;\nvar CDO = TYPE.CDO;\nvar CDC = TYPE.CDC;\nvar EXCLAMATIONMARK = 0x0021; // U+0021 EXCLAMATION MARK (!)\n\nfunction consumeRaw(startToken) {\n    return this.Raw(startToken, null, false);\n}\n\nmodule.exports = {\n    name: 'StyleSheet',\n    structure: {\n        children: [[\n            'Comment',\n            'CDO',\n            'CDC',\n            'Atrule',\n            'Rule',\n            'Raw'\n        ]]\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var children = this.createList();\n        var child;\n\n        scan:\n        while (!this.scanner.eof) {\n            switch (this.scanner.tokenType) {\n                case WHITESPACE:\n                    this.scanner.next();\n                    continue;\n\n                case COMMENT:\n                    // ignore comments except exclamation comments (i.e. /*! .. */) on top level\n                    if (this.scanner.source.charCodeAt(this.scanner.tokenStart + 2) !== EXCLAMATIONMARK) {\n                        this.scanner.next();\n                        continue;\n                    }\n\n                    child = this.Comment();\n                    break;\n\n                case CDO: // <!--\n                    child = this.CDO();\n                    break;\n\n                case CDC: // -->\n                    child = this.CDC();\n                    break;\n\n                // CSS Syntax Module Level 3\n                // §2.2 Error handling\n                // At the \"top level\" of a stylesheet, an <at-keyword-token> starts an at-rule.\n                case ATKEYWORD:\n                    child = this.parseWithFallback(this.Atrule, consumeRaw);\n                    break;\n\n                // Anything else starts a qualified rule ...\n                default:\n                    child = this.parseWithFallback(this.Rule, consumeRaw);\n            }\n\n            children.push(child);\n        }\n\n        return {\n            type: 'StyleSheet',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.children(node);\n    },\n    walkContext: 'stylesheet'\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar IDENT = TYPE.Ident;\nvar ASTERISK = 0x002A;     // U+002A ASTERISK (*)\nvar VERTICALLINE = 0x007C; // U+007C VERTICAL LINE (|)\n\nfunction eatIdentifierOrAsterisk() {\n    if (this.scanner.tokenType !== IDENT &&\n        this.scanner.isDelim(ASTERISK) === false) {\n        this.error('Identifier or asterisk is expected');\n    }\n\n    this.scanner.next();\n}\n\n// ident\n// ident|ident\n// ident|*\n// *\n// *|ident\n// *|*\n// |ident\n// |*\nmodule.exports = {\n    name: 'TypeSelector',\n    structure: {\n        name: String\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n\n        if (this.scanner.isDelim(VERTICALLINE)) {\n            this.scanner.next();\n            eatIdentifierOrAsterisk.call(this);\n        } else {\n            eatIdentifierOrAsterisk.call(this);\n\n            if (this.scanner.isDelim(VERTICALLINE)) {\n                this.scanner.next();\n                eatIdentifierOrAsterisk.call(this);\n            }\n        }\n\n        return {\n            type: 'TypeSelector',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            name: this.scanner.substrToCursor(start)\n        };\n    },\n    generate: function(node) {\n        this.chunk(node.name);\n    }\n};\n","var isHexDigit = require('../../tokenizer').isHexDigit;\nvar cmpChar = require('../../tokenizer').cmpChar;\nvar TYPE = require('../../tokenizer').TYPE;\nvar NAME = require('../../tokenizer').NAME;\n\nvar IDENT = TYPE.Ident;\nvar NUMBER = TYPE.Number;\nvar DIMENSION = TYPE.Dimension;\nvar PLUSSIGN = 0x002B;     // U+002B PLUS SIGN (+)\nvar HYPHENMINUS = 0x002D;  // U+002D HYPHEN-MINUS (-)\nvar QUESTIONMARK = 0x003F; // U+003F QUESTION MARK (?)\nvar U = 0x0075;            // U+0075 LATIN SMALL LETTER U (u)\n\nfunction eatHexSequence(offset, allowDash) {\n    for (var pos = this.scanner.tokenStart + offset, len = 0; pos < this.scanner.tokenEnd; pos++) {\n        var code = this.scanner.source.charCodeAt(pos);\n\n        if (code === HYPHENMINUS && allowDash && len !== 0) {\n            if (eatHexSequence.call(this, offset + len + 1, false) === 0) {\n                this.error();\n            }\n\n            return -1;\n        }\n\n        if (!isHexDigit(code)) {\n            this.error(\n                allowDash && len !== 0\n                    ? 'HyphenMinus' + (len < 6 ? ' or hex digit' : '') + ' is expected'\n                    : (len < 6 ? 'Hex digit is expected' : 'Unexpected input'),\n                pos\n            );\n        }\n\n        if (++len > 6) {\n            this.error('Too many hex digits', pos);\n        };\n    }\n\n    this.scanner.next();\n    return len;\n}\n\nfunction eatQuestionMarkSequence(max) {\n    var count = 0;\n\n    while (this.scanner.isDelim(QUESTIONMARK)) {\n        if (++count > max) {\n            this.error('Too many question marks');\n        }\n\n        this.scanner.next();\n    }\n}\n\nfunction startsWith(code) {\n    if (this.scanner.source.charCodeAt(this.scanner.tokenStart) !== code) {\n        this.error(NAME[code] + ' is expected');\n    }\n}\n\n// https://drafts.csswg.org/css-syntax/#urange\n// Informally, the <urange> production has three forms:\n// U+0001\n//      Defines a range consisting of a single code point, in this case the code point \"1\".\n// U+0001-00ff\n//      Defines a range of codepoints between the first and the second value, in this case\n//      the range between \"1\" and \"ff\" (255 in decimal) inclusive.\n// U+00??\n//      Defines a range of codepoints where the \"?\" characters range over all hex digits,\n//      in this case defining the same as the value U+0000-00ff.\n// In each form, a maximum of 6 digits is allowed for each hexadecimal number (if you treat \"?\" as a hexadecimal digit).\n//\n// <urange> =\n//   u '+' <ident-token> '?'* |\n//   u <dimension-token> '?'* |\n//   u <number-token> '?'* |\n//   u <number-token> <dimension-token> |\n//   u <number-token> <number-token> |\n//   u '+' '?'+\nfunction scanUnicodeRange() {\n    var hexLength = 0;\n\n    // u '+' <ident-token> '?'*\n    // u '+' '?'+\n    if (this.scanner.isDelim(PLUSSIGN)) {\n        this.scanner.next();\n\n        if (this.scanner.tokenType === IDENT) {\n            hexLength = eatHexSequence.call(this, 0, true);\n            if (hexLength > 0) {\n                eatQuestionMarkSequence.call(this, 6 - hexLength);\n            }\n            return;\n        }\n\n        if (this.scanner.isDelim(QUESTIONMARK)) {\n            this.scanner.next();\n            eatQuestionMarkSequence.call(this, 5);\n            return;\n        }\n\n        this.error('Hex digit or question mark is expected');\n        return;\n    }\n\n    // u <number-token> '?'*\n    // u <number-token> <dimension-token>\n    // u <number-token> <number-token>\n    if (this.scanner.tokenType === NUMBER) {\n        startsWith.call(this, PLUSSIGN);\n        hexLength = eatHexSequence.call(this, 1, true);\n\n        if (this.scanner.isDelim(QUESTIONMARK)) {\n            eatQuestionMarkSequence.call(this, 6 - hexLength);\n            return;\n        }\n\n        if (this.scanner.tokenType === DIMENSION ||\n            this.scanner.tokenType === NUMBER) {\n            startsWith.call(this, HYPHENMINUS);\n            eatHexSequence.call(this, 1, false);\n            return;\n        }\n\n        return;\n    }\n\n    // u <dimension-token> '?'*\n    if (this.scanner.tokenType === DIMENSION) {\n        startsWith.call(this, PLUSSIGN);\n        hexLength = eatHexSequence.call(this, 1, true);\n\n        if (hexLength > 0) {\n            eatQuestionMarkSequence.call(this, 6 - hexLength);\n        }\n\n        return;\n    }\n\n    this.error();\n}\n\nmodule.exports = {\n    name: 'UnicodeRange',\n    structure: {\n        value: String\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n\n        // U or u\n        if (!cmpChar(this.scanner.source, start, U)) {\n            this.error('U is expected');\n        }\n\n        if (!cmpChar(this.scanner.source, start + 1, PLUSSIGN)) {\n            this.error('Plus sign is expected');\n        }\n\n        this.scanner.next();\n        scanUnicodeRange.call(this);\n\n        return {\n            type: 'UnicodeRange',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            value: this.scanner.substrToCursor(start)\n        };\n    },\n    generate: function(node) {\n        this.chunk(node.value);\n    }\n};\n","var isWhiteSpace = require('../../tokenizer').isWhiteSpace;\nvar cmpStr = require('../../tokenizer').cmpStr;\nvar TYPE = require('../../tokenizer').TYPE;\n\nvar FUNCTION = TYPE.Function;\nvar URL = TYPE.Url;\nvar RIGHTPARENTHESIS = TYPE.RightParenthesis;\n\n// <url-token> | <function-token> <string> )\nmodule.exports = {\n    name: 'Url',\n    structure: {\n        value: ['String', 'Raw']\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var value;\n\n        switch (this.scanner.tokenType) {\n            case URL:\n                var rawStart = start + 4;\n                var rawEnd = this.scanner.tokenEnd - 1;\n\n                while (rawStart < rawEnd && isWhiteSpace(this.scanner.source.charCodeAt(rawStart))) {\n                    rawStart++;\n                }\n\n                while (rawStart < rawEnd && isWhiteSpace(this.scanner.source.charCodeAt(rawEnd - 1))) {\n                    rawEnd--;\n                }\n\n                value = {\n                    type: 'Raw',\n                    loc: this.getLocation(rawStart, rawEnd),\n                    value: this.scanner.source.substring(rawStart, rawEnd)\n                };\n\n                this.eat(URL);\n                break;\n\n            case FUNCTION:\n                if (!cmpStr(this.scanner.source, this.scanner.tokenStart, this.scanner.tokenEnd, 'url(')) {\n                    this.error('Function name must be `url`');\n                }\n\n                this.eat(FUNCTION);\n                this.scanner.skipSC();\n                value = this.String();\n                this.scanner.skipSC();\n                this.eat(RIGHTPARENTHESIS);\n                break;\n\n            default:\n                this.error('Url or Function is expected');\n        }\n\n        return {\n            type: 'Url',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            value: value\n        };\n    },\n    generate: function(node) {\n        this.chunk('url');\n        this.chunk('(');\n        this.node(node.value);\n        this.chunk(')');\n    }\n};\n","module.exports = {\n    name: 'Value',\n    structure: {\n        children: [[]]\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var children = this.readSequence(this.scope.Value);\n\n        return {\n            type: 'Value',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.children(node);\n    }\n};\n","var WHITESPACE = require('../../tokenizer').TYPE.WhiteSpace;\nvar SPACE = Object.freeze({\n    type: 'WhiteSpace',\n    loc: null,\n    value: ' '\n});\n\nmodule.exports = {\n    name: 'WhiteSpace',\n    structure: {\n        value: String\n    },\n    parse: function() {\n        this.eat(WHITESPACE);\n        return SPACE;\n\n        // return {\n        //     type: 'WhiteSpace',\n        //     loc: this.getLocation(this.scanner.tokenStart, this.scanner.tokenEnd),\n        //     value: this.consume(WHITESPACE)\n        // };\n    },\n    generate: function(node) {\n        this.chunk(node.value);\n    }\n};\n","module.exports = {\n    AnPlusB: require('./AnPlusB'),\n    Atrule: require('./Atrule'),\n    AtrulePrelude: require('./AtrulePrelude'),\n    AttributeSelector: require('./AttributeSelector'),\n    Block: require('./Block'),\n    Brackets: require('./Brackets'),\n    CDC: require('./CDC'),\n    CDO: require('./CDO'),\n    ClassSelector: require('./ClassSelector'),\n    Combinator: require('./Combinator'),\n    Comment: require('./Comment'),\n    Declaration: require('./Declaration'),\n    DeclarationList: require('./DeclarationList'),\n    Dimension: require('./Dimension'),\n    Function: require('./Function'),\n    Hash: require('./Hash'),\n    Identifier: require('./Identifier'),\n    IdSelector: require('./IdSelector'),\n    MediaFeature: require('./MediaFeature'),\n    MediaQuery: require('./MediaQuery'),\n    MediaQueryList: require('./MediaQueryList'),\n    Nth: require('./Nth'),\n    Number: require('./Number'),\n    Operator: require('./Operator'),\n    Parentheses: require('./Parentheses'),\n    Percentage: require('./Percentage'),\n    PseudoClassSelector: require('./PseudoClassSelector'),\n    PseudoElementSelector: require('./PseudoElementSelector'),\n    Ratio: require('./Ratio'),\n    Raw: require('./Raw'),\n    Rule: require('./Rule'),\n    Selector: require('./Selector'),\n    SelectorList: require('./SelectorList'),\n    String: require('./String'),\n    StyleSheet: require('./StyleSheet'),\n    TypeSelector: require('./TypeSelector'),\n    UnicodeRange: require('./UnicodeRange'),\n    Url: require('./Url'),\n    Value: require('./Value'),\n    WhiteSpace: require('./WhiteSpace')\n};\n","var data = require('../../../data');\n\nmodule.exports = {\n    generic: true,\n    types: data.types,\n    atrules: data.atrules,\n    properties: data.properties,\n    node: require('../node')\n};\n","var cmpChar = require('../../tokenizer').cmpChar;\nvar cmpStr = require('../../tokenizer').cmpStr;\nvar TYPE = require('../../tokenizer').TYPE;\n\nvar IDENT = TYPE.Ident;\nvar STRING = TYPE.String;\nvar NUMBER = TYPE.Number;\nvar FUNCTION = TYPE.Function;\nvar URL = TYPE.Url;\nvar HASH = TYPE.Hash;\nvar DIMENSION = TYPE.Dimension;\nvar PERCENTAGE = TYPE.Percentage;\nvar LEFTPARENTHESIS = TYPE.LeftParenthesis;\nvar LEFTSQUAREBRACKET = TYPE.LeftSquareBracket;\nvar COMMA = TYPE.Comma;\nvar DELIM = TYPE.Delim;\nvar NUMBERSIGN = 0x0023;  // U+0023 NUMBER SIGN (#)\nvar ASTERISK = 0x002A;    // U+002A ASTERISK (*)\nvar PLUSSIGN = 0x002B;    // U+002B PLUS SIGN (+)\nvar HYPHENMINUS = 0x002D; // U+002D HYPHEN-MINUS (-)\nvar SOLIDUS = 0x002F;     // U+002F SOLIDUS (/)\nvar U = 0x0075;           // U+0075 LATIN SMALL LETTER U (u)\n\nmodule.exports = function defaultRecognizer(context) {\n    switch (this.scanner.tokenType) {\n        case HASH:\n            return this.Hash();\n\n        case COMMA:\n            context.space = null;\n            context.ignoreWSAfter = true;\n            return this.Operator();\n\n        case LEFTPARENTHESIS:\n            return this.Parentheses(this.readSequence, context.recognizer);\n\n        case LEFTSQUAREBRACKET:\n            return this.Brackets(this.readSequence, context.recognizer);\n\n        case STRING:\n            return this.String();\n\n        case DIMENSION:\n            return this.Dimension();\n\n        case PERCENTAGE:\n            return this.Percentage();\n\n        case NUMBER:\n            return this.Number();\n\n        case FUNCTION:\n            return cmpStr(this.scanner.source, this.scanner.tokenStart, this.scanner.tokenEnd, 'url(')\n                ? this.Url()\n                : this.Function(this.readSequence, context.recognizer);\n\n        case URL:\n            return this.Url();\n\n        case IDENT:\n            // check for unicode range, it should start with u+ or U+\n            if (cmpChar(this.scanner.source, this.scanner.tokenStart, U) &&\n                cmpChar(this.scanner.source, this.scanner.tokenStart + 1, PLUSSIGN)) {\n                return this.UnicodeRange();\n            } else {\n                return this.Identifier();\n            }\n\n        case DELIM:\n            var code = this.scanner.source.charCodeAt(this.scanner.tokenStart);\n\n            if (code === SOLIDUS ||\n                code === ASTERISK ||\n                code === PLUSSIGN ||\n                code === HYPHENMINUS) {\n                return this.Operator(); // TODO: replace with Delim\n            }\n\n            // TODO: produce a node with Delim node type\n\n            if (code === NUMBERSIGN) {\n                this.error('Hex or identifier is expected', this.scanner.tokenStart + 1);\n            }\n\n            break;\n    }\n};\n","module.exports = {\n    getNode: require('./default')\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar DELIM = TYPE.Delim;\nvar IDENT = TYPE.Ident;\nvar DIMENSION = TYPE.Dimension;\nvar PERCENTAGE = TYPE.Percentage;\nvar NUMBER = TYPE.Number;\nvar HASH = TYPE.Hash;\nvar COLON = TYPE.Colon;\nvar LEFTSQUAREBRACKET = TYPE.LeftSquareBracket;\nvar NUMBERSIGN = 0x0023;      // U+0023 NUMBER SIGN (#)\nvar ASTERISK = 0x002A;        // U+002A ASTERISK (*)\nvar PLUSSIGN = 0x002B;        // U+002B PLUS SIGN (+)\nvar SOLIDUS = 0x002F;         // U+002F SOLIDUS (/)\nvar FULLSTOP = 0x002E;        // U+002E FULL STOP (.)\nvar GREATERTHANSIGN = 0x003E; // U+003E GREATER-THAN SIGN (>)\nvar VERTICALLINE = 0x007C;    // U+007C VERTICAL LINE (|)\nvar TILDE = 0x007E;           // U+007E TILDE (~)\n\nfunction getNode(context) {\n    switch (this.scanner.tokenType) {\n        case LEFTSQUAREBRACKET:\n            return this.AttributeSelector();\n\n        case HASH:\n            return this.IdSelector();\n\n        case COLON:\n            if (this.scanner.lookupType(1) === COLON) {\n                return this.PseudoElementSelector();\n            } else {\n                return this.PseudoClassSelector();\n            }\n\n        case IDENT:\n            return this.TypeSelector();\n\n        case NUMBER:\n        case PERCENTAGE:\n            return this.Percentage();\n\n        case DIMENSION:\n            // throws when .123ident\n            if (this.scanner.source.charCodeAt(this.scanner.tokenStart) === FULLSTOP) {\n                this.error('Identifier is expected', this.scanner.tokenStart + 1);\n            }\n            break;\n\n        case DELIM:\n            var code = this.scanner.source.charCodeAt(this.scanner.tokenStart);\n\n            switch (code) {\n                case PLUSSIGN:\n                case GREATERTHANSIGN:\n                case TILDE:\n                    context.space = null;\n                    context.ignoreWSAfter = true;\n                    return this.Combinator();\n\n                case SOLIDUS:  // /deep/\n                    return this.Combinator();\n\n                case FULLSTOP:\n                    return this.ClassSelector();\n\n                case ASTERISK:\n                case VERTICALLINE:\n                    return this.TypeSelector();\n\n                case NUMBERSIGN:\n                    return this.IdSelector();\n            }\n\n            break;\n    }\n};\n\nmodule.exports = {\n    getNode: getNode\n};\n","// legacy IE function\n// expression( <any-value> )\nmodule.exports = function() {\n    return this.createSingleNodeList(\n        this.Raw(this.scanner.tokenIndex, null, false)\n    );\n};\n","var TYPE = require('../../tokenizer').TYPE;\nvar rawMode = require('../node/Raw').mode;\n\nvar COMMA = TYPE.Comma;\nvar WHITESPACE = TYPE.WhiteSpace;\n\n// var( <ident> , <value>? )\nmodule.exports = function() {\n    var children = this.createList();\n\n    this.scanner.skipSC();\n\n    // NOTE: Don't check more than a first argument is an ident, rest checks are for lexer\n    children.push(this.Identifier());\n\n    this.scanner.skipSC();\n\n    if (this.scanner.tokenType === COMMA) {\n        children.push(this.Operator());\n\n        const startIndex = this.scanner.tokenIndex;\n        const value = this.parseCustomProperty\n            ? this.Value(null)\n            : this.Raw(this.scanner.tokenIndex, rawMode.exclamationMarkOrSemicolon, false);\n\n        if (value.type === 'Value' && value.children.isEmpty()) {\n            for (let offset = startIndex - this.scanner.tokenIndex; offset <= 0; offset++) {\n                if (this.scanner.lookupType(offset) === WHITESPACE) {\n                    value.children.appendData({\n                        type: 'WhiteSpace',\n                        loc: null,\n                        value: ' '\n                    });\n                    break;\n                }\n            }\n        }\n\n        children.push(value);\n    }\n\n    return children;\n};\n","module.exports = {\n    getNode: require('./default'),\n    'expression': require('../function/expression'),\n    'var': require('../function/var')\n};\n","module.exports = {\n    AtrulePrelude: require('./atrulePrelude'),\n    Selector: require('./selector'),\n    Value: require('./value')\n};\n","module.exports = {\n    parse: {\n        prelude: null,\n        block: function() {\n            return this.Block(true);\n        }\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar STRING = TYPE.String;\nvar IDENT = TYPE.Ident;\nvar URL = TYPE.Url;\nvar FUNCTION = TYPE.Function;\nvar LEFTPARENTHESIS = TYPE.LeftParenthesis;\n\nmodule.exports = {\n    parse: {\n        prelude: function() {\n            var children = this.createList();\n\n            this.scanner.skipSC();\n\n            switch (this.scanner.tokenType) {\n                case STRING:\n                    children.push(this.String());\n                    break;\n\n                case URL:\n                case FUNCTION:\n                    children.push(this.Url());\n                    break;\n\n                default:\n                    this.error('String or url() is expected');\n            }\n\n            if (this.lookupNonWSType(0) === IDENT ||\n                this.lookupNonWSType(0) === LEFTPARENTHESIS) {\n                children.push(this.WhiteSpace());\n                children.push(this.MediaQueryList());\n            }\n\n            return children;\n        },\n        block: null\n    }\n};\n","module.exports = {\n    parse: {\n        prelude: function() {\n            return this.createSingleNodeList(\n                this.MediaQueryList()\n            );\n        },\n        block: function() {\n            return this.Block(false);\n        }\n    }\n};\n","module.exports = {\n    parse: {\n        prelude: function() {\n            return this.createSingleNodeList(\n                this.SelectorList()\n            );\n        },\n        block: function() {\n            return this.Block(true);\n        }\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar WHITESPACE = TYPE.WhiteSpace;\nvar COMMENT = TYPE.Comment;\nvar IDENT = TYPE.Ident;\nvar FUNCTION = TYPE.Function;\nvar COLON = TYPE.Colon;\nvar LEFTPARENTHESIS = TYPE.LeftParenthesis;\n\nfunction consumeRaw() {\n    return this.createSingleNodeList(\n        this.Raw(this.scanner.tokenIndex, null, false)\n    );\n}\n\nfunction parentheses() {\n    this.scanner.skipSC();\n\n    if (this.scanner.tokenType === IDENT &&\n        this.lookupNonWSType(1) === COLON) {\n        return this.createSingleNodeList(\n            this.Declaration()\n        );\n    }\n\n    return readSequence.call(this);\n}\n\nfunction readSequence() {\n    var children = this.createList();\n    var space = null;\n    var child;\n\n    this.scanner.skipSC();\n\n    scan:\n    while (!this.scanner.eof) {\n        switch (this.scanner.tokenType) {\n            case WHITESPACE:\n                space = this.WhiteSpace();\n                continue;\n\n            case COMMENT:\n                this.scanner.next();\n                continue;\n\n            case FUNCTION:\n                child = this.Function(consumeRaw, this.scope.AtrulePrelude);\n                break;\n\n            case IDENT:\n                child = this.Identifier();\n                break;\n\n            case LEFTPARENTHESIS:\n                child = this.Parentheses(parentheses, this.scope.AtrulePrelude);\n                break;\n\n            default:\n                break scan;\n        }\n\n        if (space !== null) {\n            children.push(space);\n            space = null;\n        }\n\n        children.push(child);\n    }\n\n    return children;\n}\n\nmodule.exports = {\n    parse: {\n        prelude: function() {\n            var children = readSequence.call(this);\n\n            if (this.getFirstListNode(children) === null) {\n                this.error('Condition is expected');\n            }\n\n            return children;\n        },\n        block: function() {\n            return this.Block(false);\n        }\n    }\n};\n","module.exports = {\n    'font-face': require('./font-face'),\n    'import': require('./import'),\n    'media': require('./media'),\n    'page': require('./page'),\n    'supports': require('./supports')\n};\n","module.exports = {\n    parse: function() {\n        return this.createSingleNodeList(\n            this.Identifier()\n        );\n    }\n};\n","module.exports = {\n    parse: function() {\n        return this.createSingleNodeList(\n            this.SelectorList()\n        );\n    }\n};\n","module.exports = {\n    parse: function() {\n        return this.createSingleNodeList(\n            this.Identifier()\n        );\n    }\n};\n","module.exports = {\n    parse: function selectorList() {\n        return this.createSingleNodeList(\n            this.SelectorList()\n        );\n    }\n};\n","module.exports = require('./common/selectorList');\n","module.exports = require('./common/selectorList');\n","var ALLOW_OF_CLAUSE = true;\n\nmodule.exports = {\n    parse: function nthWithOfClause() {\n        return this.createSingleNodeList(\n            this.Nth(ALLOW_OF_CLAUSE)\n        );\n    }\n};\n","module.exports = require('./common/nthWithOfClause');\n","module.exports = require('./common/nthWithOfClause');\n","var DISALLOW_OF_CLAUSE = false;\n\nmodule.exports = {\n    parse: function nth() {\n        return this.createSingleNodeList(\n            this.Nth(DISALLOW_OF_CLAUSE)\n        );\n    }\n};\n","module.exports = require('./common/nth');\n","module.exports = require('./common/nth');\n","module.exports = {\n    parse: function compoundSelector() {\n        return this.createSingleNodeList(\n            this.Selector()\n        );\n    }\n};\n","module.exports = {\n    'dir': require('./dir'),\n    'has': require('./has'),\n    'lang': require('./lang'),\n    'matches': require('./matches'),\n    'not': require('./not'),\n    'nth-child': require('./nth-child'),\n    'nth-last-child': require('./nth-last-child'),\n    'nth-last-of-type': require('./nth-last-of-type'),\n    'nth-of-type': require('./nth-of-type'),\n    'slotted': require('./slotted')\n};\n","module.exports = {\n    parseContext: {\n        default: 'StyleSheet',\n        stylesheet: 'StyleSheet',\n        atrule: 'Atrule',\n        atrulePrelude: function(options) {\n            return this.AtrulePrelude(options.atrule ? String(options.atrule) : null);\n        },\n        mediaQueryList: 'MediaQueryList',\n        mediaQuery: 'MediaQuery',\n        rule: 'Rule',\n        selectorList: 'SelectorList',\n        selector: 'Selector',\n        block: function() {\n            return this.Block(true);\n        },\n        declarationList: 'DeclarationList',\n        declaration: 'Declaration',\n        value: 'Value'\n    },\n    scope: require('../scope'),\n    atrule: require('../atrule'),\n    pseudo: require('../pseudo'),\n    node: require('../node')\n};\n","module.exports = {\n    node: require('../node')\n};\n","function merge() {\n    var dest = {};\n\n    for (var i = 0; i < arguments.length; i++) {\n        var src = arguments[i];\n        for (var key in src) {\n            dest[key] = src[key];\n        }\n    }\n\n    return dest;\n}\n\nmodule.exports = require('./create').create(\n    merge(\n        require('./config/lexer'),\n        require('./config/parser'),\n        require('./config/walker')\n    )\n);\nmodule.exports.version = require('../../package.json').version;\n","module.exports = require('./syntax');\n","import csstree from \"css-tree\";\nimport { UUID } from \"../utils/utils.js\";\nimport Hook from \"../utils/hook.js\";\n\nclass Sheet {\n\tconstructor(url, hooks) {\n\n\t\tif (hooks) {\n\t\t\tthis.hooks = hooks;\n\t\t} else {\n\t\t\tthis.hooks = {};\n\t\t\tthis.hooks.onUrl = new Hook(this);\n\t\t\tthis.hooks.onAtPage = new Hook(this);\n\t\t\tthis.hooks.onAtMedia = new Hook(this);\n\t\t\tthis.hooks.onRule = new Hook(this);\n\t\t\tthis.hooks.onDeclaration = new Hook(this);\n\t\t\tthis.hooks.onSelector = new Hook(this);\n\t\t\tthis.hooks.onPseudoSelector = new Hook(this);\n\n\t\t\tthis.hooks.onContent = new Hook(this);\n\t\t\tthis.hooks.onImport = new Hook(this);\n\n\t\t\tthis.hooks.beforeTreeParse = new Hook(this);\n\t\t\tthis.hooks.beforeTreeWalk = new Hook(this);\n\t\t\tthis.hooks.afterTreeWalk = new Hook(this);\n\t\t}\n\n\t\ttry {\n\t\t\tthis.url = new URL(url, window.location.href);\n\t\t} catch (e) {\n\t\t\tthis.url = new URL(window.location.href);\n\t\t}\n\t}\n\n\n\n\t// parse\n\tasync parse(text) {\n\t\tthis.text = text;\n\n\t\tawait this.hooks.beforeTreeParse.trigger(this.text, this);\n\n\t\t// send to csstree\n\t\tthis.ast = csstree.parse(this._text);\n\n\t\tawait this.hooks.beforeTreeWalk.trigger(this.ast);\n\n\t\t// Replace urls\n\t\tthis.replaceUrls(this.ast);\n\n\t\t// Scope\n\t\tthis.id = UUID();\n\t\t// this.addScope(this.ast, this.uuid);\n\n\t\t// Replace IDs with data-id\n\t\tthis.replaceIds(this.ast);\n\n\t\tthis.imported = [];\n\n\t\t// Trigger Hooks\n\t\tthis.urls(this.ast);\n\t\tthis.rules(this.ast);\n\t\tthis.atrules(this.ast);\n\n\t\tawait this.hooks.afterTreeWalk.trigger(this.ast, this);\n\n\t\t// return ast\n\t\treturn this.ast;\n\t}\n\n\n\n\tinsertRule(rule) {\n\t\tlet inserted = this.ast.children.appendData(rule);\n\n\t\tthis.declarations(rule);\n\n\t\treturn inserted;\n\t}\n\n\turls(ast) {\n\t\tcsstree.walk(ast, {\n\t\t\tvisit: \"Url\",\n\t\t\tenter: (node, item, list) => {\n\t\t\t\tthis.hooks.onUrl.trigger(node, item, list);\n\t\t\t}\n\t\t});\n\t}\n\n\tatrules(ast) {\n\t\tcsstree.walk(ast, {\n\t\t\tvisit: \"Atrule\",\n\t\t\tenter: (node, item, list) => {\n\t\t\t\tconst basename = csstree.keyword(node.name).basename;\n\n\t\t\t\tif (basename === \"page\") {\n\t\t\t\t\tthis.hooks.onAtPage.trigger(node, item, list);\n\t\t\t\t\tthis.declarations(node, item, list);\n\t\t\t\t}\n\n\t\t\t\tif (basename === \"media\") {\n\t\t\t\t\tthis.hooks.onAtMedia.trigger(node, item, list);\n\t\t\t\t\tthis.declarations(node, item, list);\n\t\t\t\t}\n\n\t\t\t\tif (basename === \"import\") {\n\t\t\t\t\tthis.hooks.onImport.trigger(node, item, list);\n\t\t\t\t\tthis.imports(node, item, list);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\n\trules(ast) {\n\t\tcsstree.walk(ast, {\n\t\t\tvisit: \"Rule\",\n\t\t\tenter: (ruleNode, ruleItem, rulelist) => {\n\n\t\t\t\tthis.hooks.onRule.trigger(ruleNode, ruleItem, rulelist);\n\t\t\t\tthis.declarations(ruleNode, ruleItem, rulelist);\n\t\t\t\tthis.onSelector(ruleNode, ruleItem, rulelist);\n\n\t\t\t}\n\t\t});\n\t}\n\n\tdeclarations(ruleNode, ruleItem, rulelist) {\n\t\tcsstree.walk(ruleNode, {\n\t\t\tvisit: \"Declaration\",\n\t\t\tenter: (declarationNode, dItem, dList) => {\n\n\t\t\t\tthis.hooks.onDeclaration.trigger(declarationNode, dItem, dList, {ruleNode, ruleItem, rulelist});\n\n\t\t\t\tif (declarationNode.property === \"content\") {\n\t\t\t\t\tcsstree.walk(declarationNode, {\n\t\t\t\t\t\tvisit: \"Function\",\n\t\t\t\t\t\tenter: (funcNode, fItem, fList) => {\n\t\t\t\t\t\t\tthis.hooks.onContent.trigger(funcNode, fItem, fList, {declarationNode, dItem, dList}, {ruleNode, ruleItem, rulelist});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t}\n\t\t});\n\t}\n\n\t// add pseudo elements to parser\n\tonSelector(ruleNode, ruleItem, rulelist) {\n\t\tcsstree.walk(ruleNode, {\n\t\t\tvisit: \"Selector\",\n\t\t\tenter: (selectNode, selectItem, selectList) => {\n\t\t\t\tthis.hooks.onSelector.trigger(selectNode, selectItem, selectList, {ruleNode, ruleItem, rulelist});\n\n\t\t\t\tif (selectNode.children.forEach(node => {if (node.type === \"PseudoElementSelector\") {\n\t\t\t\t\tcsstree.walk(node, {\n\t\t\t\t\t\tvisit: \"PseudoElementSelector\",\n\t\t\t\t\t\tenter: (pseudoNode, pItem, pList) => {\n\t\t\t\t\t\t\tthis.hooks.onPseudoSelector.trigger(pseudoNode, pItem, pList, {selectNode, selectItem, selectList}, {ruleNode, ruleItem, rulelist});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}}));\n\t\t\t}\n\t\t});\n\t}\n\n\treplaceUrls(ast) {\n\t\tcsstree.walk(ast, {\n\t\t\tvisit: \"Url\",\n\t\t\tenter: (node, item, list) => {\n\t\t\t\tlet content = node.value.value;\n\t\t\t\tif ((node.value.type === \"Raw\" && content.startsWith(\"data:\")) || (node.value.type === \"String\" && (content.startsWith(\"\\\"data:\") || content.startsWith(\"'data:\")))) {\n\t\t\t\t\t// data-uri should not be parsed using the URL interface.\n\t\t\t\t} else {\n\t\t\t\t\tlet href = content.replace(/[\"']/g, \"\");\n\t\t\t\t\tlet url = new URL(href, this.url);\n\t\t\t\t\tnode.value.value = url.toString();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\taddScope(ast, id) {\n\t\t// Get all selector lists\n\t\t// add an id\n\t\tcsstree.walk(ast, {\n\t\t\tvisit: \"Selector\",\n\t\t\tenter: (node, item, list) => {\n\t\t\t\tlet children = node.children;\n\t\t\t\tchildren.prepend(children.createItem({\n\t\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\t\tvalue: \" \"\n\t\t\t\t}));\n\t\t\t\tchildren.prepend(children.createItem({\n\t\t\t\t\ttype: \"IdSelector\",\n\t\t\t\t\tname: id,\n\t\t\t\t\tloc: null,\n\t\t\t\t\tchildren: null\n\t\t\t\t}));\n\t\t\t}\n\t\t});\n\t}\n\n\tgetNamedPageSelectors(ast) {\n\t\tlet namedPageSelectors = {};\n\t\tcsstree.walk(ast, {\n\t\t\tvisit: \"Rule\",\n\t\t\tenter: (node, item, list) => {\n\t\t\t\tcsstree.walk(node, {\n\t\t\t\t\tvisit: \"Declaration\",\n\t\t\t\t\tenter: (declaration, dItem, dList) => {\n\t\t\t\t\t\tif (declaration.property === \"page\") {\n\t\t\t\t\t\t\tlet value = declaration.value.children.first();\n\t\t\t\t\t\t\tlet name = value.name;\n\t\t\t\t\t\t\tlet selector = csstree.generate(node.prelude);\n\t\t\t\t\t\t\tnamedPageSelectors[name] = {\n\t\t\t\t\t\t\t\tname: name,\n\t\t\t\t\t\t\t\tselector: selector\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t// dList.remove(dItem);\n\n\t\t\t\t\t\t\t// Add in page break\n\t\t\t\t\t\t\tdeclaration.property = \"break-before\";\n\t\t\t\t\t\t\tvalue.type = \"Identifier\";\n\t\t\t\t\t\t\tvalue.name = \"always\";\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\treturn namedPageSelectors;\n\t}\n\n\treplaceIds(ast) {\n\t\tcsstree.walk(ast, {\n\t\t\tvisit: \"Rule\",\n\t\t\tenter: (node, item, list) => {\n\n\t\t\t\tcsstree.walk(node, {\n\t\t\t\t\tvisit: \"IdSelector\",\n\t\t\t\t\tenter: (idNode, idItem, idList) => {\n\t\t\t\t\t\tlet name = idNode.name;\n\t\t\t\t\t\tidNode.flags = null;\n\t\t\t\t\t\tidNode.matcher = \"=\";\n\t\t\t\t\t\tidNode.name = {type: \"Identifier\", loc: null, name: \"data-id\"};\n\t\t\t\t\t\tidNode.type = \"AttributeSelector\";\n\t\t\t\t\t\tidNode.value = {type: \"String\", loc: null, value: `\"${name}\"`};\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\timports(node, item, list) {\n\t\t// console.log(\"import\", node, item, list);\n\t\tlet queries = [];\n\t\tcsstree.walk(node, {\n\t\t\tvisit: \"MediaQuery\",\n\t\t\tenter: (mqNode, mqItem, mqList) => {\n\t\t\t\tcsstree.walk(mqNode, {\n\t\t\t\t\tvisit: \"Identifier\",\n\t\t\t\t\tenter: (identNode, identItem, identList) => {\n\t\t\t\t\t\tqueries.push(identNode.name);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t// Just basic media query support for now\n\t\tlet shouldNotApply = queries.some((query, index) => {\n\t\t\tlet q = query;\n\t\t\tif (q === \"not\") {\n\t\t\t\tq = queries[index + 1];\n\t\t\t\treturn !(q === \"screen\" || q === \"speech\");\n\t\t\t} else {\n\t\t\t\treturn (q === \"screen\" || q === \"speech\");\n\t\t\t}\n\t\t});\n\n\t\tif (shouldNotApply) {\n\t\t\treturn;\n\t\t}\n\n\t\tcsstree.walk(node, {\n\t\t\tvisit: \"String\",\n\t\t\tenter: (urlNode, urlItem, urlList) => {\n\t\t\t\tlet href = urlNode.value.replace(/[\"']/g, \"\");\n\t\t\t\tlet url = new URL(href, this.url);\n\t\t\t\tlet value = url.toString();\n\n\t\t\t\tthis.imported.push(value);\n\n\t\t\t\t// Remove the original\n\t\t\t\tlist.remove(item);\n\t\t\t}\n\t\t});\n\t}\n\n\tset text(t) {\n\t\tthis._text = t;\n\t}\n\n\tget text() {\n\t\treturn this._text;\n\t}\n\n\t// generate string\n\ttoString(ast) {\n\t\treturn csstree.generate(ast || this.ast);\n\t}\n}\n\nexport default Sheet;\n","export default `\n:root {\n\t--pagedjs-width: 8.5in;\n\t--pagedjs-height: 11in;\n\t--pagedjs-width-right: 8.5in;\n\t--pagedjs-height-right: 11in;\n\t--pagedjs-width-left: 8.5in;\n\t--pagedjs-height-left: 11in;\n\t--pagedjs-pagebox-width: 8.5in;\n\t--pagedjs-pagebox-height: 11in;\n\t--pagedjs-footnotes-height: 0mm;\n\t--pagedjs-margin-top: 1in;\n\t--pagedjs-margin-right: 1in;\n\t--pagedjs-margin-bottom: 1in;\n\t--pagedjs-margin-left: 1in;\n\t--pagedjs-padding-top: 0mm;\n\t--pagedjs-padding-right: 0mm;\n\t--pagedjs-padding-bottom: 0mm;\n\t--pagedjs-padding-left: 0mm;\n\t--pagedjs-border-top: 0mm;\n\t--pagedjs-border-right: 0mm;\n\t--pagedjs-border-bottom: 0mm;\n\t--pagedjs-border-left: 0mm;\n\t--pagedjs-bleed-top: 0mm;\n\t--pagedjs-bleed-right: 0mm;\n\t--pagedjs-bleed-bottom: 0mm;\n\t--pagedjs-bleed-left: 0mm;\n\t--pagedjs-bleed-right-top: 0mm;\n\t--pagedjs-bleed-right-right: 0mm;\n\t--pagedjs-bleed-right-bottom: 0mm;\n\t--pagedjs-bleed-right-left: 0mm;\n\t--pagedjs-bleed-left-top: 0mm;\n\t--pagedjs-bleed-left-right: 0mm;\n\t--pagedjs-bleed-left-bottom: 0mm;\n\t--pagedjs-bleed-left-left: 0mm;\n\t--pagedjs-crop-color: black;\n\t--pagedjs-crop-shadow: white;\n\t--pagedjs-crop-offset: 2mm;\n\t--pagedjs-crop-stroke: 1px;\n\t--pagedjs-cross-size: 5mm;\n\t--pagedjs-mark-cross-display: none;\n\t--pagedjs-mark-crop-display: none;\n\t--pagedjs-page-count: 0;\n\t--pagedjs-page-counter-increment: 1;\n\t--pagedjs-footnotes-count: 0;\n\t--pagedjs-column-gap-offset: 1000px;\n}\n\n@page {\n\tsize: letter;\n\tmargin: 0;\n}\n\n.pagedjs_sheet {\n\tbox-sizing: border-box;\n\twidth: var(--pagedjs-width);\n\theight: var(--pagedjs-height);\n\toverflow: hidden;\n\tposition: relative;\n\tdisplay: grid;\n\tgrid-template-columns: [bleed-left] var(--pagedjs-bleed-left) [sheet-center] calc(var(--pagedjs-width) - var(--pagedjs-bleed-left) - var(--pagedjs-bleed-right)) [bleed-right] var(--pagedjs-bleed-right);\n\tgrid-template-rows: [bleed-top] var(--pagedjs-bleed-top) [sheet-middle] calc(var(--pagedjs-height) - var(--pagedjs-bleed-top) - var(--pagedjs-bleed-bottom)) [bleed-bottom] var(--pagedjs-bleed-bottom);\n}\n\n.pagedjs_right_page .pagedjs_sheet {\n\twidth: var(--pagedjs-width-right);\n\theight: var(--pagedjs-height-right);\n\tgrid-template-columns: [bleed-left] var(--pagedjs-bleed-right-left) [sheet-center] calc(var(--pagedjs-width) - var(--pagedjs-bleed-right-left) - var(--pagedjs-bleed-right-right)) [bleed-right] var(--pagedjs-bleed-right-right);\n\tgrid-template-rows: [bleed-top] var(--pagedjs-bleed-right-top) [sheet-middle] calc(var(--pagedjs-height) - var(--pagedjs-bleed-right-top) - var(--pagedjs-bleed-right-bottom)) [bleed-bottom] var(--pagedjs-bleed-right-bottom);\n}\n\n.pagedjs_left_page .pagedjs_sheet {\n\twidth: var(--pagedjs-width-left);\n\theight: var(--pagedjs-height-left);\n\tgrid-template-columns: [bleed-left] var(--pagedjs-bleed-left-left) [sheet-center] calc(var(--pagedjs-width) - var(--pagedjs-bleed-left-left) - var(--pagedjs-bleed-left-right)) [bleed-right] var(--pagedjs-bleed-left-right);\n\tgrid-template-rows: [bleed-top] var(--pagedjs-bleed-left-top) [sheet-middle] calc(var(--pagedjs-height) - var(--pagedjs-bleed-left-top) - var(--pagedjs-bleed-left-bottom)) [bleed-bottom] var(--pagedjs-bleed-left-bottom);\n}\n\n.pagedjs_bleed {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tflex-wrap: nowrap;\n\toverflow: hidden;\n}\n\n.pagedjs_bleed-top {\n\tgrid-column: bleed-left / -1;\n\tgrid-row: bleed-top;\n\tflex-direction: row;\n}\n\n.pagedjs_bleed-bottom {\n\tgrid-column: bleed-left / -1;\n\tgrid-row: bleed-bottom;\n\tflex-direction: row;\n}\n\n.pagedjs_bleed-left {\n\tgrid-column: bleed-left;\n\tgrid-row: bleed-top / -1;\n\tflex-direction: column;\n}\n\n.pagedjs_bleed-right {\n\tgrid-column: bleed-right;\n\tgrid-row: bleed-top / -1;\n\tflex-direction: column;\n}\n\n.pagedjs_marks-crop {\n\tdisplay: var(--pagedjs-mark-crop-display);\n\tflex-grow: 0;\n\tflex-shrink: 0;\n\tz-index: 9999999999;\n}\n\n.pagedjs_bleed-top .pagedjs_marks-crop:nth-child(1),\n.pagedjs_bleed-bottom .pagedjs_marks-crop:nth-child(1) {\n\twidth: calc(var(--pagedjs-bleed-left) - var(--pagedjs-crop-stroke));\n\tborder-right: var(--pagedjs-crop-stroke) solid var(--pagedjs-crop-color);\n\tbox-shadow: 1px 0px 0px 0px var(--pagedjs-crop-shadow);\n}\n\n.pagedjs_right_page .pagedjs_bleed-top .pagedjs_marks-crop:nth-child(1),\n.pagedjs_right_page .pagedjs_bleed-bottom .pagedjs_marks-crop:nth-child(1) {\n\twidth: calc(var(--pagedjs-bleed-right-left) - var(--pagedjs-crop-stroke));\n}\n\n.pagedjs_left_page .pagedjs_bleed-top .pagedjs_marks-crop:nth-child(1),\n.pagedjs_left_page .pagedjs_bleed-bottom .pagedjs_marks-crop:nth-child(1) {\n\twidth: calc(var(--pagedjs-bleed-left-left) - var(--pagedjs-crop-stroke));\n}\n\n.pagedjs_bleed-top .pagedjs_marks-crop:nth-child(3),\n.pagedjs_bleed-bottom .pagedjs_marks-crop:nth-child(3) {\n\twidth: calc(var(--pagedjs-bleed-right) - var(--pagedjs-crop-stroke));\n\tborder-left: var(--pagedjs-crop-stroke) solid var(--pagedjs-crop-color);\n\tbox-shadow: -1px 0px 0px 0px var(--pagedjs-crop-shadow);\n}\n\n.pagedjs_right_page .pagedjs_bleed-top .pagedjs_marks-crop:nth-child(3),\n.pagedjs_right_page .pagedjs_bleed-bottom .pagedjs_marks-crop:nth-child(3) {\n\twidth: calc(var(--pagedjs-bleed-right-right) - var(--pagedjs-crop-stroke));\n}\n\n.pagedjs_left_page .pagedjs_bleed-top .pagedjs_marks-crop:nth-child(3),\n.pagedjs_left_page .pagedjs_bleed-bottom .pagedjs_marks-crop:nth-child(3) {\n\twidth: calc(var(--pagedjs-bleed-left-right) - var(--pagedjs-crop-stroke));\n}\n\n.pagedjs_bleed-top .pagedjs_marks-crop {\n\talign-self: flex-start;\n\theight: calc(var(--pagedjs-bleed-top) - var(--pagedjs-crop-offset));\n}\n\n.pagedjs_right_page .pagedjs_bleed-top .pagedjs_marks-crop {\n\theight: calc(var(--pagedjs-bleed-right-top) - var(--pagedjs-crop-offset));\n}\n\n.pagedjs_left_page .pagedjs_bleed-top .pagedjs_marks-crop {\n\theight: calc(var(--pagedjs-bleed-left-top) - var(--pagedjs-crop-offset));\n}\n\n.pagedjs_bleed-bottom .pagedjs_marks-crop {\n\talign-self: flex-end;\n\theight: calc(var(--pagedjs-bleed-bottom) - var(--pagedjs-crop-offset));\n}\n\n.pagedjs_right_page .pagedjs_bleed-bottom .pagedjs_marks-crop {\n\theight: calc(var(--pagedjs-bleed-right-bottom) - var(--pagedjs-crop-offset));\n}\n\n.pagedjs_left_page .pagedjs_bleed-bottom .pagedjs_marks-crop {\n\theight: calc(var(--pagedjs-bleed-left-bottom) - var(--pagedjs-crop-offset));\n}\n\n.pagedjs_bleed-left .pagedjs_marks-crop:nth-child(1),\n.pagedjs_bleed-right .pagedjs_marks-crop:nth-child(1) {\n\theight: calc(var(--pagedjs-bleed-top) - var(--pagedjs-crop-stroke));\n\tborder-bottom: var(--pagedjs-crop-stroke) solid var(--pagedjs-crop-color);\n\tbox-shadow: 0px 1px 0px 0px var(--pagedjs-crop-shadow);\n}\n\n.pagedjs_right_page .pagedjs_bleed-left .pagedjs_marks-crop:nth-child(1),\n.pagedjs_right_page .pagedjs_bleed-right .pagedjs_marks-crop:nth-child(1) {\n\theight: calc(var(--pagedjs-bleed-right-top) - var(--pagedjs-crop-stroke));\n}\n\n.pagedjs_left_page .pagedjs_bleed-left .pagedjs_marks-crop:nth-child(1),\n.pagedjs_left_page .pagedjs_bleed-right .pagedjs_marks-crop:nth-child(1) {\n\theight: calc(var(--pagedjs-bleed-left-top) - var(--pagedjs-crop-stroke));\n}\n\n.pagedjs_bleed-left .pagedjs_marks-crop:nth-child(3),\n.pagedjs_bleed-right .pagedjs_marks-crop:nth-child(3) {\n\theight: calc(var(--pagedjs-bleed-bottom) - var(--pagedjs-crop-stroke));\n\tborder-top: var(--pagedjs-crop-stroke) solid var(--pagedjs-crop-color);\n\tbox-shadow: 0px -1px 0px 0px var(--pagedjs-crop-shadow);\n}\n\n.pagedjs_right_page .pagedjs_bleed-left .pagedjs_marks-crop:nth-child(3),\n.pagedjs_right_page .pagedjs_bleed-right .pagedjs_marks-crop:nth-child(3) {\n\theight: calc(var(--pagedjs-bleed-right-bottom) - var(--pagedjs-crop-stroke));\n}\n\n.pagedjs_left_page .pagedjs_bleed-left .pagedjs_marks-crop:nth-child(3),\n.pagedjs_left_page .pagedjs_bleed-right .pagedjs_marks-crop:nth-child(3) {\n\theight: calc(var(--pagedjs-bleed-left-bottom) - var(--pagedjs-crop-stroke));\n}\n\n.pagedjs_bleed-left .pagedjs_marks-crop {\n\twidth: calc(var(--pagedjs-bleed-left) - var(--pagedjs-crop-offset));\n\talign-self: flex-start;\n}\n\n.pagedjs_right_page .pagedjs_bleed-left .pagedjs_marks-crop {\n\twidth: calc(var(--pagedjs-bleed-right-left) - var(--pagedjs-crop-offset));\n}\n\n.pagedjs_left_page .pagedjs_bleed-left .pagedjs_marks-crop {\n\twidth: calc(var(--pagedjs-bleed-left-left) - var(--pagedjs-crop-offset));\n}\n\n.pagedjs_bleed-right .pagedjs_marks-crop {\n\twidth: calc(var(--pagedjs-bleed-right) - var(--pagedjs-crop-offset));\n\talign-self: flex-end;\n}\n\n.pagedjs_right_page .pagedjs_bleed-right .pagedjs_marks-crop {\n\twidth: calc(var(--pagedjs-bleed-right-right) - var(--pagedjs-crop-offset));\n}\n\n.pagedjs_left_page .pagedjs_bleed-right .pagedjs_marks-crop {\n\twidth: calc(var(--pagedjs-bleed-left-right) - var(--pagedjs-crop-offset));\n}\n\n.pagedjs_marks-middle {\n\tdisplay: flex;\n\tflex-grow: 1;\n\tflex-shrink: 0;\n\talign-items: center;\n\tjustify-content: center;\n}\n\n.pagedjs_marks-cross {\n\tdisplay: var(--pagedjs-mark-cross-display);\n\tbackground-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSIzMi41MzdweCIgaGVpZ2h0PSIzMi41MzdweCIgdmlld0JveD0iMC4xMDQgMC4xMDQgMzIuNTM3IDMyLjUzNyIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwLjEwNCAwLjEwNCAzMi41MzcgMzIuNTM3IiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNGRkZGRkYiIHN0cm9rZS13aWR0aD0iMy4zODkzIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGQ9Ik0yOS45MzEsMTYuMzczYzAsNy40ODktNi4wNjgsMTMuNTYtMTMuNTU4LDEzLjU2Yy03LjQ4MywwLTEzLjU1Ny02LjA3Mi0xMy41NTctMTMuNTZjMC03LjQ4Niw2LjA3NC0xMy41NTQsMTMuNTU3LTEzLjU1NEMyMy44NjIsMi44MTksMjkuOTMxLDguODg3LDI5LjkzMSwxNi4zNzN6Ii8+PGxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjRkZGRkZGIiBzdHJva2Utd2lkdGg9IjMuMzg5MyIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiB4MT0iMC4xMDQiIHkxPSIxNi4zNzMiIHgyPSIzMi42NDIiIHkyPSIxNi4zNzMiLz48bGluZSBmaWxsPSJub25lIiBzdHJva2U9IiNGRkZGRkYiIHN0cm9rZS13aWR0aD0iMy4zODkzIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHgxPSIxNi4zNzMiIHkxPSIwLjEwNCIgeDI9IjE2LjM3MyIgeTI9IjMyLjY0MiIvPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0ZGRkZGRiIgc3Ryb2tlLXdpZHRoPSIzLjM4OTMiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTI0LjUwOCwxNi4zNzNjMCw0LjQ5Ni0zLjYzOCw4LjEzNS04LjEzNSw4LjEzNWMtNC40OTEsMC04LjEzNS0zLjYzOC04LjEzNS04LjEzNWMwLTQuNDg5LDMuNjQ0LTguMTM1LDguMTM1LTguMTM1QzIwLjg2OSw4LjIzOSwyNC41MDgsMTEuODg0LDI0LjUwOCwxNi4zNzN6Ii8+PHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utd2lkdGg9IjAuNjc3OCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMjkuOTMxLDE2LjM3M2MwLDcuNDg5LTYuMDY4LDEzLjU2LTEzLjU1OCwxMy41NmMtNy40ODMsMC0xMy41NTctNi4wNzItMTMuNTU3LTEzLjU2YzAtNy40ODYsNi4wNzQtMTMuNTU0LDEzLjU1Ny0xMy41NTRDMjMuODYyLDIuODE5LDI5LjkzMSw4Ljg4NywyOS45MzEsMTYuMzczeiIvPjxsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLXdpZHRoPSIwLjY3NzgiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgeDE9IjAuMTA0IiB5MT0iMTYuMzczIiB4Mj0iMzIuNjQyIiB5Mj0iMTYuMzczIi8+PGxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utd2lkdGg9IjAuNjc3OCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiB4MT0iMTYuMzczIiB5MT0iMC4xMDQiIHgyPSIxNi4zNzMiIHkyPSIzMi42NDIiLz48cGF0aCBkPSJNMjQuNTA4LDE2LjM3M2MwLDQuNDk2LTMuNjM4LDguMTM1LTguMTM1LDguMTM1Yy00LjQ5MSwwLTguMTM1LTMuNjM4LTguMTM1LTguMTM1YzAtNC40ODksMy42NDQtOC4xMzUsOC4xMzUtOC4xMzVDMjAuODY5LDguMjM5LDI0LjUwOCwxMS44ODQsMjQuNTA4LDE2LjM3MyIvPjxsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0ZGRkZGRiIgc3Ryb2tlLXdpZHRoPSIwLjY3NzgiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgeDE9IjguMjM5IiB5MT0iMTYuMzczIiB4Mj0iMjQuNTA4IiB5Mj0iMTYuMzczIi8+PGxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjRkZGRkZGIiBzdHJva2Utd2lkdGg9IjAuNjc3OCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiB4MT0iMTYuMzczIiB5MT0iOC4yMzkiIHgyPSIxNi4zNzMiIHkyPSIyNC41MDgiLz48L3N2Zz4=);\n  background-repeat: no-repeat;\n  background-position: 50% 50%;\n  background-size: var(--pagedjs-cross-size);\n\n  z-index: 2147483647;\n\twidth: var(--pagedjs-cross-size);\n\theight: var(--pagedjs-cross-size);\n}\n\n.pagedjs_pagebox {\n\tbox-sizing: border-box;\n\twidth: var(--pagedjs-pagebox-width);\n\theight: var(--pagedjs-pagebox-height);\n\tposition: relative;\n\tdisplay: grid;\n\tgrid-template-columns: [left] var(--pagedjs-margin-left) [center] calc(var(--pagedjs-pagebox-width) - var(--pagedjs-margin-left) - var(--pagedjs-margin-right)) [right] var(--pagedjs-margin-right);\n\tgrid-template-rows: [header] var(--pagedjs-margin-top) [page] calc(var(--pagedjs-pagebox-height) - var(--pagedjs-margin-top) - var(--pagedjs-margin-bottom)) [footer] var(--pagedjs-margin-bottom);\n\tgrid-column: sheet-center;\n\tgrid-row: sheet-middle;\n}\n\n.pagedjs_pagebox * {\n\tbox-sizing: border-box;\n}\n\n.pagedjs_margin-top {\n\twidth: calc(var(--pagedjs-pagebox-width) - var(--pagedjs-margin-left) - var(--pagedjs-margin-right));\n\theight: var(--pagedjs-margin-top);\n\tgrid-column: center;\n\tgrid-row: header;\n\tflex-wrap: nowrap;\n\tdisplay: grid;\n\tgrid-template-columns: repeat(3, 1fr);\n\tgrid-template-rows: 100%;\n}\n\n.pagedjs_margin-top-left-corner-holder {\n\twidth: var(--pagedjs-margin-left);\n\theight: var(--pagedjs-margin-top);\n\tdisplay: flex;\n\tgrid-column: left;\n\tgrid-row: header;\n}\n\n.pagedjs_margin-top-right-corner-holder {\n\twidth: var(--pagedjs-margin-right);\n\theight: var(--pagedjs-margin-top);\n\tdisplay: flex;\n\tgrid-column: right;\n\tgrid-row: header;\n}\n\n.pagedjs_margin-top-left-corner {\n\twidth: var(--pagedjs-margin-left);\n}\n\n.pagedjs_margin-top-right-corner {\n\twidth: var(--pagedjs-margin-right);\n}\n\n.pagedjs_margin-right {\n\theight: calc(var(--pagedjs-pagebox-height) - var(--pagedjs-margin-top) - var(--pagedjs-margin-bottom));\n\twidth: var(--pagedjs-margin-right);\n\tright: 0;\n\tgrid-column: right;\n\tgrid-row: page;\n\tdisplay: grid;\n\tgrid-template-rows: repeat(3, 33.3333%);\n\tgrid-template-columns: 100%;\n}\n\n.pagedjs_margin-bottom {\n\twidth: calc(var(--pagedjs-pagebox-width) - var(--pagedjs-margin-left) - var(--pagedjs-margin-right));\n\theight: var(--pagedjs-margin-bottom);\n\tgrid-column: center;\n\tgrid-row: footer;\n\tdisplay: grid;\n\tgrid-template-columns: repeat(3, 1fr);\n\tgrid-template-rows: 100%;\n}\n\n.pagedjs_margin-bottom-left-corner-holder {\n\twidth: var(--pagedjs-margin-left);\n\theight: var(--pagedjs-margin-bottom);\n\tdisplay: flex;\n\tgrid-column: left;\n\tgrid-row: footer;\n}\n\n.pagedjs_margin-bottom-right-corner-holder {\n\twidth: var(--pagedjs-margin-right);\n\theight: var(--pagedjs-margin-bottom);\n\tdisplay: flex;\n\tgrid-column: right;\n\tgrid-row: footer;\n}\n\n.pagedjs_margin-bottom-left-corner {\n\twidth: var(--pagedjs-margin-left);\n}\n\n.pagedjs_margin-bottom-right-corner {\n\twidth: var(--pagedjs-margin-right);\n}\n\n\n\n.pagedjs_margin-left {\n\theight: calc(var(--pagedjs-pagebox-height) - var(--pagedjs-margin-top) - var(--pagedjs-margin-bottom));\n\twidth: var(--pagedjs-margin-left);\n\tgrid-column: left;\n\tgrid-row: page;\n\tdisplay: grid;\n\tgrid-template-rows: repeat(3, 33.33333%);\n\tgrid-template-columns: 100%;\n}\n\n.pagedjs_pages .pagedjs_pagebox .pagedjs_margin:not(.hasContent) {\n\tvisibility: hidden;\n}\n\n.pagedjs_pagebox > .pagedjs_area {\n\tgrid-column: center;\n\tgrid-row: page;\n\twidth: 100%;\n\theight: 100%;\n\tpadding: var(--pagedjs-padding-top) var(--pagedjs-padding-right) var(--pagedjs-padding-bottom) var(--pagedjs-padding-left);\n\tborder-top: var(--pagedjs-border-top);\n\tborder-right: var(--pagedjs-border-right);\n\tborder-bottom: var(--pagedjs-border-bottom);\n\tborder-left: var(--pagedjs-border-left);\n}\n\n.pagedjs_pagebox > .pagedjs_area > .pagedjs_page_content {\n\twidth: 100%;\n\theight: calc(100% - var(--pagedjs-footnotes-height));\n\tposition: relative;\n\tcolumn-fill: auto;\n}\n\n.pagedjs_pagebox > .pagedjs_area > .pagedjs_page_content > div {\n\theight: inherit;\n}\n\n.pagedjs_pagebox > .pagedjs_area > .pagedjs_footnote_area {\n\tposition: relative;\n\toverflow: hidden;\n\theight: var(--pagedjs-footnotes-height);\n\tdisplay: flex;\n    justify-content: flex-end;\n    flex-flow: column;\n}\n\n.pagedjs_pagebox > .pagedjs_area > .pagedjs_footnote_area > .pagedjs_footnote_content {\n\toverflow: hidden;\n}\n\n.pagedjs_pagebox > .pagedjs_area > .pagedjs_footnote_area > .pagedjs_footnote_inner_content {\n\toverflow: hidden;\n}\n\n.pagedjs_area [data-footnote-call] {\n\tall: unset;\n\tcounter-increment: footnote;\n}\n\n.pagedjs_area [data-split-from] {\n\tcounter-increment: unset;\n\tcounter-reset: unset;\n}\n\n[data-footnote-call]::after {\n\tvertical-align: super;\n\tfont-size: 65%;\n\tline-height: normal;\n\tcontent: counter(footnote);\n}\n\n@supports ( font-variant-position: super ) {\n\t[data-footnote-call]::after {\n\t\tvertical-align: baseline;\n\t\tfont-size: 100%;\n\t\tline-height: inherit;\n\t\tfont-variant-position: super;\n\t}\n}\n\n.pagedjs_footnote_empty {\n\tdisplay: none;\n}\n\n.pagedjs_area [data-split-from] {\n\tcounter-increment: unset;\n\tcounter-reset: unset;\n}\n\n[data-footnote-marker] {\n\ttext-indent: 0;\n\tdisplay: list-item;\n\tlist-style-position: inside;\n}\n\n[data-footnote-marker][data-split-from] {\n\tlist-style: none;\n}\n\n[data-footnote-marker]:not([data-split-from]) {\n\tcounter-increment: footnote-marker;\n}\n\n[data-footnote-marker]::marker {\n\tcontent: counter(footnote-marker) \". \";\n}\n\n[data-footnote-marker][data-split-from]::marker {\n\tcontent: unset;\n}\n\n.pagedjs_area .pagedjs_footnote_inner_content [data-note-display=\"inline\"] {\n \tdisplay: inline;\n}\n\n.pagedjs_page {\n\tcounter-increment: page var(--pagedjs-page-counter-increment);\n\twidth: var(--pagedjs-width);\n\theight: var(--pagedjs-height);\n}\n\n.pagedjs_page.pagedjs_right_page {\n\twidth: var(--pagedjs-width-right);\n\theight: var(--pagedjs-height-right);\n}\n\n.pagedjs_page.pagedjs_left_page {\n\twidth: var(--pagedjs-width-left);\n\theight: var(--pagedjs-height-left);\n}\n\n.pagedjs_pages {\n\tcounter-reset: pages var(--pagedjs-page-count) footnote var(--pagedjs-footnotes-count) footnote-marker var(--pagedjs-footnotes-count);\n}\n\n.pagedjs_pagebox .pagedjs_margin-top-left-corner,\n.pagedjs_pagebox .pagedjs_margin-top-right-corner,\n.pagedjs_pagebox .pagedjs_margin-bottom-left-corner,\n.pagedjs_pagebox .pagedjs_margin-bottom-right-corner,\n.pagedjs_pagebox .pagedjs_margin-top-left,\n.pagedjs_pagebox .pagedjs_margin-top-right,\n.pagedjs_pagebox .pagedjs_margin-bottom-left,\n.pagedjs_pagebox .pagedjs_margin-bottom-right,\n.pagedjs_pagebox .pagedjs_margin-top-center,\n.pagedjs_pagebox .pagedjs_margin-bottom-center,\n.pagedjs_pagebox .pagedjs_margin-top-center,\n.pagedjs_pagebox .pagedjs_margin-bottom-center,\n.pagedjs_margin-right-middle,\n.pagedjs_margin-left-middle  {\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.pagedjs_margin-right-top,\n.pagedjs_margin-left-top  {\n\tdisplay: flex;\n\talign-items: flex-top;\n}\n\n\n.pagedjs_margin-right-bottom,\n.pagedjs_margin-left-bottom  {\n\tdisplay: flex;\n\talign-items: flex-end;\n}\n\n\n\n/*\n.pagedjs_pagebox .pagedjs_margin-top-center,\n.pagedjs_pagebox .pagedjs_margin-bottom-center {\n\theight: 100%;\n\tdisplay: none;\n\talign-items: center;\n\tflex: 1 0 33%;\n\tmargin: 0 auto;\n}\n\n.pagedjs_pagebox .pagedjs_margin-top-left-corner,\n.pagedjs_pagebox .pagedjs_margin-top-right-corner,\n.pagedjs_pagebox .pagedjs_margin-bottom-right-corner,\n.pagedjs_pagebox .pagedjs_margin-bottom-left-corner {\n\tdisplay: none;\n\talign-items: center;\n}\n\n.pagedjs_pagebox .pagedjs_margin-left-top,\n.pagedjs_pagebox .pagedjs_margin-right-top {\n\tdisplay: none;\n\talign-items: flex-start;\n}\n\n.pagedjs_pagebox .pagedjs_margin-right-middle,\n.pagedjs_pagebox .pagedjs_margin-left-middle {\n\tdisplay: none;\n\talign-items: center;\n}\n\n.pagedjs_pagebox .pagedjs_margin-left-bottom,\n.pagedjs_pagebox .pagedjs_margin-right-bottom {\n\tdisplay: none;\n\talign-items: flex-end;\n}\n*/\n\n.pagedjs_pagebox .pagedjs_margin-top-left,\n.pagedjs_pagebox .pagedjs_margin-top-right-corner,\n.pagedjs_pagebox .pagedjs_margin-bottom-left,\n.pagedjs_pagebox .pagedjs_margin-bottom-right-corner { text-align: left; }\n\n.pagedjs_pagebox .pagedjs_margin-top-left-corner,\n.pagedjs_pagebox .pagedjs_margin-top-right,\n.pagedjs_pagebox .pagedjs_margin-bottom-left-corner,\n.pagedjs_pagebox .pagedjs_margin-bottom-right { text-align: right; }\n\n.pagedjs_pagebox .pagedjs_margin-top-center,\n.pagedjs_pagebox .pagedjs_margin-bottom-center,\n.pagedjs_pagebox .pagedjs_margin-left-top,\n.pagedjs_pagebox .pagedjs_margin-left-middle,\n.pagedjs_pagebox .pagedjs_margin-left-bottom,\n.pagedjs_pagebox .pagedjs_margin-right-top,\n.pagedjs_pagebox .pagedjs_margin-right-middle,\n.pagedjs_pagebox .pagedjs_margin-right-bottom { text-align: center; }\n\n.pagedjs_pages .pagedjs_margin .pagedjs_margin-content {\n\twidth: 100%;\n}\n\n.pagedjs_pages .pagedjs_margin-left .pagedjs_margin-content::after,\n.pagedjs_pages .pagedjs_margin-top .pagedjs_margin-content::after,\n.pagedjs_pages .pagedjs_margin-right .pagedjs_margin-content::after,\n.pagedjs_pages .pagedjs_margin-bottom .pagedjs_margin-content::after {\n\tdisplay: block;\n}\n\n.pagedjs_pages > .pagedjs_page > .pagedjs_sheet > .pagedjs_pagebox > .pagedjs_area > div [data-split-to] {\n\tmargin-bottom: unset;\n\tpadding-bottom: unset;\n}\n\n.pagedjs_pages > .pagedjs_page > .pagedjs_sheet > .pagedjs_pagebox > .pagedjs_area > div [data-split-from] {\n\ttext-indent: unset;\n\tmargin-top: unset;\n\tpadding-top: unset;\n\tinitial-letter: unset;\n}\n\n.pagedjs_pages > .pagedjs_page > .pagedjs_sheet > .pagedjs_pagebox > .pagedjs_area > div [data-split-from] > *::first-letter,\n.pagedjs_pages > .pagedjs_page > .pagedjs_sheet > .pagedjs_pagebox > .pagedjs_area > div [data-split-from]::first-letter {\n\tcolor: unset;\n\tfont-size: unset;\n\tfont-weight: unset;\n\tfont-family: unset;\n\tcolor: unset;\n\tline-height: unset;\n\tfloat: unset;\n\tpadding: unset;\n\tmargin: unset;\n}\n\n.pagedjs_pages > .pagedjs_page > .pagedjs_sheet > .pagedjs_pagebox > .pagedjs_area > div [data-split-to]:not([data-footnote-call]):after,\n.pagedjs_pages > .pagedjs_page > .pagedjs_sheet > .pagedjs_pagebox > .pagedjs_area > div [data-split-to]:not([data-footnote-call])::after {\n\tcontent: unset;\n}\n\n.pagedjs_pages > .pagedjs_page > .pagedjs_sheet > .pagedjs_pagebox > .pagedjs_area > div [data-split-from]:not([data-footnote-call]):before,\n.pagedjs_pages > .pagedjs_page > .pagedjs_sheet > .pagedjs_pagebox > .pagedjs_area > div [data-split-from]:not([data-footnote-call])::before {\n\tcontent: unset;\n}\n\n.pagedjs_pages > .pagedjs_page > .pagedjs_sheet > .pagedjs_pagebox > .pagedjs_area > div li[data-split-from]:first-of-type {\n\tlist-style: none;\n}\n\n/*\n[data-page]:not([data-split-from]),\n[data-break-before=\"page\"]:not([data-split-from]),\n[data-break-before=\"always\"]:not([data-split-from]),\n[data-break-before=\"left\"]:not([data-split-from]),\n[data-break-before=\"right\"]:not([data-split-from]),\n[data-break-before=\"recto\"]:not([data-split-from]),\n[data-break-before=\"verso\"]:not([data-split-from])\n{\n\tbreak-before: column;\n}\n\n[data-page]:not([data-split-to]),\n[data-break-after=\"page\"]:not([data-split-to]),\n[data-break-after=\"always\"]:not([data-split-to]),\n[data-break-after=\"left\"]:not([data-split-to]),\n[data-break-after=\"right\"]:not([data-split-to]),\n[data-break-after=\"recto\"]:not([data-split-to]),\n[data-break-after=\"verso\"]:not([data-split-to])\n{\n\tbreak-after: column;\n}\n*/\n\n.pagedjs_clear-after::after {\n\tcontent: none !important;\n}\n\n[data-align-last-split-element='justify'] {\n\ttext-align-last: justify;\n}\n\n\n@media print {\n\thtml {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\t-webkit-print-color-adjust: exact;\n\t\tprint-color-adjust: exact;\n\t}\n\tbody {\n\t\tmargin: 0;\n\t\tpadding: 0;\n\t\twidth: 100% !important;\n\t\theight: 100% !important;\n\t\tmin-width: 100%;\n\t\tmax-width: 100%;\n\t\tmin-height: 100%;\n\t\tmax-height: 100%;\n\t}\n\t.pagedjs_pages {\n\t\twidth: auto;\n\t\tdisplay: block !important;\n\t\ttransform: none !important;\n\t\theight: 100% !important;\n\t\tmin-height: 100%;\n\t\tmax-height: 100%;\n\t\toverflow: visible;\n\t}\n\t.pagedjs_page {\n\t\tmargin: 0;\n\t\tpadding: 0;\n\t\tmax-height: 100%;\n\t\tmin-height: 100%;\n\t\theight: 100% !important;\n\t\tpage-break-after: always;\n\t\tbreak-after: page;\n\t}\n\t.pagedjs_sheet {\n\t\tmargin: 0;\n\t\tpadding: 0;\n\t\tmax-height: 100%;\n\t\tmin-height: 100%;\n\t\theight: 100% !important;\n\t}\n}\n`;\n","export default async function request(url, options={}) {\n\treturn new Promise(function(resolve, reject) {\n\t\tlet request = new XMLHttpRequest();\n\n\t\trequest.open(options.method || \"get\", url, true);\n\n\t\tfor (let i in options.headers) {\n\t\t\trequest.setRequestHeader(i, options.headers[i]);\n\t\t}\n\n\t\trequest.withCredentials = options.credentials === \"include\";\n\n\t\trequest.onload = () => {\n\t\t\t// Chrome returns a status code of 0 for local files\n\t\t\tconst status = request.status === 0 && url.startsWith(\"file://\") ? 200 : request.status;\n\t\t\tresolve(new Response(request.responseText, {status}));\n\t\t};\n\n\t\trequest.onerror = reject;\n\n\t\trequest.send(options.body || null);\n\t});\n}\n","import Sheet from \"./sheet.js\";\nimport baseStyles from \"./base.js\";\nimport Hook from \"../utils/hook.js\";\nimport request from \"../utils/request.js\";\n\nclass Polisher {\n\tconstructor(setup) {\n\t\tthis.sheets = [];\n\t\tthis.inserted = [];\n\n\t\tthis.hooks = {};\n\t\tthis.hooks.onUrl = new Hook(this);\n\t\tthis.hooks.onAtPage = new Hook(this);\n\t\tthis.hooks.onAtMedia = new Hook(this);\n\t\tthis.hooks.onRule = new Hook(this);\n\t\tthis.hooks.onDeclaration = new Hook(this);\n\t\tthis.hooks.onContent = new Hook(this);\n\t\tthis.hooks.onSelector = new Hook(this);\n\t\tthis.hooks.onPseudoSelector = new Hook(this);\n\n\t\tthis.hooks.onImport = new Hook(this);\n\n\t\tthis.hooks.beforeTreeParse = new Hook(this);\n\t\tthis.hooks.beforeTreeWalk = new Hook(this);\n\t\tthis.hooks.afterTreeWalk = new Hook(this);\n\n\t\tif (setup !== false) {\n\t\t\tthis.setup();\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.base = this.insert(baseStyles);\n\t\tthis.styleEl = document.createElement(\"style\");\n\t\tdocument.head.appendChild(this.styleEl);\n\t\tthis.styleSheet = this.styleEl.sheet;\n\t\treturn this.styleSheet;\n\t}\n\n\tasync add() {\n\t\tlet fetched = [];\n\t\tlet urls = [];\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tlet f;\n\n\t\t\tif (typeof arguments[i] === \"object\") {\n\t\t\t\tfor (let url in arguments[i]) {\n\t\t\t\t\tlet obj = arguments[i];\n\t\t\t\t\tf = new Promise(function(resolve, reject) {\n\t\t\t\t\t\turls.push(url);\n\t\t\t\t\t\tresolve(obj[url]);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\turls.push(arguments[i]);\n\t\t\t\tf = request(arguments[i]).then((response) => {\n\t\t\t\t\treturn response.text();\n\t\t\t\t});\n\t\t\t}\n\n\n\t\t\tfetched.push(f);\n\t\t}\n\n\t\treturn await Promise.all(fetched)\n\t\t\t.then(async (originals) => {\n\t\t\t\tlet text = \"\";\n\t\t\t\tfor (let index = 0; index < originals.length; index++) {\n\t\t\t\t\ttext = await this.convertViaSheet(originals[index], urls[index]);\n\t\t\t\t\tthis.insert(text);\n\t\t\t\t}\n\t\t\t\treturn text;\n\t\t\t});\n\t}\n\n\tasync convertViaSheet(cssStr, href) {\n\t\tlet sheet = new Sheet(href, this.hooks);\n\t\tawait sheet.parse(cssStr);\n\n\t\t// Insert the imported sheets first\n\t\tfor (let url of sheet.imported) {\n\t\t\tlet str = await request(url).then((response) => {\n\t\t\t\treturn response.text();\n\t\t\t});\n\t\t\tlet text = await this.convertViaSheet(str, url);\n\t\t\tthis.insert(text);\n\t\t}\n\n\t\tthis.sheets.push(sheet);\n\n\t\tif (typeof sheet.width !== \"undefined\") {\n\t\t\tthis.width = sheet.width;\n\t\t}\n\t\tif (typeof sheet.height !== \"undefined\") {\n\t\t\tthis.height = sheet.height;\n\t\t}\n\t\tif (typeof sheet.orientation !== \"undefined\") {\n\t\t\tthis.orientation = sheet.orientation;\n\t\t}\n\t\treturn sheet.toString();\n\t}\n\n\tinsert(text){\n\t\tlet head = document.querySelector(\"head\");\n\t\tlet style = document.createElement(\"style\");\n\t\tstyle.setAttribute(\"data-pagedjs-inserted-styles\", \"true\");\n\n\t\tstyle.appendChild(document.createTextNode(text));\n\n\t\thead.appendChild(style);\n\n\t\tthis.inserted.push(style);\n\t\treturn style;\n\t}\n\n\tdestroy() {\n\t\tthis.styleEl.remove();\n\t\tthis.inserted.forEach((s) => {\n\t\t\ts.remove();\n\t\t});\n\t\tthis.sheets = [];\n\t}\n}\n\nexport default Polisher;\n","import EventEmitter from \"event-emitter\";\n\nclass Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tlet hooks = Object.assign({}, chunker && chunker.hooks, polisher && polisher.hooks, caller && caller.hooks);\n\t\tthis.chunker = chunker;\n\t\tthis.polisher = polisher;\n\t\tthis.caller = caller;\n\n\t\tfor (let name in hooks) {\n\t\t\tif (name in this) {\n\t\t\t\tlet hook = hooks[name];\n\t\t\t\thook.register(this[name].bind(this));\n\t\t\t}\n\t\t}\n\t}\n}\n\nEventEmitter(Handler.prototype);\n\nexport default Handler;\n","// https://www.w3.org/TR/css3-page/#page-size-prop\n\nexport default {\n\t\"A0\": {\n\t\twidth: {\n\t\t\tvalue: 841,\n\t\t\tunit: \"mm\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 1189,\n\t\t\tunit: \"mm\"\n\t\t}\n\t},\n\t\"A1\": {\n\t\twidth: {\n\t\t\tvalue: 594,\n\t\t\tunit: \"mm\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 841,\n\t\t\tunit: \"mm\"\n\t\t}\n\t},\n\t\"A2\": {\n\t\twidth: {\n\t\t\tvalue: 420,\n\t\t\tunit: \"mm\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 594,\n\t\t\tunit: \"mm\"\n\t\t}\n\t},\n\t\"A3\": {\n\t\twidth: {\n\t\t\tvalue: 297,\n\t\t\tunit: \"mm\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 420,\n\t\t\tunit: \"mm\"\n\t\t}\n\t},\n\t\"A4\": {\n\t\twidth: {\n\t\t\tvalue: 210,\n\t\t\tunit: \"mm\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 297,\n\t\t\tunit: \"mm\"\n\t\t}\n\t},\n\t\"A5\": {\n\t\twidth: {\n\t\t\tvalue: 148,\n\t\t\tunit: \"mm\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 210,\n\t\t\tunit: \"mm\"\n\t\t}\n\t},\n\t\"A6\": {\n\t\twidth: {\n\t\t\tvalue: 105,\n\t\t\tunit: \"mm\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 148,\n\t\t\tunit: \"mm\"\n\t\t}\n\t},\n\t\"A7\": {\n\t\twidth: {\n\t\t\tvalue: 74,\n\t\t\tunit: \"mm\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 105,\n\t\t\tunit: \"mm\"\n\t\t}\n\t},\n\t\"A8\": {\n\t\twidth: {\n\t\t\tvalue: 52,\n\t\t\tunit: \"mm\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 74,\n\t\t\tunit: \"mm\"\n\t\t}\n\t},\n\t\"A9\": {\n\t\twidth: {\n\t\t\tvalue: 37,\n\t\t\tunit: \"mm\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 52,\n\t\t\tunit: \"mm\"\n\t\t}\n\t},\n\t\"A10\": {\n\t\twidth: {\n\t\t\tvalue: 26,\n\t\t\tunit: \"mm\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 37,\n\t\t\tunit: \"mm\"\n\t\t}\n\t},\n\t\"B4\": {\n\t\twidth: {\n\t\t\tvalue: 250,\n\t\t\tunit: \"mm\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 353,\n\t\t\tunit: \"mm\"\n\t\t}\n\t},\n\t\"B5\": {\n\t\twidth: {\n\t\t\tvalue: 176,\n\t\t\tunit: \"mm\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 250,\n\t\t\tunit: \"mm\"\n\t\t}\n\t},\n\t\"letter\": {\n\t\twidth: {\n\t\t\tvalue: 8.5,\n\t\t\tunit: \"in\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 11,\n\t\t\tunit: \"in\"\n\t\t}\n\t},\n\t\"legal\": {\n\t\twidth: {\n\t\t\tvalue: 8.5,\n\t\t\tunit: \"in\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 14,\n\t\t\tunit: \"in\"\n\t\t}\n\t},\n\t\"ledger\": {\n\t\twidth: {\n\t\t\tvalue: 11,\n\t\t\tunit: \"in\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 17,\n\t\t\tunit: \"in\"\n\t\t}\n\t}\n};\n","import Handler from \"../handler.js\";\nimport csstree from \"css-tree\";\nimport pageSizes from \"../../polisher/sizes.js\";\nimport { rebuildAncestors } from \"../../utils/dom.js\";\nimport { CSSValueToString } from \"../../utils/utils.js\";\n\nclass AtPage extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\n\t\tthis.pages = {};\n\n\t\tthis.width = undefined;\n\t\tthis.height = undefined;\n\t\tthis.orientation = undefined;\n\t\tthis.marginalia = {};\n\t}\n\n\tpageModel(selector) {\n\t\treturn {\n\t\t\tselector: selector,\n\t\t\tname: undefined,\n\t\t\tpsuedo: undefined,\n\t\t\tnth: undefined,\n\t\t\tmarginalia: {},\n\t\t\twidth: undefined,\n\t\t\theight: undefined,\n\t\t\torientation: undefined,\n\t\t\tmargin: {\n\t\t\t\ttop: {},\n\t\t\t\tright: {},\n\t\t\t\tleft: {},\n\t\t\t\tbottom: {}\n\t\t\t},\n\t\t\tpadding: {\n\t\t\t\ttop: {},\n\t\t\t\tright: {},\n\t\t\t\tleft: {},\n\t\t\t\tbottom: {}\n\t\t\t},\n\t\t\tborder: {\n\t\t\t\ttop: {},\n\t\t\t\tright: {},\n\t\t\t\tleft: {},\n\t\t\t\tbottom: {}\n\t\t\t},\n\t\t\tbackgroundOrigin: undefined,\n\t\t\tblock: {},\n\t\t\tmarks: undefined,\n\t\t\tnotes: undefined,\n\t\t\tadded: false\n\t\t};\n\t}\n\n\t// Find and Remove @page rules\n\tonAtPage(node, item, list) {\n\t\tlet page, marginalia;\n\t\tlet selector = \"\";\n\t\tlet named, psuedo, nth;\n\t\tlet needsMerge = false;\n\n\t\tif (node.prelude) {\n\t\t\tnamed = this.getTypeSelector(node);\n\t\t\tpsuedo = this.getPsuedoSelector(node);\n\t\t\tnth = this.getNthSelector(node);\n\t\t\tselector = csstree.generate(node.prelude);\n\t\t} else {\n\t\t\tselector = \"*\";\n\t\t}\n\n\t\tif (selector in this.pages) {\n\t\t\t// this.pages[selector] = Object.assign(this.pages[selector], page);\n\t\t\t// console.log(\"after\", selector, this.pages[selector]);\n\n\t\t\t// this.pages[selector].added = false;\n\t\t\tpage = this.pages[selector];\n\t\t\tmarginalia = this.replaceMarginalia(node);\n\t\t\tneedsMerge = true;\n\t\t\t// Mark page for getting classes added again\n\t\t\tpage.added = false;\n\t\t} else {\n\t\t\tpage = this.pageModel(selector);\n\t\t\tmarginalia = this.replaceMarginalia(node);\n\t\t\tthis.pages[selector] = page;\n\t\t}\n\n\t\tpage.name = named;\n\t\tpage.psuedo = psuedo;\n\t\tpage.nth = nth;\n\n\t\tif (needsMerge) {\n\t\t\tpage.marginalia = Object.assign(page.marginalia, marginalia);\n\t\t} else {\n\t\t\tpage.marginalia = marginalia;\n\t\t}\n\n\t\tlet notes = this.replaceNotes(node);\n\t\tpage.notes = notes;\n\n\t\tlet declarations = this.replaceDeclarations(node);\n\n\t\tif (declarations.size) {\n\t\t\tpage.size = declarations.size;\n\t\t\tpage.width = declarations.size.width;\n\t\t\tpage.height = declarations.size.height;\n\t\t\tpage.orientation = declarations.size.orientation;\n\t\t\tpage.format = declarations.size.format;\n\t\t}\n\n\t\tif (declarations.bleed && declarations.bleed[0] != \"auto\") {\n\t\t\tswitch (declarations.bleed.length) {\n\t\t\t\tcase 4: // top right bottom left\n\t\t\t\t\tpage.bleed = {\n\t\t\t\t\t\ttop: declarations.bleed[0],\n\t\t\t\t\t\tright: declarations.bleed[1],\n\t\t\t\t\t\tbottom: declarations.bleed[2],\n\t\t\t\t\t\tleft: declarations.bleed[3]\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3: // top right bottom right\n\t\t\t\t\tpage.bleed = {\n\t\t\t\t\t\ttop: declarations.bleed[0],\n\t\t\t\t\t\tright: declarations.bleed[1],\n\t\t\t\t\t\tbottom: declarations.bleed[2],\n\t\t\t\t\t\tleft: declarations.bleed[1]\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2: // top right top right\n\t\t\t\t\tpage.bleed = {\n\t\t\t\t\t\ttop: declarations.bleed[0],\n\t\t\t\t\t\tright: declarations.bleed[1],\n\t\t\t\t\t\tbottom: declarations.bleed[0],\n\t\t\t\t\t\tleft: declarations.bleed[1]\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tpage.bleed = {\n\t\t\t\t\t\ttop: declarations.bleed[0],\n\t\t\t\t\t\tright: declarations.bleed[0],\n\t\t\t\t\t\tbottom: declarations.bleed[0],\n\t\t\t\t\t\tleft: declarations.bleed[0]\n\t\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tif (declarations.marks) {\n\t\t\tif (!declarations.bleed || declarations.bleed && declarations.bleed[0] === \"auto\") {\n\t\t\t\t// Spec say 6pt, but needs more space for marks\n\t\t\t\tpage.bleed = {\n\t\t\t\t\ttop: { value: 6, unit: \"mm\" },\n\t\t\t\t\tright: { value: 6, unit: \"mm\" },\n\t\t\t\t\tbottom: { value: 6, unit: \"mm\" },\n\t\t\t\t\tleft: { value: 6, unit: \"mm\" }\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tpage.marks = declarations.marks;\n\t\t}\n\n\t\tif (declarations.margin) {\n\t\t\tpage.margin = declarations.margin;\n\t\t}\n\t\tif (declarations.padding) {\n\t\t\tpage.padding = declarations.padding;\n\t\t}\n\n\t\tif (declarations.border) {\n\t\t\tpage.border = declarations.border;\n\t\t}\n\n\t\tif (declarations.marks) {\n\t\t\tpage.marks = declarations.marks;\n\t\t}\n\n\t\tif (needsMerge) {\n\t\t\tpage.block.children.appendList(node.block.children);\n\t\t} else {\n\t\t\tpage.block = node.block;\n\t\t}\n\n\t\t// Remove the rule\n\t\tlist.remove(item);\n\t}\n\n\t/* Handled in breaks */\n\t/*\n\tafterParsed(parsed) {\n\t\tfor (let b in this.named) {\n\t\t\t// Find elements\n\t\t\tlet elements = parsed.querySelectorAll(b);\n\t\t\t// Add break data\n\t\t\tfor (var i = 0; i < elements.length; i++) {\n\t\t\t\telements[i].setAttribute(\"data-page\", this.named[b]);\n\t\t\t}\n\t\t}\n\t}\n\t*/\n\n\tafterTreeWalk(ast, sheet) {\n\t\tlet dirtyPage = \"*\" in this.pages && this.pages[\"*\"].added === false;\n\n\t\tthis.addPageClasses(this.pages, ast, sheet);\n\n\t\tif (dirtyPage) {\n\t\t\tlet width = this.pages[\"*\"].width;\n\t\t\tlet height = this.pages[\"*\"].height;\n\t\t\tlet format = this.pages[\"*\"].format;\n\t\t\tlet orientation = this.pages[\"*\"].orientation;\n\t\t\tlet bleed = this.pages[\"*\"].bleed;\n\t\t\tlet marks = this.pages[\"*\"].marks;\n\t\t\tlet bleedverso = undefined;\n\t\t\tlet bleedrecto = undefined;\n\n\t\t\tif (\":left\" in this.pages) {\n\t\t\t\tbleedverso = this.pages[\":left\"].bleed;\n\t\t\t}\n\n\t\t\tif (\":right\" in this.pages) {\n\t\t\t\tbleedrecto = this.pages[\":right\"].bleed;\n\t\t\t}\n\n\t\t\tif ((width && height) &&\n\t\t\t\t(this.width !== width || this.height !== height)) {\n\t\t\t\tthis.width = width;\n\t\t\t\tthis.height = height;\n\t\t\t\tthis.format = format;\n\t\t\t\tthis.orientation = orientation;\n\n\t\t\t\tthis.addRootVars(ast, width, height, orientation, bleed, bleedrecto, bleedverso, marks);\n\t\t\t\tthis.addRootPage(ast, this.pages[\"*\"].size, bleed, bleedrecto, bleedverso);\n\n\t\t\t\tthis.emit(\"size\", { width, height, orientation, format, bleed });\n\t\t\t\tthis.emit(\"atpages\", this.pages);\n\t\t\t}\n\n\t\t}\n\t}\n\n\tgetTypeSelector(ast) {\n\t\t// Find page name\n\t\tlet name;\n\n\t\tcsstree.walk(ast, {\n\t\t\tvisit: \"TypeSelector\",\n\t\t\tenter: (node, item, list) => {\n\t\t\t\tname = node.name;\n\t\t\t}\n\t\t});\n\n\t\treturn name;\n\t}\n\n\tgetPsuedoSelector(ast) {\n\t\t// Find if it has :left & :right & :black & :first\n\t\tlet name;\n\t\tcsstree.walk(ast, {\n\t\t\tvisit: \"PseudoClassSelector\",\n\t\t\tenter: (node, item, list) => {\n\t\t\t\tif (node.name !== \"nth\") {\n\t\t\t\t\tname = node.name;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn name;\n\t}\n\n\tgetNthSelector(ast) {\n\t\t// Find if it has :nth\n\t\tlet nth;\n\t\tcsstree.walk(ast, {\n\t\t\tvisit: \"PseudoClassSelector\",\n\t\t\tenter: (node, item, list) => {\n\t\t\t\tif (node.name === \"nth\" && node.children) {\n\t\t\t\t\tlet raw = node.children.first();\n\t\t\t\t\tnth = raw.value;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn nth;\n\t}\n\n\treplaceMarginalia(ast) {\n\t\tlet parsed = {};\n\t\tconst MARGINS = [\n\t\t\t\"top-left-corner\", \"top-left\", \"top\", \"top-center\", \"top-right\", \"top-right-corner\",\n\t\t\t\"bottom-left-corner\", \"bottom-left\", \"bottom\", \"bottom-center\", \"bottom-right\", \"bottom-right-corner\",\n\t\t\t\"left-top\", \"left-middle\", \"left\", \"left-bottom\", \"top-right-corner\",\n\t\t\t\"right-top\", \"right-middle\", \"right\", \"right-bottom\", \"right-right-corner\"\n\t\t];\n\t\tcsstree.walk(ast.block, {\n\t\t\tvisit: \"Atrule\",\n\t\t\tenter: (node, item, list) => {\n\t\t\t\tlet name = node.name;\n\t\t\t\tif (MARGINS.includes(name)) {\n\t\t\t\t\tif (name === \"top\") {\n\t\t\t\t\t\tname = \"top-center\";\n\t\t\t\t\t}\n\t\t\t\t\tif (name === \"right\") {\n\t\t\t\t\t\tname = \"right-middle\";\n\t\t\t\t\t}\n\t\t\t\t\tif (name === \"left\") {\n\t\t\t\t\t\tname = \"left-middle\";\n\t\t\t\t\t}\n\t\t\t\t\tif (name === \"bottom\") {\n\t\t\t\t\t\tname = \"bottom-center\";\n\t\t\t\t\t}\n\t\t\t\t\tparsed[name] = node.block;\n\t\t\t\t\tlist.remove(item);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn parsed;\n\t}\n\n\treplaceNotes(ast) {\n\t\tlet parsed = {};\n\n\t\tcsstree.walk(ast.block, {\n\t\t\tvisit: \"Atrule\",\n\t\t\tenter: (node, item, list) => {\n\t\t\t\tlet name = node.name;\n\t\t\t\tif (name === \"footnote\") {\n\t\t\t\t\tparsed[name] = node.block;\n\t\t\t\t\tlist.remove(item);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn parsed;\n\t}\n\n\treplaceDeclarations(ast) {\n\t\tlet parsed = {};\n\n\t\tcsstree.walk(ast.block, {\n\t\t\tvisit: \"Declaration\",\n\t\t\tenter: (declaration, dItem, dList) => {\n\t\t\t\tlet prop = csstree.property(declaration.property).name;\n\t\t\t\t// let value = declaration.value;\n\n\t\t\t\tif (prop === \"marks\") {\n\t\t\t\t\tparsed.marks = [];\n\t\t\t\t\tcsstree.walk(declaration, {\n\t\t\t\t\t\tvisit: \"Identifier\",\n\t\t\t\t\t\tenter: (ident) => {\n\t\t\t\t\t\t\tparsed.marks.push(ident.name);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tdList.remove(dItem);\n\t\t\t\t} else if (prop === \"margin\") {\n\t\t\t\t\tparsed.margin = this.getMargins(declaration);\n\t\t\t\t\tdList.remove(dItem);\n\n\t\t\t\t} else if (prop.indexOf(\"margin-\") === 0) {\n\t\t\t\t\tlet m = prop.substring(\"margin-\".length);\n\t\t\t\t\tif (!parsed.margin) {\n\t\t\t\t\t\tparsed.margin = {\n\t\t\t\t\t\t\ttop: {},\n\t\t\t\t\t\t\tright: {},\n\t\t\t\t\t\t\tleft: {},\n\t\t\t\t\t\t\tbottom: {}\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tparsed.margin[m] = declaration.value.children.first();\n\t\t\t\t\tdList.remove(dItem);\n\n\t\t\t\t} else if (prop === \"padding\") {\n\t\t\t\t\tparsed.padding = this.getPaddings(declaration.value);\n\t\t\t\t\tdList.remove(dItem);\n\n\t\t\t\t} else if (prop.indexOf(\"padding-\") === 0) {\n\t\t\t\t\tlet p = prop.substring(\"padding-\".length);\n\t\t\t\t\tif (!parsed.padding) {\n\t\t\t\t\t\tparsed.padding = {\n\t\t\t\t\t\t\ttop: {},\n\t\t\t\t\t\t\tright: {},\n\t\t\t\t\t\t\tleft: {},\n\t\t\t\t\t\t\tbottom: {}\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tparsed.padding[p] = declaration.value.children.first();\n\t\t\t\t\tdList.remove(dItem);\n\t\t\t\t}\n\n\t\t\t\telse if (prop === \"border\") {\n\t\t\t\t\tif (!parsed.border) {\n\t\t\t\t\t\tparsed.border = {\n\t\t\t\t\t\t\ttop: {},\n\t\t\t\t\t\t\tright: {},\n\t\t\t\t\t\t\tleft: {},\n\t\t\t\t\t\t\tbottom: {}\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tparsed.border.top = csstree.generate(declaration.value);\n\t\t\t\t\tparsed.border.right = csstree.generate(declaration.value);\n\t\t\t\t\tparsed.border.left = csstree.generate(declaration.value);\n\t\t\t\t\tparsed.border.bottom = csstree.generate(declaration.value);\n\n\t\t\t\t\tdList.remove(dItem);\n\n\t\t\t\t}\n\n\t\t\t\telse if (prop.indexOf(\"border-\") === 0) {\n\t\t\t\t\tif (!parsed.border) {\n\t\t\t\t\t\tparsed.border = {\n\t\t\t\t\t\t\ttop: {},\n\t\t\t\t\t\t\tright: {},\n\t\t\t\t\t\t\tleft: {},\n\t\t\t\t\t\t\tbottom: {}\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tlet p = prop.substring(\"border-\".length);\n\n\t\t\t\t\tparsed.border[p] = csstree.generate(declaration.value);\n\t\t\t\t\tdList.remove(dItem);\n\n\t\t\t\t}\n\n\t\t\t\telse if (prop === \"size\") {\n\t\t\t\t\tparsed.size = this.getSize(declaration);\n\t\t\t\t\tdList.remove(dItem);\n\t\t\t\t} else if (prop === \"bleed\") {\n\t\t\t\t\tparsed.bleed = [];\n\n\t\t\t\t\tcsstree.walk(declaration, {\n\t\t\t\t\t\tenter: (subNode) => {\n\t\t\t\t\t\t\tswitch (subNode.type) {\n\t\t\t\t\t\t\t\tcase \"String\": // bleed: \"auto\"\n\t\t\t\t\t\t\t\t\tif (subNode.value.indexOf(\"auto\") > -1) {\n\t\t\t\t\t\t\t\t\t\tparsed.bleed.push(\"auto\");\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase \"Dimension\": // bleed: 1in 2in, bleed: 20px ect.\n\t\t\t\t\t\t\t\t\tparsed.bleed.push({\n\t\t\t\t\t\t\t\t\t\tvalue: subNode.value,\n\t\t\t\t\t\t\t\t\t\tunit: subNode.unit\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase \"Number\":\n\t\t\t\t\t\t\t\t\tparsed.bleed.push({\n\t\t\t\t\t\t\t\t\t\tvalue: subNode.value,\n\t\t\t\t\t\t\t\t\t\tunit: \"px\"\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t// ignore\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tdList.remove(dItem);\n\t\t\t\t}\n\n\t\t\t}\n\t\t});\n\n\t\treturn parsed;\n\n\t}\n\tgetSize(declaration) {\n\t\tlet width, height, orientation, format;\n\n\t\t// Get size: Xmm Ymm\n\t\tcsstree.walk(declaration, {\n\t\t\tvisit: \"Dimension\",\n\t\t\tenter: (node, item, list) => {\n\t\t\t\tlet { value, unit } = node;\n\t\t\t\tif (typeof width === \"undefined\") {\n\t\t\t\t\twidth = { value, unit };\n\t\t\t\t} else if (typeof height === \"undefined\") {\n\t\t\t\t\theight = { value, unit };\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Get size: \"A4\"\n\t\tcsstree.walk(declaration, {\n\t\t\tvisit: \"String\",\n\t\t\tenter: (node, item, list) => {\n\t\t\t\tlet name = node.value.replace(/[\"|']/g, \"\");\n\t\t\t\tlet s = pageSizes[name];\n\t\t\t\tif (s) {\n\t\t\t\t\twidth = s.width;\n\t\t\t\t\theight = s.height;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Get Format or Landscape or Portrait\n\t\tcsstree.walk(declaration, {\n\t\t\tvisit: \"Identifier\",\n\t\t\tenter: (node, item, list) => {\n\t\t\t\tlet name = node.name;\n\t\t\t\tif (name === \"landscape\" || name === \"portrait\") {\n\t\t\t\t\torientation = node.name;\n\t\t\t\t} else if (name !== \"auto\") {\n\t\t\t\t\tlet s = pageSizes[name];\n\t\t\t\t\tif (s) {\n\t\t\t\t\t\twidth = s.width;\n\t\t\t\t\t\theight = s.height;\n\t\t\t\t\t}\n\t\t\t\t\tformat = name;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn {\n\t\t\twidth,\n\t\t\theight,\n\t\t\torientation,\n\t\t\tformat\n\t\t};\n\t}\n\n\tgetMargins(declaration) {\n\t\tlet margins = [];\n\t\tlet margin = {\n\t\t\ttop: {},\n\t\t\tright: {},\n\t\t\tleft: {},\n\t\t\tbottom: {}\n\t\t};\n\n\t\tcsstree.walk(declaration, {\n\t\t\tenter: (node) => {\n\t\t\t\tswitch (node.type) {\n\t\t\t\t\tcase \"Dimension\": // margin: 1in 2in, margin: 20px, etc...\n\t\t\t\t\t\tmargins.push(node);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Number\": // margin: 0\n\t\t\t\t\t\tmargins.push({value: node.value, unit: \"px\"});\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t// ignore\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (margins.length === 1) {\n\t\t\tfor (let m in margin) {\n\t\t\t\tmargin[m] = margins[0];\n\t\t\t}\n\t\t} else if (margins.length === 2) {\n\t\t\tmargin.top = margins[0];\n\t\t\tmargin.right = margins[1];\n\t\t\tmargin.bottom = margins[0];\n\t\t\tmargin.left = margins[1];\n\t\t} else if (margins.length === 3) {\n\t\t\tmargin.top = margins[0];\n\t\t\tmargin.right = margins[1];\n\t\t\tmargin.bottom = margins[2];\n\t\t\tmargin.left = margins[1];\n\t\t} else if (margins.length === 4) {\n\t\t\tmargin.top = margins[0];\n\t\t\tmargin.right = margins[1];\n\t\t\tmargin.bottom = margins[2];\n\t\t\tmargin.left = margins[3];\n\t\t}\n\n\t\treturn margin;\n\t}\n\n\tgetPaddings(declaration) {\n\t\tlet paddings = [];\n\t\tlet padding = {\n\t\t\ttop: {},\n\t\t\tright: {},\n\t\t\tleft: {},\n\t\t\tbottom: {}\n\t\t};\n\n\t\tcsstree.walk(declaration, {\n\t\t\tenter: (node) => {\n\t\t\t\tswitch (node.type) {\n\t\t\t\t\tcase \"Dimension\": // padding: 1in 2in, padding: 20px, etc...\n\t\t\t\t\t\tpaddings.push(node);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Number\": // padding: 0\n\t\t\t\t\t\tpaddings.push({value: node.value, unit: \"px\"});\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t// ignore\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tif (paddings.length === 1) {\n\t\t\tfor (let p in padding) {\n\t\t\t\tpadding[p] = paddings[0];\n\t\t\t}\n\t\t} else if (paddings.length === 2) {\n\n\t\t\tpadding.top = paddings[0];\n\t\t\tpadding.right = paddings[1];\n\t\t\tpadding.bottom = paddings[0];\n\t\t\tpadding.left = paddings[1];\n\t\t} else if (paddings.length === 3) {\n\n\t\t\tpadding.top = paddings[0];\n\t\t\tpadding.right = paddings[1];\n\t\t\tpadding.bottom = paddings[2];\n\t\t\tpadding.left = paddings[1];\n\t\t} else if (paddings.length === 4) {\n\n\t\t\tpadding.top = paddings[0];\n\t\t\tpadding.right = paddings[1];\n\t\t\tpadding.bottom = paddings[2];\n\t\t\tpadding.left = paddings[3];\n\t\t}\n\t\treturn padding;\n\t}\n\n\t// get values for the border on the @page to pass them to the element with the .pagedjs_area class\n\tgetBorders(declaration) {\n\t\tlet border = {\n\t\t\ttop: {},\n\t\t\tright: {},\n\t\t\tleft: {},\n\t\t\tbottom: {}\n\t\t};\n\n\t\tif (declaration.prop == \"border\") {\n\t\t\tborder.top = csstree.generate(declaration.value);\n\t\t\tborder.right = csstree.generate(declaration.value);\n\t\t\tborder.bottom = csstree.generate(declaration.value);\n\t\t\tborder.left = csstree.generate(declaration.value);\n\n\t\t}\n\t\telse if (declaration.prop == \"border-top\") {\n\t\t\tborder.top = csstree.generate(declaration.value);\n\t\t}\n\t\telse if (declaration.prop == \"border-right\") {\n\t\t\tborder.right = csstree.generate(declaration.value);\n\n\t\t}\n\t\telse if (declaration.prop == \"border-bottom\") {\n\t\t\tborder.bottom = csstree.generate(declaration.value);\n\n\t\t}\n\t\telse if (declaration.prop == \"border-left\") {\n\t\t\tborder.left = csstree.generate(declaration.value);\n\t\t}\n\n\t\treturn border;\n\t}\n\n\n\taddPageClasses(pages, ast, sheet) {\n\t\t// First add * page\n\t\tif (\"*\" in pages && pages[\"*\"].added === false) {\n\t\t\tlet p = this.createPage(pages[\"*\"], ast.children, sheet);\n\t\t\tsheet.insertRule(p);\n\t\t\tpages[\"*\"].added = true;\n\t\t}\n\t\t// Add :left & :right\n\t\tif (\":left\" in pages && pages[\":left\"].added === false) {\n\t\t\tlet left = this.createPage(pages[\":left\"], ast.children, sheet);\n\t\t\tsheet.insertRule(left);\n\t\t\tpages[\":left\"].added = true;\n\t\t}\n\t\tif (\":right\" in pages && pages[\":right\"].added === false) {\n\t\t\tlet right = this.createPage(pages[\":right\"], ast.children, sheet);\n\t\t\tsheet.insertRule(right);\n\t\t\tpages[\":right\"].added = true;\n\t\t}\n\t\t// Add :first & :blank\n\t\tif (\":first\" in pages && pages[\":first\"].added === false) {\n\t\t\tlet first = this.createPage(pages[\":first\"], ast.children, sheet);\n\t\t\tsheet.insertRule(first);\n\t\t\tpages[\":first\"].added = true;\n\t\t}\n\t\tif (\":blank\" in pages && pages[\":blank\"].added === false) {\n\t\t\tlet blank = this.createPage(pages[\":blank\"], ast.children, sheet);\n\t\t\tsheet.insertRule(blank);\n\t\t\tpages[\":blank\"].added = true;\n\t\t}\n\t\t// Add nth pages\n\t\tfor (let pg in pages) {\n\t\t\tif (pages[pg].nth && pages[pg].added === false) {\n\t\t\t\tlet nth = this.createPage(pages[pg], ast.children, sheet);\n\t\t\t\tsheet.insertRule(nth);\n\t\t\t\tpages[pg].added = true;\n\t\t\t}\n\t\t}\n\n\t\t// Add named pages\n\t\tfor (let pg in pages) {\n\t\t\tif (pages[pg].name && pages[pg].added === false) {\n\t\t\t\tlet named = this.createPage(pages[pg], ast.children, sheet);\n\t\t\t\tsheet.insertRule(named);\n\t\t\t\tpages[pg].added = true;\n\t\t\t}\n\t\t}\n\n\t}\n\n\tcreatePage(page, ruleList, sheet) {\n\n\t\tlet selectors = this.selectorsForPage(page);\n\t\tlet children = page.block.children.copy();\n\t\tlet block = {\n\t\t\ttype: \"Block\",\n\t\t\tloc: 0,\n\t\t\tchildren: children\n\t\t};\n\n\n\t\tlet rule = this.createRule(selectors, block);\n\n\t\tthis.addMarginVars(page.margin, children, children.first());\n\t\tthis.addPaddingVars(page.padding, children, children.first());\n\t\tthis.addBorderVars(page.border, children, children.first());\n\n\n\t\tif (page.width) {\n\t\t\tthis.addDimensions(page.width, page.height, page.orientation, children, children.first());\n\t\t}\n\n\t\tif (page.marginalia) {\n\t\t\tthis.addMarginaliaStyles(page, ruleList, rule, sheet);\n\t\t\tthis.addMarginaliaContent(page, ruleList, rule, sheet);\n\t\t}\n\n\t\tif(page.notes) {\n\t\t\tthis.addNotesStyles(page.notes, page, ruleList, rule, sheet);\n\t\t}\n\n\t\treturn rule;\n\t}\n\n\taddMarginVars(margin, list, item) {\n\t\t// variables for margins\n\t\tfor (let m in margin) {\n\t\t\tif (typeof margin[m].value !== \"undefined\") {\n\t\t\t\tlet value = margin[m].value + (margin[m].unit || \"\");\n\t\t\t\tlet mVar = list.createItem({\n\t\t\t\t\ttype: \"Declaration\",\n\t\t\t\t\tproperty: \"--pagedjs-margin-\" + m,\n\t\t\t\t\tvalue: {\n\t\t\t\t\t\ttype: \"Raw\",\n\t\t\t\t\t\tvalue: value\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tlist.append(mVar, item);\n\n\t\t\t}\n\t\t}\n\t}\n\n\taddPaddingVars(padding, list, item) {\n\t\t// variables for padding\n\t\tfor (let p in padding) {\n\n\t\t\tif (typeof padding[p].value !== \"undefined\") {\n\t\t\t\tlet value = padding[p].value + (padding[p].unit || \"\");\n\t\t\t\tlet pVar = list.createItem({\n\t\t\t\t\ttype: \"Declaration\",\n\t\t\t\t\tproperty: \"--pagedjs-padding-\" + p,\n\t\t\t\t\tvalue: {\n\t\t\t\t\t\ttype: \"Raw\",\n\t\t\t\t\t\tvalue: value\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tlist.append(pVar, item);\n\t\t\t}\n\n\t\t}\n\t}\n\n\taddBorderVars(border, list, item) {\n\t\t// variables for borders\n\t\tfor (const name of Object.keys(border)) {\n\t\t\tconst value = border[name];\n\t\t\t// value is an empty object when undefined\n\t\t\tif (typeof value === \"string\") {\n\t\t\t\tconst borderItem = list.createItem({\n\t\t\t\t\ttype: \"Declaration\",\n\t\t\t\t\tproperty: \"--pagedjs-border-\" + name,\n\t\t\t\t\tvalue: {\n\t\t\t\t\t\ttype: \"Raw\",\n\t\t\t\t\t\tvalue: value\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tlist.append(borderItem, item);\n\t\t\t}\n\t\t}\n\t}\n\n\taddDimensions(width, height, orientation, list, item) {\n\t\tlet widthString, heightString;\n\n\t\twidthString = CSSValueToString(width);\n\t\theightString = CSSValueToString(height);\n\n\t\tif (orientation && orientation !== \"portrait\") {\n\t\t\t// reverse for orientation\n\t\t\t[widthString, heightString] = [heightString, widthString];\n\t\t}\n\n\t\t// width variable\n\t\tlet wVar = this.createVariable(\"--pagedjs-pagebox-width\", widthString);\n\t\tlist.appendData(wVar);\n\n\t\t// height variable\n\t\tlet hVar = this.createVariable(\"--pagedjs-pagebox-height\", heightString);\n\t\tlist.appendData(hVar);\n\n\t\t// let w = this.createDimension(\"width\", width);\n\t\t// let h = this.createDimension(\"height\", height);\n\t\t// list.appendData(w);\n\t\t// list.appendData(h);\n\t}\n\n\taddMarginaliaStyles(page, list, item, sheet) {\n\t\tfor (let loc in page.marginalia) {\n\t\t\tlet block = csstree.clone(page.marginalia[loc]);\n\t\t\tlet hasContent = false;\n\n\t\t\tif (block.children.isEmpty()) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tcsstree.walk(block, {\n\t\t\t\tvisit: \"Declaration\",\n\t\t\t\tenter: (node, item, list) => {\n\t\t\t\t\tif (node.property === \"content\") {\n\t\t\t\t\t\tif (node.value.children && node.value.children.first().name === \"none\") {\n\t\t\t\t\t\t\thasContent = false;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\thasContent = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlist.remove(item);\n\t\t\t\t\t}\n\t\t\t\t\tif (node.property === \"vertical-align\") {\n\t\t\t\t\t\tcsstree.walk(node, {\n\t\t\t\t\t\t\tvisit: \"Identifier\",\n\t\t\t\t\t\t\tenter: (identNode, identItem, identlist) => {\n\t\t\t\t\t\t\t\tlet name = identNode.name;\n\t\t\t\t\t\t\t\tif (name === \"top\") {\n\t\t\t\t\t\t\t\t\tidentNode.name = \"flex-start\";\n\t\t\t\t\t\t\t\t} else if (name === \"middle\") {\n\t\t\t\t\t\t\t\t\tidentNode.name = \"center\";\n\t\t\t\t\t\t\t\t} else if (name === \"bottom\") {\n\t\t\t\t\t\t\t\t\tidentNode.name = \"flex-end\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnode.property = \"align-items\";\n\t\t\t\t\t}\n\n\t\t\t\t\tif (node.property === \"width\" &&\n\t\t\t\t\t\t(loc === \"top-left\" ||\n\t\t\t\t\t\t\tloc === \"top-center\" ||\n\t\t\t\t\t\t\tloc === \"top-right\" ||\n\t\t\t\t\t\t\tloc === \"bottom-left\" ||\n\t\t\t\t\t\t\tloc === \"bottom-center\" ||\n\t\t\t\t\t\t\tloc === \"bottom-right\")) {\n\t\t\t\t\t\tlet c = csstree.clone(node);\n\t\t\t\t\t\tc.property = \"max-width\";\n\t\t\t\t\t\tlist.appendData(c);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (node.property === \"height\" &&\n\t\t\t\t\t\t(loc === \"left-top\" ||\n\t\t\t\t\t\t\tloc === \"left-middle\" ||\n\t\t\t\t\t\t\tloc === \"left-bottom\" ||\n\t\t\t\t\t\t\tloc === \"right-top\" ||\n\t\t\t\t\t\t\tloc === \"right-middle\" ||\n\t\t\t\t\t\t\tloc === \"right-bottom\")) {\n\t\t\t\t\t\tlet c = csstree.clone(node);\n\t\t\t\t\t\tc.property = \"max-height\";\n\t\t\t\t\t\tlist.appendData(c);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlet marginSelectors = this.selectorsForPageMargin(page, loc);\n\t\t\tlet marginRule = this.createRule(marginSelectors, block);\n\n\t\t\tlist.appendData(marginRule);\n\n\t\t\tlet sel = csstree.generate({\n\t\t\t\ttype: \"Selector\",\n\t\t\t\tchildren: marginSelectors\n\t\t\t});\n\n\t\t\tthis.marginalia[sel] = {\n\t\t\t\tpage: page,\n\t\t\t\tselector: sel,\n\t\t\t\tblock: page.marginalia[loc],\n\t\t\t\thasContent: hasContent\n\t\t\t};\n\n\t\t}\n\t}\n\n\taddMarginaliaContent(page, list, item, sheet) {\n\t\tlet displayNone;\n\t\t// Just content\n\t\tfor (let loc in page.marginalia) {\n\t\t\tlet content = csstree.clone(page.marginalia[loc]);\n\t\t\tcsstree.walk(content, {\n\t\t\t\tvisit: \"Declaration\",\n\t\t\t\tenter: (node, item, list) => {\n\t\t\t\t\tif (node.property !== \"content\") {\n\t\t\t\t\t\tlist.remove(item);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (node.value.children && node.value.children.first().name === \"none\") {\n\t\t\t\t\t\tdisplayNone = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (content.children.isEmpty()) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet displaySelectors = this.selectorsForPageMargin(page, loc);\n\t\t\tlet displayDeclaration;\n\n\t\t\tdisplaySelectors.insertData({\n\t\t\t\ttype: \"Combinator\",\n\t\t\t\tname: \">\"\n\t\t\t});\n\n\t\t\tdisplaySelectors.insertData({\n\t\t\t\ttype: \"ClassSelector\",\n\t\t\t\tname: \"pagedjs_margin-content\"\n\t\t\t});\n\n\t\t\tdisplaySelectors.insertData({\n\t\t\t\ttype: \"Combinator\",\n\t\t\t\tname: \">\"\n\t\t\t});\n\n\t\t\tdisplaySelectors.insertData({\n\t\t\t\ttype: \"TypeSelector\",\n\t\t\t\tname: \"*\"\n\t\t\t});\n\n\t\t\tif (displayNone) {\n\t\t\t\tdisplayDeclaration = this.createDeclaration(\"display\", \"none\");\n\t\t\t} else {\n\t\t\t\tdisplayDeclaration = this.createDeclaration(\"display\", \"block\");\n\t\t\t}\n\n\t\t\tlet displayRule = this.createRule(displaySelectors, [displayDeclaration]);\n\t\t\tsheet.insertRule(displayRule);\n\n\t\t\t// insert content rule\n\t\t\tlet contentSelectors = this.selectorsForPageMargin(page, loc);\n\n\t\t\tcontentSelectors.insertData({\n\t\t\t\ttype: \"Combinator\",\n\t\t\t\tname: \">\"\n\t\t\t});\n\n\t\t\tcontentSelectors.insertData({\n\t\t\t\ttype: \"ClassSelector\",\n\t\t\t\tname: \"pagedjs_margin-content\"\n\t\t\t});\n\n\t\t\tcontentSelectors.insertData({\n\t\t\t\ttype: \"PseudoElementSelector\",\n\t\t\t\tname: \"after\",\n\t\t\t\tchildren: null\n\t\t\t});\n\n\t\t\tlet contentRule = this.createRule(contentSelectors, content);\n\t\t\tsheet.insertRule(contentRule);\n\t\t}\n\t}\n\n\taddRootVars(ast, width, height, orientation, bleed, bleedrecto, bleedverso, marks) {\n\t\tlet rules = [];\n\t\tlet selectors = new csstree.List();\n\t\tselectors.insertData({\n\t\t\ttype: \"PseudoClassSelector\",\n\t\t\tname: \"root\",\n\t\t\tchildren: null\n\t\t});\n\n\t\tlet widthString, heightString;\n\t\tlet widthStringRight, heightStringRight;\n\t\tlet widthStringLeft, heightStringLeft;\n\n\t\tif (!bleed) {\n\t\t\twidthString = CSSValueToString(width);\n\t\t\theightString = CSSValueToString(height);\n\t\t\twidthStringRight = CSSValueToString(width);\n\t\t\theightStringRight = CSSValueToString(height);\n\t\t\twidthStringLeft = CSSValueToString(width);\n\t\t\theightStringLeft = CSSValueToString(height);\n\t\t} else {\n\t\t\twidthString = `calc( ${CSSValueToString(width)} + ${CSSValueToString(bleed.left)} + ${CSSValueToString(bleed.right)} )`;\n\t\t\theightString = `calc( ${CSSValueToString(height)} + ${CSSValueToString(bleed.top)} + ${CSSValueToString(bleed.bottom)} )`;\n\n\t\t\twidthStringRight = `calc( ${CSSValueToString(width)} + ${CSSValueToString(bleed.left)} + ${CSSValueToString(bleed.right)} )`;\n\t\t\theightStringRight = `calc( ${CSSValueToString(height)} + ${CSSValueToString(bleed.top)} + ${CSSValueToString(bleed.bottom)} )`;\n\n\t\t\twidthStringLeft = `calc( ${CSSValueToString(width)} + ${CSSValueToString(bleed.left)} + ${CSSValueToString(bleed.right)} )`;\n\t\t\theightStringLeft = `calc( ${CSSValueToString(height)} + ${CSSValueToString(bleed.top)} + ${CSSValueToString(bleed.bottom)} )`;\n\n\t\t\tlet bleedTop = this.createVariable(\"--pagedjs-bleed-top\", CSSValueToString(bleed.top));\n\t\t\tlet bleedRight = this.createVariable(\"--pagedjs-bleed-right\", CSSValueToString(bleed.right));\n\t\t\tlet bleedBottom = this.createVariable(\"--pagedjs-bleed-bottom\", CSSValueToString(bleed.bottom));\n\t\t\tlet bleedLeft = this.createVariable(\"--pagedjs-bleed-left\", CSSValueToString(bleed.left));\n\n\t\t\tlet bleedTopRecto = this.createVariable(\"--pagedjs-bleed-right-top\", CSSValueToString(bleed.top));\n\t\t\tlet bleedRightRecto = this.createVariable(\"--pagedjs-bleed-right-right\", CSSValueToString(bleed.right));\n\t\t\tlet bleedBottomRecto = this.createVariable(\"--pagedjs-bleed-right-bottom\", CSSValueToString(bleed.bottom));\n\t\t\tlet bleedLeftRecto = this.createVariable(\"--pagedjs-bleed-right-left\", CSSValueToString(bleed.left));\n\n\t\t\tlet bleedTopVerso = this.createVariable(\"--pagedjs-bleed-left-top\", CSSValueToString(bleed.top));\n\t\t\tlet bleedRightVerso = this.createVariable(\"--pagedjs-bleed-left-right\", CSSValueToString(bleed.right));\n\t\t\tlet bleedBottomVerso = this.createVariable(\"--pagedjs-bleed-left-bottom\", CSSValueToString(bleed.bottom));\n\t\t\tlet bleedLeftVerso = this.createVariable(\"--pagedjs-bleed-left-left\", CSSValueToString(bleed.left));\n\n\t\t\tif (bleedrecto) {\n\t\t\t\tbleedTopRecto = this.createVariable(\"--pagedjs-bleed-right-top\", CSSValueToString(bleedrecto.top));\n\t\t\t\tbleedRightRecto = this.createVariable(\"--pagedjs-bleed-right-right\", CSSValueToString(bleedrecto.right));\n\t\t\t\tbleedBottomRecto = this.createVariable(\"--pagedjs-bleed-right-bottom\", CSSValueToString(bleedrecto.bottom));\n\t\t\t\tbleedLeftRecto = this.createVariable(\"--pagedjs-bleed-right-left\", CSSValueToString(bleedrecto.left));\n\n\t\t\t\twidthStringRight = `calc( ${CSSValueToString(width)} + ${CSSValueToString(bleedrecto.left)} + ${CSSValueToString(bleedrecto.right)} )`;\n\t\t\t\theightStringRight = `calc( ${CSSValueToString(height)} + ${CSSValueToString(bleedrecto.top)} + ${CSSValueToString(bleedrecto.bottom)} )`;\n\t\t\t}\n\t\t\tif (bleedverso) {\n\t\t\t\tbleedTopVerso = this.createVariable(\"--pagedjs-bleed-left-top\", CSSValueToString(bleedverso.top));\n\t\t\t\tbleedRightVerso = this.createVariable(\"--pagedjs-bleed-left-right\", CSSValueToString(bleedverso.right));\n\t\t\t\tbleedBottomVerso = this.createVariable(\"--pagedjs-bleed-left-bottom\", CSSValueToString(bleedverso.bottom));\n\t\t\t\tbleedLeftVerso = this.createVariable(\"--pagedjs-bleed-left-left\", CSSValueToString(bleedverso.left));\n\n\t\t\t\twidthStringLeft = `calc( ${CSSValueToString(width)} + ${CSSValueToString(bleedverso.left)} + ${CSSValueToString(bleedverso.right)} )`;\n\t\t\t\theightStringLeft = `calc( ${CSSValueToString(height)} + ${CSSValueToString(bleedverso.top)} + ${CSSValueToString(bleedverso.bottom)} )`;\n\t\t\t}\n\n\t\t\tlet pageWidthVar = this.createVariable(\"--pagedjs-width\", CSSValueToString(width));\n\t\t\tlet pageHeightVar = this.createVariable(\"--pagedjs-height\", CSSValueToString(height));\n\n\t\t\trules.push(\n\t\t\t\tbleedTop,\n\t\t\t\tbleedRight,\n\t\t\t\tbleedBottom,\n\t\t\t\tbleedLeft,\n\t\t\t\tbleedTopRecto,\n\t\t\t\tbleedRightRecto,\n\t\t\t\tbleedBottomRecto,\n\t\t\t\tbleedLeftRecto,\n\t\t\t\tbleedTopVerso,\n\t\t\t\tbleedRightVerso,\n\t\t\t\tbleedBottomVerso,\n\t\t\t\tbleedLeftVerso,\n\t\t\t\tpageWidthVar,\n\t\t\t\tpageHeightVar\n\t\t\t);\n\t\t}\n\n\t\tif (marks) {\n\t\t\tmarks.forEach((mark) => {\n\t\t\t\tlet markDisplay = this.createVariable(\"--pagedjs-mark-\" + mark + \"-display\", \"block\");\n\t\t\t\trules.push(markDisplay);\n\t\t\t});\n\t\t}\n\n\t\t// orientation variable\n\t\tif (orientation) {\n\t\t\tlet oVar = this.createVariable(\"--pagedjs-orientation\", orientation);\n\t\t\trules.push(oVar);\n\n\t\t\tif (orientation !== \"portrait\") {\n\t\t\t\t// reverse for orientation\n\t\t\t\t[widthString, heightString] = [heightString, widthString];\n\t\t\t\t[widthStringRight, heightStringRight] = [heightStringRight, widthStringRight];\n\t\t\t\t[widthStringLeft, heightStringLeft] = [heightStringLeft, widthStringLeft];\n\t\t\t}\n\t\t}\n\n\t\tlet wVar = this.createVariable(\"--pagedjs-width\", widthString);\n\t\tlet hVar = this.createVariable(\"--pagedjs-height\", heightString);\n\n\t\tlet wVarR = this.createVariable(\"--pagedjs-width-right\", widthStringRight);\n\t\tlet hVarR = this.createVariable(\"--pagedjs-height-right\", heightStringRight);\n\n\t\tlet wVarL = this.createVariable(\"--pagedjs-width-left\", widthStringLeft);\n\t\tlet hVarL = this.createVariable(\"--pagedjs-height-left\", heightStringLeft);\n\n\t\trules.push(wVar, hVar, wVarR, hVarR, wVarL, hVarL);\n\n\t\tlet rule = this.createRule(selectors, rules);\n\n\t\tast.children.appendData(rule);\n\t}\n\n\n\taddNotesStyles(notes, page, list, item, sheet) {\n\n\t\tfor (const note in notes) {\n\t\t\tlet selectors = this.selectorsForPage(page);\n\n\t\t\tselectors.insertData({\n\t\t\t\ttype: \"Combinator\",\n\t\t\t\tname: \" \"\n\t\t\t});\n\n\t\t\tselectors.insertData({\n\t\t\t\ttype: \"ClassSelector\",\n\t\t\t\tname: \"pagedjs_\" + note + \"_content\"\n\t\t\t});\n\n\t\t\tlet notesRule = this.createRule(selectors, notes[note]);\n\n\t\t\tlist.appendData(notesRule);\n\t\t}\n\n\t}\n\n\t/*\n\t@page {\n\t\tsize: var(--pagedjs-width) var(--pagedjs-height);\n\t\tmargin: 0;\n\t\tpadding: 0;\n\t}\n\t*/\n\taddRootPage(ast, size, bleed, bleedrecto, bleedverso) {\n\t\tlet { width, height, orientation, format } = size;\n\t\tlet children = new csstree.List();\n\t\tlet childrenLeft = new csstree.List();\n\t\tlet childrenRight = new csstree.List();\n\t\tlet dimensions = new csstree.List();\n\t\tlet dimensionsLeft = new csstree.List();\n\t\tlet dimensionsRight = new csstree.List();\n\n\t\tif (bleed) {\n\t\t\tlet widthCalculations = new csstree.List();\n\t\t\tlet heightCalculations = new csstree.List();\n\n\t\t\t// width\n\t\t\twidthCalculations.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: width.unit,\n\t\t\t\tvalue: width.value\n\t\t\t});\n\n\t\t\twidthCalculations.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\twidthCalculations.appendData({\n\t\t\t\ttype: \"Operator\",\n\t\t\t\tvalue: \"+\"\n\t\t\t});\n\n\t\t\twidthCalculations.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\twidthCalculations.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: bleed.left.unit,\n\t\t\t\tvalue: bleed.left.value\n\t\t\t});\n\n\t\t\twidthCalculations.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\twidthCalculations.appendData({\n\t\t\t\ttype: \"Operator\",\n\t\t\t\tvalue: \"+\"\n\t\t\t});\n\n\t\t\twidthCalculations.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\twidthCalculations.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: bleed.right.unit,\n\t\t\t\tvalue: bleed.right.value\n\t\t\t});\n\n\t\t\t// height\n\t\t\theightCalculations.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: height.unit,\n\t\t\t\tvalue: height.value\n\t\t\t});\n\n\t\t\theightCalculations.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\theightCalculations.appendData({\n\t\t\t\ttype: \"Operator\",\n\t\t\t\tvalue: \"+\"\n\t\t\t});\n\n\t\t\theightCalculations.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\theightCalculations.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: bleed.top.unit,\n\t\t\t\tvalue: bleed.top.value\n\t\t\t});\n\n\t\t\theightCalculations.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\theightCalculations.appendData({\n\t\t\t\ttype: \"Operator\",\n\t\t\t\tvalue: \"+\"\n\t\t\t});\n\n\t\t\theightCalculations.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\theightCalculations.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: bleed.bottom.unit,\n\t\t\t\tvalue: bleed.bottom.value\n\t\t\t});\n\n\t\t\tdimensions.appendData({\n\t\t\t\ttype: \"Function\",\n\t\t\t\tname: \"calc\",\n\t\t\t\tchildren: widthCalculations\n\t\t\t});\n\n\t\t\tdimensions.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\tdimensions.appendData({\n\t\t\t\ttype: \"Function\",\n\t\t\t\tname: \"calc\",\n\t\t\t\tchildren: heightCalculations\n\t\t\t});\n\n\t\t} else if (format) {\n\t\t\tdimensions.appendData({\n\t\t\t\ttype: \"Identifier\",\n\t\t\t\tname: format\n\t\t\t});\n\n\t\t\tif (orientation) {\n\t\t\t\tdimensions.appendData({\n\t\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\t\tvalue: \" \"\n\t\t\t\t});\n\n\t\t\t\tdimensions.appendData({\n\t\t\t\t\ttype: \"Identifier\",\n\t\t\t\t\tname: orientation\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tdimensions.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: width.unit,\n\t\t\t\tvalue: width.value\n\t\t\t});\n\n\t\t\tdimensions.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\tdimensions.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: height.unit,\n\t\t\t\tvalue: height.value\n\t\t\t});\n\t\t}\n\n\t\tchildren.appendData({\n\t\t\ttype: \"Declaration\",\n\t\t\tproperty: \"size\",\n\t\t\tloc: null,\n\t\t\tvalue: {\n\t\t\t\ttype: \"Value\",\n\t\t\t\tchildren: dimensions\n\t\t\t}\n\t\t});\n\n\t\tchildren.appendData({\n\t\t\ttype: \"Declaration\",\n\t\t\tproperty: \"margin\",\n\t\t\tloc: null,\n\t\t\tvalue: {\n\t\t\t\ttype: \"Value\",\n\t\t\t\tchildren: [{\n\t\t\t\t\ttype: \"Dimension\",\n\t\t\t\t\tunit: \"px\",\n\t\t\t\t\tvalue: 0\n\t\t\t\t}]\n\t\t\t}\n\t\t});\n\n\t\tchildren.appendData({\n\t\t\ttype: \"Declaration\",\n\t\t\tproperty: \"padding\",\n\t\t\tloc: null,\n\t\t\tvalue: {\n\t\t\t\ttype: \"Value\",\n\t\t\t\tchildren: [{\n\t\t\t\t\ttype: \"Dimension\",\n\t\t\t\t\tunit: \"px\",\n\t\t\t\t\tvalue: 0\n\t\t\t\t}]\n\t\t\t}\n\t\t});\n\n\t\tchildren.appendData({\n\t\t\ttype: \"Declaration\",\n\t\t\tproperty: \"padding\",\n\t\t\tloc: null,\n\t\t\tvalue: {\n\t\t\t\ttype: \"Value\",\n\t\t\t\tchildren: [{\n\t\t\t\t\ttype: \"Dimension\",\n\t\t\t\t\tunit: \"px\",\n\t\t\t\t\tvalue: 0\n\t\t\t\t}]\n\t\t\t}\n\t\t});\n\n\t\tlet rule = ast.children.createItem({\n\t\t\ttype: \"Atrule\",\n\t\t\tprelude: null,\n\t\t\tname: \"page\",\n\t\t\tblock: {\n\t\t\t\ttype: \"Block\",\n\t\t\t\tloc: null,\n\t\t\t\tchildren: children\n\t\t\t}\n\t\t});\n\n\t\tast.children.append(rule);\n\n\t\tif (bleedverso) {\n\t\t\tlet widthCalculationsLeft = new csstree.List();\n\t\t\tlet heightCalculationsLeft = new csstree.List();\n\n\t\t\t// width\n\t\t\twidthCalculationsLeft.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: width.unit,\n\t\t\t\tvalue: width.value\n\t\t\t});\n\n\t\t\twidthCalculationsLeft.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\twidthCalculationsLeft.appendData({\n\t\t\t\ttype: \"Operator\",\n\t\t\t\tvalue: \"+\"\n\t\t\t});\n\n\t\t\twidthCalculationsLeft.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\twidthCalculationsLeft.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: bleedverso.left.unit,\n\t\t\t\tvalue: bleedverso.left.value\n\t\t\t});\n\n\t\t\twidthCalculationsLeft.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\twidthCalculationsLeft.appendData({\n\t\t\t\ttype: \"Operator\",\n\t\t\t\tvalue: \"+\"\n\t\t\t});\n\n\t\t\twidthCalculationsLeft.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\twidthCalculationsLeft.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: bleedverso.right.unit,\n\t\t\t\tvalue: bleedverso.right.value\n\t\t\t});\n\n\t\t\t// height\n\t\t\theightCalculationsLeft.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: height.unit,\n\t\t\t\tvalue: height.value\n\t\t\t});\n\n\t\t\theightCalculationsLeft.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\theightCalculationsLeft.appendData({\n\t\t\t\ttype: \"Operator\",\n\t\t\t\tvalue: \"+\"\n\t\t\t});\n\n\t\t\theightCalculationsLeft.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\theightCalculationsLeft.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: bleedverso.top.unit,\n\t\t\t\tvalue: bleedverso.top.value\n\t\t\t});\n\n\t\t\theightCalculationsLeft.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\theightCalculationsLeft.appendData({\n\t\t\t\ttype: \"Operator\",\n\t\t\t\tvalue: \"+\"\n\t\t\t});\n\n\t\t\theightCalculationsLeft.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\theightCalculationsLeft.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: bleedverso.bottom.unit,\n\t\t\t\tvalue: bleedverso.bottom.value\n\t\t\t});\n\n\t\t\tdimensionsLeft.appendData({\n\t\t\t\ttype: \"Function\",\n\t\t\t\tname: \"calc\",\n\t\t\t\tchildren: widthCalculationsLeft\n\t\t\t});\n\n\t\t\tdimensionsLeft.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\tdimensionsLeft.appendData({\n\t\t\t\ttype: \"Function\",\n\t\t\t\tname: \"calc\",\n\t\t\t\tchildren: heightCalculationsLeft\n\t\t\t});\n\n\t\t\tchildrenLeft.appendData({\n\t\t\t\ttype: \"Declaration\",\n\t\t\t\tproperty: \"size\",\n\t\t\t\tloc: null,\n\t\t\t\tvalue: {\n\t\t\t\t\ttype: \"Value\",\n\t\t\t\t\tchildren: dimensionsLeft\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlet ruleLeft = ast.children.createItem({\n\t\t\t\ttype: \"Atrule\",\n\t\t\t\tprelude: null,\n\t\t\t\tname: \"page :left\",\n\t\t\t\tblock: {\n\t\t\t\t\ttype: \"Block\",\n\t\t\t\t\tloc: null,\n\t\t\t\t\tchildren: childrenLeft\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tast.children.append(ruleLeft);\n\n\t\t}\n\n\t\tif (bleedrecto) {\n\t\t\tlet widthCalculationsRight = new csstree.List();\n\t\t\tlet heightCalculationsRight = new csstree.List();\n\n\t\t\t// width\n\t\t\twidthCalculationsRight.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: width.unit,\n\t\t\t\tvalue: width.value\n\t\t\t});\n\n\t\t\twidthCalculationsRight.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\twidthCalculationsRight.appendData({\n\t\t\t\ttype: \"Operator\",\n\t\t\t\tvalue: \"+\"\n\t\t\t});\n\n\t\t\twidthCalculationsRight.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\twidthCalculationsRight.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: bleedrecto.left.unit,\n\t\t\t\tvalue: bleedrecto.left.value\n\t\t\t});\n\n\t\t\twidthCalculationsRight.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\twidthCalculationsRight.appendData({\n\t\t\t\ttype: \"Operator\",\n\t\t\t\tvalue: \"+\"\n\t\t\t});\n\n\t\t\twidthCalculationsRight.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\twidthCalculationsRight.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: bleedrecto.right.unit,\n\t\t\t\tvalue: bleedrecto.right.value\n\t\t\t});\n\n\t\t\t// height\n\t\t\theightCalculationsRight.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: height.unit,\n\t\t\t\tvalue: height.value\n\t\t\t});\n\n\t\t\theightCalculationsRight.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\theightCalculationsRight.appendData({\n\t\t\t\ttype: \"Operator\",\n\t\t\t\tvalue: \"+\"\n\t\t\t});\n\n\t\t\theightCalculationsRight.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\theightCalculationsRight.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: bleedrecto.top.unit,\n\t\t\t\tvalue: bleedrecto.top.value\n\t\t\t});\n\n\t\t\theightCalculationsRight.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\theightCalculationsRight.appendData({\n\t\t\t\ttype: \"Operator\",\n\t\t\t\tvalue: \"+\"\n\t\t\t});\n\n\t\t\theightCalculationsRight.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\theightCalculationsRight.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: bleedrecto.bottom.unit,\n\t\t\t\tvalue: bleedrecto.bottom.value\n\t\t\t});\n\n\t\t\tdimensionsRight.appendData({\n\t\t\t\ttype: \"Function\",\n\t\t\t\tname: \"calc\",\n\t\t\t\tchildren: widthCalculationsRight\n\t\t\t});\n\n\t\t\tdimensionsRight.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\tdimensionsRight.appendData({\n\t\t\t\ttype: \"Function\",\n\t\t\t\tname: \"calc\",\n\t\t\t\tchildren: heightCalculationsRight\n\t\t\t});\n\n\t\t\tchildrenRight.appendData({\n\t\t\t\ttype: \"Declaration\",\n\t\t\t\tproperty: \"size\",\n\t\t\t\tloc: null,\n\t\t\t\tvalue: {\n\t\t\t\t\ttype: \"Value\",\n\t\t\t\t\tchildren: dimensionsRight\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlet ruleRight = ast.children.createItem({\n\t\t\t\ttype: \"Atrule\",\n\t\t\t\tprelude: null,\n\t\t\t\tname: \"page :right\",\n\t\t\t\tblock: {\n\t\t\t\t\ttype: \"Block\",\n\t\t\t\t\tloc: null,\n\t\t\t\t\tchildren: childrenRight\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tast.children.append(ruleRight);\n\n\t\t}\n\t}\n\n\tgetNth(nth) {\n\t\tlet n = nth.indexOf(\"n\");\n\t\tlet plus = nth.indexOf(\"+\");\n\t\tlet splitN = nth.split(\"n\");\n\t\tlet splitP = nth.split(\"+\");\n\t\tlet a = null;\n\t\tlet b = null;\n\t\tif (n > -1) {\n\t\t\ta = splitN[0];\n\t\t\tif (plus > -1) {\n\t\t\t\tb = splitP[1];\n\t\t\t}\n\t\t} else {\n\t\t\tb = nth;\n\t\t}\n\n\t\treturn {\n\t\t\ttype: \"Nth\",\n\t\t\tloc: null,\n\t\t\tselector: null,\n\t\t\tnth: {\n\t\t\t\ttype: \"AnPlusB\",\n\t\t\t\tloc: null,\n\t\t\t\ta: a,\n\t\t\t\tb: b\n\t\t\t}\n\t\t};\n\t}\n\n\taddPageAttributes(page, start, pages) {\n\t\tlet namedPages = [start.dataset.page];\n\n\t\tif (namedPages && namedPages.length) {\n\t\t\tfor (const named of namedPages) {\n\t\t\t\tif (!named) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tpage.name = named;\n\t\t\t\tpage.element.classList.add(\"pagedjs_named_page\");\n\t\t\t\tpage.element.classList.add(\"pagedjs_\" + named + \"_page\");\n\n\t\t\t\tif (!start.dataset.splitFrom) {\n\t\t\t\t\tpage.element.classList.add(\"pagedjs_\" + named + \"_first_page\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetStartElement(content, breakToken) {\n\t\tlet node = breakToken && breakToken.node;\n\n\t\tif (!content && !breakToken) {\n\t\t\treturn;\n\t\t}\n\n\t\t// No break\n\t\tif (!node) {\n\t\t\treturn content.children[0];\n\t\t}\n\n\t\t// Top level element\n\t\tif (node.nodeType === 1 && node.parentNode.nodeType === 11) {\n\t\t\treturn node;\n\t\t}\n\n\t\t// Named page\n\t\tif (node.nodeType === 1 && node.dataset.page) {\n\t\t\treturn node;\n\t\t}\n\n\t\t// Get top level Named parent\n\t\tlet fragment = rebuildAncestors(node);\n\t\tlet pages = fragment.querySelectorAll(\"[data-page]\");\n\n\t\tif (pages.length) {\n\t\t\treturn pages[pages.length - 1];\n\t\t} else {\n\t\t\treturn fragment.children[0];\n\t\t}\n\t}\n\n\tbeforePageLayout(page, contents, breakToken, chunker) {\n\t\tlet start = this.getStartElement(contents, breakToken);\n\t\tif (start) {\n\t\t\tthis.addPageAttributes(page, start, chunker.pages);\n\t\t}\n\t\t// page.element.querySelector('.paged_area').style.color = red;\n\t}\n\n\tfinalizePage(fragment, page, breakToken, chunker) {\n\t\tfor (let m in this.marginalia) {\n\t\t\tlet margin = this.marginalia[m];\n\t\t\tlet sels = m.split(\" \");\n\n\t\t\tlet content;\n\t\t\tif (page.element.matches(sels[0]) && margin.hasContent) {\n\t\t\t\tcontent = page.element.querySelector(sels[1]);\n\t\t\t\tcontent.classList.add(\"hasContent\");\n\t\t\t}\n\t\t}\n\n\t\t// check center\n\t\t[\"top\", \"bottom\"].forEach((loc) => {\n\t\t\tlet marginGroup = page.element.querySelector(\".pagedjs_margin-\" + loc);\n\t\t\tlet center = page.element.querySelector(\".pagedjs_margin-\" + loc + \"-center\");\n\t\t\tlet left = page.element.querySelector(\".pagedjs_margin-\" + loc + \"-left\");\n\t\t\tlet right = page.element.querySelector(\".pagedjs_margin-\" + loc + \"-right\");\n\n\t\t\tlet centerContent = center.classList.contains(\"hasContent\");\n\t\t\tlet leftContent = left.classList.contains(\"hasContent\");\n\t\t\tlet rightContent = right.classList.contains(\"hasContent\");\n\t\t\tlet centerWidth, leftWidth, rightWidth;\n\n\t\t\tif (leftContent) {\n\t\t\t\tleftWidth = window.getComputedStyle(left)[\"max-width\"];\n\t\t\t}\n\n\t\t\tif (rightContent) {\n\t\t\t\trightWidth = window.getComputedStyle(right)[\"max-width\"];\n\t\t\t}\n\n\n\t\t\tif (centerContent) {\n\t\t\t\tcenterWidth = window.getComputedStyle(center)[\"max-width\"];\n\n\t\t\t\tif (centerWidth === \"none\" || centerWidth === \"auto\") {\n\t\t\t\t\tif (!leftContent && !rightContent) {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"0 1fr 0\";\n\t\t\t\t\t} else if (leftContent) {\n\t\t\t\t\t\tif (!rightContent) {\n\t\t\t\t\t\t\tif (leftWidth !== \"none\" && leftWidth !== \"auto\") {\n\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = leftWidth + \" 1fr \" + leftWidth;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"auto auto 1fr\";\n\t\t\t\t\t\t\t\tleft.style[\"white-space\"] = \"nowrap\";\n\t\t\t\t\t\t\t\tcenter.style[\"white-space\"] = \"nowrap\";\n\t\t\t\t\t\t\t\tlet leftOuterWidth = left.offsetWidth;\n\t\t\t\t\t\t\t\tlet centerOuterWidth = center.offsetWidth;\n\t\t\t\t\t\t\t\tlet outerwidths = leftOuterWidth + centerOuterWidth;\n\t\t\t\t\t\t\t\tlet newcenterWidth = centerOuterWidth * 100 / outerwidths;\n\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"minmax(16.66%, 1fr) minmax(33%, \" + newcenterWidth + \"%) minmax(16.66%, 1fr)\";\n\t\t\t\t\t\t\t\tleft.style[\"white-space\"] = \"normal\";\n\t\t\t\t\t\t\t\tcenter.style[\"white-space\"] = \"normal\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (leftWidth !== \"none\" && leftWidth !== \"auto\") {\n\t\t\t\t\t\t\t\tif (rightWidth !== \"none\" && rightWidth !== \"auto\") {\n\t\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = leftWidth + \" 1fr \" + rightWidth;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = leftWidth + \" 1fr \" + leftWidth;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (rightWidth !== \"none\" && rightWidth !== \"auto\") {\n\t\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = rightWidth + \" 1fr \" + rightWidth;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"auto auto 1fr\";\n\t\t\t\t\t\t\t\t\tleft.style[\"white-space\"] = \"nowrap\";\n\t\t\t\t\t\t\t\t\tcenter.style[\"white-space\"] = \"nowrap\";\n\t\t\t\t\t\t\t\t\tright.style[\"white-space\"] = \"nowrap\";\n\t\t\t\t\t\t\t\t\tlet leftOuterWidth = left.offsetWidth;\n\t\t\t\t\t\t\t\t\tlet centerOuterWidth = center.offsetWidth;\n\t\t\t\t\t\t\t\t\tlet rightOuterWidth = right.offsetWidth;\n\t\t\t\t\t\t\t\t\tlet outerwidths = leftOuterWidth + centerOuterWidth + rightOuterWidth;\n\t\t\t\t\t\t\t\t\tlet newcenterWidth = centerOuterWidth * 100 / outerwidths;\n\t\t\t\t\t\t\t\t\tif (newcenterWidth > 40) {\n\t\t\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"minmax(16.66%, 1fr) minmax(33%, \" + newcenterWidth + \"%) minmax(16.66%, 1fr)\";\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"repeat(3, 1fr)\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tleft.style[\"white-space\"] = \"normal\";\n\t\t\t\t\t\t\t\t\tcenter.style[\"white-space\"] = \"normal\";\n\t\t\t\t\t\t\t\t\tright.style[\"white-space\"] = \"normal\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (rightWidth !== \"none\" && rightWidth !== \"auto\") {\n\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = rightWidth + \" 1fr \" + rightWidth;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"auto auto 1fr\";\n\t\t\t\t\t\t\tright.style[\"white-space\"] = \"nowrap\";\n\t\t\t\t\t\t\tcenter.style[\"white-space\"] = \"nowrap\";\n\t\t\t\t\t\t\tlet rightOuterWidth = right.offsetWidth;\n\t\t\t\t\t\t\tlet centerOuterWidth = center.offsetWidth;\n\t\t\t\t\t\t\tlet outerwidths = rightOuterWidth + centerOuterWidth;\n\t\t\t\t\t\t\tlet newcenterWidth = centerOuterWidth * 100 / outerwidths;\n\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"minmax(16.66%, 1fr) minmax(33%, \" + newcenterWidth + \"%) minmax(16.66%, 1fr)\";\n\t\t\t\t\t\t\tright.style[\"white-space\"] = \"normal\";\n\t\t\t\t\t\t\tcenter.style[\"white-space\"] = \"normal\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (centerWidth !== \"none\" && centerWidth !== \"auto\") {\n\t\t\t\t\tif (leftContent && leftWidth !== \"none\" && leftWidth !== \"auto\") {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = leftWidth + \" \" + centerWidth + \" 1fr\";\n\t\t\t\t\t} else if (rightContent && rightWidth !== \"none\" && rightWidth !== \"auto\") {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"1fr \" + centerWidth + \" \" + rightWidth;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"1fr \" + centerWidth + \" 1fr\";\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tif (leftContent) {\n\t\t\t\t\tif (!rightContent) {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"1fr 0 0\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (leftWidth !== \"none\" && leftWidth !== \"auto\") {\n\t\t\t\t\t\t\tif (rightWidth !== \"none\" && rightWidth !== \"auto\") {\n\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = leftWidth + \" 1fr \" + rightWidth;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = leftWidth + \" 0 1fr\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (rightWidth !== \"none\" && rightWidth !== \"auto\") {\n\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"1fr 0 \" + rightWidth;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"auto 1fr auto\";\n\t\t\t\t\t\t\t\tleft.style[\"white-space\"] = \"nowrap\";\n\t\t\t\t\t\t\t\tright.style[\"white-space\"] = \"nowrap\";\n\t\t\t\t\t\t\t\tlet leftOuterWidth = left.offsetWidth;\n\t\t\t\t\t\t\t\tlet rightOuterWidth = right.offsetWidth;\n\t\t\t\t\t\t\t\tlet outerwidths = leftOuterWidth + rightOuterWidth;\n\t\t\t\t\t\t\t\tlet newLeftWidth = leftOuterWidth * 100 / outerwidths;\n\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"minmax(16.66%, \" + newLeftWidth + \"%) 0 1fr\";\n\t\t\t\t\t\t\t\tleft.style[\"white-space\"] = \"normal\";\n\t\t\t\t\t\t\t\tright.style[\"white-space\"] = \"normal\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (rightWidth !== \"none\" && rightWidth !== \"auto\") {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"1fr 0 \" + rightWidth;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"0 0 1fr\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// check middle\n\t\t[\"left\", \"right\"].forEach((loc) => {\n\t\t\tlet middle = page.element.querySelector(\".pagedjs_margin-\" + loc + \"-middle.hasContent\");\n\t\t\tlet marginGroup = page.element.querySelector(\".pagedjs_margin-\" + loc);\n\t\t\tlet top = page.element.querySelector(\".pagedjs_margin-\" + loc + \"-top\");\n\t\t\tlet bottom = page.element.querySelector(\".pagedjs_margin-\" + loc + \"-bottom\");\n\t\t\tlet topContent = top.classList.contains(\"hasContent\");\n\t\t\tlet bottomContent = bottom.classList.contains(\"hasContent\");\n\t\t\tlet middleHeight, topHeight, bottomHeight;\n\n\t\t\tif (topContent) {\n\t\t\t\ttopHeight = window.getComputedStyle(top)[\"max-height\"];\n\t\t\t}\n\n\t\t\tif (bottomContent) {\n\t\t\t\tbottomHeight = window.getComputedStyle(bottom)[\"max-height\"];\n\t\t\t}\n\n\t\t\tif (middle) {\n\t\t\t\tmiddleHeight = window.getComputedStyle(middle)[\"max-height\"];\n\n\t\t\t\tif (middleHeight === \"none\" || middleHeight === \"auto\") {\n\t\t\t\t\tif (!topContent && !bottomContent) {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = \"0 1fr 0\";\n\t\t\t\t\t} else if (topContent) {\n\t\t\t\t\t\tif (!bottomContent) {\n\t\t\t\t\t\t\tif (topHeight !== \"none\" && topHeight !== \"auto\") {\n\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = topHeight + \" calc(100% - \" + topHeight + \"*2) \" + topHeight;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (topHeight !== \"none\" && topHeight !== \"auto\") {\n\t\t\t\t\t\t\t\tif (bottomHeight !== \"none\" && bottomHeight !== \"auto\") {\n\t\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = topHeight + \" calc(100% - \" + topHeight + \" - \" + bottomHeight + \") \" + bottomHeight;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = topHeight + \" calc(100% - \" + topHeight + \"*2) \" + topHeight;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (bottomHeight !== \"none\" && bottomHeight !== \"auto\") {\n\t\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = bottomHeight + \" calc(100% - \" + bottomHeight + \"*2) \" + bottomHeight;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (bottomHeight !== \"none\" && bottomHeight !== \"auto\") {\n\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = bottomHeight + \" calc(100% - \" + bottomHeight + \"*2) \" + bottomHeight;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (topContent && topHeight !== \"none\" && topHeight !== \"auto\") {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = topHeight + \" \" + middleHeight + \" calc(100% - (\" + topHeight + \" + \" + middleHeight + \"))\";\n\t\t\t\t\t} else if (bottomContent && bottomHeight !== \"none\" && bottomHeight !== \"auto\") {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = \"1fr \" + middleHeight + \" \" + bottomHeight;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = \"calc((100% - \" + middleHeight + \")/2) \" + middleHeight + \" calc((100% - \" + middleHeight + \")/2)\";\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tif (topContent) {\n\t\t\t\t\tif (!bottomContent) {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = \"1fr 0 0\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (topHeight !== \"none\" && topHeight !== \"auto\") {\n\t\t\t\t\t\t\tif (bottomHeight !== \"none\" && bottomHeight !== \"auto\") {\n\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = topHeight + \" 1fr \" + bottomHeight;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = topHeight + \" 0 1fr\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (bottomHeight !== \"none\" && bottomHeight !== \"auto\") {\n\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = \"1fr 0 \" + bottomHeight;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = \"1fr 0 1fr\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (bottomHeight !== \"none\" && bottomHeight !== \"auto\") {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = \"1fr 0 \" + bottomHeight;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = \"0 0 1fr\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\n\n\t\t});\n\n\t}\n\n\t// CSS Tree Helpers\n\n\tselectorsForPage(page) {\n\t\tlet nthlist;\n\t\tlet nth;\n\n\t\tlet selectors = new csstree.List();\n\n\t\tselectors.insertData({\n\t\t\ttype: \"ClassSelector\",\n\t\t\tname: \"pagedjs_page\"\n\t\t});\n\n\t\t// Named page\n\t\tif (page.name) {\n\t\t\tselectors.insertData({\n\t\t\t\ttype: \"ClassSelector\",\n\t\t\t\tname: \"pagedjs_named_page\"\n\t\t\t});\n\n\t\t\tselectors.insertData({\n\t\t\t\ttype: \"ClassSelector\",\n\t\t\t\tname: \"pagedjs_\" + page.name + \"_page\"\n\t\t\t});\n\t\t}\n\n\t\t// PsuedoSelector\n\t\tif (page.psuedo && !(page.name && page.psuedo === \"first\")) {\n\t\t\tselectors.insertData({\n\t\t\t\ttype: \"ClassSelector\",\n\t\t\t\tname: \"pagedjs_\" + page.psuedo + \"_page\"\n\t\t\t});\n\t\t}\n\n\t\tif (page.name && page.psuedo === \"first\") {\n\t\t\tselectors.insertData({\n\t\t\t\ttype: \"ClassSelector\",\n\t\t\t\tname: \"pagedjs_\" + page.name + \"_\" + page.psuedo + \"_page\"\n\t\t\t});\n\t\t}\n\n\t\t// Nth\n\t\tif (page.nth) {\n\t\t\tnthlist = new csstree.List();\n\t\t\tnth = this.getNth(page.nth);\n\n\t\t\tnthlist.insertData(nth);\n\n\t\t\tselectors.insertData({\n\t\t\t\ttype: \"PseudoClassSelector\",\n\t\t\t\tname: \"nth-of-type\",\n\t\t\t\tchildren: nthlist\n\t\t\t});\n\t\t}\n\n\t\treturn selectors;\n\t}\n\n\tselectorsForPageMargin(page, margin) {\n\t\tlet selectors = this.selectorsForPage(page);\n\n\t\tselectors.insertData({\n\t\t\ttype: \"Combinator\",\n\t\t\tname: \" \"\n\t\t});\n\n\t\tselectors.insertData({\n\t\t\ttype: \"ClassSelector\",\n\t\t\tname: \"pagedjs_margin-\" + margin\n\t\t});\n\n\t\treturn selectors;\n\t}\n\n\tcreateDeclaration(property, value, important) {\n\t\tlet children = new csstree.List();\n\n\t\tchildren.insertData({\n\t\t\ttype: \"Identifier\",\n\t\t\tloc: null,\n\t\t\tname: value\n\t\t});\n\n\t\treturn {\n\t\t\ttype: \"Declaration\",\n\t\t\tloc: null,\n\t\t\timportant: important,\n\t\t\tproperty: property,\n\t\t\tvalue: {\n\t\t\t\ttype: \"Value\",\n\t\t\t\tloc: null,\n\t\t\t\tchildren: children\n\t\t\t}\n\t\t};\n\t}\n\n\tcreateVariable(property, value) {\n\t\treturn {\n\t\t\ttype: \"Declaration\",\n\t\t\tloc: null,\n\t\t\tproperty: property,\n\t\t\tvalue: {\n\t\t\t\ttype: \"Raw\",\n\t\t\t\tvalue: value\n\t\t\t}\n\t\t};\n\t}\n\n\tcreateCalculatedDimension(property, items, important, operator = \"+\") {\n\t\tlet children = new csstree.List();\n\t\tlet calculations = new csstree.List();\n\n\t\titems.forEach((item, index) => {\n\t\t\tcalculations.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: item.unit,\n\t\t\t\tvalue: item.value\n\t\t\t});\n\n\t\t\tcalculations.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\tif (index + 1 < items.length) {\n\t\t\t\tcalculations.appendData({\n\t\t\t\t\ttype: \"Operator\",\n\t\t\t\t\tvalue: operator\n\t\t\t\t});\n\n\t\t\t\tcalculations.appendData({\n\t\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\t\tvalue: \" \"\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tchildren.insertData({\n\t\t\ttype: \"Function\",\n\t\t\tloc: null,\n\t\t\tname: \"calc\",\n\t\t\tchildren: calculations\n\t\t});\n\n\t\treturn {\n\t\t\ttype: \"Declaration\",\n\t\t\tloc: null,\n\t\t\timportant: important,\n\t\t\tproperty: property,\n\t\t\tvalue: {\n\t\t\t\ttype: \"Value\",\n\t\t\t\tloc: null,\n\t\t\t\tchildren: children\n\t\t\t}\n\t\t};\n\t}\n\n\tcreateDimension(property, cssValue, important) {\n\t\tlet children = new csstree.List();\n\n\t\tchildren.insertData({\n\t\t\ttype: \"Dimension\",\n\t\t\tloc: null,\n\t\t\tvalue: cssValue.value,\n\t\t\tunit: cssValue.unit\n\t\t});\n\n\t\treturn {\n\t\t\ttype: \"Declaration\",\n\t\t\tloc: null,\n\t\t\timportant: important,\n\t\t\tproperty: property,\n\t\t\tvalue: {\n\t\t\t\ttype: \"Value\",\n\t\t\t\tloc: null,\n\t\t\t\tchildren: children\n\t\t\t}\n\t\t};\n\t}\n\n\tcreateBlock(declarations) {\n\t\tlet block = new csstree.List();\n\n\t\tdeclarations.forEach((declaration) => {\n\t\t\tblock.insertData(declaration);\n\t\t});\n\n\t\treturn {\n\t\t\ttype: \"Block\",\n\t\t\tloc: null,\n\t\t\tchildren: block\n\t\t};\n\t}\n\n\tcreateRule(selectors, block) {\n\t\tlet selectorList = new csstree.List();\n\t\tselectorList.insertData({\n\t\t\ttype: \"Selector\",\n\t\t\tchildren: selectors\n\t\t});\n\n\t\tif (Array.isArray(block)) {\n\t\t\tblock = this.createBlock(block);\n\t\t}\n\n\t\treturn {\n\t\t\ttype: \"Rule\",\n\t\t\tprelude: {\n\t\t\t\ttype: \"SelectorList\",\n\t\t\t\tchildren: selectorList\n\t\t\t},\n\t\t\tblock: block\n\t\t};\n\t}\n\n}\n\nexport default AtPage;\n","import Handler from \"../handler.js\";\nimport csstree from \"css-tree\";\nimport { displayedElementAfter, displayedElementBefore, needsPageBreak } from \"../../utils/dom.js\";\n\nclass Breaks extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\n\t\tthis.breaks = {};\n\t}\n\n\tonDeclaration(declaration, dItem, dList, rule) {\n\t\tlet property = declaration.property;\n\n\t\tif (property === \"page\") {\n\t\t\tlet children = declaration.value.children.first();\n\t\t\tlet value = children.name;\n\t\t\tlet selector = csstree.generate(rule.ruleNode.prelude);\n\t\t\tlet name = value;\n\n\t\t\tlet breaker = {\n\t\t\t\tproperty: property,\n\t\t\t\tvalue: value,\n\t\t\t\tselector: selector,\n\t\t\t\tname: name\n\t\t\t};\n\n\t\t\tselector.split(\",\").forEach((s) => {\n\t\t\t\tif (!this.breaks[s]) {\n\t\t\t\t\tthis.breaks[s] = [breaker];\n\t\t\t\t} else {\n\t\t\t\t\tthis.breaks[s].push(breaker);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tdList.remove(dItem);\n\t\t}\n\n\t\tif (property === \"break-before\" ||\n\t\t\t\tproperty === \"break-after\" ||\n\t\t\t\tproperty === \"page-break-before\" ||\n\t\t\t\tproperty === \"page-break-after\"\n\t\t) {\n\t\t\tlet child = declaration.value.children.first();\n\t\t\tlet value = child.name;\n\t\t\tlet selector = csstree.generate(rule.ruleNode.prelude);\n\n\t\t\tif (property === \"page-break-before\") {\n\t\t\t\tproperty = \"break-before\";\n\t\t\t} else if (property === \"page-break-after\") {\n\t\t\t\tproperty = \"break-after\";\n\t\t\t}\n\n\t\t\tlet breaker = {\n\t\t\t\tproperty: property,\n\t\t\t\tvalue: value,\n\t\t\t\tselector: selector\n\t\t\t};\n\n\t\t\tselector.split(\",\").forEach((s) => {\n\t\t\t\tif (!this.breaks[s]) {\n\t\t\t\t\tthis.breaks[s] = [breaker];\n\t\t\t\t} else {\n\t\t\t\t\tthis.breaks[s].push(breaker);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Remove from CSS -- handle right / left in module\n\t\t\tdList.remove(dItem);\n\t\t}\n\t}\n\n\tafterParsed(parsed) {\n\t\tthis.processBreaks(parsed, this.breaks);\n\t}\n\n\tprocessBreaks(parsed, breaks) {\n\t\tfor (let b in breaks) {\n\t\t\t// Find elements\n\t\t\tlet elements = parsed.querySelectorAll(b);\n\t\t\t// Add break data\n\t\t\tfor (var i = 0; i < elements.length; i++) {\n\t\t\t\tfor (let prop of breaks[b]) {\n\n\t\t\t\t\tif (prop.property === \"break-after\") {\n\t\t\t\t\t\tlet nodeAfter = displayedElementAfter(elements[i], parsed);\n\n\t\t\t\t\t\telements[i].setAttribute(\"data-break-after\", prop.value);\n\n\t\t\t\t\t\tif (nodeAfter) {\n\t\t\t\t\t\t\tnodeAfter.setAttribute(\"data-previous-break-after\", prop.value);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (prop.property === \"break-before\") {\n\t\t\t\t\t\tlet nodeBefore = displayedElementBefore(elements[i], parsed);\n\n\t\t\t\t\t\t// Breaks are only allowed between siblings, not between a box and its container.\n\t\t\t\t\t\t// If we cannot find a node before we should not break!\n\t\t\t\t\t\t// https://drafts.csswg.org/css-break-3/#break-propagation\n\t\t\t\t\t\tif (nodeBefore) {\n\t\t\t\t\t\t\tif (prop.value === \"page\" && needsPageBreak(elements[i], nodeBefore)) {\n\t\t\t\t\t\t\t\t// we ignore this explicit page break because an implicit page break is already needed\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telements[i].setAttribute(\"data-break-before\", prop.value);\n\t\t\t\t\t\t\tnodeBefore.setAttribute(\"data-next-break-before\", prop.value);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (prop.property === \"page\") {\n\t\t\t\t\t\telements[i].setAttribute(\"data-page\", prop.value);\n\n\t\t\t\t\t\tlet nodeAfter = displayedElementAfter(elements[i], parsed);\n\n\t\t\t\t\t\tif (nodeAfter) {\n\t\t\t\t\t\t\tnodeAfter.setAttribute(\"data-after-page\", prop.value);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\telements[i].setAttribute(\"data-\" + prop.property, prop.value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tmergeBreaks(pageBreaks, newBreaks) {\n\t\tfor (let b in newBreaks) {\n\t\t\tif (b in pageBreaks) {\n\t\t\t\tpageBreaks[b] = pageBreaks[b].concat(newBreaks[b]);\n\t\t\t} else {\n\t\t\t\tpageBreaks[b] = newBreaks[b];\n\t\t\t}\n\t\t}\n\t\treturn pageBreaks;\n\t}\n\n\taddBreakAttributes(pageElement, page) {\n\t\tlet before = pageElement.querySelector(\"[data-break-before]\");\n\t\tlet after = pageElement.querySelector(\"[data-break-after]\");\n\t\tlet previousBreakAfter = pageElement.querySelector(\"[data-previous-break-after]\");\n\n\t\tif (before) {\n\t\t\tif (before.dataset.splitFrom) {\n\t\t\t\tpage.splitFrom = before.dataset.splitFrom;\n\t\t\t\tpageElement.setAttribute(\"data-split-from\", before.dataset.splitFrom);\n\t\t\t} else if (before.dataset.breakBefore && before.dataset.breakBefore !== \"avoid\") {\n\t\t\t\tpage.breakBefore = before.dataset.breakBefore;\n\t\t\t\tpageElement.setAttribute(\"data-break-before\", before.dataset.breakBefore);\n\t\t\t}\n\t\t}\n\n\t\tif (after && after.dataset) {\n\t\t\tif (after.dataset.splitTo) {\n\t\t\t\tpage.splitTo = after.dataset.splitTo;\n\t\t\t\tpageElement.setAttribute(\"data-split-to\", after.dataset.splitTo);\n\t\t\t} else if (after.dataset.breakAfter && after.dataset.breakAfter !== \"avoid\") {\n\t\t\t\tpage.breakAfter = after.dataset.breakAfter;\n\t\t\t\tpageElement.setAttribute(\"data-break-after\", after.dataset.breakAfter);\n\t\t\t}\n\t\t}\n\n\t\tif (previousBreakAfter && previousBreakAfter.dataset) {\n\t\t\tif (previousBreakAfter.dataset.previousBreakAfter && previousBreakAfter.dataset.previousBreakAfter !== \"avoid\") {\n\t\t\t\tpage.previousBreakAfter = previousBreakAfter.dataset.previousBreakAfter;\n\t\t\t}\n\t\t}\n\t}\n\n\tafterPageLayout(pageElement, page) {\n\t\tthis.addBreakAttributes(pageElement, page);\n\t}\n}\n\nexport default Breaks;\n","import Handler from \"../handler.js\";\nimport csstree from \"css-tree\";\n\nclass PrintMedia extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\t}\n\n\tonAtMedia(node, item, list) {\n\t\tlet media = this.getMediaName(node);\n\t\tlet rules;\n\t\tif (media.includes(\"print\")) {\n\t\t\trules = node.block.children;\n\n\t\t\t// Append rules to the end of main rules list\n\t\t\t// TODO: this isn't working right, needs to check what is in the prelude\n\t\t\t/*\n\t\t\trules.forEach((selectList) => {\n\t\t\t\tif (selectList.prelude) {\n\t\t\t\t\tselectList.prelude.children.forEach((rule) => {\n\n\t\t\t\t\t\trule.children.prependData({\n\t\t\t\t\t\t\ttype: \"Combinator\",\n\t\t\t\t\t\t\tname: \" \"\n\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\trule.children.prependData({\n\t\t\t\t\t\t\ttype: \"ClassSelector\",\n\t\t\t\t\t\t\tname: \"pagedjs_page\"\n\t\t\t\t\t\t});\n\t\t\t\t\t});\t\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlist.insertList(rules, item);\n\t\t\t*/\n\n\t\t\t// Append rules to the end of main rules list\n\t\t\tlist.appendList(rules);\n\n\t\t\t// Remove rules from the @media block\n\t\t\tlist.remove(item);\n\t\t} else if (!media.includes(\"all\") && !media.includes(\"pagedjs-ignore\")) {\n\t\t\tlist.remove(item);\n\t\t}\n\n\t}\n\n\tgetMediaName(node) {\n\t\tlet media = [];\n\n\t\tif (typeof node.prelude === \"undefined\" ||\n\t\t\t\tnode.prelude.type !== \"AtrulePrelude\" ) {\n\t\t\treturn;\n\t\t}\n\n\t\tcsstree.walk(node.prelude, {\n\t\t\tvisit: \"Identifier\",\n\t\t\tenter: (identNode, iItem, iList) => {\n\t\t\t\tmedia.push(identNode.name);\n\t\t\t}\n\t\t});\n\t\treturn media;\n\t}\n\n\n}\n\nexport default PrintMedia;\n","import Handler from \"../handler.js\";\n\nclass Splits extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\t}\n\n\tafterPageLayout(pageElement, page, breakToken, chunker) {\n\t\tlet splits = Array.from(pageElement.querySelectorAll(\"[data-split-from]\"));\n\t\tlet pages = pageElement.parentNode;\n\t\tlet index = Array.prototype.indexOf.call(pages.children, pageElement);\n\t\tlet prevPage;\n\n\t\tif (index === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tprevPage = pages.children[index - 1];\n\n\t\tlet from; // Capture the last from element\n\t\tsplits.forEach((split) => {\n\t\t\tlet ref = split.dataset.ref;\n\t\t\tfrom = prevPage.querySelector(\"[data-ref='\"+ ref +\"']:not([data-split-to])\");\n\n\t\t\tif (from) {\n\t\t\t\tfrom.dataset.splitTo = ref;\n\n\t\t\t\tif (!from.dataset.splitFrom) {\n\t\t\t\t\tfrom.dataset.splitOriginal = true;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Fix alignment on the deepest split element\n\t\tif (from) {\n\t\t\tthis.handleAlignment(from);\n\t\t}\n\t}\n\n\thandleAlignment(node) {\n\t\tlet styles = window.getComputedStyle(node);\n\t\tlet align = styles[\"text-align\"];\n\t\tlet alignLast = styles[\"text-align-last\"];\n\t\tnode.dataset.lastSplitElement = \"true\";\n\t\tif (align === \"justify\" && alignLast === \"auto\") {\n\t\t\tnode.dataset.alignLastSplitElement = \"justify\";\n\t\t} else {\n\t\t\tnode.dataset.alignLastSplitElement = alignLast;\n\t\t}\n\t}\n\n}\n\nexport default Splits;\n","import Handler from \"../handler.js\";\nimport csstree from \"css-tree\";\n\nclass Counters extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\n\t\tthis.styleSheet = polisher.styleSheet;\n\t\tthis.counters = {};\n\t\tthis.resetCountersMap = new Map();\n\t}\n\n\tonDeclaration(declaration, dItem, dList, rule) {\n\t\tlet property = declaration.property;\n\n\t\tif (property === \"counter-increment\") {\n\t\t\tthis.handleIncrement(declaration, rule);\n\t\t\t// clean up empty declaration\n\t\t\tlet hasProperities = false;\n\t\t\tdeclaration.value.children.forEach((data) => {\n\t\t\t\tif (data.type && data.type !== \"WhiteSpace\") {\n\t\t\t\t\thasProperities = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (!hasProperities) {\n\t\t\t\tdList.remove(dItem);\n\t\t\t}\n\t\t} else if (property === \"counter-reset\") {\n\t\t\tthis.handleReset(declaration, rule);\n\t\t\t// clean up empty declaration\n\t\t\tlet hasProperities = false;\n\t\t\tdeclaration.value.children.forEach((data) => {\n\t\t\t\tif (data.type && data.type !== \"WhiteSpace\") {\n\t\t\t\t\thasProperities = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (!hasProperities) {\n\t\t\t\tdList.remove(dItem);\n\t\t\t}\n\t\t}\n\t}\n\n\tafterParsed(parsed) {\n\t\tthis.processCounters(parsed, this.counters);\n\t\tthis.scopeCounters(this.counters);\n\t}\n\n\taddCounter(name) {\n\t\tif (name in this.counters) {\n\t\t\treturn this.counters[name];\n\t\t}\n\n\t\tthis.counters[name] = {\n\t\t\tname: name,\n\t\t\tincrements: {},\n\t\t\tresets: {}\n\t\t};\n\n\t\treturn this.counters[name];\n\t}\n\n\thandleIncrement(declaration, rule) {\n\t\tlet increments = [];\n\t\tlet children = declaration.value.children;\n\n\t\tchildren.forEach((data, item) => {\n\t\t\tif (data.type && data.type === \"Identifier\") {\n\t\t\t\tlet name = data.name;\n\n\t\t\t\tif (name === \"page\" || name.indexOf(\"target-counter-\") === 0) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet whitespace, number, value;\n\t\t\t\tif (item.next && item.next.data.type === \"WhiteSpace\") {\n\t\t\t\t\twhitespace = item.next;\n\t\t\t\t}\n\t\t\t\tif (whitespace && whitespace.next && whitespace.next.data.type === \"Number\") {\n\t\t\t\t\tnumber = whitespace.next;\n\t\t\t\t\tvalue = parseInt(number.data.value);\n\t\t\t\t}\n\n\t\t\t\tlet selector = csstree.generate(rule.ruleNode.prelude);\n\n\t\t\t\tlet counter;\n\t\t\t\tif (!(name in this.counters)) {\n\t\t\t\t\tcounter = this.addCounter(name);\n\t\t\t\t} else {\n\t\t\t\t\tcounter = this.counters[name];\n\t\t\t\t}\n\t\t\t\tlet increment = {\n\t\t\t\t\tselector: selector,\n\t\t\t\t\tnumber: value || 1\n\t\t\t\t};\n\t\t\t\tcounter.increments[selector] = increment;\n\t\t\t\tincrements.push(increment);\n\n\t\t\t\t// Remove the parsed resets\n\t\t\t\tchildren.remove(item);\n\t\t\t\tif (whitespace) {\n\t\t\t\t\tchildren.remove(whitespace);\n\t\t\t\t}\n\t\t\t\tif (number) {\n\t\t\t\t\tchildren.remove(number);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn increments;\n\t}\n\n\thandleReset(declaration, rule) {\n\t\tlet children = declaration.value.children;\n\n\t\tchildren.forEach((data, item) => {\n\t\t\tif (data.type && data.type === \"Identifier\") {\n\t\t\t\tlet name = data.name;\n\t\t\t\tlet whitespace, number, value;\n\t\t\t\tif (item.next && item.next.data.type === \"WhiteSpace\") {\n\t\t\t\t\twhitespace = item.next;\n\t\t\t\t}\n\t\t\t\tif (whitespace && whitespace.next) {\n\t\t\t\t\tif (whitespace.next.data.type === \"Number\") {\n\t\t\t\t\t\t// The counter reset value is specified using a number. E.g. counter-reset: c2 5;\n\t\t\t\t\t\tnumber = whitespace.next;\n\t\t\t\t\t\tvalue = parseInt(number.data.value);\n\t\t\t\t\t} else if (whitespace.next.data.type === \"Function\" && whitespace.next.data.name === \"var\") {\n\t\t\t\t\t\t// The counter reset value is specified using a CSS variable (custom property).\n\t\t\t\t\t\t// E.g. counter-reset: c2 var(--my-variable);\n\t\t\t\t\t\t// See https://developer.mozilla.org/en-US/docs/Web/CSS/var\n\t\t\t\t\t\tnumber = whitespace.next;\n\t\t\t\t\t\t// Use the variable name (e.g. '--my-variable') as value for now. The actual value is resolved later by the\n\t\t\t\t\t\t// processCounterResets function.\n\t\t\t\t\t\tvalue = whitespace.next.data.children.head.data.name;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet counter;\n\t\t\t\tlet selector;\n\t\t\t\tlet prelude = rule.ruleNode.prelude;\n\n\t\t\t\tif (rule.ruleNode.type === \"Atrule\" && rule.ruleNode.name === \"page\") {\n\t\t\t\t\tselector = \".pagedjs_page\";\n\t\t\t\t} else {\n\t\t\t\t\tselector = csstree.generate(prelude || rule.ruleNode);\n\t\t\t\t}\n\n\t\t\t\tif (name === \"footnote\") {\n\t\t\t\t\tthis.addFootnoteMarkerCounter(declaration.value.children);\n\t\t\t\t}\n\n\t\t\t\tif (!(name in this.counters)) {\n\t\t\t\t\tcounter = this.addCounter(name);\n\t\t\t\t} else {\n\t\t\t\t\tcounter = this.counters[name];\n\t\t\t\t}\n\n\t\t\t\tlet reset = {\n\t\t\t\t\tselector: selector,\n\t\t\t\t\tnumber: value || 0\n\t\t\t\t};\n\n\t\t\t\tcounter.resets[selector] = reset;\n\n\t\t\t\tif (selector !== \".pagedjs_page\") {\n\t\t\t\t\t// Remove the parsed resets\n\t\t\t\t\tchildren.remove(item);\n\t\t\t\t\tif (whitespace) {\n\t\t\t\t\t\tchildren.remove(whitespace);\n\t\t\t\t\t}\n\t\t\t\t\tif (number) {\n\t\t\t\t\t\tchildren.remove(number);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprocessCounters(parsed, counters) {\n\t\tlet counter;\n\t\tfor (let c in counters) {\n\t\t\tcounter = this.counters[c];\n\t\t\tthis.processCounterIncrements(parsed, counter);\n\t\t\tthis.processCounterResets(parsed, counter);\n\t\t\tif (c !== \"page\") {\n\t\t\t\tthis.addCounterValues(parsed, counter);\n\t\t\t}\n\t\t}\n\t}\n\n\tscopeCounters(counters) {\n\t\tlet countersArray = [];\n\t\tfor (let c in counters) {\n\t\t\tif(c !== \"page\") {\n\t\t\t\tcountersArray.push(`${counters[c].name} 0`);\n\t\t\t}\n\t\t}\n\t\t// Add to pages to allow cross page scope\n\t\tthis.insertRule(`.pagedjs_pages { counter-reset: ${countersArray.join(\" \")} page 0 pages var(--pagedjs-page-count) footnote var(--pagedjs-footnotes-count) footnote-marker var(--pagedjs-footnotes-count)}`);\n\t}\n\n\tinsertRule(rule) {\n\t\tthis.styleSheet.insertRule(rule, this.styleSheet.cssRules.length);\n\t}\n\n\tprocessCounterIncrements(parsed, counter) {\n\t\tlet increment;\n\t\tfor (let inc in counter.increments) {\n\t\t\tincrement = counter.increments[inc];\n\t\t\t// Find elements for increments\n\t\t\tlet incrementElements = parsed.querySelectorAll(increment.selector);\n\t\t\t// Add counter data\n\t\t\tfor (let i = 0; i < incrementElements.length; i++) {\n\t\t\t\tincrementElements[i].setAttribute(\"data-counter-\"+ counter.name +\"-increment\", increment.number);\n\t\t\t\tif (incrementElements[i].getAttribute(\"data-counter-increment\")) {\n\t\t\t\t\tincrementElements[i].setAttribute(\"data-counter-increment\", incrementElements[i].getAttribute(\"data-counter-increment\") + \" \" + counter.name);\n\t\t\t\t} else {\n\t\t\t\t\tincrementElements[i].setAttribute(\"data-counter-increment\", counter.name);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessCounterResets(parsed, counter) {\n\t\tlet reset;\n\t\tfor (let r in counter.resets) {\n\t\t\treset = counter.resets[r];\n\t\t\t// Find elements for resets\n\t\t\tlet resetElements = parsed.querySelectorAll(reset.selector);\n\t\t\t// Add counter data\n\t\t\tfor (var i = 0; i < resetElements.length; i++) {\n\t\t\t\tlet value = reset.number;\n\t\t\t\tif (typeof value === \"string\" && value.startsWith(\"--\")) {\n\t\t\t\t\t// The value is specified using a CSS variable (custom property).\n\t\t\t\t\t// FIXME: We get the variable value only from the inline style of the element because at this point the\n\t\t\t\t\t// element is detached and thus using:\n\t\t\t\t\t//\n\t\t\t\t\t//\t\tgetComputedStyle(resetElements[i]).getPropertyValue(value)\n\t\t\t\t\t//\n\t\t\t\t\t// always returns an empty string. We could try to temporarily attach the element to get its computed style,\n\t\t\t\t\t// but for now using the inline style is enough for us.\n\t\t\t\t\tvalue = resetElements[i].style.getPropertyValue(value) || 0;\n\t\t\t\t}\n\t\t\t\tresetElements[i].setAttribute(\"data-counter-\"+ counter.name +\"-reset\", value);\n\t\t\t\tif (resetElements[i].getAttribute(\"data-counter-reset\")) {\n\t\t\t\t\tresetElements[i].setAttribute(\"data-counter-reset\", resetElements[i].getAttribute(\"data-counter-reset\") + \" \" + counter.name);\n\t\t\t\t} else {\n\t\t\t\t\tresetElements[i].setAttribute(\"data-counter-reset\", counter.name);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\taddCounterValues(parsed, counter) {\n\t\tlet counterName = counter.name;\n\n\t\tif (counterName === \"page\" || counterName === \"footnote\") {\n\t\t\treturn;\n\t\t}\n\n\t\tlet elements = parsed.querySelectorAll(\"[data-counter-\"+ counterName +\"-reset], [data-counter-\"+ counterName +\"-increment]\");\n\n\t\tlet count = 0;\n\t\tlet element;\n\t\tlet increment, reset;\n\t\tlet resetValue, incrementValue, resetDelta;\n\t\tlet incrementArray;\n\n\t\tfor (let i = 0; i < elements.length; i++) {\n\t\t\telement = elements[i];\n\t\t\tresetDelta = 0;\n\t\t\tincrementArray = [];\n\n\t\t\tif (element.hasAttribute(\"data-counter-\"+ counterName +\"-reset\")) {\n\t\t\t\treset = element.getAttribute(\"data-counter-\"+ counterName +\"-reset\");\n\t\t\t\tresetValue = parseInt(reset);\n\n\t\t\t\t// Use negative increment value inplace of reset\n\t\t\t\tresetDelta = resetValue - count;\n\t\t\t\tincrementArray.push(`${counterName} ${resetDelta}`);\n\n\t\t\t\tcount = resetValue;\n\t\t\t}\n\n\t\t\tif (element.hasAttribute(\"data-counter-\"+ counterName +\"-increment\")) {\n\n\t\t\t\tincrement = element.getAttribute(\"data-counter-\"+ counterName +\"-increment\");\n\t\t\t\tincrementValue = parseInt(increment);\n\n\t\t\t\tcount += incrementValue;\n\n\t\t\t\telement.setAttribute(\"data-counter-\"+counterName+\"-value\", count);\n\n\t\t\t\tincrementArray.push(`${counterName} ${incrementValue}`);\n\t\t\t}\n\n\t\t\tif (incrementArray.length > 0) {\n\t\t\t\tthis.incrementCounterForElement(element, incrementArray);\n\t\t\t}\n\n\t\t}\n\t}\n\n\taddFootnoteMarkerCounter(list) {\n\t\tlet markers = [];\n\t\tcsstree.walk(list, {\n\t\t\tvisit: \"Identifier\",\n\t\t\tenter: (identNode, iItem, iList) => {\n\t\t\t\tmarkers.push(identNode.name);\n\t\t\t}\n\t\t});\n\n\t\t// Already added\n\t\tif (markers.includes(\"footnote-maker\")) {\n\t\t\treturn;\n\t\t}\n\n\t\tlist.insertData({\n\t\t\ttype: \"WhiteSpace\",\n\t\t\tvalue: \" \"\n\t\t});\n\n\t\tlist.insertData({\n\t\t\ttype: \"Identifier\",\n\t\t\tname: \"footnote-marker\"\n\t\t});\n\n\t\tlist.insertData({\n\t\t\ttype: \"WhiteSpace\",\n\t\t\tvalue: \" \"\n\t\t});\n\n\t\tlist.insertData({\n\t\t\ttype: \"Number\",\n\t\t\tvalue: 0\n\t\t});\n\t}\n\n\tincrementCounterForElement(element, incrementArray) {\n\t\tif (!element || !incrementArray || incrementArray.length === 0) return;\n\n\t\tconst ref = element.dataset.ref;\n\t\tconst increments = Array.from(this.styleSheet.cssRules).filter((rule) => {\n\t\t\treturn rule.selectorText === `[data-ref=\"${element.dataset.ref}\"]:not([data-split-from])`\n\t\t\t\t\t\t && rule.style[0] === \"counter-increment\";\n\t\t}).map(rule => rule.style.counterIncrement);\n\n\t\t// Merge the current increments by summing the values because we generate both a decrement and an increment when the\n\t\t// element resets and increments the counter at the same time. E.g. ['c1 -7', 'c1 1'] should lead to 'c1 -6'.\n\t\tincrements.push(this.mergeIncrements(incrementArray,\n\t\t\t(prev, next) => (parseInt(prev) || 0) + (parseInt(next) || 0)));\n\n\t\t// Keep the last value for each counter when merging with the previous increments. E.g. ['c1 -7 c2 3', 'c1 1']\n\t\t// should lead to 'c1 1 c2 3'.\n\t\tconst counterIncrement = this.mergeIncrements(increments, (prev, next) => next);\n\t\tthis.insertRule(`[data-ref=\"${ref}\"]:not([data-split-from]) { counter-increment: ${counterIncrement} }`);\n\t}\n\n\t/**\n\t * Merge multiple values of a counter-increment CSS rule, using the specified operator.\n\t *\n\t * @param {Array} incrementArray the values to merge, e.g. ['c1 1', 'c1 -7 c2 1']\n\t * @param {Function} operator the function used to merge counter values (e.g. keep the last value of a counter or sum\n\t *\t\t\t\t\tthe counter values)\n\t * @return {string} the merged value of the counter-increment CSS rule\n\t */\n\tmergeIncrements(incrementArray, operator) {\n\t\tconst increments = {};\n\t\tincrementArray.forEach(increment => {\n\t\t\tlet values = increment.split(\" \");\n\t\t\tfor (let i = 0; i < values.length; i+=2) {\n\t\t\t\tincrements[values[i]] = operator(increments[values[i]], values[i + 1]);\n\t\t\t}\n\t\t});\n\n\t\treturn Object.entries(increments).map(([key, value]) => `${key} ${value}`).join(\" \");\n\t}\n\n\tafterPageLayout(pageElement, page) {\n\t\tlet resets = [];\n\n\t\tlet pgreset = pageElement.querySelectorAll(\"[data-counter-page-reset]:not([data-split-from])\");\n\t\tpgreset.forEach((reset) => {\n\t\t\tconst ref = reset.dataset && reset.dataset.ref;\n\t\t\tif (ref && this.resetCountersMap.has(ref)) {\n\t\t\t\t// ignoring, the counter-reset directive has already been taken into account.\n\t\t\t} else {\n\t\t\t\tif (ref) {\n\t\t\t\t\tthis.resetCountersMap.set(ref, \"\");\n\t\t\t\t}\n\t\t\t\tlet value = reset.dataset.counterPageReset;\n\t\t\t\tresets.push(`page ${value}`);\n\t\t\t}\n\t\t});\n\n\t\tlet notereset = pageElement.querySelectorAll(\"[data-counter-footnote-reset]:not([data-split-from])\");\n\t\tnotereset.forEach((reset) => {\n\t\t\tlet value = reset.dataset.counterFootnoteReset;\n\t\t\tresets.push(`footnote ${value}`);\n\t\t\tresets.push(`footnote-marker ${value}`);\n\t\t});\n\n\t\tif (resets.length) {\n\t\t\tthis.styleSheet.insertRule(`[data-page-number=\"${pageElement.dataset.pageNumber}\"] { counter-increment: none; counter-reset: ${resets.join(\" \")} }`, this.styleSheet.cssRules.length);\n\t\t}\n\t}\n\n}\n\nexport default Counters;\n","import Handler from \"../handler.js\";\n\nclass Lists extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\t}\n\tafterParsed(content) {\n\t\tconst orderedLists = content.querySelectorAll(\"ol\");\n\n\t\tfor (var list of orderedLists) {\n\t\t\tthis.addDataNumbers(list);\n\t\t}\n\t}\n\n\tafterPageLayout(pageElement, page, breakToken, chunker) {\n\t\tvar orderedLists = pageElement.getElementsByTagName(\"ol\");\n\t\tfor (var list of orderedLists) {\n\t\t\tif (list.firstElementChild) {\n\t\t\t\tlist.start = list.firstElementChild.dataset.itemNum;\n\t\t\t}\n\t\t}\n\t}\n\n\taddDataNumbers(list) {\n\t\tlet start = 1;\n\t\tif (list.hasAttribute(\"start\")) {\n\t\t\tstart = parseInt(list.getAttribute(\"start\"), 10);\n\t\t\tif (isNaN(start)) {\n\t\t\t\tstart = 1;\n\t\t\t}\n\t\t}\n\t\tlet items = list.children;\n\t\tfor (var i = 0; i < items.length; i++) {\n\t\t\titems[i].setAttribute(\"data-item-num\", i + start);\n\t\t}\n\t}\n\n}\n\nexport default Lists;\n","import Handler from \"../handler.js\";\nimport csstree from \"css-tree\";\n\nclass PositionFixed extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\t\tthis.styleSheet = polisher.styleSheet;\n\t\tthis.fixedElementsSelector = [];\n\t\tthis.fixedElements = [];\n\t}\n\n\tonDeclaration(declaration, dItem, dList, rule) {\n\t\tif (declaration.property === \"position\" && declaration.value.children.first().name === \"fixed\") {\n\t\t\tlet selector = csstree.generate(rule.ruleNode.prelude);\n\t\t\tthis.fixedElementsSelector.push(selector);\n\t\t\tdList.remove(dItem);\n\t\t}\n\t}\n\n\tafterParsed(fragment) {\n\t\tthis.fixedElementsSelector.forEach(fixedEl => {\n\t\t\tfragment.querySelectorAll(`${fixedEl}`).forEach(el => {\n\t\t\t\tel.style.setProperty(\"position\", \"absolute\");\n\t\t\t\tthis.fixedElements.push(el);\n\t\t\t\tel.remove();\n\t\t\t});\n\t\t});\n\t}\n\n\tafterPageLayout(pageElement, page, breakToken) {\n\t\tthis.fixedElements.forEach(el => {\n\t\t\tconst clone = el.cloneNode(true);\n\t\t\tpageElement.querySelector(\".pagedjs_pagebox\").insertAdjacentElement(\"afterbegin\", clone);\n\t\t});\n\t}\n}\n\n\n\n\n\nexport default PositionFixed;\n\n","import Handler from \"../handler.js\";\nimport csstree from \"css-tree\";\n\nclass PageCounterIncrement extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\n\t\tthis.styleSheet = polisher.styleSheet;\n\t\tthis.pageCounter = {\n\t\t\tname: \"page\",\n\t\t\tincrements: {},\n\t\t\tresets: {}\n\t\t};\n\t}\n\n\tonDeclaration(declaration, dItem, dList, rule) {\n\t\tconst property = declaration.property;\n\n\t\tif (property === \"counter-increment\") {\n\t\t\tlet inc = this.handleIncrement(declaration, rule);\n\t\t\tif (inc) {\n\t\t\t\tdList.remove(dItem);\n\t\t\t}\n\t\t}\n\t}\n\n\tafterParsed(_) {\n\t\tfor (const inc in this.pageCounter.increments) {\n\t\t\tconst increment = this.pageCounter.increments[inc];\n\t\t\tthis.insertRule(`${increment.selector} { --pagedjs-page-counter-increment: ${increment.number} }`);\n\t\t}\n\t}\n\n\thandleIncrement(declaration, rule) {\n\t\tconst identifier = declaration.value.children.first();\n\t\tconst number = declaration.value.children.getSize() > 1 ? declaration.value.children.last().value : 1;\n\t\tconst name = identifier && identifier.name;\n\n\t\tif (name && name.indexOf(\"target-counter-\") === 0) {\n\t\t\treturn;\n\t\t}\n\t\t// A counter named page is automatically created and incremented by 1 on every page of the document,\n\t\t// unless the counter-increment property in the page context explicitly specifies a different increment for the page counter.\n\t\t// https://www.w3.org/TR/css-page-3/#page-based-counters\n\t\tif (name !== \"page\") {\n\t\t\treturn;\n\t\t}\n\t\t// the counter-increment property is not defined on the page context (i.e. @page rule), ignoring...\n\t\tif (rule.ruleNode.name === \"page\" && rule.ruleNode.type === \"Atrule\") {\n\t\t\treturn;\n\t\t}\n\t\tconst selector = csstree.generate(rule.ruleNode.prelude);\n\t\treturn this.pageCounter.increments[selector] = {\n\t\t\tselector: selector,\n\t\t\tnumber\n\t\t};\n\t}\n\n\tinsertRule(rule) {\n\t\tthis.styleSheet.insertRule(rule, this.styleSheet.cssRules.length);\n\t}\n}\n\nexport default PageCounterIncrement;\n","import Handler from \"../handler.js\";\nimport csstree from \"css-tree\";\nimport {UUID} from \"../../utils/utils.js\";\n\nclass NthOfType extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\n\t\tthis.styleSheet = polisher.styleSheet;\n\t\tthis.selectors = {};\n\t}\n\n\tonRule(ruleNode, ruleItem, rulelist) {\n\t\tlet selector = csstree.generate(ruleNode.prelude);\n\t\tif (selector.match(/:(first|last|nth)-of-type/)) {\n\t\t\t\n\t\t\tlet declarations = csstree.generate(ruleNode.block);\n\t\t\tdeclarations = declarations.replace(/[{}]/g,\"\");\n\n\t\t\tlet uuid = \"nth-of-type-\" + UUID();\n\n\t\t\tselector.split(\",\").forEach((s) => {\n\t\t\t\tif (!this.selectors[s]) {\n\t\t\t\t\tthis.selectors[s] = [uuid, declarations];\n\t\t\t\t} else {\n\t\t\t\t\tthis.selectors[s][1] = `${this.selectors[s][1]};${declarations}` ;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\trulelist.remove(ruleItem);\n\t\t}\n\t}\n\n\tafterParsed(parsed) {\n\t\tthis.processSelectors(parsed, this.selectors);\n\t}\n\n\tprocessSelectors(parsed, selectors) {\n\t\t// add the new attributes to matching elements\n\t\tfor (let s in selectors) {\n\t\t\tlet elements = parsed.querySelectorAll(s);\n\n\t\t\tfor (var i = 0; i < elements.length; i++) {\n\t\t\t\tlet dataNthOfType = elements[i].getAttribute(\"data-nth-of-type\");\n\n\t\t\t\tif (dataNthOfType && dataNthOfType != \"\") {\n\t\t\t\t\tdataNthOfType = `${dataNthOfType},${selectors[s][0]}`;\n\t\t\t\t\telements[i].setAttribute(\"data-nth-of-type\", dataNthOfType);\n\t\t\t\t} else {\n\t\t\t\t\telements[i].setAttribute(\"data-nth-of-type\", selectors[s][0]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet rule = `*[data-nth-of-type*='${selectors[s][0]}'] { ${selectors[s][1]}; }`;\n\t\t\tthis.styleSheet.insertRule(rule, this.styleSheet.cssRules.length);\n\t\t}\n\t}\n}\n\n\n\n\nexport default NthOfType;\n\n","import Handler from \"../handler.js\";\nimport csstree from \"css-tree\";\nimport {UUID} from \"../../utils/utils.js\";\n\nclass Following extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\n\t\tthis.styleSheet = polisher.styleSheet;\n\t\tthis.selectors = {};\n\t}\n\n\tonRule(ruleNode, ruleItem, rulelist) {\n\t\tlet selector = csstree.generate(ruleNode.prelude);\n\t\tif (selector.match(/\\+/)) {\n\t\t\t\n\t\t\tlet declarations = csstree.generate(ruleNode.block);\n\t\t\tdeclarations = declarations.replace(/[{}]/g,\"\");\n\n\t\t\tlet uuid = \"following-\" + UUID();\n\n\t\t\tselector.split(\",\").forEach((s) => {\n\t\t\t\tif (!this.selectors[s]) {\n\t\t\t\t\tthis.selectors[s] = [uuid, declarations];\n\t\t\t\t} else {\n\t\t\t\t\tthis.selectors[s][1] = `${this.selectors[s][1]};${declarations}` ;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\trulelist.remove(ruleItem);\n\t\t}\n\t}\n\n\tafterParsed(parsed) {\n\t\tthis.processSelectors(parsed, this.selectors);\n\t}\n\n\tprocessSelectors(parsed, selectors) {\n\t\t// add the new attributes to matching elements\n\t\tfor (let s in selectors) {\n\t\t\tlet elements = parsed.querySelectorAll(s);\n\n\t\t\tfor (var i = 0; i < elements.length; i++) {\n\t\t\t\tlet dataFollowing = elements[i].getAttribute(\"data-following\");\n\n\t\t\t\tif (dataFollowing && dataFollowing != \"\") {\n\t\t\t\t\tdataFollowing = `${dataFollowing},${selectors[s][0]}`;\n\t\t\t\t\telements[i].setAttribute(\"data-following\", dataFollowing);\n\t\t\t\t} else {\n\t\t\t\t\telements[i].setAttribute(\"data-following\", selectors[s][0]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet rule = `*[data-following*='${selectors[s][0]}'] { ${selectors[s][1]}; }`;\n\t\t\tthis.styleSheet.insertRule(rule, this.styleSheet.cssRules.length);\n\t\t}\n\t}\n}\n\n\n\n\nexport default Following;\n\n","import Handler from \"../handler.js\";\nimport { isContainer, isElement } from \"../../utils/dom.js\";\nimport Layout from \"../../chunker/layout.js\";\nimport csstree from \"css-tree\";\n\nclass Footnotes extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\n\t\tthis.footnotes = {};\n\t\tthis.needsLayout = [];\n\t}\n\n\tonDeclaration(declaration, dItem, dList, rule) {\n\t\tlet property = declaration.property;\n\t\tif (property === \"float\") {\n\t\t\tlet identifier = declaration.value.children && declaration.value.children.first();\n\t\t\tlet location = identifier && identifier.name;\n\t\t\tif (location === \"footnote\") {\n\t\t\t\tlet selector = csstree.generate(rule.ruleNode.prelude);\n\t\t\t\tthis.footnotes[selector] = {\n\t\t\t\t\tselector: selector,\n\t\t\t\t\tpolicy: \"auto\",\n\t\t\t\t\tdisplay: \"block\"\n\t\t\t\t};\n\t\t\t\tdList.remove(dItem);\n\t\t\t}\n\t\t}\n\t\tif (property === \"footnote-policy\") {\n\t\t\tlet identifier = declaration.value.children && declaration.value.children.first();\n\t\t\tlet policy = identifier && identifier.name;\n\t\t\tif (policy) {\n\t\t\t\tlet selector = csstree.generate(rule.ruleNode.prelude);\n\t\t\t\tlet note = this.footnotes[selector];\n\t\t\t\tif (note) {\n\t\t\t\t\tnote.policy = policy;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (property === \"footnote-display\") {\n\t\t\tlet identifier = declaration.value.children && declaration.value.children.first();\n\t\t\tlet display = identifier && identifier.name;\n\t\t\tlet selector = csstree.generate(rule.ruleNode.prelude);\n\t\t\tif (display && this.footnotes[selector]) {\n\t\t\t\tlet note = this.footnotes[selector];\n\t\t\t\tif (note) {\n\t\t\t\t\tnote.display = display;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonPseudoSelector(pseudoNode, pItem, pList, selector, rule) {\n\t\tlet name = pseudoNode.name;\n\t\tif (name === \"footnote-marker\") {\n\t\t\t// switch ::footnote-marker to [data-footnote-marker]::before\n\t\t\tlet prelude = rule.ruleNode.prelude;\n\t\t\tlet newPrelude = new csstree.List();\n\n\t\t\t// Can't get remove to work, so just copying everything else\n\t\t\tprelude.children.first().children.each((node) => {\n\t\t\t\tif (node.type !== \"PseudoElementSelector\") {\n\t\t\t\t\tnewPrelude.appendData(node);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Add our data call\n\t\t\tnewPrelude.appendData({\n\t\t\t\ttype: \"AttributeSelector\",\n\t\t\t\tname: {\n\t\t\t\t\ttype: \"Identifier\",\n\t\t\t\t\tname: \"data-footnote-marker\",\n\t\t\t\t},\n\t\t\t\tflags: null,\n\t\t\t\tloc: null,\n\t\t\t\tmatcher: null,\n\t\t\t\tvalue: null\n\t\t\t});\n\n\t\t\t// Add new pseudo element\n\t\t\tnewPrelude.appendData({\n\t\t\t\ttype: \"PseudoElementSelector\",\n\t\t\t\tname: \"marker\",\n\t\t\t\tloc: null,\n\t\t\t\tchildren: null\n\t\t\t});\n\n\t\t\tprelude.children.first().children = newPrelude;\n\t\t}\n\n\t\tif (name === \"footnote-call\") {\n\t\t\t// switch ::footnote-call to [data-footnote-call]::after\n\n\t\t\tlet prelude = rule.ruleNode.prelude;\n\t\t\tlet newPrelude = new csstree.List();\n\n\t\t\t// Can't get remove to work, so just copying everything else\n\t\t\tprelude.children.first().children.each((node) => {\n\t\t\t\tif (node.type !== \"PseudoElementSelector\") {\n\t\t\t\t\tnewPrelude.appendData(node);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Add our data call\n\t\t\tnewPrelude.appendData({\n\t\t\t\ttype: \"AttributeSelector\",\n\t\t\t\tname: {\n\t\t\t\t\ttype: \"Identifier\",\n\t\t\t\t\tname: \"data-footnote-call\",\n\t\t\t\t},\n\t\t\t\tflags: null,\n\t\t\t\tloc: null,\n\t\t\t\tmatcher: null,\n\t\t\t\tvalue: null\n\t\t\t});\n\n\t\t\t// Add new pseudo element\n\t\t\tnewPrelude.appendData({\n\t\t\t\ttype: \"PseudoElementSelector\",\n\t\t\t\tname: \"after\",\n\t\t\t\tloc: null,\n\t\t\t\tchildren: null\n\t\t\t});\n\n\t\t\tprelude.children.first().children = newPrelude;\n\t\t}\n\t}\n\n\tafterParsed(parsed) {\n\t\tthis.processFootnotes(parsed, this.footnotes);\n\t}\n\n\tprocessFootnotes(parsed, notes) {\n\t\tfor (let n in notes) {\n\t\t\t// Find elements\n\t\t\tlet elements = parsed.querySelectorAll(n);\n\t\t\tlet element;\n\t\t\tlet note = notes[n];\n\t\t\tfor (var i = 0; i < elements.length; i++) {\n\t\t\t\telement = elements[i];\n\t\t\t\t// Add note type\n\t\t\t\telement.setAttribute(\"data-note\", \"footnote\");\n\t\t\t\telement.setAttribute(\"data-break-before\", \"avoid\");\n\t\t\t\telement.setAttribute(\"data-note-policy\", note.policy || \"auto\");\n\t\t\t\telement.setAttribute(\"data-note-display\", note.display || \"block\");\n\t\t\t\t// Mark all parents\n\t\t\t\tthis.processFootnoteContainer(element);\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessFootnoteContainer(node) {\n\t\t// Find the container\n\t\tlet element = node.parentElement;\n\t\tlet prevElement = element;\n\t\t// Walk up the dom until we find a container element\n\t\twhile (element) {\n\t\t\tif (isContainer(element)) {\n\t\t\t\t// Add flag to the previous non-container element that will render with children\n\t\t\t\tprevElement.setAttribute(\"data-has-notes\", \"true\");\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tprevElement = element;\n\t\t\telement = element.parentElement;\n\n\t\t\t// If no containers were found and there are no further parents flag the last element\n\t\t\tif (!element) {\n\t\t\t\tprevElement.setAttribute(\"data-has-notes\", \"true\");\n\t\t\t}\n\t\t}\n\t}\n\n\trenderNode(node) {\n\t\tif (node.nodeType == 1) {\n\t\t\t// Get all notes\n\t\t\tlet notes;\n\n\t\t\t// Ingnore html element nodes, like mathml\n\t\t\tif (!node.dataset) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (node.dataset.note === \"footnote\") {\n\t\t\t\tnotes = [node];\n\t\t\t} else if (node.dataset.hasNotes || node.querySelectorAll(\"[data-note='footnote']\")) {\n\t\t\t\tnotes = node.querySelectorAll(\"[data-note='footnote']\");\n\t\t\t}\n\n\t\t\tif (notes && notes.length) {\n\t\t\t\tthis.findVisibleFootnotes(notes, node);\n\t\t\t}\n\t\t}\n\t}\n\n\tfindVisibleFootnotes(notes, node) {\n\t\tlet area, size, right;\n\t\tarea = node.closest(\".pagedjs_page_content\");\n\t\tsize = area.getBoundingClientRect();\n\t\tright = size.left + size.width;\n\n\t\tfor (let i = 0; i < notes.length; ++i) {\n\t\t\tlet currentNote = notes[i];\n\t\t\tlet bounds = currentNote.getBoundingClientRect();\n\t\t\tlet left = bounds.left;\n\n\t\t\tif (left < right) {\n\t\t\t\t// Add call for the note\n\t\t\t\tthis.moveFootnote(currentNote, node.closest(\".pagedjs_area\"), true);\n\t\t\t}\n\t\t}\n\t}\n\n\tmoveFootnote(node, pageArea, needsNoteCall) {\n\t\t// let pageArea = node.closest(\".pagedjs_area\");\n\t\tlet noteArea = pageArea.querySelector(\".pagedjs_footnote_area\");\n\t\tlet noteContent = noteArea.querySelector(\".pagedjs_footnote_content\");\n\t\tlet noteInnerContent = noteContent.querySelector(\".pagedjs_footnote_inner_content\");\n\n\t\tif (!isElement(node)) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Add call for the note\n\t\tlet noteCall;\n\t\tif (needsNoteCall) {\n\t\t\tnoteCall = this.createFootnoteCall(node);\n\t\t}\n\n\t\t// Remove the break before attribute for future layout\n\t\tnode.removeAttribute(\"data-break-before\");\n\n\t\t// Check if note already exists for overflow\n\t\tlet existing = noteInnerContent.querySelector(`[data-ref=\"${node.dataset.ref}\"]`);\n\t\tif (existing) {\n\t\t\t// Remove the note from the flow but no need to render it again\n\t\t\tnode.remove();\n\t\t\treturn;\n\t\t}\n\n\t\t// Add the note node\n\t\tnoteInnerContent.appendChild(node);\n\n\t\t// Remove empty class\n\t\tif (noteContent.classList.contains(\"pagedjs_footnote_empty\")) {\n\t\t\tnoteContent.classList.remove(\"pagedjs_footnote_empty\");\n\t\t}\n\n\t\t// Add marker\n\t\tnode.dataset.footnoteMarker = node.dataset.ref;\n\n\t\t// Add Id\n\t\tnode.id = `note-${node.dataset.ref}`;\n\n\t\t// Get note content size\n\t\tlet height = noteContent.scrollHeight;\n\n\t\t// Check the noteCall is still on screen\n\t\tlet area = pageArea.querySelector(\".pagedjs_page_content\");\n\t\tlet size = area.getBoundingClientRect();\n\t\tlet right = size.left + size.width;\n\n\t\t// TODO: add a max height in CSS\n\n\t\t// Check element sizes\n\t\tlet noteCallBounds = noteCall && noteCall.getBoundingClientRect();\n\t\tlet noteAreaBounds = noteArea.getBoundingClientRect();\n\n\t\t// Get the @footnote margins\n\t\tlet noteContentMargins = this.marginsHeight(noteContent);\n\t\tlet noteContentPadding = this.paddingHeight(noteContent);\n\t\tlet noteContentBorders = this.borderHeight(noteContent);\n\t\tlet total = noteContentMargins + noteContentPadding + noteContentBorders;\n\n\t\t// Get the top of the @footnote area\n\t\tlet notAreaTop = Math.floor(noteAreaBounds.top);\n\t\t// If the height isn't set yet, remove the margins from the top\n\t\tif (noteAreaBounds.height === 0) {\n\t\t\tnotAreaTop -= this.marginsHeight(noteContent, false);\n\t\t\tnotAreaTop -= this.paddingHeight(noteContent, false);\n\t\t\tnotAreaTop -= this.borderHeight(noteContent, false);\n\t\t}\n\t\t// Determine the note call position and offset per policy\n\t\tlet notePolicy = node.dataset.notePolicy;\n\t\tlet noteCallPosition = 0;\n\t\tlet noteCallOffset = 0;\n\t\tif (noteCall) {\n\t\t\t// Get the correct line bottom for super or sub styled callouts\n\t\t\tlet prevSibling = noteCall.previousSibling;\n\t\t\tlet range = new Range();\n\t\t\tif (prevSibling) {\n\t\t\t\trange.setStartBefore(prevSibling);\n\t\t\t} else {\n\t\t\t\trange.setStartBefore(noteCall);\n\t\t\t}\n\t\t\trange.setEndAfter(noteCall);\n\t\t\tlet rangeBounds = range.getBoundingClientRect();\n\t\t\tnoteCallPosition = rangeBounds.bottom;\n\t\t\tif (!notePolicy || notePolicy === \"auto\") {\n\t\t\t\tnoteCallOffset = Math.ceil(rangeBounds.bottom);\n\t\t\t} else if (notePolicy === \"line\") {\n\t\t\t\tnoteCallOffset = Math.ceil(rangeBounds.top);\n\t\t\t} else if (notePolicy === \"block\") {\n\t\t\t\t// Check that there is a previous element on the page\n\t\t\t\tlet parentParagraph = noteCall.closest(\"p\").previousElementSibling;\n\t\t\t\tif (parentParagraph) {\n\t\t\t\t\tnoteCallOffset = Math.ceil(\n\t\t\t\t\t\tparentParagraph.getBoundingClientRect().bottom\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tnoteCallOffset = Math.ceil(rangeBounds.bottom);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet contentDelta = height + total - noteAreaBounds.height;\n\t\t// Space between the top of the footnotes area and the bottom of the footnote call\n\t\tlet noteDelta = noteCallPosition ? notAreaTop - noteCallPosition : 0;\n\t\t// Space needed for the force a break for the policy of the footnote\n\t\tlet notePolicyDelta = noteCallPosition ? Math.floor(noteAreaBounds.top) - noteCallOffset : 0;\n\t\tlet hasNotes = noteArea.querySelector(\"[data-note='footnote']\");\n\t\tif (needsNoteCall && noteCallBounds.left > right) {\n\t\t\t// Note is offscreen and will be chunked to the next page on overflow\n\t\t\tnode.remove();\n\t\t} else if (!hasNotes && needsNoteCall && total > noteDelta) {\n\t\t\t// No space to add even the footnote area\n\t\t\tpageArea.style.setProperty(\"--pagedjs-footnotes-height\", \"0px\");\n\t\t\t// Add a wrapper as this div is removed later\n\t\t\tlet wrapperDiv = document.createElement(\"div\");\n\t\t\twrapperDiv.appendChild(node);\n\t\t\t// Push to the layout queue for the next page\n\t\t\tthis.needsLayout.push(wrapperDiv);\n\t\t} else if (!needsNoteCall) {\n\t\t\t// Call was previously added, force adding footnote\n\t\t\tpageArea.style.setProperty(\n\t\t\t\t\"--pagedjs-footnotes-height\",\n\t\t\t\t`${height + total}px`\n\t\t\t);\n\t\t} else if (noteCallPosition < noteAreaBounds.top - contentDelta) {\n\t\t\t// the current note content will fit without pushing the call to the next page\n\t\t\tpageArea.style.setProperty(\n\t\t\t\t\"--pagedjs-footnotes-height\",\n\t\t\t\t`${height + noteContentMargins + noteContentBorders}px`\n\t\t\t);\n\t\t} else {\n\t\t\t// set height to just before note call\n\t\t\tpageArea.style.setProperty(\n\t\t\t\t\"--pagedjs-footnotes-height\",\n\t\t\t\t`${noteAreaBounds.height + notePolicyDelta}px`\n\t\t\t);\n\t\t\tnoteInnerContent.style.height =\n\t\t\t\tnoteAreaBounds.height + notePolicyDelta - total + \"px\";\n\t\t}\n\t}\n\n\tcreateFootnoteCall(node) {\n\t\tlet parentElement = node.parentElement;\n\t\tlet footnoteCall = document.createElement(\"a\");\n\t\tfor (const className of node.classList) {\n\t\t\tfootnoteCall.classList.add(`${className}`);\n\t\t}\n\n\t\tfootnoteCall.dataset.footnoteCall = node.dataset.ref;\n\t\tfootnoteCall.dataset.ref = node.dataset.ref;\n\n\t\t// Increment for counters\n\t\tfootnoteCall.dataset.dataCounterFootnoteIncrement = 1;\n\n\t\t// Add link\n\t\tfootnoteCall.href = `#note-${node.dataset.ref}`;\n\n\t\tparentElement.insertBefore(footnoteCall, node);\n\n\t\treturn footnoteCall;\n\t}\n\n\tafterPageLayout(pageElement, page, breakToken, chunker) {\n\t\tlet pageArea = pageElement.querySelector(\".pagedjs_area\");\n\t\tlet noteArea = page.footnotesArea;\n\t\tlet noteContent = noteArea.querySelector(\".pagedjs_footnote_content\");\n\t\tlet noteInnerContent = noteArea.querySelector(\".pagedjs_footnote_inner_content\");\n\n\t\tlet noteContentBounds = noteContent.getBoundingClientRect();\n\t\tlet { width } = noteContentBounds;\n\n\t\tnoteInnerContent.style.columnWidth = Math.round(width) + \"px\";\n\t\tnoteInnerContent.style.columnGap = \"calc(var(--pagedjs-margin-right) + var(--pagedjs-margin-left))\";\n\n\t\t// Get overflow\n\t\tlet layout = new Layout(noteArea, undefined, chunker.settings);\n\t\tlet overflow = layout.findOverflow(noteInnerContent, noteContentBounds);\n\n\t\tif (overflow) {\n\t\t\tlet { startContainer, startOffset } = overflow;\n\t\t\tlet startIsNode;\n\t\t\tif (isElement(startContainer)) {\n\t\t\t\tlet start = startContainer.childNodes[startOffset];\n\t\t\t\tstartIsNode = isElement(start) && start.hasAttribute(\"data-footnote-marker\");\n\t\t\t}\n\n\t\t\tlet extracted = overflow.extractContents();\n\n\t\t\tif (!startIsNode) {\n\t\t\t\tlet splitChild = extracted.firstElementChild;\n\t\t\t\tsplitChild.dataset.splitFrom = splitChild.dataset.ref;\n\n\t\t\t\tthis.handleAlignment(noteInnerContent.lastElementChild);\n\t\t\t}\n\n\t\t\tthis.needsLayout.push(extracted);\n\n\t\t\tnoteContent.style.removeProperty(\"height\");\n\t\t\tnoteInnerContent.style.removeProperty(\"height\");\n\n\t\t\tlet noteInnerContentBounds = noteInnerContent.getBoundingClientRect();\n\t\t\tlet { height } = noteInnerContentBounds;\n\n\t\t\t// Get the @footnote margins\n\t\t\tlet noteContentMargins = this.marginsHeight(noteContent);\n\t\t\tlet noteContentPadding = this.paddingHeight(noteContent);\n\t\t\tlet noteContentBorders = this.borderHeight(noteContent);\n\t\t\tpageArea.style.setProperty(\n\t\t\t\t\"--pagedjs-footnotes-height\",\n\t\t\t\t`${height + noteContentMargins + noteContentBorders + noteContentPadding}px`\n\t\t\t);\n\n\t\t\t// Hide footnote content if empty\n\t\t\tif (noteInnerContent.childNodes.length === 0) {\n\t\t\t\tnoteContent.classList.add(\"pagedjs_footnote_empty\");\n\t\t\t}\n\n\t\t\tif (!breakToken) {\n\t\t\t\tchunker.clonePage(page);\n\t\t\t} else {\n\t\t\t\tlet breakBefore, previousBreakAfter;\n\t\t\t\tif (\n\t\t\t\t\tbreakToken.node &&\n\t\t\t\t\ttypeof breakToken.node.dataset !== \"undefined\" &&\n\t\t\t\t\ttypeof breakToken.node.dataset.previousBreakAfter !== \"undefined\"\n\t\t\t\t) {\n\t\t\t\t\tpreviousBreakAfter = breakToken.node.dataset.previousBreakAfter;\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\tbreakToken.node &&\n\t\t\t\t\ttypeof breakToken.node.dataset !== \"undefined\" &&\n\t\t\t\t\ttypeof breakToken.node.dataset.breakBefore !== \"undefined\"\n\t\t\t\t) {\n\t\t\t\t\tbreakBefore = breakToken.node.dataset.breakBefore;\n\t\t\t\t}\n\n\t\t\t\tif (breakBefore || previousBreakAfter) {\n\t\t\t\t\tchunker.clonePage(page);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tnoteInnerContent.style.height = \"auto\";\n\t}\n\n\thandleAlignment(node) {\n\t\tlet styles = window.getComputedStyle(node);\n\t\tlet alignLast = styles[\"text-align-last\"];\n\t\tnode.dataset.lastSplitElement = \"true\";\n\t\tif (alignLast === \"auto\") {\n\t\t\tnode.dataset.alignLastSplitElement = \"justify\";\n\t\t} else {\n\t\t\tnode.dataset.alignLastSplitElement = alignLast;\n\t\t}\n\t}\n\n\tbeforePageLayout(page) {\n\t\twhile (this.needsLayout.length) {\n\t\t\tlet fragment = this.needsLayout.shift();\n\n\t\t\tArray.from(fragment.childNodes).forEach((node) => {\n\t\t\t\tthis.moveFootnote(\n\t\t\t\t\tnode,\n\t\t\t\t\tpage.element.querySelector(\".pagedjs_area\"),\n\t\t\t\t\tfalse\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\t}\n\n\tafterOverflowRemoved(removed, rendered) {\n\t\t// Find the page area\n\t\tlet area = rendered.closest(\".pagedjs_area\");\n\t\t// Get any rendered footnotes\n\t\tlet notes = area.querySelectorAll(\".pagedjs_footnote_area [data-note='footnote']\");\n\t\tfor (let n = 0; n < notes.length; n++) {\n\t\t\tconst note = notes[n];\n\t\t\t// Check if the call for that footnote has been removed with the overflow\n\t\t\tlet call = removed.querySelector(`[data-footnote-call=\"${note.dataset.ref}\"]`);\n\t\t\tif (call) {\n\t\t\t\tnote.remove();\n\t\t\t}\n\t\t}\n\t\t// Hide footnote content if empty\n\t\tlet noteInnerContent = area.querySelector(\".pagedjs_footnote_inner_content\");\n\t\tif (noteInnerContent && noteInnerContent.childNodes.length === 0) {\n\t\t\tnoteInnerContent.parentElement.classList.add(\"pagedjs_footnote_empty\");\n\t\t}\n\t}\n\n\tmarginsHeight(element, total=true) {\n\t\tlet styles = window.getComputedStyle(element);\n\t\tlet marginTop = parseInt(styles.marginTop);\n\t\tlet marginBottom = parseInt(styles.marginBottom);\n\t\tlet margin = 0;\n\t\tif (marginTop) {\n\t\t\tmargin += marginTop;\n\t\t}\n\t\tif (marginBottom && total) {\n\t\t\tmargin += marginBottom;\n\t\t}\n\t\treturn margin;\n\t}\n\n\tpaddingHeight(element, total=true) {\n\t\tlet styles = window.getComputedStyle(element);\n\t\tlet paddingTop = parseInt(styles.paddingTop);\n\t\tlet paddingBottom = parseInt(styles.paddingBottom);\n\t\tlet padding = 0;\n\t\tif (paddingTop) {\n\t\t\tpadding += paddingTop;\n\t\t}\n\t\tif (paddingBottom && total) {\n\t\t\tpadding += paddingBottom;\n\t\t}\n\t\treturn padding;\n\t}\n\n\tborderHeight(element, total=true) {\n\t\tlet styles = window.getComputedStyle(element);\n\t\tlet borderTop = parseInt(styles.borderTop);\n\t\tlet borderBottom = parseInt(styles.borderBottom);\n\t\tlet borders = 0;\n\t\tif (borderTop) {\n\t\t\tborders += borderTop;\n\t\t}\n\t\tif (borderBottom && total) {\n\t\t\tborders += borderBottom;\n\t\t}\n\t\treturn borders;\n\t}\n}\n\nexport default Footnotes;\n","import AtPage from \"./atpage.js\";\nimport Breaks from \"./breaks.js\";\nimport PrintMedia from \"./print-media.js\";\nimport Splits from \"./splits.js\";\nimport Counters from \"./counters.js\";\nimport Lists from \"./lists.js\";\nimport PositionFixed from \"./position-fixed.js\";\nimport PageCounterIncrement from \"./page-counter-increment.js\";\nimport NthOfType from \"./nth-of-type.js\";\nimport Following from \"./following.js\";\nimport Footnotes from \"./footnotes.js\";\n\nexport default [\n\tPrintMedia,\n\tAtPage,\n\tBreaks,\n\tSplits,\n\tCounters,\n\tLists,\n\tPositionFixed,\n\tPageCounterIncrement,\n\tNthOfType,\n\tFollowing,\n\tFootnotes\n];\n","import Handler from \"../handler.js\";\nimport csstree from \"css-tree\";\n\nclass RunningHeaders extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\n\t\tthis.runningSelectors = {};\n\t\tthis.elements = {};\n\t}\n\n\tonDeclaration(declaration, dItem, dList, rule) {\n\t\tif (declaration.property === \"position\") {\n\t\t\tlet selector = csstree.generate(rule.ruleNode.prelude);\n\t\t\tlet identifier = declaration.value.children.first().name;\n\n\t\t\tif (identifier === \"running\") {\n\t\t\t\tlet value;\n\t\t\t\tcsstree.walk(declaration, {\n\t\t\t\t\tvisit: \"Function\",\n\t\t\t\t\tenter: (node, item, list) => {\n\t\t\t\t\t\tvalue = node.children.first().name;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.runningSelectors[value] = {\n\t\t\t\t\tidentifier: identifier,\n\t\t\t\t\tvalue: value,\n\t\t\t\t\tselector: selector\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tif (declaration.property === \"content\") {\n\n\t\t\tcsstree.walk(declaration, {\n\t\t\t\tvisit: \"Function\",\n\t\t\t\tenter: (funcNode, fItem, fList) => {\n\n\t\t\t\t\tif (funcNode.name.indexOf(\"element\") > -1) {\n\n\t\t\t\t\t\tlet selector = csstree.generate(rule.ruleNode.prelude);\n\n\t\t\t\t\t\tlet func = funcNode.name;\n\n\t\t\t\t\t\tlet value = funcNode.children.first().name;\n\n\t\t\t\t\t\tlet args = [value];\n\n\t\t\t\t\t\t// we only handle first for now\n\t\t\t\t\t\tlet style = \"first\";\n\n\t\t\t\t\t\tselector.split(\",\").forEach((s) => {\n\t\t\t\t\t\t\t// remove before / after\n\t\t\t\t\t\t\ts = s.replace(/::after|::before/, \"\");\n\n\t\t\t\t\t\t\tthis.elements[s] = {\n\t\t\t\t\t\t\t\tfunc: func,\n\t\t\t\t\t\t\t\targs: args,\n\t\t\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\t\t\tstyle: style || \"first\",\n\t\t\t\t\t\t\t\tselector: s,\n\t\t\t\t\t\t\t\tfullSelector: selector\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tafterParsed(fragment) {\n\t\tfor (let name of Object.keys(this.runningSelectors)) {\n\t\t\tlet set = this.runningSelectors[name];\n\t\t\tlet selected = Array.from(fragment.querySelectorAll(set.selector));\n\n\t\t\tif (set.identifier === \"running\") {\n\t\t\t\tfor (let header of selected) {\n\t\t\t\t\theader.style.display = \"none\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t}\n\n\tafterPageLayout(fragment) {\n\t\tfor (let name of Object.keys(this.runningSelectors)) {\n\t\t\tlet set = this.runningSelectors[name];\n\t\t\tlet selected = fragment.querySelector(set.selector);\n\t\t\tif (selected) {\n\t\t\t\t// let cssVar;\n\t\t\t\tif (set.identifier === \"running\") {\n\t\t\t\t\t// cssVar = selected.textContent.replace(/\\\\([\\s\\S])|([\"|'])/g,\"\\\\$1$2\");\n\t\t\t\t\t// this.styleSheet.insertRule(`:root { --string-${name}: \"${cssVar}\"; }`, this.styleSheet.cssRules.length);\n\t\t\t\t\t// fragment.style.setProperty(`--string-${name}`, `\"${cssVar}\"`);\n\t\t\t\t\tset.first = selected;\n\t\t\t\t} else {\n\t\t\t\t\tconsole.warn(set.value + \"needs css replacement\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// move elements\n\t\tif (!this.orderedSelectors) {\n\t\t\tthis.orderedSelectors = this.orderSelectors(this.elements);\n\t\t}\n\n\t\tfor (let selector of this.orderedSelectors) {\n\t\t\tif (selector) {\n\n\t\t\t\tlet el = this.elements[selector];\n\t\t\t\tlet selected = fragment.querySelector(selector);\n\t\t\t\tif (selected) {\n\t\t\t\t\tlet running = this.runningSelectors[el.args[0]];\n\t\t\t\t\tif (running && running.first) {\n\t\t\t\t\t\tselected.innerHTML = \"\"; // Clear node\n\t\t\t\t\t\t// selected.classList.add(\"pagedjs_clear-after\"); // Clear ::after\n\t\t\t\t\t\tlet clone = running.first.cloneNode(true);\n\t\t\t\t\t\tclone.style.display = null;\n\t\t\t\t\t\tselected.appendChild(clone);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t* Assign a weight to @page selector classes\n\t* 1) page\n\t* 2) left & right\n\t* 3) blank\n\t* 4) first & nth\n\t* 5) named page\n\t* 6) named left & right\n\t* 7) named first & nth\n\t* @param {string} [s] selector string\n\t* @return {int} weight\n\t*/\n\tpageWeight(s) {\n\t\tlet weight = 1;\n\t\tlet selector = s.split(\" \");\n\t\tlet parts = selector.length && selector[0].split(\".\");\n\n\t\tparts.shift(); // remove empty first part\n\n\t\tswitch (parts.length) {\n\t\t\tcase 4:\n\t\t\t\tif (/^pagedjs_[\\w-]+_first_page$/.test(parts[3])) {\n\t\t\t\t\tweight = 7;\n\t\t\t\t} else if (parts[3] === \"pagedjs_left_page\" || parts[3] === \"pagedjs_right_page\") {\n\t\t\t\t\tweight = 6;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tif (parts[1] === \"pagedjs_named_page\") {\n\t\t\t\t\tif (parts[2].indexOf(\":nth-of-type\") > -1) {\n\t\t\t\t\t\tweight = 7;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tweight = 5;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tif (parts[1] === \"pagedjs_first_page\") {\n\t\t\t\t\tweight = 4;\n\t\t\t\t} else if (parts[1] === \"pagedjs_blank_page\") {\n\t\t\t\t\tweight = 3;\n\t\t\t\t} else if (parts[1] === \"pagedjs_left_page\" || parts[1] === \"pagedjs_right_page\") {\n\t\t\t\t\tweight = 2;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tif (parts[0].indexOf(\":nth-of-type\") > -1) {\n\t\t\t\t\tweight = 4;\n\t\t\t\t} else {\n\t\t\t\t\tweight = 1;\n\t\t\t\t}\n\t\t}\n\n\t\treturn weight;\n\t}\n\n\t/**\n\t* Orders the selectors based on weight\n\t*\n\t* Does not try to deduplicate base on specifity of the selector\n\t* Previous matched selector will just be overwritten\n\t* @param {obj} [obj] selectors object\n\t* @return {Array} orderedSelectors\n\t*/\n\torderSelectors(obj) {\n\t\tlet selectors = Object.keys(obj);\n\t\tlet weighted = {\n\t\t\t1: [],\n\t\t\t2: [],\n\t\t\t3: [],\n\t\t\t4: [],\n\t\t\t5: [],\n\t\t\t6: [],\n\t\t\t7: []\n\t\t};\n\n\t\tlet orderedSelectors = [];\n\n\t\tfor (let s of selectors) {\n\t\t\tlet w = this.pageWeight(s);\n\t\t\tweighted[w].unshift(s);\n\t\t}\n\n\t\tfor (var i = 1; i <= 7; i++) {\n\t\t\torderedSelectors = orderedSelectors.concat(weighted[i]);\n\t\t}\n\n\t\treturn orderedSelectors;\n\t}\n\n\tbeforeTreeParse(text, sheet) {\n\t\t// element(x) is parsed as image element selector, so update element to element-ident\n\t\tsheet.text = text.replace(/element[\\s]*\\(([^|^#)]*)\\)/g, \"element-ident($1)\");\n\t}\n}\n\nexport default RunningHeaders;\n","export function cleanPseudoContent(el, trim = \"\\\"' \") {\n\tif(el == null) return;\n\treturn el\n\t\t.replace(new RegExp(`^[${trim}]+`), \"\")\n\t\t.replace(new RegExp(`[${trim}]+$`), \"\")\n\t\t.replace(/[\"']/g, match => {\n\t\t\treturn \"\\\\\" + match;\n\t\t})\n\t\t.replace(/[\\n]/g, match => {\n\t\t\treturn \"\\\\00000A\";\n\t\t});\n}\n\nexport function cleanSelector(el) {\n\tif(el == null) return;\n\treturn el\n\t\t.replace(new RegExp(\"::footnote-call\", \"g\"), \"\")\n\t\t.replace(new RegExp(\"::footnote-marker\", \"g\"), \"\");\n}\n","import Handler from \"../handler.js\";\nimport csstree from \"css-tree\";\nimport { cleanPseudoContent } from \"../../utils/css.js\";\n\nclass StringSets extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\n\t\tthis.stringSetSelectors = {};\n\t\tthis.type;\n\t\t// pageLastString = last string variable defined on the page\n\t\tthis.pageLastString;\n\n\t}\n\t\n\tonDeclaration(declaration, dItem, dList, rule) {\n\t\tif (declaration.property === \"string-set\") {\n\t\t\tlet selector = csstree.generate(rule.ruleNode.prelude);\n\n\t\t\tlet identifiers = [];\n\t\t\tlet functions = [];\n\t\t\tlet values = [];\n\n\t\t\tdeclaration.value.children.forEach((child) => {\n\t\t\t\tif (child.type === \"Identifier\") {\n\t\t\t\t\tidentifiers.push(child.name);\n\t\t\t\t}\n\t\t\t\tif (child.type === \"Function\") {\n\t\t\t\t\tfunctions.push(child.name);\n\t\t\t\t\tchild.children.forEach((subchild) => {\n\t\t\t\t\t\tif (subchild.type === \"Identifier\") {\n\t\t\t\t\t\t\tvalues.push(subchild.name);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tidentifiers.forEach((identifier, index) => {\n\t\t\t\tlet func = functions[index];\n\t\t\t\tlet value = values[index];\n\t\t\t\tthis.stringSetSelectors[identifier] = {\n\t\t\t\t\tidentifier,\n\t\t\t\t\tfunc,\n\t\t\t\t\tvalue,\n\t\t\t\t\tselector\n\t\t\t\t};\n\t\t\t});\n\n\t\t}\n\t}\n\n\tonContent(funcNode, fItem, fList, declaration, rule) {\n\n\t\tif (funcNode.name === \"string\") {\n\t\t\tlet identifier = funcNode.children && funcNode.children.first().name;\n\t\t\tthis.type = funcNode.children.last().name;\n\t\t\tfuncNode.name = \"var\";\n\t\t\tfuncNode.children = new csstree.List();\n\n \n\t\t\tif(this.type === \"first\" || this.type === \"last\" || this.type === \"start\" || this.type === \"first-except\"){\n\t\t\t\tfuncNode.children.append(\n\t\t\t\t\tfuncNode.children.createItem({\n\t\t\t\t\t\ttype: \"Identifier\",\n\t\t\t\t\t\tloc: null,\n\t\t\t\t\t\tname: \"--pagedjs-string-\" + this.type + \"-\" + identifier\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}else{\n\t\t\t\tfuncNode.children.append(\n\t\t\t\t\tfuncNode.children.createItem({\n\t\t\t\t\t\ttype: \"Identifier\",\n\t\t\t\t\t\tloc: null,\n\t\t\t\t\t\tname: \"--pagedjs-string-first-\" + identifier\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tafterPageLayout(fragment) {\n\n\t\n\t\tif ( this.pageLastString === undefined )\n\t\t{\n\t\t\tthis.pageLastString = {};\n\t\t}\n\n\t\t\n\t\tfor (let name of Object.keys(this.stringSetSelectors)) {\n\t\n\t\t\tlet set = this.stringSetSelectors[name];\n\t\t\tlet value = set.value;\n\t\t\tlet func = set.func;\n\t\t\tlet selected = fragment.querySelectorAll(set.selector);\n\n\t\t\t// Get the last found string for the current identifier\n\t\t\tlet stringPrevPage = ( name in this.pageLastString ) ? this.pageLastString[name] : \"\";\n\n\t\t\tlet varFirst, varLast, varStart, varFirstExcept;\n\n\t\t\tif(selected.length == 0){\n\t\t\t\t// if there is no sel. on the page\n\t\t\t\tvarFirst = stringPrevPage;\n\t\t\t\tvarLast = stringPrevPage;\n\t\t\t\tvarStart = stringPrevPage;\n\t\t\t\tvarFirstExcept = stringPrevPage;\n\t\t\t}else{\n\n\t\t\t\tselected.forEach((sel) => {\n\t\t\t\t\t// push each content into the array to define in the variable the first and the last element of the page.\n\t\t\t\t\tif (func === \"content\") {\n\t\t\t\t\t\tthis.pageLastString[name] = selected[selected.length - 1].textContent;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (func === \"attr\") {\n\t\t\t\t\t\tthis.pageLastString[name] = selected[selected.length - 1].getAttribute(value) || \"\";\n\t\t\t\t\t}\n\n\t\t\t\t});\t\n\n\t\t\t\t/* FIRST */\n\t\n\t\t\t\tif (func === \"content\") {\n\t\t\t\t\tvarFirst = selected[0].textContent;\n\t\t\t\t}\n\n\t\t\t\tif (func === \"attr\") {\n\t\t\t\t\tvarFirst = selected[0].getAttribute(value) || \"\";\n\t\t\t\t}\n\n\n\t\t\t\t/* LAST */\n\n\t\t\t\tif (func === \"content\") {\n\t\t\t\t\tvarLast = selected[selected.length - 1].textContent;\n\t\t\t\t}\n\n\t\t\t\tif (func === \"attr\") {\n\t\t\t\t\tvarLast = selected[selected.length - 1].getAttribute(value) || \"\";\n\t\t\t\t}\n\n\n\t\t\t\t/* START */\n\n\t\t\t\t// Hack to find if the sel. is the first elem of the page / find a better way \n\t\t\t\tlet selTop = selected[0].getBoundingClientRect().top;\n\t\t\t\tlet pageContent = selected[0].closest(\".pagedjs_page_content\");\n\t\t\t\tlet pageContentTop = pageContent.getBoundingClientRect().top;\n\n\t\t\t\tif(selTop == pageContentTop){\n\t\t\t\t\tvarStart = varFirst;\n\t\t\t\t}else{\n\t\t\t\t\tvarStart = stringPrevPage;\n\t\t\t\t}\n\n\t\t\t\t/* FIRST EXCEPT */\n\n\t\t\t\tvarFirstExcept = \"\";\n\t\t\t\t\n\t\t\t}\n\n\t\t\tfragment.style.setProperty(`--pagedjs-string-first-${name}`, `\"${cleanPseudoContent(varFirst)}`);\n\t\t\tfragment.style.setProperty(`--pagedjs-string-last-${name}`, `\"${cleanPseudoContent(varLast)}`);\n\t\t\tfragment.style.setProperty(`--pagedjs-string-start-${name}`, `\"${cleanPseudoContent(varStart)}`);\n\t\t\tfragment.style.setProperty(`--pagedjs-string-first-except-${name}`, `\"${cleanPseudoContent(varFirstExcept)}`);\n\t\t\t\n\t\n\t\t}\n\t}\n\t\n\n}\n\n\n\nexport default StringSets;\n","import Handler from \"../handler.js\";\nimport {attr, querySelectorEscape, UUID} from \"../../utils/utils.js\";\nimport csstree from \"css-tree\";\n\nclass TargetCounters extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\n\t\tthis.styleSheet = polisher.styleSheet;\n\n\t\tthis.counterTargets = {};\n\t}\n\n\tonContent(funcNode, fItem, fList, declaration, rule) {\n\t\tif (funcNode.name === \"target-counter\") {\n\t\t\tlet selector = csstree.generate(rule.ruleNode.prelude);\n\n\t\t\tlet first = funcNode.children.first();\n\t\t\tlet func = first.name;\n\n\t\t\tlet value = csstree.generate(funcNode);\n\n\t\t\tlet args = [];\n\n\t\t\tfirst.children.forEach((child) => {\n\t\t\t\tif (child.type === \"Identifier\") {\n\n\t\t\t\t\targs.push(child.name);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlet counter;\n\t\t\tlet style;\n\t\t\tlet styleIdentifier;\n\n\t\t\tfuncNode.children.forEach((child) => {\n\t\t\t\tif (child.type === \"Identifier\") {\n\t\t\t\t\tif (!counter) {\n\t\t\t\t\t\tcounter = child.name;\n\t\t\t\t\t} else if (!style) {\n\t\t\t\t\t\tstyleIdentifier = csstree.clone(child);\n\t\t\t\t\t\tstyle = child.name;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlet variable = \"target-counter-\" + UUID();\n\n\t\t\tselector.split(\",\").forEach((s) => {\n\t\t\t\tthis.counterTargets[s] = {\n\t\t\t\t\tfunc: func,\n\t\t\t\t\targs: args,\n\t\t\t\t\tvalue: value,\n\t\t\t\t\tcounter: counter,\n\t\t\t\t\tstyle: style,\n\t\t\t\t\tselector: s,\n\t\t\t\t\tfullSelector: selector,\n\t\t\t\t\tvariable: variable\n\t\t\t\t};\n\t\t\t});\n\n\t\t\t// Replace with counter\n\t\t\tfuncNode.name = \"counter\";\n\t\t\tfuncNode.children = new csstree.List();\n\t\t\tfuncNode.children.appendData({\n\t\t\t\ttype: \"Identifier\",\n\t\t\t\tloc: 0,\n\t\t\t\tname: variable\n\t\t\t});\n\n\t\t\tif (styleIdentifier) {\n\t\t\t\tfuncNode.children.appendData({type: \"Operator\", loc: null, value: \",\"});\n\t\t\t\tfuncNode.children.appendData(styleIdentifier);\n\t\t\t}\n\t\t}\n\t}\n\n\tafterPageLayout(fragment, page, breakToken, chunker) {\n\t\tObject.keys(this.counterTargets).forEach((name) => {\n\t\t\tlet target = this.counterTargets[name];\n\t\t\tlet split = target.selector.split(/::?/g);\n\t\t\tlet query = split[0];\n\n\t\t\tlet queried = chunker.pagesArea.querySelectorAll(query + \":not([data-\" + target.variable + \"])\");\n\n\t\t\tqueried.forEach((selected, index) => {\n\t\t\t\t// TODO: handle func other than attr\n\t\t\t\tif (target.func !== \"attr\") {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlet val = attr(selected, target.args);\n\t\t\t\tlet element = chunker.pagesArea.querySelector(querySelectorEscape(val));\n\n\t\t\t\tif (element) {\n\t\t\t\t\tlet selector = UUID();\n\t\t\t\t\tselected.setAttribute(\"data-\" + target.variable, selector);\n\t\t\t\t\t// TODO: handle other counter types (by query)\n\t\t\t\t\tlet pseudo = \"\";\n\t\t\t\t\tif (split.length > 1) {\n\t\t\t\t\t\tpseudo += \"::\" + split[1];\n\t\t\t\t\t}\n\t\t\t\t\tif (target.counter === \"page\") {\n\t\t\t\t\t\tlet pages = chunker.pagesArea.querySelectorAll(\".pagedjs_page\");\n\t\t\t\t\t\tlet pg = 0;\n\t\t\t\t\t\tfor (let i = 0; i < pages.length; i++) {\n\t\t\t\t\t\t\tlet page = pages[i];\n\t\t\t\t\t\t\tlet styles = window.getComputedStyle(page);\n\t\t\t\t\t\t\tlet reset = styles[\"counter-reset\"].replace(\"page\", \"\").trim();\n\t\t\t\t\t\t\tlet increment = styles[\"counter-increment\"].replace(\"page\", \"\").trim();\n\n\t\t\t\t\t\t\tif (reset !== \"none\") {\n\t\t\t\t\t\t\t\tpg = parseInt(reset);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (increment !== \"none\") {\n\t\t\t\t\t\t\t\tpg += parseInt(increment);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (page.contains(element)){\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.styleSheet.insertRule(`[data-${target.variable}=\"${selector}\"]${pseudo} { counter-reset: ${target.variable} ${pg}; }`, this.styleSheet.cssRules.length);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlet value = element.getAttribute(`data-counter-${target.counter}-value`);\n\t\t\t\t\t\tif (value) {\n\t\t\t\t\t\t\tthis.styleSheet.insertRule(`[data-${target.variable}=\"${selector}\"]${pseudo} { counter-reset: ${target.variable} ${target.variable} ${parseInt(value)}; }`, this.styleSheet.cssRules.length);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// force redraw\n\t\t\t\t\tlet el = document.querySelector(`[data-${target.variable}=\"${selector}\"]`);\n\t\t\t\t\tif (el) {\n\t\t\t\t\t\tel.style.display = \"none\";\n\t\t\t\t\t\tel.clientHeight;\n\t\t\t\t\t\tel.style.removeProperty(\"display\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n}\n\nexport default TargetCounters;\n","import Handler from \"../handler.js\";\nimport { UUID, attr, querySelectorEscape } from \"../../utils/utils.js\";\nimport { cleanPseudoContent } from \"../../utils/css.js\";\nimport csstree from \"css-tree\";\n// import { nodeAfter } from \"../../utils/dom\";\n\nclass TargetText extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\n\t\tthis.styleSheet = polisher.styleSheet;\n\t\tthis.textTargets = {};\n\t\tthis.beforeContent = \"\";\n\t\tthis.afterContent = \"\";\n\t\tthis.selector = {};\n\t}\n\n\tonContent(funcNode, fItem, fList, declaration, rule) {\n\t\tif (funcNode.name === \"target-text\") {\n\t\t\tthis.selector = csstree.generate(rule.ruleNode.prelude);\n\t\t\tlet first = funcNode.children.first();\n\t\t\tlet last = funcNode.children.last();\n\t\t\tlet func = first.name;\n\n\t\t\tlet value = csstree.generate(funcNode);\n\n\t\t\tlet args = [];\n\n\t\t\tfirst.children.forEach(child => {\n\t\t\t\tif (child.type === \"Identifier\") {\n\t\t\t\t\targs.push(child.name);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlet style;\n\t\t\tif (last !== first) {\n\t\t\t\tstyle = last.name;\n\t\t\t}\n\n\t\t\tlet variable = \"--pagedjs-\" + UUID();\n\n\t\t\tthis.selector.split(\",\").forEach(s => {\n\t\t\t\tthis.textTargets[s] = {\n\t\t\t\t\tfunc: func,\n\t\t\t\t\targs: args,\n\t\t\t\t\tvalue: value,\n\t\t\t\t\tstyle: style || \"content\",\n\t\t\t\t\tselector: s,\n\t\t\t\t\tfullSelector: this.selector,\n\t\t\t\t\tvariable: variable\n\t\t\t\t};\n\t\t\t});\n\n\t\t\t// Replace with variable\n\t\t\tfuncNode.name = \"var\";\n\t\t\tfuncNode.children = new csstree.List();\n\t\t\tfuncNode.children.appendData({\n\t\t\t\ttype: \"Identifier\",\n\t\t\t\tloc: 0,\n\t\t\t\tname: variable\n\t\t\t});\n\t\t}\n\t}\n\n\t//   parse this on the ONCONTENT : get all before and after and replace the value with a variable\n\tonPseudoSelector(pseudoNode, pItem, pList, selector, rule) {\n\t\t// console.log(pseudoNode);\n\t\t// console.log(rule);\n\n\t\trule.ruleNode.block.children.forEach(properties => {\n\t\t\tif (pseudoNode.name === \"before\" && properties.property === \"content\") {\n\t\t\t\t// let beforeVariable = \"--pagedjs-\" + UUID();\n\n\t\t\t\tlet contenu = properties.value.children;\n\t\t\t\tcontenu.forEach(prop => {\n\t\t\t\t\tif (prop.type === \"String\") {\n\t\t\t\t\t\tthis.beforeContent = prop.value;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else if (pseudoNode.name === \"after\" && properties.property === \"content\") {\n\t\t\t\tproperties.value.children.forEach(prop => {\n\t\t\t\t\tif (prop.type === \"String\") {\n\t\t\t\t\t\tthis.afterContent = prop.value;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tafterParsed(fragment) {\n\t\tObject.keys(this.textTargets).forEach(name => {\n\t\t\tlet target = this.textTargets[name];\n\t\t\tlet split = target.selector.split(\"::\");\n\t\t\tlet query = split[0];\n\t\t\tlet queried = fragment.querySelectorAll(query);\n\t\t\tlet textContent;\n\t\t\tqueried.forEach((selected, index) => {\n\t\t\t\tlet val = attr(selected, target.args);\n\t\t\t\tlet element = fragment.querySelector(querySelectorEscape(val));\n\t\t\t\tif (element) {\n\t\t\t\t\t// content & first-letter & before & after refactorized\n\t\t\t\t\tif (target.style) {\n\t\t\t\t\t\tthis.selector = UUID();\n\t\t\t\t\t\tselected.setAttribute(\"data-target-text\", this.selector);\n\n\t\t\t\t\t\tlet psuedo = \"\";\n\t\t\t\t\t\tif (split.length > 1) {\n\t\t\t\t\t\t\tpsuedo += \"::\" + split[1];\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (target.style === \"before\" || target.style === \"after\") {\n\t\t\t\t\t\t\tconst pseudoType = `${target.style}Content`;\n\t\t\t\t\t\t\ttextContent = cleanPseudoContent(this[pseudoType]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttextContent = cleanPseudoContent(element.textContent, \" \");\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttextContent = target.style === \"first-letter\" ? textContent.charAt(0) : textContent;\n\t\t\t\t\t\tthis.styleSheet.insertRule(`[data-target-text=\"${this.selector}\"]${psuedo} { ${target.variable}: \"${textContent}\" }`);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.warn(\"missed target\", val);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n}\n\nexport default TargetText;\n\n","import RunningHeaders from \"./running-headers.js\";\nimport StringSets from \"./string-sets.js\";\nimport TargetCounters from \"./target-counters.js\";\nimport TargetText from \"./target-text.js\";\n\nexport default [\n\tRunningHeaders,\n\tStringSets,\n\tTargetCounters,\n\tTargetText\n];\n","import Handler from \"../handler.js\";\nimport {isElement, isIgnorable, nextSignificantNode, previousSignificantNode, filterTree} from \"../../utils/dom.js\";\n\nclass WhiteSpaceFilter extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\t}\n\n\tfilter(content) {\n\n\t\tfilterTree(content, (node) => {\n\t\t\treturn this.filterEmpty(node);\n\t\t}, NodeFilter.SHOW_TEXT);\n\n\t}\n\n\tfilterEmpty(node) {\n\t\tif (node.textContent.length > 1 && isIgnorable(node)) {\n\n\t\t\t// Do not touch the content if text is pre-formatted\n\t\t\tlet parent = node.parentNode;\n\t\t\tlet pre = isElement(parent) && parent.closest(\"pre\");\n\t\t\tif (pre) {\n\t\t\t\treturn NodeFilter.FILTER_REJECT;\n\t\t\t}\n\n\t\t\tconst previousSibling = previousSignificantNode(node);\n\t\t\tconst nextSibling = nextSignificantNode(node);\n\n\t\t\tif (nextSibling === null && previousSibling === null) {\n\t\t\t\t// we should not remove a Node that does not have any siblings.\n\t\t\t\tnode.textContent = \" \";\n\t\t\t\treturn NodeFilter.FILTER_REJECT;\n\t\t\t}\n\t\t\tif (nextSibling === null) {\n\t\t\t\t// we can safely remove this node\n\t\t\t\treturn NodeFilter.FILTER_ACCEPT;\n\t\t\t}\n\t\t\tif (previousSibling === null) {\n\t\t\t\t// we can safely remove this node\n\t\t\t\treturn NodeFilter.FILTER_ACCEPT;\n\t\t\t}\n\n\t\t\t// replace the content with a single space\n\t\t\tnode.textContent = \" \";\n\n\t\t\t// TODO: we also need to preserve sequences of white spaces when the parent has \"white-space\" rule:\n\t\t\t// pre\n\t\t\t// Sequences of white space are preserved. Lines are only broken at newline characters in the source and at <br> elements.\n\t\t\t//\n\t\t\t// pre-wrap\n\t\t\t// Sequences of white space are preserved. Lines are broken at newline characters, at <br>, and as necessary to fill line boxes.\n\t\t\t//\n\t\t\t// pre-line\n\t\t\t// Sequences of white space are collapsed. Lines are broken at newline characters, at <br>, and as necessary to fill line boxes.\n\t\t\t//\n\t\t\t// break-spaces\n\t\t\t// The behavior is identical to that of pre-wrap, except that:\n\t\t\t// - Any sequence of preserved white space always takes up space, including at the end of the line.\n\t\t\t// - A line breaking opportunity exists after every preserved white space character, including between white space characters.\n\t\t\t// - Such preserved spaces take up space and do not hang, and thus affect the box’s intrinsic sizes (min-content size and max-content size).\n\t\t\t//\n\t\t\t// See: https://developer.mozilla.org/en-US/docs/Web/CSS/white-space#Values\n\n\t\t\treturn NodeFilter.FILTER_REJECT;\n\t\t} else {\n\t\t\treturn NodeFilter.FILTER_REJECT;\n\t\t}\n\t}\n\n}\n\nexport default WhiteSpaceFilter;\n","import Handler from \"../handler.js\";\nimport {filterTree} from \"../../utils/dom.js\";\n\nclass CommentsFilter extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\t}\n\n\tfilter(content) {\n\t\tfilterTree(content, null, NodeFilter.SHOW_COMMENT);\n\t}\n\n}\n\nexport default CommentsFilter;\n","import Handler from \"../handler.js\";\n\nclass ScriptsFilter extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\t}\n\n\tfilter(content) {\n\t\tcontent.querySelectorAll(\"script\").forEach( script => { script.remove(); });\n\t}\n\n}\n\nexport default ScriptsFilter;\n","/**\n * Originally ported from https://github.com/keeganstreet/specificity/blob/866bf7ab4e7f62a7179c15b13a95af4e1c7b1afa/specificity.js\n *\n * Calculates the specificity of CSS selectors\n * http://www.w3.org/TR/css3-selectors/#specificity\n *\n * Returns a selector integer value\n */\n\n// The following regular expressions assume that selectors matching the preceding regular expressions have been removed\nvar attributeRegex = /(\\[[^\\]]+\\])/g;\nvar idRegex = /(#[^\\s\\+>~\\.\\[:]+)/g;\nvar classRegex = /(\\.[^\\s\\+>~\\.\\[:]+)/g;\nvar pseudoElementRegex = /(::[^\\s\\+>~\\.\\[:]+|:first-line|:first-letter|:before|:after)/g;\nvar pseudoClassRegex = /(:[^\\s\\+>~\\.\\[:]+)/g;\nvar elementRegex = /([^\\s\\+>~\\.\\[:]+)/g;\nvar notRegex = /:not\\(([^\\)]*)\\)/g;\nvar ruleRegex = /\\{[^]*/gm;\nvar separatorRegex = /[\\*\\s\\+>~]/g;\nvar straysRegex = /[#\\.]/g;\n\n// Find matches for a regular expression in a string and push their details to parts\n// Type is \"a\" for IDs, \"b\" for classes, attributes and pseudo-classes and \"c\" for elements and pseudo-elements\nvar findMatch = function(regex, type, types, selector) {\n  var matches = selector.match(regex);\n  if (matches) {\n    for (var i = 0; i < matches.length; i++) {\n      types[type]++;\n      // Replace this simple selector with whitespace so it won't be counted in further simple selectors\n      selector = selector.replace(matches[i], ' ');\n    }\n  }\n\n  return selector;\n}\n\n// Calculate the specificity for a selector by dividing it into simple selectors and counting them\nvar calculate = function(selector) {\n  var commaIndex = selector.indexOf(',');\n  if (commaIndex !== -1) {\n    selector = selector.substring(0, commaIndex);\n  }\n\n  var  types = {\n    a: 0,\n    b: 0,\n    c: 0\n  };\n\n  // Remove the negation psuedo-class (:not) but leave its argument because specificity is calculated on its argument\n  selector = selector.replace(notRegex, ' $1 ');\n\n  // Remove anything after a left brace in case a user has pasted in a rule, not just a selector\n  selector = selector.replace(ruleRegex, ' ');\n\n  // Add attribute selectors to parts collection (type b)\n  selector = findMatch(attributeRegex, 'b', types, selector);\n\n  // Add ID selectors to parts collection (type a)\n  selector = findMatch(idRegex, 'a', types, selector);\n\n  // Add class selectors to parts collection (type b)\n  selector = findMatch(classRegex, 'b', types, selector);\n\n  // Add pseudo-element selectors to parts collection (type c)\n  selector = findMatch(pseudoElementRegex, 'c', types, selector);\n\n  // Add pseudo-class selectors to parts collection (type b)\n  selector = findMatch(pseudoClassRegex, 'b', types, selector);\n\n  // Remove universal selector and separator characters\n  selector = selector.replace(separatorRegex, ' ');\n\n  // Remove any stray dots or hashes which aren't attached to words\n  // These may be present if the user is live-editing this selector\n  selector = selector.replace(straysRegex, ' ');\n\n  // The only things left should be element selectors (type c)\n  findMatch(elementRegex, 'c', types, selector);\n\n  return (types.a * 100) + (types.b * 10) + (types.c * 1);\n}\n\nvar specificityCache = {};\n\nexports.calculateSpecificity = function(selector) {\n  var specificity = specificityCache[selector];\n  if (specificity === undefined) {\n    specificity = calculate(selector);\n    specificityCache[selector] = specificity;\n  }\n  return specificity;\n}\n\nvar validSelectorCache = {};\nvar testSelectorElement = null;\n\nexports.isSelectorValid = function(selector) {\n  var valid = validSelectorCache[selector];\n  if (valid === undefined) {\n    if (testSelectorElement == null) {\n      testSelectorElement = document.createElement('div')\n    }\n\n    try {\n      testSelectorElement.querySelector(selector);\n      valid = true;\n    } catch (error) {\n      valid = false;\n    }\n    validSelectorCache[selector] = valid;\n  }\n  return valid;\n}\n\nexports.validateSelector = function(selector) {\n  if (!exports.isSelectorValid(selector)) {\n    var error = new SyntaxError(selector + ' is not a valid selector');\n    error.code = 'EBADSELECTOR';\n    throw error;\n  }\n}\n","import Handler from \"../handler.js\";\nimport csstree from \"css-tree\";\nimport { calculateSpecificity } from \"clear-cut\";\nimport { cleanSelector } from \"../../utils/css.js\";\n\nclass UndisplayedFilter extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\t\tthis.displayRules = {};\n\t}\n\n\tonDeclaration(declaration, dItem, dList, rule) {\n\t\tif (declaration.property === \"display\") {\n\t\t\tlet selector = csstree.generate(rule.ruleNode.prelude);\n\t\t\tlet value = declaration.value.children.first().name;\n\n\t\t\tselector.split(\",\").forEach((s) => {\n\t\t\t\tthis.displayRules[s] = {\n\t\t\t\t\tvalue: value,\n\t\t\t\t\tselector: s,\n\t\t\t\t\tspecificity: calculateSpecificity(s),\n\t\t\t\t\timportant: declaration.important\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\t}\n\n\tfilter(content) {\n\t\tlet { matches, selectors } = this.sortDisplayedSelectors(content, this.displayRules);\n\n\t\t// Find matching elements that have display styles\n\t\tfor (let i = 0; i < matches.length; i++) {\n\t\t\tlet element = matches[i];\n\t\t\tlet selector = selectors[i];\n\t\t\tlet displayValue = selector[selector.length-1].value;\n\t\t\tif(this.removable(element) && displayValue === \"none\") {\n\t\t\t\telement.dataset.undisplayed = \"undisplayed\";\n\t\t\t}\n\t\t}\n\n\t\t// Find elements that have inline styles\n\t\tlet styledElements = content.querySelectorAll(\"[style]\");\n\t\tfor (let i = 0; i < styledElements.length; i++) {\n\t\t\tlet element = styledElements[i];\n\t\t\tif (this.removable(element)) {\n\t\t\t\telement.dataset.undisplayed = \"undisplayed\";\n\t\t\t}\n\t\t}\n\t}\n\n\tsorter(a, b) {\n\t\tif (a.important && !b.important) {\n\t\t\treturn 1;\n\t\t}\n\n\t\tif (b.important && !a.important) {\n\t\t\treturn -1;\n\t\t}\n\n\t\treturn a.specificity - b.specificity;\n\t}\n\n\tsortDisplayedSelectors(content, displayRules=[]) {\n\t\tlet matches = [];\n\t\tlet selectors = [];\n\t\tfor (let d in displayRules) {\n\t\t\tlet displayItem = displayRules[d];\n\t\t\tlet selector = displayItem.selector;\n\t\t\tlet query = [];\n\t\t\ttry {\n\t\t\t\ttry {\n\t\t\t\t\tquery = content.querySelectorAll(selector);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tquery = content.querySelectorAll(cleanSelector(selector));\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tquery = [];\n\t\t\t}\n\t\t\tlet elements = Array.from(query);\n\t\t\tfor (let e of elements) {\n\t\t\t\tif (matches.includes(e)) {\n\t\t\t\t\tlet index = matches.indexOf(e);\n\t\t\t\t\tselectors[index].push(displayItem);\n\t\t\t\t\tselectors[index] = selectors[index].sort(this.sorter);\n\t\t\t\t} else {\n\t\t\t\t\tmatches.push(e);\n\t\t\t\t\tselectors.push([displayItem]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn { matches, selectors };\n\t}\n\n\tremovable(element) {\n\t\tif (element.style &&\n\t\t\t\telement.style.display !== \"\" &&\n\t\t\t\telement.style.display !== \"none\") {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n}\n\nexport default UndisplayedFilter;\n","import WhiteSpaceFilter from \"./whitespace.js\";\nimport CommentsFilter from \"./comments.js\";\nimport ScriptsFilter from \"./scripts.js\";\nimport UndisplayedFilter from \"./undisplayed.js\";\n\nexport default [\n\tWhiteSpaceFilter,\n\tCommentsFilter,\n\tScriptsFilter,\n\tUndisplayedFilter\n];\n","\"use strict\";\n\nmodule.exports = function () {\n\tvar from = Array.from, arr, result;\n\tif (typeof from !== \"function\") return false;\n\tarr = [\"raz\", \"dwa\"];\n\tresult = from(arr);\n\treturn Boolean(result && result !== arr && result[1] === \"dwa\");\n};\n","\"use strict\";\n\nmodule.exports = function () {\n\tif (typeof globalThis !== \"object\") return false;\n\tif (!globalThis) return false;\n\treturn globalThis.Array === Array;\n};\n","var naiveFallback = function () {\n\tif (typeof self === \"object\" && self) return self;\n\tif (typeof window === \"object\" && window) return window;\n\tthrow new Error(\"Unable to resolve global `this`\");\n};\n\nmodule.exports = (function () {\n\tif (this) return this;\n\n\t// Unexpected strict mode (may happen if e.g. bundled into ESM module)\n\n\t// Thanks @mathiasbynens -> https://mathiasbynens.be/notes/globalthis\n\t// In all ES5+ engines global object inherits from Object.prototype\n\t// (if you approached one that doesn't please report)\n\ttry {\n\t\tObject.defineProperty(Object.prototype, \"__global__\", {\n\t\t\tget: function () { return this; },\n\t\t\tconfigurable: true\n\t\t});\n\t} catch (error) {\n\t\t// Unfortunate case of Object.prototype being sealed (via preventExtensions, seal or freeze)\n\t\treturn naiveFallback();\n\t}\n\ttry {\n\t\t// Safari case (window.__global__ is resolved with global context, but __global__ does not)\n\t\tif (!__global__) return naiveFallback();\n\t\treturn __global__;\n\t} finally {\n\t\tdelete Object.prototype.__global__;\n\t}\n})();\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? globalThis : require(\"./implementation\");\n","\"use strict\";\n\nvar global     = require(\"ext/global-this\")\n  , validTypes = { object: true, symbol: true };\n\nmodule.exports = function () {\n\tvar Symbol = global.Symbol;\n\tvar symbol;\n\tif (typeof Symbol !== \"function\") return false;\n\tsymbol = Symbol(\"test symbol\");\n\ttry { String(symbol); }\n\tcatch (e) { return false; }\n\n\t// Return 'true' also for polyfills\n\tif (!validTypes[typeof Symbol.iterator]) return false;\n\tif (!validTypes[typeof Symbol.toPrimitive]) return false;\n\tif (!validTypes[typeof Symbol.toStringTag]) return false;\n\n\treturn true;\n};\n","\"use strict\";\n\nmodule.exports = function (value) {\n\tif (!value) return false;\n\tif (typeof value === \"symbol\") return true;\n\tif (!value.constructor) return false;\n\tif (value.constructor.name !== \"Symbol\") return false;\n\treturn value[value.constructor.toStringTag] === \"Symbol\";\n};\n","\"use strict\";\n\nvar isSymbol = require(\"./is-symbol\");\n\nmodule.exports = function (value) {\n\tif (!isSymbol(value)) throw new TypeError(value + \" is not a symbol\");\n\treturn value;\n};\n","\"use strict\";\n\nvar d = require(\"d\");\n\nvar create = Object.create, defineProperty = Object.defineProperty, objPrototype = Object.prototype;\n\nvar created = create(null);\nmodule.exports = function (desc) {\n\tvar postfix = 0, name, ie11BugWorkaround;\n\twhile (created[desc + (postfix || \"\")]) ++postfix;\n\tdesc += postfix || \"\";\n\tcreated[desc] = true;\n\tname = \"@@\" + desc;\n\tdefineProperty(\n\t\tobjPrototype, name,\n\t\td.gs(null, function (value) {\n\t\t\t// For IE11 issue see:\n\t\t\t// https://connect.microsoft.com/IE/feedbackdetail/view/1928508/\n\t\t\t//    ie11-broken-getters-on-dom-objects\n\t\t\t// https://github.com/medikoo/es6-symbol/issues/12\n\t\t\tif (ie11BugWorkaround) return;\n\t\t\tie11BugWorkaround = true;\n\t\t\tdefineProperty(this, name, d(value));\n\t\t\tie11BugWorkaround = false;\n\t\t})\n\t);\n\treturn name;\n};\n","\"use strict\";\n\nvar d            = require(\"d\")\n  , NativeSymbol = require(\"ext/global-this\").Symbol;\n\nmodule.exports = function (SymbolPolyfill) {\n\treturn Object.defineProperties(SymbolPolyfill, {\n\t\t// To ensure proper interoperability with other native functions (e.g. Array.from)\n\t\t// fallback to eventual native implementation of given symbol\n\t\thasInstance: d(\n\t\t\t\"\", (NativeSymbol && NativeSymbol.hasInstance) || SymbolPolyfill(\"hasInstance\")\n\t\t),\n\t\tisConcatSpreadable: d(\n\t\t\t\"\",\n\t\t\t(NativeSymbol && NativeSymbol.isConcatSpreadable) ||\n\t\t\t\tSymbolPolyfill(\"isConcatSpreadable\")\n\t\t),\n\t\titerator: d(\"\", (NativeSymbol && NativeSymbol.iterator) || SymbolPolyfill(\"iterator\")),\n\t\tmatch: d(\"\", (NativeSymbol && NativeSymbol.match) || SymbolPolyfill(\"match\")),\n\t\treplace: d(\"\", (NativeSymbol && NativeSymbol.replace) || SymbolPolyfill(\"replace\")),\n\t\tsearch: d(\"\", (NativeSymbol && NativeSymbol.search) || SymbolPolyfill(\"search\")),\n\t\tspecies: d(\"\", (NativeSymbol && NativeSymbol.species) || SymbolPolyfill(\"species\")),\n\t\tsplit: d(\"\", (NativeSymbol && NativeSymbol.split) || SymbolPolyfill(\"split\")),\n\t\ttoPrimitive: d(\n\t\t\t\"\", (NativeSymbol && NativeSymbol.toPrimitive) || SymbolPolyfill(\"toPrimitive\")\n\t\t),\n\t\ttoStringTag: d(\n\t\t\t\"\", (NativeSymbol && NativeSymbol.toStringTag) || SymbolPolyfill(\"toStringTag\")\n\t\t),\n\t\tunscopables: d(\n\t\t\t\"\", (NativeSymbol && NativeSymbol.unscopables) || SymbolPolyfill(\"unscopables\")\n\t\t)\n\t});\n};\n","\"use strict\";\n\nvar d              = require(\"d\")\n  , validateSymbol = require(\"../../../validate-symbol\");\n\nvar registry = Object.create(null);\n\nmodule.exports = function (SymbolPolyfill) {\n\treturn Object.defineProperties(SymbolPolyfill, {\n\t\tfor: d(function (key) {\n\t\t\tif (registry[key]) return registry[key];\n\t\t\treturn (registry[key] = SymbolPolyfill(String(key)));\n\t\t}),\n\t\tkeyFor: d(function (symbol) {\n\t\t\tvar key;\n\t\t\tvalidateSymbol(symbol);\n\t\t\tfor (key in registry) {\n\t\t\t\tif (registry[key] === symbol) return key;\n\t\t\t}\n\t\t\treturn undefined;\n\t\t})\n\t});\n};\n","// ES2015 Symbol polyfill for environments that do not (or partially) support it\n\n\"use strict\";\n\nvar d                    = require(\"d\")\n  , validateSymbol       = require(\"./validate-symbol\")\n  , NativeSymbol         = require(\"ext/global-this\").Symbol\n  , generateName         = require(\"./lib/private/generate-name\")\n  , setupStandardSymbols = require(\"./lib/private/setup/standard-symbols\")\n  , setupSymbolRegistry  = require(\"./lib/private/setup/symbol-registry\");\n\nvar create = Object.create\n  , defineProperties = Object.defineProperties\n  , defineProperty = Object.defineProperty;\n\nvar SymbolPolyfill, HiddenSymbol, isNativeSafe;\n\nif (typeof NativeSymbol === \"function\") {\n\ttry {\n\t\tString(NativeSymbol());\n\t\tisNativeSafe = true;\n\t} catch (ignore) {}\n} else {\n\tNativeSymbol = null;\n}\n\n// Internal constructor (not one exposed) for creating Symbol instances.\n// This one is used to ensure that `someSymbol instanceof Symbol` always return false\nHiddenSymbol = function Symbol(description) {\n\tif (this instanceof HiddenSymbol) throw new TypeError(\"Symbol is not a constructor\");\n\treturn SymbolPolyfill(description);\n};\n\n// Exposed `Symbol` constructor\n// (returns instances of HiddenSymbol)\nmodule.exports = SymbolPolyfill = function Symbol(description) {\n\tvar symbol;\n\tif (this instanceof Symbol) throw new TypeError(\"Symbol is not a constructor\");\n\tif (isNativeSafe) return NativeSymbol(description);\n\tsymbol = create(HiddenSymbol.prototype);\n\tdescription = description === undefined ? \"\" : String(description);\n\treturn defineProperties(symbol, {\n\t\t__description__: d(\"\", description),\n\t\t__name__: d(\"\", generateName(description))\n\t});\n};\n\nsetupStandardSymbols(SymbolPolyfill);\nsetupSymbolRegistry(SymbolPolyfill);\n\n// Internal tweaks for real symbol producer\ndefineProperties(HiddenSymbol.prototype, {\n\tconstructor: d(SymbolPolyfill),\n\ttoString: d(\"\", function () { return this.__name__; })\n});\n\n// Proper implementation of methods exposed on Symbol.prototype\n// They won't be accessible on produced symbol instances as they derive from HiddenSymbol.prototype\ndefineProperties(SymbolPolyfill.prototype, {\n\ttoString: d(function () { return \"Symbol (\" + validateSymbol(this).__description__ + \")\"; }),\n\tvalueOf: d(function () { return validateSymbol(this); })\n});\ndefineProperty(\n\tSymbolPolyfill.prototype, SymbolPolyfill.toPrimitive,\n\td(\"\", function () {\n\t\tvar symbol = validateSymbol(this);\n\t\tif (typeof symbol === \"symbol\") return symbol;\n\t\treturn symbol.toString();\n\t})\n);\ndefineProperty(SymbolPolyfill.prototype, SymbolPolyfill.toStringTag, d(\"c\", \"Symbol\"));\n\n// Proper implementaton of toPrimitive and toStringTag for returned symbol instances\ndefineProperty(\n\tHiddenSymbol.prototype, SymbolPolyfill.toStringTag,\n\td(\"c\", SymbolPolyfill.prototype[SymbolPolyfill.toStringTag])\n);\n\n// Note: It's important to define `toPrimitive` as last one, as some implementations\n// implement `toPrimitive` natively without implementing `toStringTag` (or other specified symbols)\n// And that may invoke error in definition flow:\n// See: https://github.com/medikoo/es6-symbol/issues/13#issuecomment-164146149\ndefineProperty(\n\tHiddenSymbol.prototype, SymbolPolyfill.toPrimitive,\n\td(\"c\", SymbolPolyfill.prototype[SymbolPolyfill.toPrimitive])\n);\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")()\n\t? require(\"ext/global-this\").Symbol\n\t: require(\"./polyfill\");\n","\"use strict\";\n\nvar objToString = Object.prototype.toString\n  , id = objToString.call((function () { return arguments; })());\n\nmodule.exports = function (value) { return objToString.call(value) === id; };\n","\"use strict\";\n\nvar objToString = Object.prototype.toString\n  , isFunctionStringTag = RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);\n\nmodule.exports = function (value) {\n\treturn typeof value === \"function\" && isFunctionStringTag(objToString.call(value));\n};\n","\"use strict\";\n\nmodule.exports = function () {\n\tvar sign = Math.sign;\n\tif (typeof sign !== \"function\") return false;\n\treturn sign(10) === 1 && sign(-20) === -1;\n};\n","\"use strict\";\n\nmodule.exports = function (value) {\n\tvalue = Number(value);\n\tif (isNaN(value) || value === 0) return value;\n\treturn value > 0 ? 1 : -1;\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? Math.sign : require(\"./shim\");\n","\"use strict\";\n\nvar sign  = require(\"../math/sign\")\n  , abs   = Math.abs\n  , floor = Math.floor;\n\nmodule.exports = function (value) {\n\tif (isNaN(value)) return 0;\n\tvalue = Number(value);\n\tif (value === 0 || !isFinite(value)) return value;\n\treturn sign(value) * floor(abs(value));\n};\n","\"use strict\";\n\nvar toInteger = require(\"./to-integer\")\n  , max       = Math.max;\n\nmodule.exports = function (value) { return max(0, toInteger(value)); };\n","\"use strict\";\n\nvar objToString = Object.prototype.toString, id = objToString.call(\"\");\n\nmodule.exports = function (value) {\n\treturn (\n\t\ttypeof value === \"string\" ||\n\t\t(value &&\n\t\t\ttypeof value === \"object\" &&\n\t\t\t(value instanceof String || objToString.call(value) === id)) ||\n\t\tfalse\n\t);\n};\n","\"use strict\";\n\nvar iteratorSymbol = require(\"es6-symbol\").iterator\n  , isArguments    = require(\"../../function/is-arguments\")\n  , isFunction     = require(\"../../function/is-function\")\n  , toPosInt       = require(\"../../number/to-pos-integer\")\n  , callable       = require(\"../../object/valid-callable\")\n  , validValue     = require(\"../../object/valid-value\")\n  , isValue        = require(\"../../object/is-value\")\n  , isString       = require(\"../../string/is-string\")\n  , isArray        = Array.isArray\n  , call           = Function.prototype.call\n  , desc           = { configurable: true, enumerable: true, writable: true, value: null }\n  , defineProperty = Object.defineProperty;\n\n// eslint-disable-next-line complexity, max-lines-per-function\nmodule.exports = function (arrayLike /*, mapFn, thisArg*/) {\n\tvar mapFn = arguments[1]\n\t  , thisArg = arguments[2]\n\t  , Context\n\t  , i\n\t  , j\n\t  , arr\n\t  , length\n\t  , code\n\t  , iterator\n\t  , result\n\t  , getIterator\n\t  , value;\n\n\tarrayLike = Object(validValue(arrayLike));\n\n\tif (isValue(mapFn)) callable(mapFn);\n\tif (!this || this === Array || !isFunction(this)) {\n\t\t// Result: Plain array\n\t\tif (!mapFn) {\n\t\t\tif (isArguments(arrayLike)) {\n\t\t\t\t// Source: Arguments\n\t\t\t\tlength = arrayLike.length;\n\t\t\t\tif (length !== 1) return Array.apply(null, arrayLike);\n\t\t\t\tarr = new Array(1);\n\t\t\t\tarr[0] = arrayLike[0];\n\t\t\t\treturn arr;\n\t\t\t}\n\t\t\tif (isArray(arrayLike)) {\n\t\t\t\t// Source: Array\n\t\t\t\tarr = new Array((length = arrayLike.length));\n\t\t\t\tfor (i = 0; i < length; ++i) arr[i] = arrayLike[i];\n\t\t\t\treturn arr;\n\t\t\t}\n\t\t}\n\t\tarr = [];\n\t} else {\n\t\t// Result: Non plain array\n\t\tContext = this;\n\t}\n\n\tif (!isArray(arrayLike)) {\n\t\tif ((getIterator = arrayLike[iteratorSymbol]) !== undefined) {\n\t\t\t// Source: Iterator\n\t\t\titerator = callable(getIterator).call(arrayLike);\n\t\t\tif (Context) arr = new Context();\n\t\t\tresult = iterator.next();\n\t\t\ti = 0;\n\t\t\twhile (!result.done) {\n\t\t\t\tvalue = mapFn ? call.call(mapFn, thisArg, result.value, i) : result.value;\n\t\t\t\tif (Context) {\n\t\t\t\t\tdesc.value = value;\n\t\t\t\t\tdefineProperty(arr, i, desc);\n\t\t\t\t} else {\n\t\t\t\t\tarr[i] = value;\n\t\t\t\t}\n\t\t\t\tresult = iterator.next();\n\t\t\t\t++i;\n\t\t\t}\n\t\t\tlength = i;\n\t\t} else if (isString(arrayLike)) {\n\t\t\t// Source: String\n\t\t\tlength = arrayLike.length;\n\t\t\tif (Context) arr = new Context();\n\t\t\tfor (i = 0, j = 0; i < length; ++i) {\n\t\t\t\tvalue = arrayLike[i];\n\t\t\t\tif (i + 1 < length) {\n\t\t\t\t\tcode = value.charCodeAt(0);\n\t\t\t\t\t// eslint-disable-next-line max-depth\n\t\t\t\t\tif (code >= 0xd800 && code <= 0xdbff) value += arrayLike[++i];\n\t\t\t\t}\n\t\t\t\tvalue = mapFn ? call.call(mapFn, thisArg, value, j) : value;\n\t\t\t\tif (Context) {\n\t\t\t\t\tdesc.value = value;\n\t\t\t\t\tdefineProperty(arr, j, desc);\n\t\t\t\t} else {\n\t\t\t\t\tarr[j] = value;\n\t\t\t\t}\n\t\t\t\t++j;\n\t\t\t}\n\t\t\tlength = j;\n\t\t}\n\t}\n\tif (length === undefined) {\n\t\t// Source: array or array-like\n\t\tlength = toPosInt(arrayLike.length);\n\t\tif (Context) arr = new Context(length);\n\t\tfor (i = 0; i < length; ++i) {\n\t\t\tvalue = mapFn ? call.call(mapFn, thisArg, arrayLike[i], i) : arrayLike[i];\n\t\t\tif (Context) {\n\t\t\t\tdesc.value = value;\n\t\t\t\tdefineProperty(arr, i, desc);\n\t\t\t} else {\n\t\t\t\tarr[i] = value;\n\t\t\t}\n\t\t}\n\t}\n\tif (Context) {\n\t\tdesc.value = null;\n\t\tarr.length = length;\n\t}\n\treturn arr;\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? Array.from : require(\"./shim\");\n","\"use strict\";\n\nmodule.exports = function () {\n\tvar numberIsNaN = Number.isNaN;\n\tif (typeof numberIsNaN !== \"function\") return false;\n\treturn !numberIsNaN({}) && numberIsNaN(NaN) && !numberIsNaN(34);\n};\n","\"use strict\";\n\nmodule.exports = function (value) {\n\t// eslint-disable-next-line no-self-compare\n\treturn value !== value;\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? Number.isNaN : require(\"./shim\");\n","\"use strict\";\n\nvar numberIsNaN       = require(\"../../number/is-nan\")\n  , toPosInt          = require(\"../../number/to-pos-integer\")\n  , value             = require(\"../../object/valid-value\")\n  , indexOf           = Array.prototype.indexOf\n  , objHasOwnProperty = Object.prototype.hasOwnProperty\n  , abs               = Math.abs\n  , floor             = Math.floor;\n\nmodule.exports = function (searchElement /*, fromIndex*/) {\n\tvar i, length, fromIndex, val;\n\tif (!numberIsNaN(searchElement)) return indexOf.apply(this, arguments);\n\n\tlength = toPosInt(value(this).length);\n\tfromIndex = arguments[1];\n\tif (isNaN(fromIndex)) fromIndex = 0;\n\telse if (fromIndex >= 0) fromIndex = floor(fromIndex);\n\telse fromIndex = toPosInt(this.length) - floor(abs(fromIndex));\n\n\tfor (i = fromIndex; i < length; ++i) {\n\t\tif (objHasOwnProperty.call(this, i)) {\n\t\t\tval = this[i];\n\t\t\tif (numberIsNaN(val)) return i; // Jslint: ignore\n\t\t}\n\t}\n\treturn -1;\n};\n","\"use strict\";\n\nvar indexOf = require(\"./e-index-of\")\n  , forEach = Array.prototype.forEach\n  , splice  = Array.prototype.splice;\n\n// eslint-disable-next-line no-unused-vars\nmodule.exports = function (itemToRemove /*, …item*/) {\n\tforEach.call(\n\t\targuments,\n\t\tfunction (item) {\n\t\t\tvar index = indexOf.call(this, item);\n\t\t\tif (index !== -1) splice.call(this, index, 1);\n\t\t},\n\t\tthis\n\t);\n};\n","\"use strict\";\n\nvar isValue = require(\"./is-value\");\n\nvar map = { function: true, object: true };\n\nmodule.exports = function (value) { return (isValue(value) && map[typeof value]) || false; };\n","\"use strict\";\n\nvar isObject = require(\"./is-object\");\n\nmodule.exports = function (value) {\n\tif (!isObject(value)) throw new TypeError(value + \" is not an Object\");\n\treturn value;\n};\n","'use strict';\n\nvar aFrom          = require('es5-ext/array/from')\n  , remove         = require('es5-ext/array/#/remove')\n  , value          = require('es5-ext/object/valid-object')\n  , d              = require('d')\n  , emit           = require('./').methods.emit\n\n  , defineProperty = Object.defineProperty\n  , hasOwnProperty = Object.prototype.hasOwnProperty\n  , getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\nmodule.exports = function (e1, e2/*, name*/) {\n\tvar pipes, pipe, desc, name;\n\n\t(value(e1) && value(e2));\n\tname = arguments[2];\n\tif (name === undefined) name = 'emit';\n\n\tpipe = {\n\t\tclose: function () { remove.call(pipes, e2); }\n\t};\n\tif (hasOwnProperty.call(e1, '__eePipes__')) {\n\t\t(pipes = e1.__eePipes__).push(e2);\n\t\treturn pipe;\n\t}\n\tdefineProperty(e1, '__eePipes__', d('c', pipes = [e2]));\n\tdesc = getOwnPropertyDescriptor(e1, name);\n\tif (!desc) {\n\t\tdesc = d('c', undefined);\n\t} else {\n\t\tdelete desc.get;\n\t\tdelete desc.set;\n\t}\n\tdesc.value = function () {\n\t\tvar i, emitter, data = aFrom(pipes);\n\t\temit.apply(this, arguments);\n\t\tfor (i = 0; (emitter = data[i]); ++i) emit.apply(emitter, arguments);\n\t};\n\tdefineProperty(e1, name, desc);\n\treturn pipe;\n};\n","import pagedMediaHandlers from \"../modules/paged-media/index.js\";\nimport generatedContentHandlers from \"../modules/generated-content/index.js\";\nimport filters from \"../modules/filters/index.js\";\nimport EventEmitter from \"event-emitter\";\nimport pipe from \"event-emitter/pipe.js\";\n\nexport let registeredHandlers = [...pagedMediaHandlers, ...generatedContentHandlers, ...filters];\n\nexport class Handlers {\n\tconstructor(chunker, polisher, caller) {\n\t\tlet handlers = [];\n\n\t\tregisteredHandlers.forEach((Handler) => {\n\t\t\tlet handler = new Handler(chunker, polisher, caller);\n\t\t\thandlers.push(handler);\n\t\t\tpipe(handler, this);\n\t\t});\n\t}\n}\n\nEventEmitter(Handlers.prototype);\n\nexport function registerHandlers() {\n\tfor (var i = 0; i < arguments.length; i++) {\n\t\tregisteredHandlers.push(arguments[i]);\n\t}\n}\n\nexport function initializeHandlers(chunker, polisher, caller) {\n\tlet handlers = new Handlers(chunker, polisher, caller);\n\treturn handlers;\n}\n","import EventEmitter from \"event-emitter\";\n\nimport Hook from \"../utils/hook.js\";\nimport Chunker from \"../chunker/chunker.js\";\nimport Polisher from \"../polisher/polisher.js\";\n\nimport { initializeHandlers, registerHandlers } from \"../utils/handlers.js\";\n\nclass Previewer {\n\tconstructor(options) {\n\t\t// this.preview = this.getParams(\"preview\") !== \"false\";\n\n\t\tthis.settings = options || {};\n\n\t\t// Process styles\n\t\tthis.polisher = new Polisher(false);\n\n\t\t// Chunk contents\n\t\tthis.chunker = new Chunker(undefined, undefined, this.settings);\n\n\t\t// Hooks\n\t\tthis.hooks = {};\n\t\tthis.hooks.beforePreview = new Hook(this);\n\t\tthis.hooks.afterPreview = new Hook(this);\n\n\t\t// default size\n\t\tthis.size = {\n\t\t\twidth: {\n\t\t\t\tvalue: 8.5,\n\t\t\t\tunit: \"in\"\n\t\t\t},\n\t\t\theight: {\n\t\t\t\tvalue: 11,\n\t\t\t\tunit: \"in\"\n\t\t\t},\n\t\t\tformat: undefined,\n\t\t\torientation: undefined\n\t\t};\n\n\t\tthis.chunker.on(\"page\", (page) => {\n\t\t\tthis.emit(\"page\", page);\n\t\t});\n\n\t\tthis.chunker.on(\"rendering\", () => {\n\t\t\tthis.emit(\"rendering\", this.chunker);\n\t\t});\n\t}\n\n\tinitializeHandlers() {\n\t\tlet handlers = initializeHandlers(this.chunker, this.polisher, this);\n\n\t\thandlers.on(\"size\", (size) => {\n\t\t\tthis.size = size;\n\t\t\tthis.emit(\"size\", size);\n\t\t});\n\n\t\thandlers.on(\"atpages\", (pages) => {\n\t\t\tthis.atpages = pages;\n\t\t\tthis.emit(\"atpages\", pages);\n\t\t});\n\n\t\treturn handlers;\n\t}\n\n\tregisterHandlers() {\n\t\treturn registerHandlers.apply(registerHandlers, arguments);\n\t}\n\n\tgetParams(name) {\n\t\tlet param;\n\t\tlet url = new URL(window.location);\n\t\tlet params = new URLSearchParams(url.search);\n\t\tfor(var pair of params.entries()) {\n\t\t\tif(pair[0] === name) {\n\t\t\t\tparam = pair[1];\n\t\t\t}\n\t\t}\n\n\t\treturn param;\n\t}\n\n\twrapContent() {\n\t\t// Wrap body in template tag\n\t\tlet body = document.querySelector(\"body\");\n\n\t\t// Check if a template exists\n\t\tlet template;\n\t\ttemplate = body.querySelector(\":scope > template[data-ref='pagedjs-content']\");\n\n\t\tif (!template) {\n\t\t\t// Otherwise create one\n\t\t\ttemplate = document.createElement(\"template\");\n\t\t\ttemplate.dataset.ref = \"pagedjs-content\";\n\t\t\ttemplate.innerHTML = body.innerHTML;\n\t\t\tbody.innerHTML = \"\";\n\t\t\tbody.appendChild(template);\n\t\t}\n\n\t\treturn template.content;\n\t}\n\n\tremoveStyles(doc=document) {\n\t\t// Get all stylesheets\n\t\tconst stylesheets = Array.from(doc.querySelectorAll(\"link[rel='stylesheet']:not([data-pagedjs-ignore], [media~='screen'])\"));\n\t\t// Get inline styles\n\t\tconst inlineStyles = Array.from(doc.querySelectorAll(\"style:not([data-pagedjs-inserted-styles], [data-pagedjs-ignore], [media~='screen'])\"));\n\t\tconst elements = [...stylesheets, ...inlineStyles];\n\t\treturn elements\n\t\t\t// preserve order\n\t\t\t.sort(function (element1, element2) {\n\t\t\t\tconst position = element1.compareDocumentPosition(element2);\n\t\t\t\tif (position === Node.DOCUMENT_POSITION_PRECEDING) {\n\t\t\t\t\treturn 1;\n\t\t\t\t} else if (position === Node.DOCUMENT_POSITION_FOLLOWING) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t})\n\t\t\t// extract the href\n\t\t\t.map((element) => {\n\t\t\t\tif (element.nodeName === \"STYLE\") {\n\t\t\t\t\tconst obj = {};\n\t\t\t\t\tobj[window.location.href] = element.textContent;\n\t\t\t\t\telement.remove();\n\t\t\t\t\treturn obj;\n\t\t\t\t}\n\t\t\t\tif (element.nodeName === \"LINK\") {\n\t\t\t\t\telement.remove();\n\t\t\t\t\treturn element.href;\n\t\t\t\t}\n\t\t\t\t// ignore\n\t\t\t\tconsole.warn(`Unable to process: ${element}, ignoring.`);\n\t\t\t});\n\t}\n\n\tasync preview(content, stylesheets, renderTo) {\n\n\t\tawait this.hooks.beforePreview.trigger(content, renderTo);\n\n\t\tif (!content) {\n\t\t\tcontent = this.wrapContent();\n\t\t}\n\n\t\tif (!stylesheets) {\n\t\t\tstylesheets = this.removeStyles();\n\t\t}\n\n\t\tthis.polisher.setup();\n\n\t\tthis.handlers = this.initializeHandlers();\n\n\t\tawait this.polisher.add(...stylesheets);\n\n\t\tlet startTime = performance.now();\n\n\t\t// Render flow\n\t\tlet flow = await this.chunker.flow(content, renderTo);\n\n\t\tlet endTime = performance.now();\n\n\t\tflow.performance = (endTime - startTime);\n\t\tflow.size = this.size;\n\n\t\tthis.emit(\"rendered\", flow);\n\n\t\tawait this.hooks.afterPreview.trigger(flow.pages);\n\n\t\treturn flow;\n\t}\n}\n\nEventEmitter(Previewer.prototype);\n\nexport default Previewer;\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var root = require('./_root');\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nmodule.exports = now;\n","/** Used to match a single whitespace character. */\nvar reWhitespace = /\\s/;\n\n/**\n * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n * character of `string`.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {number} Returns the index of the last non-whitespace character.\n */\nfunction trimmedEndIndex(string) {\n  var index = string.length;\n\n  while (index-- && reWhitespace.test(string.charAt(index))) {}\n  return index;\n}\n\nmodule.exports = trimmedEndIndex;\n","var trimmedEndIndex = require('./_trimmedEndIndex');\n\n/** Used to match leading whitespace. */\nvar reTrimStart = /^\\s+/;\n\n/**\n * The base implementation of `_.trim`.\n *\n * @private\n * @param {string} string The string to trim.\n * @returns {string} Returns the trimmed string.\n */\nfunction baseTrim(string) {\n  return string\n    ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')\n    : string;\n}\n\nmodule.exports = baseTrim;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nmodule.exports = isSymbol;\n","var baseTrim = require('./_baseTrim'),\n    isObject = require('./isObject'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = baseTrim(value);\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = toNumber;\n","var isObject = require('./isObject'),\n    now = require('./now'),\n    toNumber = require('./toNumber');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nmodule.exports = debounce;\n","declare const $uhuu: {\n  editDialog: (value: any) => void;\n};\n\nclass DocumentUtils {\n  prepareRendering(container: HTMLElement) {        \n    const { clientHeight: height, clientWidth: width } = container;\n    container.innerHTML = '';\n    if (height) container.style.minHeight = `${height}px`;\n    if (width && window !== window.parent) container.style.minWidth = `${width}px`;\n    document?.querySelectorAll(\"style[data-pagedjs-inserted-styles]\").forEach((style) => style.remove());\n    this.resetZoom();\n  }\n\n  finalizeRendering(container: HTMLElement) {    \n    if (container) {\n      container.style.minWidth = 'auto';\n      container.style.minHeight = 'auto';\n    }\n    this.attachEventListeners();\n    this.applyPagedCSS();\n    this.restoreZoom();\n  }\n\n  attachEventListeners() {        \n    document?.querySelectorAll(\"[data-uhuu]\").forEach((item) => {\n      const clickListener = function () {\n        const value = JSON.parse(this.getAttribute(\"data-uhuu\"));\n        $uhuu.editDialog(value);\n      };\n      item.removeEventListener('click', clickListener);\n      item.addEventListener('click', clickListener);\n    });\n  }\n\n  applyPagedCSS() {    \n    document?.querySelectorAll(\".page-break-after[data-paged-css]\").forEach((el) => {\n      const pagedSheet = el.closest('div.pagedjs_sheet');\n      const pagedCSS = el.getAttribute('data-paged-css');\n      if (pagedSheet && pagedCSS) {\n        pagedCSS.split(' ').filter(Boolean).forEach((cssClass) => pagedSheet.classList.add(cssClass));\n      }\n    });\n  }\n\n  getStyleUrls(styles: string, fileName: string) {\n    if (styles) {\n      const blob = new Blob([styles], { type: 'text/css' });\n      return [URL.createObjectURL(blob)];\n    }\n    return fileName ? [fileName] : [];\n  };\n\n  private originalStyles: {\n    width: string;\n    height: string; \n    transform: string;\n    transformOrigin: string;\n  };\n\n  resetZoom() {\n    if (typeof document === 'undefined') return;\n    \n    const body = document?.body;\n    if(!body.style.transform) {      \n      return;     \n    }\n    \n    this.originalStyles = {\n      width: body.style.width,\n      height: body.style.height,\n      transform: body.style.transform,\n      transformOrigin: body.style.transformOrigin || 'center center'\n    };\n\n    body.style.opacity = '0';\n    body.style.width = '100%';\n    body.style.height = '100%';\n    body.style.transform = '';\n  }\n\n  restoreZoom() {           \n    if (typeof document === 'undefined') return;\n    \n    const body = document?.body;\n    body.style.opacity = '1';\n\n    if(!this.originalStyles?.transform) return;            \n    body.style.width = this.originalStyles.width;\n    body.style.height = this.originalStyles.height;\n    body.style.transform = this.originalStyles.transform;    \n  }\n}\n\nexport default DocumentUtils;","/**\n * Standard page size calculations in millimeters\n */\nexport class PageSizeUtils {\n    static PAGE_SIZES = {\n        // A series\n        'A0': { width: 841, height: 1189 },\n        'A1': { width: 594, height: 841 },\n        'A2': { width: 420, height: 594 },\n        'A3': { width: 297, height: 420 },\n        'A4': { width: 210, height: 297 },\n        'A5': { width: 148, height: 210 },\n        'A6': { width: 105, height: 148 },\n        \n        // B series\n        'B0': { width: 1000, height: 1414 },\n        'B1': { width: 707, height: 1000 },\n        'B2': { width: 500, height: 707 },\n        'B3': { width: 353, height: 500 },\n        'B4': { width: 250, height: 353 },\n        'B5': { width: 176, height: 250 },\n        'B6': { width: 125, height: 176 },\n        \n        // C series (envelopes)\n        'C0': { width: 917, height: 1297 },\n        'C1': { width: 648, height: 917 },\n        'C2': { width: 458, height: 648 },\n        'C3': { width: 324, height: 458 },\n        'C4': { width: 229, height: 324 },\n        'C5': { width: 162, height: 229 },\n        'C6': { width: 114, height: 162 },\n        \n        // US Sizes\n        'LETTER': { width: 216, height: 279 },\n        'LEGAL': { width: 216, height: 356 },\n        'TABLOID': { width: 279, height: 432 },\n        'LEDGER': { width: 432, height: 279 }\n    };\n    /**\n     * Get all available page size format names\n     * @returns {string[]} Array of page size format names\n     */\n    static getStandardFormats() {\n        return ['Custom', 'A3', 'A4', 'A5', 'LETTER', 'LEGAL'];\n    }\n\n    /**\n     * Get dimensions for a specific page size\n     * @param {Object} options - Configuration options\n     * @param {string} options.format - Page size format (e.g., 'A4', 'LETTER')\n     * @param {string} [options.orientation='portrait'] - Page orientation ('portrait' or 'landscape')\n     * @returns {{ width: number, height: number } | null} Dimensions in millimeters\n     */\n    static getDimensions({ \n        format, \n        orientation = 'portrait'\n    }) {\n        const size = this.PAGE_SIZES[format.toUpperCase()];\n        if (!size) return null;\n\n        return orientation === 'landscape' ? \n            { \n                width: size.height, \n                height: size.width\n            } : \n            { \n                width: size.width, \n                height: size.height\n            };\n    }\n\n    /**\n     * Convert millimeters to pixels at a given DPI\n     * @param {number} mm - Value in millimeters\n     * @param {number} dpi - Dots per inch (default: 72)\n     * @returns {number} Value in pixels\n     */\n    static mmToPx(mm, dpi = 72) {\n        return (mm * dpi) / 25.4;\n    }\n\n    /**\n     * Get dimensions in pixels for a specific page size\n     * @param {Object} options - Configuration options\n     * @param {string} options.format - Page size format (e.g., 'A4', 'LETTER')\n     * @param {string} [options.orientation='portrait'] - Page orientation ('portrait' or 'landscape')\n     * @param {number} [options.dpi=72] - Dots per inch\n     * @returns {{ width: number, height: number } | null} Dimensions in pixels\n     */\n    static getDimensionsInPx({ \n        format, \n        orientation = 'portrait', \n        dpi = 72\n    }) {\n        const dimensions = this.getDimensions({ \n            format, \n            orientation\n        });\n        if (!dimensions) return null;\n\n        return {\n            width: this.mmToPx(dimensions.width, dpi),\n            height: this.mmToPx(dimensions.height, dpi)\n        };\n    }\n\n    /**\n     * Check if a format exists\n     * @param {string} format - Page size format to check\n     * @returns {boolean} Whether the format exists\n     */\n    static hasFormat(format) {\n        return format.toUpperCase() in this.PAGE_SIZES;\n    }\n\n    /**\n     * Get all available formats\n     * @returns {string[]} Array of available format names\n     */\n    static getAvailableFormats() {\n        return Object.keys(this.PAGE_SIZES);\n    }\n\n    static pageParams(paginationType, args) {\n        if (typeof document === 'undefined') return;\n        \n        const {format, orientation, width, height, bleed, showBleed, compatibility, printCssRaw, printCssUrl, preview} = args;\n        const dimensions = (!format || format.toLowerCase() === 'custom') && width && height && width > 10 && height > 10 && width < 4000 && height < 4000\n            ? { width, height } \n            : this.getDimensions({ format: format ?? 'A4', orientation });\n\n\n        if (dimensions) {\n            document.documentElement.style.setProperty('--uhuu-page-width', `${dimensions.width}mm`);\n            document.documentElement.style.setProperty('--uhuu-page-height', `${dimensions.height}mm`);        \n        }\n\n        document.documentElement.style.setProperty('--uhuu-page-bleed', `${Math.min(Math.max(bleed ?? 0, 0), 400)}mm`);\n\n        const page = { \n            paginationType,\n            format, \n            orientation, \n            bleed, \n            width: dimensions?.width, \n            height: dimensions?.height, \n            preview, \n            showBleed,\n            compatibility,\n            printCssRaw,\n            printCssUrl \n        };\n\n        return { page };  \n    }\n}\n\nexport default PageSizeUtils;","import React, { createContext } from 'react';\n\n// Create the Context\nexport const ConfigContext = createContext(null);\n\n// ConfigProvider Component\nconst ConfigProvider = ({ config, children }) => {\n  return (\n    <ConfigContext.Provider value={config}>\n      {children}\n    </ConfigContext.Provider>\n  );\n};\n\nexport default ConfigProvider;","import { useState, useRef, useEffect } from 'react';\nimport { Previewer } from 'pagedjs';\nimport debounce from 'lodash/debounce';\nimport DocumentUtils from './pagination/DocumentUtils';\nimport PageSizeUtils from '../utility/PageSizeUtils';\nimport ConfigProvider from '../config/config-provider';\nimport './pagination/pagination-dynamic.css';\nimport './../styles/uhuu-indicators.css';\n\ninterface PaginationProps {\n  children: React.ReactNode;\n  className?: string;\n  setup: any;  \n}\n\nconst Pagination = ({ children, className, setup }: PaginationProps) => {\n  \n  const [rendering, setRendering] = useState(false);\n  const containerRef = useRef(null);\n  const contentRef = useRef(null);    \n  const documentUtilsRef = useRef<DocumentUtils>(new DocumentUtils());\n\n  const config = PageSizeUtils.pageParams(\"dynamic\", setup);\n\n  let printCssRaw = config?.page?.printCssRaw;\n  if (config?.page?.width && config?.page?.height) {\n    const pageRuleRegex = /@page\\s*{([^}]*)}/;\n    const match = printCssRaw?.match(pageRuleRegex);\n    \n    const sizeAndBleedStyles = `\n      size: ${config.page.width}mm ${config.page.height}mm;\n      bleed: ${config.page.bleed ?? 0}mm;`;\n\n    if (match) {\n      // Remove any existing size/bleed properties\n      const existingStyles = match[1].replace(/\\s*(size|bleed)\\s*:[^;]*;/g, '');\n      const newPageRule = `@page {${sizeAndBleedStyles}${existingStyles}}`;\n      printCssRaw = printCssRaw.replace(pageRuleRegex, newPageRule);\n    } else {\n      printCssRaw = `@page {${sizeAndBleedStyles}}\\n${printCssRaw ?? ''}`;\n    }\n  }\n\n  const layoutPage = debounce(() => {\n    if (!containerRef.current || !contentRef.current) {\n      console.warn(\"Container or page content reference is missing.\");\n      return;\n    }\n\n    if(rendering) {\n      return;\n    }\n    \n    setRendering(true);    \n    documentUtilsRef.current.prepareRendering(containerRef.current);\n\n    const paged = new Previewer();\n    const styleUrls = documentUtilsRef.current.getStyleUrls(printCssRaw ?? '', config?.page?.printCssUrl ?? '');\n    \n    try {\n      paged.preview(contentRef.current?.innerHTML ?? '', styleUrls, containerRef.current).then(() => {        \n        setRendering(false);\n        documentUtilsRef.current.finalizeRendering(containerRef.current);\n      });\n    } catch (error) {\n      console.error(\"Error during Paged.js preview rendering:\", error);      \n      setRendering(false);\n    }\n  }, 500, { leading: true });\n\n  useEffect(() => {\n    layoutPage();\n  }, [children, setup]);\n\n  return (\n    <ConfigProvider config={config}>\n      <div className={[(className ?? ''), (rendering ? 'rendering' : 'rendered'), (config?.page?.showBleed ? 'uhuu-bleed-visible' : ''), (config?.page?.preview ?? '')].filter(Boolean).join(' ')} ref={containerRef}></div>\n      <div className=\"uhuu-reactive-content\" style={{display: 'none'}} ref={contentRef}>\n        {children}\n      </div>\n    </ConfigProvider>\n  );\n};\n\nexport default Pagination;","import React, { ReactNode } from \"react\";\n\ninterface SheetProps {\n  children: ReactNode;\n}\n\nconst Sheet: React.FC<SheetProps> = ({ children }) => {\n  return <>{children}</>;\n};\n\nexport default Sheet;","class Compatibility {\n\n  static handlePageBreakStyles() {\n    document?.querySelectorAll(\".page-break-after[data-paged-css]\").forEach((el) => {\n      const pagedSheet = el.closest('div.uhuu-page-sheet');\n      const pagedCSS = el.getAttribute('data-paged-css');\n      \n      if (pagedSheet && pagedCSS) {\n        const cssClasses = pagedCSS.split(' ').filter(Boolean);\n        cssClasses.forEach((cssClass) => pagedSheet.classList.add(cssClass));\n      }\n    });\n  }\n  \n  static handleUhuuDialogs() {\n    const clickListener = function(this: HTMLElement) {\n      const value = JSON.parse(this.getAttribute(\"data-uhuu\") || '{}');\n      $uhuu.editDialog(value);\n    };\n  \n    document?.querySelectorAll(\"[data-uhuu]\").forEach((el) => {\n      el.removeEventListener('click', clickListener);\n      el.addEventListener('click', clickListener);\n    });\n  }\n\n  static handle() {\n    Compatibility.handlePageBreakStyles();\n    Compatibility.handleUhuuDialogs();\n  }\n}\n\nexport default Compatibility;","class DocumentUtils {\n  static setupPageStyles(printCssUrl?: string) {\n    if (!printCssUrl || typeof document === 'undefined') return;\n    const link = document.createElement(\"link\");\n    link.rel = \"stylesheet\";\n    link.href = printCssUrl;\n    document.head.appendChild(link);\n    return link;\n  }\n\n  static removePageStyles(link: HTMLLinkElement) {\n    if (link && typeof document !== 'undefined') document?.head.removeChild(link);\n  }\n  \n}\n\nexport default DocumentUtils;","import React, { useEffect } from 'react';\nimport CompatibilityUtils from './pagination/CompatibilityUtils';\nimport DocumentUtils from './pagination/DocumentUtils';\nimport PageSizeUtils from '../utility/PageSizeUtils';\nimport ConfigProvider from '../config/config-provider';\nimport './pagination/print.css';\nimport './pagination/pagination-static.css';\nimport './../styles/uhuu-indicators.css';\n\ninterface PaginationProps {\n  children: React.ReactNode;\n  className?: string;\n  setup: any;\n}\n\nexport const Pagination: React.FC<PaginationProps> = ({ children, className, setup }) => {\n  const config = PageSizeUtils.pageParams(\"static\", setup);\n\n  useEffect(() => {\n    if (config?.page?.compatibility) {\n      CompatibilityUtils.handle();\n    }\n\n    const styleLink = DocumentUtils.setupPageStyles(config?.page?.printCssUrl);\n\n    return () => {\n      DocumentUtils.removePageStyles(styleLink);\n    };\n  }, [setup, config?.page?.compatibility, config?.page?.printCssUrl]);\n\n  const combinedClassName = [className, config?.page?.preview].filter(Boolean).join(' ');\n\n  return (\n    <ConfigProvider config={config}>\n      <div className={combinedClassName}>\n        {children}\n      </div>\n    </ConfigProvider>\n  );\n};\n\nexport default Pagination;\n","import React, { ReactNode, useContext, CSSProperties } from \"react\";\nimport { ConfigContext } from '../config/config-provider'; // Import the ConfigContext\n\ninterface SheetProps {\n  children: ReactNode;\n  className?: string;\n  style?: CSSProperties;\n  pageNo: number;\n  showBleed?: boolean;\n  overlay?: (args: {pageNo: number}) => ReactNode;\n}\n\nconst Sheet: React.FC<SheetProps> = ({ children, className = \"\", style, pageNo, overlay, showBleed }) => {\n  const config = useContext(ConfigContext);\n  const showBleedArea = showBleed ?? config?.page?.showBleed ?? false;\n  return (\n    <div className={`uhuu-page-sheet ${className}`} style={style}> \n      {children}\n      {overlay && overlay({pageNo}) }        \n      {showBleedArea && <div className=\"uhuu-bleed-area\"></div>}\n    </div>\n  );\n};\n\nexport default Sheet;","export const getDialogProps = (props, config) => {\n    const dialog = props.dialog;\n\n    if (!dialog) return {};\n    \n    if(config?.page?.paginationType === 'dynamic') return {\n      'data-uhuu': JSON.stringify(dialog)\n    };\n\n    return {\n      onClick: () => window.$uhuu?.editDialog(dialog),\n      'data-uhuu' : ''\n    };\n  };","import { useContext, useState } from \"react\";\nimport { ConfigContext } from '../config/config-provider'; // Import the ConfigContext\nimport { getDialogProps } from '../editable/dialog-props';\nimport './image.css';\n\ninterface ImageBleedProps {  \n  src?: string;\n  backgroundColor?: string;\n  width?: number;\n  left?: number;\n  right?: number;\n  top?: number;\n  bottom?: number;\n  height?: number;\n  pageWidth?: number;\n  pageHeight?: number;\n  bleed?: number;\n  dialog?: object;\n}\n\nconst ImageBleed = (props: ImageBleedProps) => {\n  const config = useContext(ConfigContext);  \n  // Get page dimensions and bleed from props or use defaults (from context if not provided)  \n  const BLEED = props.bleed ?? config?.page?.bleed ?? 0;  \n  const PAGE_CONTENT_WIDTH = (props.pageWidth ?? config?.page?.width ?? 210); \n  const PAGE_CONTENT_HEIGHT = (props.pageHeight ?? config?.page?.height ?? 297); \n\n  const {\n    src,\n    backgroundColor,\n    width: imageW,\n    height: imageH,\n    left: imageL = 0,\n    right: imageR = 0,\n    top: imageT = 0,\n    bottom: imageB = 0,        \n  } = props;\n\n\n  const [coverClass, setCoverClass] = useState(\"h-full w-full object-cover object-center\");\n\n  const unitFormat = (value) => `${value}mm`;\n\n  const calculateImageHeight = (): number => {\n    let result = imageH; \n    if(!imageH) {\n      result =  PAGE_CONTENT_HEIGHT;\n      if(!imageT) result +=  BLEED;\n      if(!imageB) result += BLEED;\n      if(imageT || imageB) result -= (imageT ?? 0) + (imageB ?? 0);\n    }\n    return result;\n  };\n\n  const calculateImageWidth = (): number => {\n\n    let result = imageW; \n    if(!imageW) {\n      result = PAGE_CONTENT_WIDTH;\n      if(!imageL) result += BLEED;\n      if(!imageR) result += BLEED;\n      if(imageL || imageR) result -= (imageL ?? 0) + (imageR ?? 0);\n    }\n    return result;\n  };\n\n\n  const imageWidth = calculateImageWidth();\n  const imageHeight = calculateImageHeight();\n  \n\n  const formatStyleValue = (value: number | undefined): string | undefined => \n    value !== undefined ? unitFormat(value) : undefined;\n\n  const createStyle = (styles: Record<string, string | undefined>) => {\n    return Object.fromEntries(\n      Object.entries(styles).filter(([_, value]) => value !== undefined)\n    );\n  };\n\n  // Replace old style object with new createStyle implementation\n  const style = createStyle({\n    backgroundColor,\n    width: formatStyleValue(imageWidth),\n    height: formatStyleValue(imageHeight),\n    left: formatStyleValue(imageL > 0 ? imageL + BLEED : imageL),\n    right: formatStyleValue(imageR > 0 ? imageR + BLEED : imageR),\n    top: formatStyleValue(imageT > 0 ? imageT + BLEED : imageT),\n    bottom: formatStyleValue(imageB > 0 ? imageB + BLEED : imageB),\n  });\n\n    \n  // calc ratio of image: if imageHeight set to 0 (means it should be \"auto\") then calc using default pageHeight and spacings\n  const ratio = imageHeight > 0 ? imageWidth / imageHeight : \n                                  imageWidth / (PAGE_CONTENT_HEIGHT - (imageT ?? 0) - (imageB ?? 0));\n  \n\n  const imageLoaded = (e) => {\n    // Compare loaded image ratio with container ratio to determine cover mode\n    const imageRatio = e.target.naturalWidth / e.target.naturalHeight; // Use naturalWidth/Height to get actual image dimensions\n\n    // If image is wider relative to container, use vertical cover mode\n    // Otherwise use horizontal cover mode\n    let imageClass = imageRatio > ratio  ? \"cover-vertical\"  : \"cover-horizontal\";    \n    setCoverClass(imageClass);\n  };\n\n  \n\n  return (\n    <div className=\"uhuu-image-container\" style={style}>\n      <div \n        className=\"uhuu-image-inner\" \n        {...getDialogProps(props, config)}\n      >\n        <img \n          className={coverClass} \n          src={src} \n          onLoad={(e) => imageLoaded(e)} \n          key={`${src}-${imageWidth}-${imageHeight}`}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default ImageBleed;","import { useState, useContext } from \"react\";\nimport { ConfigContext } from '../config/config-provider'; // Import the ConfigContext\nimport { getDialogProps } from '../editable/dialog-props';\nimport './image.css';\n\ninterface ImageSpreadProps {  \n  src?: string;\n  side?: \"start\" | \"end\";\n  backgroundColor?: string;\n  width?: number;\n  left?: number;\n  right?: number;\n  top?: number;\n  bottom?: number;\n  height?: number;\n  pageWidth?: number;\n  pageHeight?: number;\n  bleed?: number;\n  editDialog?: object;\n}\n\n// Constants\nexport default function ImageSpread(props: ImageSpreadProps) {\n\n  const config = useContext(ConfigContext);  \n  console.log(\"config\", config);\n  // Get page dimensions and bleed from props or use defaults (from context if not provided)\n  const BLEED = props.bleed ?? config?.page?.bleed ?? 0;  \n  const PAGE_CONTENT_WIDTH = (props.pageWidth ?? config?.page?.width ?? 210);\n  const PAGE_CONTENT_HEIGHT = (props.pageHeight ?? config?.page?.height ?? 297);\n  \n  const {\n    src,\n    side,\n    backgroundColor,\n    width: imageW,\n    height: imageH,\n    left: imageL = 0,\n    right: imageR = 0,\n    top: imageT = 0,\n    bottom: imageB = 0,        \n  } = props;\n\n  const [coverClass, setCoverClass] = useState(\"h-full w-full object-cover object-center\");\n\n\n  const unitFormat = (val: number): string => {\n    return `${val}mm`;\n  };\n\n  const calculateImageWidth = (): number => {\n    let result = imageW; \n    if(!imageW) {\n      result = 2 * PAGE_CONTENT_WIDTH;\n      if(!imageL) result += 2 * BLEED;\n      if(!imageR) result += 2 * BLEED;\n      if(imageL || imageR) result -= (imageL ?? 0) + (imageR ?? 0);\n    }\n    return result;\n  };\n\n  const calculateImageHeight = (): number => {\n    let result = imageH; \n    if(!imageH) {\n      result = PAGE_CONTENT_HEIGHT;\n      if(!imageT) result += BLEED;\n      if(!imageB) result += BLEED;\n      if(imageT || imageB) result -= (imageT ?? 0) + (imageB ?? 0);\n    }\n    return result;\n  };\n\n  // Calculate dimensions  \n  const imageWidth = calculateImageWidth();\n  const imageHeight = calculateImageHeight();  \n  \n\n  const formatStyleValue = (value: number | undefined): string | undefined => \n    value !== undefined ? unitFormat(value) : undefined;\n\n  const createStyle = (styles: Record<string, string | undefined>) => {\n    return Object.fromEntries(\n      Object.entries(styles).filter(([_, value]) => value !== undefined)\n    );\n  };\n\n  // const imageTop = imageT ?? (-1 * BLEED);\n  // const imageBottom = imageB ?? undefined;\n  const imageLeft = imageL > 0 ? imageL : (-1 * BLEED);\n  const rightPageOffset = -1 * PAGE_CONTENT_WIDTH + imageLeft; // Offset of right page\n  \n  const leftStyle = createStyle({\n    backgroundColor,\n    width: formatStyleValue(imageWidth),\n    height: formatStyleValue(imageHeight),\n    left: formatStyleValue(imageLeft),\n    top: formatStyleValue(imageT > 0 ? imageT + BLEED : imageT),\n    bottom: formatStyleValue(imageB > 0 ? imageB + BLEED : imageB)\n  });\n\n  const rightStyle = createStyle({\n    width: formatStyleValue(imageWidth),\n    height: formatStyleValue(imageHeight),\n    left: formatStyleValue(rightPageOffset),\n    top: formatStyleValue(imageT > 0 ? imageT + BLEED : imageT),\n    bottom: formatStyleValue(imageB > 0 ? imageB + BLEED : imageB)\n  });\n\n  // calc ratio of image: if imageHeight set to 0 (means it should be \"auto\") then calc using default pageHeight and spacings\n  const ratio =\n    imageHeight != 0\n      ? imageWidth / imageHeight\n      : imageWidth / (PAGE_CONTENT_HEIGHT - (imageT ?? 0) - (imageB ?? 0));\n\n  const imageLoaded = (e) => {\n    // Compare loaded image ratio with container ratio to determine cover mode\n    const imageRatio = e.target.naturalWidth / e.target.naturalHeight; // Use naturalWidth/Height to get actual image dimensions\n    \n    // If image is wider relative to container, use vertical cover mode\n    // Otherwise use horizontal cover mode\n    let imageClass = imageRatio > ratio  ? \"cover-vertical\"  : \"cover-horizontal\";    \n    setCoverClass(imageClass);\n  };\n\n\n  return <div className={`uhuu-image-container`} style={side == \"end\" ? rightStyle : leftStyle}>\n        <div className=\"uhuu-image-inner\" {...getDialogProps(props, config)}>\n          <img \n            className={coverClass} \n            src={src} \n            onLoad={(e) => imageLoaded(e)}\n            key={`${src}-${imageWidth}-${imageHeight}`} // Force reload when height or width change\n          />\n        </div>\n      </div>\n}\n\n","import { useContext, useState } from \"react\";\nimport { ConfigContext } from '../config/config-provider'; // Import the ConfigContext\nimport { getDialogProps } from './dialog-props';\nimport './../styles/uhuu-indicators.css';\n\n\ninterface EditableProps {    \n  className?: string;\n  dialog?: object;\n  children?: React.ReactNode;\n}\n\nconst Editable = (props: EditableProps) => {\n  const config = useContext(ConfigContext);  \n  // Get page dimensions and bleed from props or use defaults (from context if not provided)  \n  \n  return (    \n      <div \n        className={props.className} \n        {...getDialogProps(props, config)}\n      >\n        {props.children}\n      </div>    \n  );\n};\n\nexport default Editable;","import { useState, forwardRef, useRef, useImperativeHandle, useCallback } from 'react';\nimport { Previewer } from 'pagedjs';\nimport debounce from 'lodash/debounce';\n\nconst PagedComponent = forwardRef(({ children }, ref) => {\n  const [rendering, setRendering] = useState(false);\n  const containerRef = useRef(null);\n  const pageFlowRef = useRef(null);\n\n  if (typeof document === 'undefined') {\n    return null;\n  }\n\n  // Expose layout method to parent via ref\n  useImperativeHandle(ref, () => ({\n    layout: layoutPage,\n  }));\n\n  // Memoize the layoutPage function with debounce\n  const layoutPage = useCallback(\n    debounce(() => {\n      // Ensure container and flow elements are available\n      if (!containerRef.current || !pageFlowRef.current) {\n        console.warn(\"Container or page flow reference is missing.\");\n        return;\n      }\n\n      setRendering(true);\n\n      const { clientHeight: height, clientWidth: width } = containerRef.current;\n\n      // Clear the container before rendering new content\n      containerRef.current.innerHTML = '';\n\n      // Set fixed width and height to avoid layout issues during rendering\n      if (height) containerRef.current.style.minHeight = `${height}px`;\n      if (width && window !== window.parent) containerRef.current.style.minWidth = `${width}px`;\n\n      // Remove previously inserted paged.js styles\n      document.querySelectorAll(\"style[data-pagedjs-inserted-styles]\").forEach((style) => style.remove());\n\n      let pageFileName = \"page.css\"\n      const paged = new Previewer();\n\n      // Wrap in a try-catch to handle errors during preview generation\n      try {\n        paged.preview(pageFlowRef.current.innerHTML, [pageFileName], containerRef.current).then(() => {\n          setRendering(false);\n\n          // revert back container minWidth, minHeight after rendering.\n          containerRef.current.style.minWidth = 'auto';\n          containerRef.current.style.minHeight = 'auto';\n\n          // Attach event listeners for elements with \"data-uhuu\" attribute\n          document.querySelectorAll(\"[data-uhuu]\").forEach((item) => {\n            const clickListener = function () {\n              const value = JSON.parse(this.getAttribute(\"data-uhuu\"));\n              $uhuu.editDialog(value);\n            };\n            // Ensure unique listener attachment\n            item.removeEventListener('click', clickListener);\n            item.addEventListener('click', clickListener);\n          });\n\n          // Apply custom classes based on page-break-after elements\n          document.querySelectorAll(\".page-break-after[data-paged-css]\").forEach((el) => {\n            const pagedSheet = el.closest('div.pagedjs_sheet');\n            const pagedCSS = el.getAttribute('data-paged-css');\n            if (pagedSheet && pagedCSS) {\n              pagedCSS.split(' ').filter(Boolean).forEach((cssClass) => pagedSheet.classList.add(cssClass));\n            }\n          });\n        });\n      } catch (error) {\n        console.error(\"Error during Paged.js preview rendering:\", error);\n        setRendering(false);\n      }\n    }, 500),\n    []\n  );\n\n  return (\n    <div className={rendering ? 'rendering uhuu-page' : 'rendered uhuu-page'}>\n      {/* Container for Paged.js preview */}\n      <div className=\"pagedjs_preview_container\" ref={containerRef}></div>\n\n      {/* Hidden flow container for the content */}\n      <div style={{display:\"none\"}} ref={pageFlowRef}>\n        {children}\n      </div>\n    </div>\n  );\n});\n\nexport default PagedComponent;","// src/index.js\nimport PaginationDynamic from './uhuu/pagination-dynamic/pagination-dynamic';\nimport SheetDynamic from './uhuu/pagination-dynamic/sheet-dynamic';\n\n// Group Dynamic components\nexport const Dynamic = {\n  Pagination: PaginationDynamic,\n  Sheet: SheetDynamic\n};\n\nimport PaginationStatic from './uhuu/pagination-static/pagination-static';\nimport SheetStatic from './uhuu/pagination-static/sheet-static';\n\n// Group Static components\nexport const Static = {\n  Pagination: PaginationStatic,\n  Sheet: SheetStatic\n};\n\nexport { default as ImageBleed } from './uhuu/image/image-bleed';\nexport { default as ImageSpread } from './uhuu/image/image-spread';\nexport { default as Editable } from './uhuu/editable/editable';\n\n\n// backwards compatibility\nexport { default as PagedPreview } from './PagedPreview';\n"],"names":["getBoundingClientRect","element","rect","range","getClientRects","UUID","d","c","attr","attributes","i","querySelectorEscape","value","string","length","index","codeUnit","result","firstCodeUnit","defer","resolve","reject","requestIdleCallback","CSSValueToString","obj","isElement","node","isText","walk","start","limiter","nodeAfter","significantNode","nextSignificantNode","nodeBefore","previousSignificantNode","elementAfter","after","elementBefore","before","displayedElementAfter","displayedElementBefore","rebuildAncestors","parent","ancestor","ancestors","added","fragment","previousRow","previousRowDistance","initialColumns","k","j","column","duplicatedColumn","initialColumn","dataID","td","prev","sib","needsBreakBefore","needsPreviousBreakAfter","needsPageBreak","isIgnorable","previousSignificantNodePage","nodeWithNamedPage","getNodeWithNamedPage","currentNodePage","words","currentText","max","currentOffset","currentLetter","significantWhitespaces","letters","wordRange","isContainer","container","cloneNode","n","deep","findElement","doc","forceQuery","ref","findRef","validNode","prevValidNode","indexOf","child","hasContent","indexOfTextNode","nodeTextContent","isAllWhitespace","breakInsideAvoidParentNode","parentOf","nodeName","filterTree","content","func","what","treeWalker","current","BreakToken","offset","otherBreakToken","hash","RenderResult","breakToken","error","OverflowContentError","message","items","_undefined","is","isValue","require$$0","possibleTypes","isObject","isPrototype","isFunction","classRe","functionToString","isImplemented","assign","noop","val","keys","shim","object","require$$1","validValue","dest","src","key","e","forEach","create","process","normalizeOptions","opts1","options","str","searchString","contains","isPlainFunction","require$$2","normalizeOpts","require$$3","require$$4","dModule","dscr","w","desc","d$1","get","set","validCallable","fn","callable","apply","call","defineProperty","defineProperties","hasOwnProperty","descriptor","on","once","off","emit","methods","descriptors","base","type","listener","data","self","listeners","candidate","l","args","module","exports","o","Hook","context","promises","task","executing","results","MAX_CHARS_PER_BREAK","Layout","hooks","gap","leftMargin","wrapper","source","bounds","walker","prevNode","done","next","hasRenderedContent","newBreakToken","prevBreakToken","imgs","named","page","shallow","rendered","newToken","previousNode","parentNode","parentBreakBefore","doubleBreakBefore","rebuild","clone","newNode","img","image","width","height","breakNode","overflow","renderedNode","temp","renderedNodeFromSource","lastChildOfRenderedNodeFromSource","extract","breakLetter","newOverflow","removed","constrainingElement","scrollWidth","scrollHeight","end","vStart","vEnd","skip","breakAvoid","br","pos","left","right","top","bottom","isFloat","insideTableCell","styles","tableRow","table","rowspan","columnCount","cell","previousRowColumnCount","rects","lastChild","lastNodeIndex","original","wordwalker","word","letterwalker","letter","nextLetter","doneLetter","startContainer","extracted","startText","prevLetter","a","b","EventEmitter","Page","pagesArea","pageTemplate","blank","template","pagebox","area","footnotesArea","size","pgnum","id","contents","maxChars","settings","entries","prevHeight","entry","cr","endToken","ContentParser","cb","markup","mime","uuid","Queue","deferred","promise","queued","inwait","TEMPLATE","Chunker","renderTo","parsed","startAt","renderer","force","currentPage","currentPosition","currentSide","previousBreakAfter","breakBefore","tokens","err","fromIndex","lastPage","overflowToken","originalPage","className","fontPromises","fontFace","fontLoaded","r","createItem","allocateCursor","cursor","cursors","releaseCursor","List","List$6","prevOld","prevNew","nextOld","nextNew","array","item","initialValue","acc","list","oldItem","newItemOrList","List_1","createCustomError","name","errorStack","MAX_LINE_LENGTH","OFFSET_CORRECTION","TAB_REPLACEMENT","sourceFragment","extraLines","processLines","lines","line","idx","num","maxNumLength","startLine","endLine","cutLeft","SyntaxError","_SyntaxError","TYPE","NAME","_const","EOF","isDigit","code","isHexDigit","isUppercaseLetter","isLowercaseLetter","isLetter","isNonAscii","isNameStart","isName","isNonPrintable","isNewline","isWhiteSpace","isValidEscape","first","second","isIdentifierStart","third","isNumberStart","isBOM","CATEGORY","charCodeCategory$1","charCodeCategory","charCodeDefinitions","charCodeDef","getCharCode","getNewlineLength","cmpChar","testStr","referenceCode","cmpStr","referenceStr","testCode","findWhiteSpaceStart","findWhiteSpaceEnd","findDecimalNumberEnd","consumeEscaped","maxOffset","consumeName","consumeNumber","sign","consumeBadUrlRemnants","utils","constants","WHITESPACE","COMMENT","OFFSET_MASK","TYPE_SHIFT","TokenStream","TokenStream$4","tokenIndex","startToken","mode","balanceEnd","loop","skipTokenCount","tokenCount","TokenStream_1","generateMultiplier","multiplier","generateTypeOpts","generateSequence","decorate","forceBraces","compact","combinator","term","generate","generate_1","defaultLoc","locateMismatch","matchResult","longestMatch","mismatchNode","badNode","mismatchOffset","mismatchLength","css","token","fromLoc","buildLoc","point","extra","loc","referenceName","SyntaxMatchError","syntax","keywords","properties","HYPHENMINUS","isCustomProperty","getVendorPrefix","secondDashIndex","getKeywordDescriptor","keyword","custom","vendor","getPropertyDescriptor","property","hack","prefix","names","MIN_SIZE","SafeUint32Array","adoptBuffer","buffer","tokenize","stream","sourceLength","consumeNumericToken","consumeIdentLikeToken","nameStartOffset","consumeUrlToken","consumeStringToken","endingCodePoint","nextCode","offsetAndType","balance","balanceCloseType","balanceStart","balancePrev","tokenizer","DELIM","IDENT","NUMBER","DIMENSION","PLUSSIGN","N","DISALLOW_SIGN","ALLOW_SIGN","isDelim","skipSC","getNextToken","checkInteger","valueOffset","disallowSign","consumeB","offset_","genericAnPlusB","QUESTIONMARK","U","startsWith","hexSequence","allowDash","hexlen","withQuestionMarkSequence","consumed","genericUrange","consumedHexLength","anPlusB","urange","cssWideKeywords","calcFunctionNames","LENGTH","ANGLE","TIME","FREQUENCY","RESOLUTION","FLEX","DECIBEL","SEMITONES","charCode","eqStr","actual","expected","eqStrAny","isPostfixIeHack","outOfRange","opts","numEnd","consumeFunction","startIdx","calc","tokenType","expectedTokenType","customIdent","customPropertyName","hexColor","idSelector","declarationValue","level","scan","anyValue","dimension","numberEnd","reverseSolidusOffset","unit","percentage","zero","number","isNumber","integer","generic","input","TAB","F","R","SPACE","Tokenizer","Tokenizer$1","EXCLAMATIONMARK","NUMBERSIGN","AMPERSAND","APOSTROPHE","LEFTPARENTHESIS","RIGHTPARENTHESIS","ASTERISK","COMMA","HYPERMINUS","LESSTHANSIGN","GREATERTHANSIGN","COMMERCIALAT","LEFTSQUAREBRACKET","RIGHTSQUAREBRACKET","LEFTCURLYBRACKET","VERTICALLINE","RIGHTCURLYBRACKET","INFINITY","NAME_CHAR","createCharMap","ch","COMBINATOR_PRECEDENCE","scanSpaces","scanWord","scanNumber","scanString","readMultiplierRange","min","readMultiplier","comma","maybeMultiplied","maybeToken","readProperty","readTypeRange","readType","readKeywordOrFunction","regroupTerms","terms","combinators","createGroup","subgroupStart","readImplicitGroup","prevToken","prevTokenPos","peek","readGroup","parse","parse$2","parse_1","ensureFunction","enter","leave","tokenStream","astToTokens","handlers","curNode","nodes","tmp","chunk","prepareTokens","nodesOffset","nodesIndex","currentNode","prepareTokens_1","MATCH","MISMATCH","DISALLOW_EMPTY","createCondition","match","thenBranch","elseBranch","isFunctionType","isEnumCapatible","buildGroupMatchGraph","atLeastOneTermMatched","map","thenClause","newGroupTerm","buildMultiplierMatchGraph","matchTerm","buildMatchGraph","matchGraph","syntaxTree","STUB","TOKEN","OPEN_SYNTAX","CLOSE_SYNTAX","EXIT_REASON_MATCH","EXIT_REASON_MISMATCH","EXIT_REASON_ITERATION_LIMIT","ITERATION_LIMIT","totalIterationCount","reverseList","areStringsEqualCaseInsensitive","isContextEdgeDelim","isCommaContextStart","isCommaContextEnd","internalMatch","state","syntaxes","moveToNextToken","nextIndex","stateSnapshotFromSyntax","nextState","matchStack","syntaxStack","thenStack","pushThenStack","pushElseStack","elseStack","addTokenToMatch","syntaxStash","openSyntax","closeSyntax","iterationCount","exitReason","matchFlag","lastTokenIndex","syntaxDict","dictSyntax","lowPriorityMatching","keywordName","matchAsList","matchAsTree","host","hostStack","getTrace","shouldPutToTrace","hasMatch","matchNode","testNode","trace","isType","isProperty","isKeyword","getFirstMatchNode","getLastMatchNode","matchFragments","lexer","ast","findFragments","fragments","search","isValidNumber","isValidLocation","createNodeStructureChecker","fields","warn","valid","fieldType","processStructure","nodeType","structure","docs","docsTypes","fieldTypes","config","SyntaxReferenceError","require$$5","require$$6","require$$7","require$$8","require$$9","require$$10","getStructureFromConfig","require$$11","cssWideKeywordsWithExpression","dumpMapSyntax","syntaxAsAst","dumpAtruleMapSyntax","atrule","valueHasVar","buildMatchResult","iterations","matchSyntax","useCommon","Lexer","Lexer$1","collectWarning","warns","res","descName","atruleName","prelude","descriptorName","propertyName","typeName","typeSyntax","declaration","fallbackBasename","atruleEntry","propertyEntry","validate","broken","brokenMap","brokenTypes","brokenProperties","pretty","Lexer_1","definitionSyntax","computeLinesAndColumns","columns","startOffset","OffsetToLocation","OffsetToLocation$1","startColumn","filename","OffsetToLocation_1","sequence","recognizer","children","FUNCTION","URL","HASH","PERCENTAGE","NULL","createParseContext","processConfig","parserConfig","pseudo","parser","consumer","fallback","fallbackNode","head","tail","location","onComment","intToCharMap","base64","bigA","bigZ","littleA","littleZ","nine","plus","slash","littleOffset","numberOffset","VLQ_BASE_SHIFT","VLQ_BASE","VLQ_BASE_MASK","VLQ_CONTINUATION_BIT","toVLQSigned","aValue","fromVLQSigned","isNegative","shifted","base64Vlq","encoded","digit","vlq","aStr","aIndex","aOutParam","strLen","shift","continuation","getArg","aArgs","aName","aDefaultValue","urlRegexp","dataUrlRegexp","urlParse","aUrl","urlGenerate","aParsedUrl","url","normalize","aPath","path","isAbsolute","parts","part","up","join","aRoot","aPathUrl","aRootUrl","joined","relative","supportsNullProto","identity","s","toSetString","isProtoString","fromSetString","compareByOriginalPositions","mappingA","mappingB","onlyCompareOriginal","cmp","strcmp","compareByGeneratedPositionsDeflated","onlyCompareGenerated","aStr1","aStr2","compareByGeneratedPositionsInflated","parseSourceMapInput","computeSourceURL","sourceRoot","sourceURL","sourceMapURL","util","has","hasNativeMap","ArraySet","ArraySet$1","aArray","aAllowDuplicates","len","sStr","isDuplicate","aIdx","arraySet","generatedPositionAfter","lineA","lineB","columnA","columnB","MappingList","MappingList$1","aCallback","aThisArg","aMapping","mappingList","base64VLQ","SourceMapGenerator","aSourceMapConsumer","generator","mapping","newMapping","sourceFile","sourceRelative","SourceMapGenerator$1","generated","aSourceFile","aSourceContent","aSourceMapPath","newSources","newNames","aGenerated","aOriginal","aSource","previousGeneratedColumn","previousGeneratedLine","previousOriginalColumn","previousOriginalLine","previousName","previousSource","nameIdx","sourceIdx","mappings","aSources","aSourceRoot","sourceMapGenerator","trackNodes","sourceMap","sourceMappingActive","activatedGenerated","activatedMapping","handlersNode","nodeLine","nodeColumn","handlersChunk","handlersResult","processChildren","delimeter","processNode","types","invokeForType","getWalkersFromStructure","walkers","getTypesFromConfig","createTypeIterator","reverse","contextName","useContext","walkReducer","prevContextValue","field","breakWalk","createFastTraveralMap","iterators","iteratorsNatural","iteratorsReverse","skipNode","fastTraversalIteratorsNatural","fastTraversalIteratorsReverse","root","walkNode","enterRet","ret","found","shape","appendOrAssign","appendOrAssignOrNull","deepAssign","copy","append","mix","innerShape","mix_1","createParser","createGenerator","createConvertor","createWalker","require$$12","createSyntax","convert","extension","mdnAtrules","mdnProperties","mdnSyntaxes","patch","extendSyntax","preprocessAtrules","dict","patchDictionary","patchDict","unpackSyntaxes","patchAtrules","patchDescriptors","checkTokenIsInteger","expectCharCode","msg","AnPlusB","WhiteSpace","Semicolon","LeftCurlyBracket","Delim","getOffsetExcludeWS","leftCurlyBracket","leftCurlyBracketOrSemicolon","exclamationMarkOrSemicolon","semicolonIncluded","Raw","excludeWhiteSpace","endOffset","rawMode","ATKEYWORD","SEMICOLON","consumeRaw","isDeclarationBlockAtrule","Atrule","nameLowerCase","block","AtrulePrelude","STRING","COLON","DOLLARSIGN","EQUALSSIGN","CIRCUMFLEXACCENT","TILDE","getAttributeName","expectIdent","checkColon","getOperator","AttributeSelector","matcher","flags","flagsPrefix","consumeRule","consumeRawDeclaration","consumeDeclaration","Block","isDeclaration","Brackets","readSequence","CDC","CDC_1","CDO","CDO_1","FULLSTOP","ClassSelector","SOLIDUS","Combinator","Comment","consumeValueRaw","consumeCustomPropertyRaw","consumeValue","startValueToken","Declaration","customProperty","parseValue","important","valueStart","getImportant","DeclarationList","Dimension","_Function","Hash","Identifier","IdSelector","MediaFeature","MediaQuery","space","MediaQueryList","Nth","allowOfClause","selector","query","_Number","Operator","Parentheses","Percentage","PseudoClassSelector","PseudoElementSelector","Ratio","consumePrelude","Rule","Selector","SelectorList","_String","StyleSheet","eatIdentifierOrAsterisk","TypeSelector","eatHexSequence","eatQuestionMarkSequence","count","scanUnicodeRange","hexLength","UnicodeRange","Url","rawStart","rawEnd","Value","require$$13","require$$14","require$$15","require$$16","require$$17","require$$18","require$$19","require$$20","require$$21","require$$22","require$$23","require$$24","require$$25","require$$26","require$$27","require$$28","require$$29","require$$30","require$$31","require$$32","require$$33","require$$34","require$$35","require$$36","require$$37","require$$38","require$$39","_default","atrulePrelude","getNode","expression","_var","startIndex","scope","_import","media","parentheses","supports","dir","lang","selectorList","matches","not","ALLOW_OF_CLAUSE","nthWithOfClause","nthChild","nthLastChild","DISALLOW_OF_CLAUSE","nth","nthLastOfType","nthOfType","slotted","merge","syntaxModule","lib","Sheet$2","text","csstree","rule","inserted","basename","ruleNode","ruleItem","rulelist","declarationNode","dItem","dList","funcNode","fItem","fList","selectNode","selectItem","selectList","pseudoNode","pItem","pList","href","namedPageSelectors","idNode","idItem","idList","queries","mqNode","mqItem","mqList","identNode","identItem","identList","q","urlNode","urlItem","urlList","t","baseStyles","request","status","Polisher","setup","fetched","urls","f","response","originals","cssStr","sheet","Sheet","style","Handler","chunker","polisher","caller","pageSizes","AtPage","marginalia","psuedo","needsMerge","notes","declarations","dirtyPage","format","orientation","bleed","marks","bleedverso","bleedrecto","MARGINS","prop","ident","m","p","subNode","margins","margin","paddings","padding","border","pages","pg","ruleList","selectors","mVar","pVar","borderItem","widthString","heightString","wVar","hVar","identlist","marginSelectors","marginRule","sel","displayNone","displaySelectors","displayDeclaration","displayRule","contentSelectors","contentRule","rules","widthStringRight","heightStringRight","widthStringLeft","heightStringLeft","bleedTop","bleedRight","bleedBottom","bleedLeft","bleedTopRecto","bleedRightRecto","bleedBottomRecto","bleedLeftRecto","bleedTopVerso","bleedRightVerso","bleedBottomVerso","bleedLeftVerso","pageWidthVar","pageHeightVar","mark","markDisplay","oVar","wVarR","hVarR","wVarL","hVarL","note","notesRule","childrenLeft","childrenRight","dimensions","dimensionsLeft","dimensionsRight","widthCalculations","heightCalculations","widthCalculationsLeft","heightCalculationsLeft","ruleLeft","widthCalculationsRight","heightCalculationsRight","ruleRight","splitN","splitP","namedPages","sels","marginGroup","center","centerContent","leftContent","rightContent","centerWidth","leftWidth","rightWidth","leftOuterWidth","centerOuterWidth","rightOuterWidth","outerwidths","newcenterWidth","newLeftWidth","middle","topContent","bottomContent","middleHeight","topHeight","bottomHeight","nthlist","operator","calculations","cssValue","Breaks","breaker","breaks","elements","pageBreaks","newBreaks","pageElement","PrintMedia","iItem","iList","Splits","splits","prevPage","from","split","align","alignLast","Counters","hasProperities","increments","whitespace","counter","increment","reset","counters","countersArray","inc","incrementElements","resetElements","counterName","resetValue","incrementValue","resetDelta","incrementArray","markers","counterIncrement","values","resets","Lists","orderedLists","PositionFixed","fixedEl","el","PageCounterIncrement","_","identifier","NthOfType","dataNthOfType","Following","dataFollowing","Footnotes","policy","display","newPrelude","prevElement","currentNote","pageArea","needsNoteCall","noteArea","noteContent","noteInnerContent","noteCall","noteCallBounds","noteAreaBounds","noteContentMargins","noteContentPadding","noteContentBorders","total","notAreaTop","notePolicy","noteCallPosition","noteCallOffset","prevSibling","rangeBounds","parentParagraph","contentDelta","noteDelta","notePolicyDelta","hasNotes","wrapperDiv","parentElement","footnoteCall","noteContentBounds","startIsNode","splitChild","noteInnerContentBounds","marginTop","marginBottom","paddingTop","paddingBottom","borderTop","borderBottom","borders","pagedMediaHandlers","RunningHeaders","selected","header","running","weight","weighted","orderedSelectors","cleanPseudoContent","trim","cleanSelector","StringSets","identifiers","functions","subchild","stringPrevPage","varFirst","varLast","varStart","varFirstExcept","selTop","pageContentTop","TargetCounters","styleIdentifier","variable","target","TargetText","last","queried","textContent","pseudoType","generatedContentHandlers","WhiteSpaceFilter","previousSibling","nextSibling","CommentsFilter","ScriptsFilter","script","attributeRegex","idRegex","classRegex","pseudoElementRegex","pseudoClassRegex","elementRegex","notRegex","ruleRegex","separatorRegex","straysRegex","findMatch","regex","calculate","commaIndex","specificityCache","specificity","validSelectorCache","testSelectorElement","UndisplayedFilter","calculateSpecificity","displayValue","styledElements","displayRules","displayItem","filters","arr","naiveFallback","implementation","globalThis_1","global","validTypes","Symbol","symbol","isSymbol","validateSymbol","objPrototype","created","generateName","postfix","ie11BugWorkaround","NativeSymbol","standardSymbols","SymbolPolyfill","registry","symbolRegistry","setupStandardSymbols","setupSymbolRegistry","HiddenSymbol","isNativeSafe","description","polyfill","es6Symbol","objToString","isArguments","isFunctionStringTag","abs","floor","toInteger","toPosInteger","isString","iteratorSymbol","toPosInt","isArray","arrayLike","mapFn","thisArg","Context","iterator","getIterator","numberIsNaN","isNan","objHasOwnProperty","eIndexOf","searchElement","splice","remove","itemToRemove","validObject","aFrom","getOwnPropertyDescriptor","pipe","e1","e2","pipes","emitter","registeredHandlers","Handlers","handler","registerHandlers","initializeHandlers","Previewer","param","params","pair","body","stylesheets","inlineStyles","element1","element2","position","startTime","flow","endTime","isObject_1","freeGlobal","_freeGlobal","freeSelf","_root","now","now_1","reWhitespace","trimmedEndIndex","_trimmedEndIndex","reTrimStart","baseTrim","_baseTrim","_Symbol","objectProto","nativeObjectToString","symToStringTag","getRawTag","isOwn","tag","unmasked","_getRawTag","objectToString","_objectToString","nullTag","undefinedTag","baseGetTag","_baseGetTag","isObjectLike","isObjectLike_1","symbolTag","isSymbol_1","NAN","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","toNumber","other","isBinary","toNumber_1","FUNC_ERROR_TEXT","nativeMax","nativeMin","debounce","wait","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","invokeFunc","time","leadingEdge","timerExpired","remainingWait","timeSinceLastCall","timeSinceLastInvoke","timeWaiting","shouldInvoke","trailingEdge","cancel","flush","debounced","isInvoking","debounce_1","DocumentUtils$1","clickListener","pagedSheet","pagedCSS","cssClass","fileName","blob","PageSizeUtils","mm","dpi","paginationType","showBleed","compatibility","printCssRaw","printCssUrl","preview","ConfigContext","createContext","ConfigProvider","Pagination","rendering","setRendering","useState","containerRef","useRef","contentRef","documentUtilsRef","DocumentUtils","pageRuleRegex","sizeAndBleedStyles","existingStyles","newPageRule","layoutPage","paged","styleUrls","useEffect","jsxs","jsx","Compatibility","link","CompatibilityUtils","styleLink","combinedClassName","pageNo","overlay","showBleedArea","getDialogProps","props","dialog","ImageBleed","BLEED","PAGE_CONTENT_WIDTH","PAGE_CONTENT_HEIGHT","backgroundColor","imageW","imageH","imageL","imageR","imageT","imageB","coverClass","setCoverClass","unitFormat","calculateImageHeight","imageWidth","imageHeight","formatStyleValue","ratio","imageLoaded","imageClass","ImageSpread","side","calculateImageWidth","createStyle","imageLeft","rightPageOffset","leftStyle","rightStyle","Editable","PagedComponent","forwardRef","pageFlowRef","useImperativeHandle","useCallback","pageFileName","Dynamic","PaginationDynamic","SheetDynamic","Static","PaginationStatic","SheetStatic"],"mappings":"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AAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;A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CN,MAAO,IACP,KAAM,IACN,EACD,OAAQ,CACP,MAAO,KACP,KAAM,IACT,CACE,EACD,GAAM,CACL,MAAO,CACN,MAAO,IACP,KAAM,IACN,EACD,OAAQ,CACP,MAAO,IACP,KAAM,IACT,CACE,EACD,GAAM,CACL,MAAO,CACN,MAAO,IACP,KAAM,IACN,EACD,OAAQ,CACP,MAAO,IACP,KAAM,IACT,CACE,EACD,GAAM,CACL,MAAO,CACN,MAAO,IACP,KAAM,IACN,EACD,OAAQ,CACP,MAAO,IACP,KAAM,IACT,CACE,EACD,GAAM,CACL,MAAO,CACN,MAAO,IACP,KAAM,IACN,EACD,OAAQ,CACP,MAAO,IACP,KAAM,IACT,CACE,EACD,GAAM,CACL,MAAO,CACN,MAAO,IACP,KAAM,IACN,EACD,OAAQ,CACP,MAAO,IACP,KAAM,IACT,CACE,EACD,GAAM,CACL,MAAO,CACN,MAAO,IACP,KAAM,IACN,EACD,OAAQ,CACP,MAAO,IACP,KAAM,IACT,CACE,EACD,GAAM,CACL,MAAO,CACN,MAAO,GACP,KAAM,IACN,EACD,OAAQ,CACP,MAAO,IACP,KAAM,IACT,CACE,EACD,GAAM,CACL,MAAO,CACN,MAAO,GACP,KAAM,IACN,EACD,OAAQ,CACP,MAAO,GACP,KAAM,IACT,CACE,EACD,GAAM,CACL,MAAO,CACN,MAAO,GACP,KAAM,IACN,EACD,OAAQ,CACP,MAAO,GACP,KAAM,IACT,CACE,EACD,IAAO,CACN,MAAO,CACN,MAAO,GACP,KAAM,IACN,EACD,OAAQ,CACP,MAAO,GACP,KAAM,IACT,CACE,EACD,GAAM,CACL,MAAO,CACN,MAAO,IACP,KAAM,IACN,EACD,OAAQ,CACP,MAAO,IACP,KAAM,IACT,CACE,EACD,GAAM,CACL,MAAO,CACN,MAAO,IACP,KAAM,IACN,EACD,OAAQ,CACP,MAAO,IACP,KAAM,IACT,CACE,EACD,OAAU,CACT,MAAO,CACN,MAAO,IACP,KAAM,IACN,EACD,OAAQ,CACP,MAAO,GACP,KAAM,IACT,CACE,EACD,MAAS,CACR,MAAO,CACN,MAAO,IA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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223]}