{"version":3,"file":"uhuu-components.es.js","sources":["../node_modules/pagedjs/src/utils/utils.js","../node_modules/pagedjs/src/utils/dom.js","../node_modules/pagedjs/src/chunker/breaktoken.js","../node_modules/pagedjs/src/chunker/renderresult.js","../node_modules/type/value/is.js","../node_modules/type/object/is.js","../node_modules/type/prototype/is.js","../node_modules/type/function/is.js","../node_modules/type/plain-function/is.js","../node_modules/es5-ext/object/assign/is-implemented.js","../node_modules/es5-ext/object/keys/is-implemented.js","../node_modules/es5-ext/function/noop.js","../node_modules/es5-ext/object/is-value.js","../node_modules/es5-ext/object/keys/shim.js","../node_modules/es5-ext/object/keys/index.js","../node_modules/es5-ext/object/valid-value.js","../node_modules/es5-ext/object/assign/shim.js","../node_modules/es5-ext/object/assign/index.js","../node_modules/es5-ext/object/normalize-options.js","../node_modules/es5-ext/string/#/contains/is-implemented.js","../node_modules/es5-ext/string/#/contains/shim.js","../node_modules/es5-ext/string/#/contains/index.js","../node_modules/d/index.js","../node_modules/es5-ext/object/valid-callable.js","../node_modules/event-emitter/index.js","../node_modules/pagedjs/src/utils/hook.js","../node_modules/pagedjs/src/chunker/layout.js","../node_modules/pagedjs/src/chunker/page.js","../node_modules/pagedjs/src/chunker/parser.js","../node_modules/pagedjs/src/utils/queue.js","../node_modules/pagedjs/src/chunker/chunker.js","../node_modules/css-tree/lib/common/List.js","../node_modules/css-tree/lib/utils/createCustomError.js","../node_modules/css-tree/lib/common/SyntaxError.js","../node_modules/css-tree/lib/tokenizer/const.js","../node_modules/css-tree/lib/tokenizer/char-code-definitions.js","../node_modules/css-tree/lib/tokenizer/utils.js","../node_modules/css-tree/lib/common/TokenStream.js","../node_modules/css-tree/lib/definition-syntax/generate.js","../node_modules/css-tree/lib/lexer/error.js","../node_modules/css-tree/lib/utils/names.js","../node_modules/css-tree/lib/common/adopt-buffer.js","../node_modules/css-tree/lib/tokenizer/index.js","../node_modules/css-tree/lib/lexer/generic-an-plus-b.js","../node_modules/css-tree/lib/lexer/generic-urange.js","../node_modules/css-tree/lib/lexer/generic.js","../node_modules/css-tree/lib/definition-syntax/SyntaxError.js","../node_modules/css-tree/lib/definition-syntax/tokenizer.js","../node_modules/css-tree/lib/definition-syntax/parse.js","../node_modules/css-tree/lib/definition-syntax/walk.js","../node_modules/css-tree/lib/lexer/prepare-tokens.js","../node_modules/css-tree/lib/lexer/match-graph.js","../node_modules/css-tree/lib/lexer/match.js","../node_modules/css-tree/lib/lexer/trace.js","../node_modules/css-tree/lib/lexer/search.js","../node_modules/css-tree/lib/lexer/structure.js","../node_modules/css-tree/lib/lexer/Lexer.js","../node_modules/css-tree/lib/definition-syntax/index.js","../node_modules/css-tree/lib/common/OffsetToLocation.js","../node_modules/css-tree/lib/parser/sequence.js","../node_modules/css-tree/lib/parser/create.js","../node_modules/source-map/lib/base64.js","../node_modules/source-map/lib/base64-vlq.js","../node_modules/source-map/lib/util.js","../node_modules/source-map/lib/array-set.js","../node_modules/source-map/lib/mapping-list.js","../node_modules/source-map/lib/source-map-generator.js","../node_modules/css-tree/lib/generator/sourceMap.js","../node_modules/css-tree/lib/generator/create.js","../node_modules/css-tree/lib/convertor/create.js","../node_modules/css-tree/lib/walker/create.js","../node_modules/css-tree/lib/utils/clone.js","../node_modules/css-tree/lib/syntax/config/mix.js","../node_modules/css-tree/lib/syntax/create.js","../node_modules/css-tree/data/index.js","../node_modules/css-tree/lib/syntax/node/AnPlusB.js","../node_modules/css-tree/lib/syntax/node/Raw.js","../node_modules/css-tree/lib/syntax/node/Atrule.js","../node_modules/css-tree/lib/syntax/node/AtrulePrelude.js","../node_modules/css-tree/lib/syntax/node/AttributeSelector.js","../node_modules/css-tree/lib/syntax/node/Block.js","../node_modules/css-tree/lib/syntax/node/Brackets.js","../node_modules/css-tree/lib/syntax/node/CDC.js","../node_modules/css-tree/lib/syntax/node/CDO.js","../node_modules/css-tree/lib/syntax/node/ClassSelector.js","../node_modules/css-tree/lib/syntax/node/Combinator.js","../node_modules/css-tree/lib/syntax/node/Comment.js","../node_modules/css-tree/lib/syntax/node/Declaration.js","../node_modules/css-tree/lib/syntax/node/DeclarationList.js","../node_modules/css-tree/lib/syntax/node/Dimension.js","../node_modules/css-tree/lib/syntax/node/Function.js","../node_modules/css-tree/lib/syntax/node/Hash.js","../node_modules/css-tree/lib/syntax/node/Identifier.js","../node_modules/css-tree/lib/syntax/node/IdSelector.js","../node_modules/css-tree/lib/syntax/node/MediaFeature.js","../node_modules/css-tree/lib/syntax/node/MediaQuery.js","../node_modules/css-tree/lib/syntax/node/MediaQueryList.js","../node_modules/css-tree/lib/syntax/node/Nth.js","../node_modules/css-tree/lib/syntax/node/Number.js","../node_modules/css-tree/lib/syntax/node/Operator.js","../node_modules/css-tree/lib/syntax/node/Parentheses.js","../node_modules/css-tree/lib/syntax/node/Percentage.js","../node_modules/css-tree/lib/syntax/node/PseudoClassSelector.js","../node_modules/css-tree/lib/syntax/node/PseudoElementSelector.js","../node_modules/css-tree/lib/syntax/node/Ratio.js","../node_modules/css-tree/lib/syntax/node/Rule.js","../node_modules/css-tree/lib/syntax/node/Selector.js","../node_modules/css-tree/lib/syntax/node/SelectorList.js","../node_modules/css-tree/lib/syntax/node/String.js","../node_modules/css-tree/lib/syntax/node/StyleSheet.js","../node_modules/css-tree/lib/syntax/node/TypeSelector.js","../node_modules/css-tree/lib/syntax/node/UnicodeRange.js","../node_modules/css-tree/lib/syntax/node/Url.js","../node_modules/css-tree/lib/syntax/node/Value.js","../node_modules/css-tree/lib/syntax/node/WhiteSpace.js","../node_modules/css-tree/lib/syntax/node/index.js","../node_modules/css-tree/lib/syntax/config/lexer.js","../node_modules/css-tree/lib/syntax/scope/default.js","../node_modules/css-tree/lib/syntax/scope/atrulePrelude.js","../node_modules/css-tree/lib/syntax/scope/selector.js","../node_modules/css-tree/lib/syntax/function/expression.js","../node_modules/css-tree/lib/syntax/function/var.js","../node_modules/css-tree/lib/syntax/scope/value.js","../node_modules/css-tree/lib/syntax/scope/index.js","../node_modules/css-tree/lib/syntax/atrule/font-face.js","../node_modules/css-tree/lib/syntax/atrule/import.js","../node_modules/css-tree/lib/syntax/atrule/media.js","../node_modules/css-tree/lib/syntax/atrule/page.js","../node_modules/css-tree/lib/syntax/atrule/supports.js","../node_modules/css-tree/lib/syntax/atrule/index.js","../node_modules/css-tree/lib/syntax/pseudo/dir.js","../node_modules/css-tree/lib/syntax/pseudo/has.js","../node_modules/css-tree/lib/syntax/pseudo/lang.js","../node_modules/css-tree/lib/syntax/pseudo/common/selectorList.js","../node_modules/css-tree/lib/syntax/pseudo/matches.js","../node_modules/css-tree/lib/syntax/pseudo/not.js","../node_modules/css-tree/lib/syntax/pseudo/common/nthWithOfClause.js","../node_modules/css-tree/lib/syntax/pseudo/nth-child.js","../node_modules/css-tree/lib/syntax/pseudo/nth-last-child.js","../node_modules/css-tree/lib/syntax/pseudo/common/nth.js","../node_modules/css-tree/lib/syntax/pseudo/nth-last-of-type.js","../node_modules/css-tree/lib/syntax/pseudo/nth-of-type.js","../node_modules/css-tree/lib/syntax/pseudo/slotted.js","../node_modules/css-tree/lib/syntax/pseudo/index.js","../node_modules/css-tree/lib/syntax/config/parser.js","../node_modules/css-tree/lib/syntax/config/walker.js","../node_modules/css-tree/lib/syntax/index.js","../node_modules/css-tree/lib/index.js","../node_modules/pagedjs/src/polisher/sheet.js","../node_modules/pagedjs/src/polisher/base.js","../node_modules/pagedjs/src/utils/request.js","../node_modules/pagedjs/src/polisher/polisher.js","../node_modules/pagedjs/src/modules/handler.js","../node_modules/pagedjs/src/polisher/sizes.js","../node_modules/pagedjs/src/modules/paged-media/atpage.js","../node_modules/pagedjs/src/modules/paged-media/breaks.js","../node_modules/pagedjs/src/modules/paged-media/print-media.js","../node_modules/pagedjs/src/modules/paged-media/splits.js","../node_modules/pagedjs/src/modules/paged-media/counters.js","../node_modules/pagedjs/src/modules/paged-media/lists.js","../node_modules/pagedjs/src/modules/paged-media/position-fixed.js","../node_modules/pagedjs/src/modules/paged-media/page-counter-increment.js","../node_modules/pagedjs/src/modules/paged-media/nth-of-type.js","../node_modules/pagedjs/src/modules/paged-media/following.js","../node_modules/pagedjs/src/modules/paged-media/footnotes.js","../node_modules/pagedjs/src/modules/paged-media/index.js","../node_modules/pagedjs/src/modules/generated-content/running-headers.js","../node_modules/pagedjs/src/utils/css.js","../node_modules/pagedjs/src/modules/generated-content/string-sets.js","../node_modules/pagedjs/src/modules/generated-content/target-counters.js","../node_modules/pagedjs/src/modules/generated-content/target-text.js","../node_modules/pagedjs/src/modules/generated-content/index.js","../node_modules/pagedjs/src/modules/filters/whitespace.js","../node_modules/pagedjs/src/modules/filters/comments.js","../node_modules/pagedjs/src/modules/filters/scripts.js","../node_modules/clear-cut/index.js","../node_modules/pagedjs/src/modules/filters/undisplayed.js","../node_modules/pagedjs/src/modules/filters/index.js","../node_modules/es5-ext/array/from/is-implemented.js","../node_modules/ext/global-this/is-implemented.js","../node_modules/ext/global-this/implementation.js","../node_modules/ext/global-this/index.js","../node_modules/es6-symbol/is-implemented.js","../node_modules/es6-symbol/is-symbol.js","../node_modules/es6-symbol/validate-symbol.js","../node_modules/es6-symbol/lib/private/generate-name.js","../node_modules/es6-symbol/lib/private/setup/standard-symbols.js","../node_modules/es6-symbol/lib/private/setup/symbol-registry.js","../node_modules/es6-symbol/polyfill.js","../node_modules/es6-symbol/index.js","../node_modules/es5-ext/function/is-arguments.js","../node_modules/es5-ext/function/is-function.js","../node_modules/es5-ext/math/sign/is-implemented.js","../node_modules/es5-ext/math/sign/shim.js","../node_modules/es5-ext/math/sign/index.js","../node_modules/es5-ext/number/to-integer.js","../node_modules/es5-ext/number/to-pos-integer.js","../node_modules/es5-ext/string/is-string.js","../node_modules/es5-ext/array/from/shim.js","../node_modules/es5-ext/array/from/index.js","../node_modules/es5-ext/number/is-nan/is-implemented.js","../node_modules/es5-ext/number/is-nan/shim.js","../node_modules/es5-ext/number/is-nan/index.js","../node_modules/es5-ext/array/#/e-index-of.js","../node_modules/es5-ext/array/#/remove.js","../node_modules/es5-ext/object/is-object.js","../node_modules/es5-ext/object/valid-object.js","../node_modules/event-emitter/pipe.js","../node_modules/pagedjs/src/utils/handlers.js","../node_modules/pagedjs/src/polyfill/previewer.js","../node_modules/lodash/isObject.js","../node_modules/lodash/_freeGlobal.js","../node_modules/lodash/_root.js","../node_modules/lodash/now.js","../node_modules/lodash/_trimmedEndIndex.js","../node_modules/lodash/_baseTrim.js","../node_modules/lodash/_Symbol.js","../node_modules/lodash/_getRawTag.js","../node_modules/lodash/_objectToString.js","../node_modules/lodash/_baseGetTag.js","../node_modules/lodash/isObjectLike.js","../node_modules/lodash/isSymbol.js","../node_modules/lodash/toNumber.js","../node_modules/lodash/debounce.js","../src/uhuu/pagination-dynamic/pagination/DocumentUtils.ts","../src/uhuu/utility/PageSizeUtils.js","../src/uhuu/config/config-provider.tsx","../src/uhuu/pagination-dynamic/pagination-dynamic.tsx","../src/uhuu/pagination-dynamic/sheet-dynamic.tsx","../src/uhuu/pagination-static/pagination/CompatibilityUtils.ts","../src/uhuu/pagination-static/pagination/DocumentUtils.ts","../src/uhuu/pagination-static/pagination-static.tsx","../src/uhuu/pagination-static/sheet-static.tsx","../src/uhuu/editable/dialog-props.js","../src/uhuu/image/image-bleed.tsx","../src/uhuu/image/image-spread.tsx","../src/uhuu/editable/editable.tsx","../src/PagedPreview.jsx","../src/index.js"],"sourcesContent":["export function getBoundingClientRect(element) {\n\tif (!element) {\n\t\treturn;\n\t}\n\tlet rect;\n\tif (typeof element.getBoundingClientRect !== \"undefined\") {\n\t\trect = element.getBoundingClientRect();\n\t} else {\n\t\tlet range = document.createRange();\n\t\trange.selectNode(element);\n\t\trect = range.getBoundingClientRect();\n\t}\n\treturn rect;\n}\n\nexport function getClientRects(element) {\n\tif (!element) {\n\t\treturn;\n\t}\n\tlet rect;\n\tif (typeof element.getClientRects !== \"undefined\") {\n\t\trect = element.getClientRects();\n\t} else {\n\t\tlet range = document.createRange();\n\t\trange.selectNode(element);\n\t\trect = range.getClientRects();\n\t}\n\treturn rect;\n}\n\n/**\n * Generates a UUID\n * based on: http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript\n * @returns {string} uuid\n */\nexport function UUID() {\n\tvar d = new Date().getTime();\n\tif (typeof performance !== \"undefined\" && typeof performance.now === \"function\") {\n\t\td += performance.now(); //use high-precision timer if available\n\t}\n\treturn \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, function (c) {\n\t\tvar r = (d + Math.random() * 16) % 16 | 0;\n\t\td = Math.floor(d / 16);\n\t\treturn (c === \"x\" ? r : (r & 0x3 | 0x8)).toString(16);\n\t});\n}\n\n// From: https://hg.mozilla.org/mozilla-central/file/tip/toolkit/modules/css-selector.js#l52\n\n/**\n * Find the position of [element] in [nodeList].\n * @param {Element} element to check\n * @param {NodeList} nodeList to find in\n * @returns {int} an index of the match, or -1 if there is no match\n */\nexport function positionInNodeList(element, nodeList) {\n\tfor (let i = 0; i < nodeList.length; i++) {\n\t\tif (element === nodeList[i]) {\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn -1;\n}\n\n/**\n * Find a unique CSS selector for a given element\n * @param {Element} ele to check\n * @returns {string} a string such that ele.ownerDocument.querySelector(reply) === ele\n * and ele.ownerDocument.querySelectorAll(reply).length === 1\n */\nexport function findCssSelector(ele) {\n\tlet document = ele.ownerDocument;\n\t// Fred: commented out to allow for parsing in fragments\n\t// if (!document || !document.contains(ele)) {\n\t//   throw new Error(\"findCssSelector received element not inside document\");\n\t// }\n\n\tlet cssEscape = window.CSS.escape;\n\n\t// document.querySelectorAll(\"#id\") returns multiple if elements share an ID\n\tif (ele.id &&\n\t\tdocument.querySelectorAll(\"#\" + cssEscape(ele.id)).length === 1) {\n\t\treturn \"#\" + cssEscape(ele.id);\n\t}\n\n\t// Inherently unique by tag name\n\tlet tagName = ele.localName;\n\tif (tagName === \"html\") {\n\t\treturn \"html\";\n\t}\n\tif (tagName === \"head\") {\n\t\treturn \"head\";\n\t}\n\tif (tagName === \"body\") {\n\t\treturn \"body\";\n\t}\n\n\t// We might be able to find a unique class name\n\tlet selector, index, matches;\n\tif (ele.classList.length > 0) {\n\t\tfor (let i = 0; i < ele.classList.length; i++) {\n\t\t\t// Is this className unique by itself?\n\t\t\tselector = \".\" + cssEscape(ele.classList.item(i));\n\t\t\tmatches = document.querySelectorAll(selector);\n\t\t\tif (matches.length === 1) {\n\t\t\t\treturn selector;\n\t\t\t}\n\t\t\t// Maybe it's unique with a tag name?\n\t\t\tselector = cssEscape(tagName) + selector;\n\t\t\tmatches = document.querySelectorAll(selector);\n\t\t\tif (matches.length === 1) {\n\t\t\t\treturn selector;\n\t\t\t}\n\t\t\t// Maybe it's unique using a tag name and nth-child\n\t\t\tindex = positionInNodeList(ele, ele.parentNode.children) + 1;\n\t\t\tselector = selector + \":nth-child(\" + index + \")\";\n\t\t\tmatches = document.querySelectorAll(selector);\n\t\t\tif (matches.length === 1) {\n\t\t\t\treturn selector;\n\t\t\t}\n\t\t}\n\t}\n\n\t// Not unique enough yet.  As long as it's not a child of the document,\n\t// continue recursing up until it is unique enough.\n\tif (ele.parentNode !== document && ele.parentNode.nodeType === 1) {\n\t\tindex = positionInNodeList(ele, ele.parentNode.children) + 1;\n\t\tselector = findCssSelector(ele.parentNode) + \" > \" +\n\t\t\tcssEscape(tagName) + \":nth-child(\" + index + \")\";\n\t}\n\n\treturn selector;\n}\n\nexport function attr(element, attributes) {\n\tfor (var i = 0; i < attributes.length; i++) {\n\t\tif (element.hasAttribute(attributes[i])) {\n\t\t\treturn element.getAttribute(attributes[i]);\n\t\t}\n\t}\n}\n\n/* Based on by https://mths.be/cssescape v1.5.1 by @mathias | MIT license\n * Allows # and .\n */\nexport function querySelectorEscape(value) {\n\tif (arguments.length == 0) {\n\t\tthrow new TypeError(\"`CSS.escape` requires an argument.\");\n\t}\n\tvar string = String(value);\n\n\tvar length = string.length;\n\tvar index = -1;\n\tvar codeUnit;\n\tvar result = \"\";\n\tvar firstCodeUnit = string.charCodeAt(0);\n\twhile (++index < length) {\n\t\tcodeUnit = string.charCodeAt(index);\n\n\n\n\t\t// Note: there’s no need to special-case astral symbols, surrogate\n\t\t// pairs, or lone surrogates.\n\n\t\t// If the character is NULL (U+0000), then the REPLACEMENT CHARACTER\n\t\t// (U+FFFD).\n\t\tif (codeUnit == 0x0000) {\n\t\t\tresult += \"\\uFFFD\";\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (\n\t\t\t// If the character is in the range [\\1-\\1F] (U+0001 to U+001F) or is\n\t\t\t// U+007F, […]\n\t\t\t(codeUnit >= 0x0001 && codeUnit <= 0x001F) || codeUnit == 0x007F ||\n\t\t\t// If the character is the first character and is in the range [0-9]\n\t\t\t// (U+0030 to U+0039), […]\n\t\t\t(index == 0 && codeUnit >= 0x0030 && codeUnit <= 0x0039) ||\n\t\t\t// If the character is the second character and is in the range [0-9]\n\t\t\t// (U+0030 to U+0039) and the first character is a `-` (U+002D), […]\n\t\t\t(\n\t\t\t\tindex == 1 &&\n\t\t\t\tcodeUnit >= 0x0030 && codeUnit <= 0x0039 &&\n\t\t\t\tfirstCodeUnit == 0x002D\n\t\t\t)\n\t\t) {\n\t\t\t// https://drafts.csswg.org/cssom/#escape-a-character-as-code-point\n\t\t\tresult += \"\\\\\" + codeUnit.toString(16) + \" \";\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (\n\t\t\t// If the character is the first character and is a `-` (U+002D), and\n\t\t\t// there is no second character, […]\n\t\t\tindex == 0 &&\n\t\t\tlength == 1 &&\n\t\t\tcodeUnit == 0x002D\n\t\t) {\n\t\t\tresult += \"\\\\\" + string.charAt(index);\n\t\t\tcontinue;\n\t\t}\n\n\t\t// support for period character in id\n\t\tif (codeUnit == 0x002E) {\n\t\t\tif (string.charAt(0) == \"#\") {\n\t\t\t\tresult += \"\\\\.\";\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\n\t\t// If the character is not handled by one of the above rules and is\n\t\t// greater than or equal to U+0080, is `-` (U+002D) or `_` (U+005F), or\n\t\t// is in one of the ranges [0-9] (U+0030 to U+0039), [A-Z] (U+0041 to\n\t\t// U+005A), or [a-z] (U+0061 to U+007A), […]\n\t\tif (\n\t\t\tcodeUnit >= 0x0080 ||\n\t\t\tcodeUnit == 0x002D ||\n\t\t\tcodeUnit == 0x005F ||\n\t\t\tcodeUnit == 35 || // Allow #\n\t\t\tcodeUnit == 46 || // Allow .\n\t\t\tcodeUnit >= 0x0030 && codeUnit <= 0x0039 ||\n\t\t\tcodeUnit >= 0x0041 && codeUnit <= 0x005A ||\n\t\t\tcodeUnit >= 0x0061 && codeUnit <= 0x007A\n\t\t) {\n\t\t\t// the character itself\n\t\t\tresult += string.charAt(index);\n\t\t\tcontinue;\n\t\t}\n\n\t\t// Otherwise, the escaped character.\n\t\t// https://drafts.csswg.org/cssom/#escape-a-character\n\t\tresult += \"\\\\\" + string.charAt(index);\n\n\t}\n\treturn result;\n}\n\n/**\n * Creates a new pending promise and provides methods to resolve or reject it.\n * From: https://developer.mozilla.org/en-US/docs/Mozilla/JavaScript_code_modules/Promise.jsm/Deferred#backwards_forwards_compatible\n * @returns {object} defered\n */\nexport function defer() {\n\tthis.resolve = null;\n\n\tthis.reject = null;\n\n\tthis.id = UUID();\n\n\tthis.promise = new Promise((resolve, reject) => {\n\t\tthis.resolve = resolve;\n\t\tthis.reject = reject;\n\t});\n\tObject.freeze(this);\n}\n\nexport const requestIdleCallback = typeof window !== \"undefined\" && (\"requestIdleCallback\" in window ? window.requestIdleCallback : window.requestAnimationFrame);\n\nexport function CSSValueToString(obj) {\n\treturn obj.value + (obj.unit || \"\");\n}","export function isElement(node) {\n\treturn node && node.nodeType === 1;\n}\n\nexport function isText(node) {\n\treturn node && node.nodeType === 3;\n}\n\nexport function* walk(start, limiter) {\n\tlet node = start;\n\n\twhile (node) {\n\n\t\tyield node;\n\n\t\tif (node.childNodes.length) {\n\t\t\tnode = node.firstChild;\n\t\t} else if (node.nextSibling) {\n\t\t\tif (limiter && node === limiter) {\n\t\t\t\tnode = undefined;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tnode = node.nextSibling;\n\t\t} else {\n\t\t\twhile (node) {\n\t\t\t\tnode = node.parentNode;\n\t\t\t\tif (limiter && node === limiter) {\n\t\t\t\t\tnode = undefined;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (node && node.nextSibling) {\n\t\t\t\t\tnode = node.nextSibling;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function nodeAfter(node, limiter) {\n\tif (limiter && node === limiter) {\n\t\treturn;\n\t}\n\tlet significantNode = nextSignificantNode(node);\n\tif (significantNode) {\n\t\treturn significantNode;\n\t}\n\tif (node.parentNode) {\n\t\twhile ((node = node.parentNode)) {\n\t\t\tif (limiter && node === limiter) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsignificantNode = nextSignificantNode(node);\n\t\t\tif (significantNode) {\n\t\t\t\treturn significantNode;\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function nodeBefore(node, limiter) {\n\tif (limiter && node === limiter) {\n\t\treturn;\n\t}\n\tlet significantNode = previousSignificantNode(node);\n\tif (significantNode) {\n\t\treturn significantNode;\n\t}\n\tif (node.parentNode) {\n\t\twhile ((node = node.parentNode)) {\n\t\t\tif (limiter && node === limiter) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsignificantNode = previousSignificantNode(node);\n\t\t\tif (significantNode) {\n\t\t\t\treturn significantNode;\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function elementAfter(node, limiter) {\n\tlet after = nodeAfter(node, limiter);\n\n\twhile (after && after.nodeType !== 1) {\n\t\tafter = nodeAfter(after, limiter);\n\t}\n\n\treturn after;\n}\n\nexport function elementBefore(node, limiter) {\n\tlet before = nodeBefore(node, limiter);\n\n\twhile (before && before.nodeType !== 1) {\n\t\tbefore = nodeBefore(before, limiter);\n\t}\n\n\treturn before;\n}\n\nexport function displayedElementAfter(node, limiter) {\n\tlet after = elementAfter(node, limiter);\n\n\twhile (after && after.dataset.undisplayed) {\n\t\tafter = elementAfter(after, limiter);\n\t}\n\n\treturn after;\n}\n\nexport function displayedElementBefore(node, limiter) {\n\tlet before = elementBefore(node, limiter);\n\n\twhile (before && before.dataset.undisplayed) {\n\t\tbefore = elementBefore(before, limiter);\n\t}\n\n\treturn before;\n}\n\nexport function stackChildren(currentNode, stacked) {\n\tlet stack = stacked || [];\n\n\tstack.unshift(currentNode);\n\n\tlet children = currentNode.children;\n\tfor (var i = 0, length = children.length; i < length; i++) {\n\t\tstackChildren(children[i], stack);\n\t}\n\n\treturn stack;\n}\n\nexport function rebuildAncestors(node) {\n\tlet parent, ancestor;\n\tlet ancestors = [];\n\tlet added = [];\n\n\tlet fragment = document.createDocumentFragment();\n\n\t// Handle rowspan on table\n\tif (node.nodeName === \"TR\") {\n\t\tlet previousRow = node.previousElementSibling;\n\t\tlet previousRowDistance = 1;\n\t\twhile (previousRow) {\n\t\t\t// previous row has more columns, might indicate a rowspan.\n\t\t\tif (previousRow.childElementCount > node.childElementCount) {\n\t\t\t\tconst initialColumns = Array.from(node.children);\n\t\t\t\twhile (node.firstChild) {\n\t\t\t\t\tnode.firstChild.remove();\n\t\t\t\t}\n\t\t\t\tlet k = 0;\n\t\t\t\tfor (let j = 0; j < previousRow.children.length; j++) {\n\t\t\t\t\tlet column = previousRow.children[j];\n\t\t\t\t\tif (column.rowSpan && column.rowSpan > previousRowDistance) {\n\t\t\t\t\t\tconst duplicatedColumn = column.cloneNode(true);\n\t\t\t\t\t\t// Adjust rowspan value\n\t\t\t\t\t\tduplicatedColumn.rowSpan = column.rowSpan - previousRowDistance;\n\t\t\t\t\t\t// Add the column to the row\n\t\t\t\t\t\tnode.appendChild(duplicatedColumn);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Fill the gap with the initial columns (if exists)\n\t\t\t\t\t\tconst initialColumn = initialColumns[k++];\n\t\t\t\t\t\t// The initial column can be undefined if the newly created table has less columns than the original table\n\t\t\t\t\t\tif (initialColumn) {\n\t\t\t\t\t\t\tnode.appendChild(initialColumn);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tpreviousRow = previousRow.previousElementSibling;\n\t\t\tpreviousRowDistance++;\n\t\t}\n\t}\n\n\t// Gather all ancestors\n\tlet element = node;\n\twhile(element.parentNode && element.parentNode.nodeType === 1) {\n\t\tancestors.unshift(element.parentNode);\n\t\telement = element.parentNode;\n\t}\n\n\tfor (var i = 0; i < ancestors.length; i++) {\n\t\tancestor = ancestors[i];\n\t\tparent = ancestor.cloneNode(false);\n\t\n\t\tparent.setAttribute(\"data-split-from\", parent.getAttribute(\"data-ref\"));\n\t\t// ancestor.setAttribute(\"data-split-to\", parent.getAttribute(\"data-ref\"));\n\n\t\tif (parent.hasAttribute(\"id\")) {\n\t\t\tlet dataID = parent.getAttribute(\"id\");\n\t\t\tparent.setAttribute(\"data-id\", dataID);\n\t\t\tparent.removeAttribute(\"id\");\n\t\t}\n\n\t\t// This is handled by css :not, but also tidied up here\n\t\tif (parent.hasAttribute(\"data-break-before\")) {\n\t\t\tparent.removeAttribute(\"data-break-before\");\n\t\t}\n\n\t\tif (parent.hasAttribute(\"data-previous-break-after\")) {\n\t\t\tparent.removeAttribute(\"data-previous-break-after\");\n\t\t}\n\n\t\tif (added.length) {\n\t\t\tlet container = added[added.length-1];\n\t\t\tcontainer.appendChild(parent);\n\t\t} else {\n\t\t\tfragment.appendChild(parent);\n\t\t}\n\t\tadded.push(parent);\n\n\t\t// rebuild table rows\n\t\tif (parent.nodeName === \"TD\" && ancestor.parentElement.contains(ancestor)) {\n\t\t\tlet td = ancestor;\n\t\t\tlet prev = parent;\n\t\t\twhile ((td = td.previousElementSibling)) {\n\t\t\t\tlet sib = td.cloneNode(false);\n\t\t\t\tparent.parentElement.insertBefore(sib, prev);\n\t\t\t\tprev = sib;\n\t\t\t}\n\t\t\t\n\t\t}\n\t}\n\n\tadded = undefined;\n\treturn fragment;\n}\n/*\nexport function split(bound, cutElement, breakAfter) {\n\t\tlet needsRemoval = [];\n\t\tlet index = indexOf(cutElement);\n\n\t\tif (!breakAfter && index === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (breakAfter && index === (cutElement.parentNode.children.length - 1)) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Create a fragment with rebuilt ancestors\n\t\tlet fragment = rebuildAncestors(cutElement);\n\n\t\t// Clone cut\n\t\tif (!breakAfter) {\n\t\t\tlet clone = cutElement.cloneNode(true);\n\t\t\tlet ref = cutElement.parentNode.getAttribute('data-ref');\n\t\t\tlet parent = fragment.querySelector(\"[data-ref='\" + ref + \"']\");\n\t\t\tparent.appendChild(clone);\n\t\t\tneedsRemoval.push(cutElement);\n\t\t}\n\n\t\t// Remove all after cut\n\t\tlet next = nodeAfter(cutElement, bound);\n\t\twhile (next) {\n\t\t\tlet clone = next.cloneNode(true);\n\t\t\tlet ref = next.parentNode.getAttribute('data-ref');\n\t\t\tlet parent = fragment.querySelector(\"[data-ref='\" + ref + \"']\");\n\t\t\tparent.appendChild(clone);\n\t\t\tneedsRemoval.push(next);\n\t\t\tnext = nodeAfter(next, bound);\n\t\t}\n\n\t\t// Remove originals\n\t\tneedsRemoval.forEach((node) => {\n\t\t\tif (node) {\n\t\t\t\tnode.remove();\n\t\t\t}\n\t\t});\n\n\t\t// Insert after bounds\n\t\tbound.parentNode.insertBefore(fragment, bound.nextSibling);\n\t\treturn [bound, bound.nextSibling];\n}\n*/\n\nexport function needsBreakBefore(node) {\n\tif( typeof node !== \"undefined\" &&\n\t\t\ttypeof node.dataset !== \"undefined\" &&\n\t\t\ttypeof node.dataset.breakBefore !== \"undefined\" &&\n\t\t\t(node.dataset.breakBefore === \"always\" ||\n\t\t\t node.dataset.breakBefore === \"page\" ||\n\t\t\t node.dataset.breakBefore === \"left\" ||\n\t\t\t node.dataset.breakBefore === \"right\" ||\n\t\t\t node.dataset.breakBefore === \"recto\" ||\n\t\t\t node.dataset.breakBefore === \"verso\")\n\t\t ) {\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n\nexport function needsBreakAfter(node) {\n\tif( typeof node !== \"undefined\" &&\n\t\t\ttypeof node.dataset !== \"undefined\" &&\n\t\t\ttypeof node.dataset.breakAfter !== \"undefined\" &&\n\t\t\t(node.dataset.breakAfter === \"always\" ||\n\t\t\t node.dataset.breakAfter === \"page\" ||\n\t\t\t node.dataset.breakAfter === \"left\" ||\n\t\t\t node.dataset.breakAfter === \"right\" ||\n\t\t\t node.dataset.breakAfter === \"recto\" ||\n\t\t\t node.dataset.breakAfter === \"verso\")\n\t\t ) {\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n\nexport function needsPreviousBreakAfter(node) {\n\tif( typeof node !== \"undefined\" &&\n\t\t\ttypeof node.dataset !== \"undefined\" &&\n\t\t\ttypeof node.dataset.previousBreakAfter !== \"undefined\" &&\n\t\t\t(node.dataset.previousBreakAfter === \"always\" ||\n\t\t\t node.dataset.previousBreakAfter === \"page\" ||\n\t\t\t node.dataset.previousBreakAfter === \"left\" ||\n\t\t\t node.dataset.previousBreakAfter === \"right\" ||\n\t\t\t node.dataset.previousBreakAfter === \"recto\" ||\n\t\t\t node.dataset.previousBreakAfter === \"verso\")\n\t\t ) {\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n\nexport function needsPageBreak(node, previousSignificantNode) {\n\tif (typeof node === \"undefined\" || !previousSignificantNode || isIgnorable(node)) {\n\t\treturn false;\n\t}\n\tif (node.dataset && node.dataset.undisplayed) {\n\t\treturn false;\n\t}\n\tlet previousSignificantNodePage = previousSignificantNode.dataset ? previousSignificantNode.dataset.page : undefined;\n\tif (typeof previousSignificantNodePage === \"undefined\") {\n\t\tconst nodeWithNamedPage = getNodeWithNamedPage(previousSignificantNode);\n\t\tif (nodeWithNamedPage) {\n\t\t\tpreviousSignificantNodePage = nodeWithNamedPage.dataset.page;\n\t\t}\n\t}\n\tlet currentNodePage = node.dataset ? node.dataset.page : undefined;\n\tif (typeof currentNodePage === \"undefined\") {\n\t\tconst nodeWithNamedPage = getNodeWithNamedPage(node, previousSignificantNode);\n\t\tif (nodeWithNamedPage) {\n\t\t\tcurrentNodePage = nodeWithNamedPage.dataset.page;\n\t\t}\n\t}\n\treturn currentNodePage !== previousSignificantNodePage;\n}\n\nexport function *words(node) {\n\tlet currentText = node.nodeValue;\n\tlet max = currentText.length;\n\tlet currentOffset = 0;\n\tlet currentLetter;\n\n\tlet range;\n\tconst significantWhitespaces = node.parentElement && node.parentElement.nodeName === \"PRE\";\n\n\twhile (currentOffset < max) {\n\t\tcurrentLetter = currentText[currentOffset];\n\t\tif (/^[\\S\\u202F\\u00A0]$/.test(currentLetter) || significantWhitespaces) {\n\t\t\tif (!range) {\n\t\t\t\trange = document.createRange();\n\t\t\t\trange.setStart(node, currentOffset);\n\t\t\t}\n\t\t} else {\n\t\t\tif (range) {\n\t\t\t\trange.setEnd(node, currentOffset);\n\t\t\t\tyield range;\n\t\t\t\trange = undefined;\n\t\t\t}\n\t\t}\n\n\t\tcurrentOffset += 1;\n\t}\n\n\tif (range) {\n\t\trange.setEnd(node, currentOffset);\n\t\tyield range;\n\t}\n}\n\nexport function *letters(wordRange) {\n\tlet currentText = wordRange.startContainer;\n\tlet max = currentText.length;\n\tlet currentOffset = wordRange.startOffset;\n\t// let currentLetter;\n\n\tlet range;\n\n\twhile(currentOffset < max) {\n\t\t // currentLetter = currentText[currentOffset];\n\t\t range = document.createRange();\n\t\t range.setStart(currentText, currentOffset);\n\t\t range.setEnd(currentText, currentOffset+1);\n\n\t\t yield range;\n\n\t\t currentOffset += 1;\n\t}\n}\n\nexport function isContainer(node) {\n\tlet container;\n\n\tif (typeof node.tagName === \"undefined\") {\n\t\treturn true;\n\t}\n\n\tif (node.style && node.style.display === \"none\") {\n\t\treturn false;\n\t}\n\n\tswitch (node.tagName) {\n\t\t// Inline\n\t\tcase \"A\":\n\t\tcase \"ABBR\":\n\t\tcase \"ACRONYM\":\n\t\tcase \"B\":\n\t\tcase \"BDO\":\n\t\tcase \"BIG\":\n\t\tcase \"BR\":\n\t\tcase \"BUTTON\":\n\t\tcase \"CITE\":\n\t\tcase \"CODE\":\n\t\tcase \"DFN\":\n\t\tcase \"EM\":\n\t\tcase \"I\":\n\t\tcase \"IMG\":\n\t\tcase \"INPUT\":\n\t\tcase \"KBD\":\n\t\tcase \"LABEL\":\n\t\tcase \"MAP\":\n\t\tcase \"OBJECT\":\n\t\tcase \"Q\":\n\t\tcase \"SAMP\":\n\t\tcase \"SCRIPT\":\n\t\tcase \"SELECT\":\n\t\tcase \"SMALL\":\n\t\tcase \"SPAN\":\n\t\tcase \"STRONG\":\n\t\tcase \"SUB\":\n\t\tcase \"SUP\":\n\t\tcase \"TEXTAREA\":\n\t\tcase \"TIME\":\n\t\tcase \"TT\":\n\t\tcase \"VAR\":\n\t\tcase \"P\":\n\t\tcase \"H1\":\n\t\tcase \"H2\":\n\t\tcase \"H3\":\n\t\tcase \"H4\":\n\t\tcase \"H5\":\n\t\tcase \"H6\":\n\t\tcase \"FIGCAPTION\":\n\t\tcase \"BLOCKQUOTE\":\n\t\tcase \"PRE\":\n\t\tcase \"LI\":\n\t\tcase \"TD\":\n\t\tcase \"DT\":\n\t\tcase \"DD\":\n\t\tcase \"VIDEO\":\n\t\tcase \"CANVAS\":\n\t\t\tcontainer = false;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tcontainer = true;\n\t}\n\n\treturn container;\n}\n\nexport function cloneNode(n, deep=false) {\n\treturn n.cloneNode(deep);\n}\n\nexport function findElement(node, doc, forceQuery) {\n\tconst ref = node.getAttribute(\"data-ref\");\n\treturn findRef(ref, doc, forceQuery);\n}\n\nexport function findRef(ref, doc, forceQuery) {\n\tif (!forceQuery && doc.indexOfRefs && doc.indexOfRefs[ref]) {\n\t\treturn doc.indexOfRefs[ref];\n\t} else {\n\t\treturn doc.querySelector(`[data-ref='${ref}']`);\n\t}\n}\n\nexport function validNode(node) {\n\tif (isText(node)) {\n\t\treturn true;\n\t}\n\n\tif (isElement(node) && node.dataset.ref) {\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n\nexport function prevValidNode(node) {\n\twhile (!validNode(node)) {\n\t\tif (node.previousSibling) {\n\t\t\tnode = node.previousSibling;\n\t\t} else {\n\t\t\tnode = node.parentNode;\n\t\t}\n\n\t\tif (!node) {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn node;\n}\n\nexport function nextValidNode(node) {\n\twhile (!validNode(node)) {\n\t\tif (node.nextSibling) {\n\t\t\tnode = node.nextSibling;\n\t\t} else {\n\t\t\tnode = node.parentNode.nextSibling;\n\t\t}\n\n\t\tif (!node) {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn node;\n}\n\n\nexport function indexOf(node) {\n\tlet parent = node.parentNode;\n\tif (!parent) {\n\t\treturn 0;\n\t}\n\treturn Array.prototype.indexOf.call(parent.childNodes, node);\n}\n\nexport function child(node, index) {\n\treturn node.childNodes[index];\n}\n\nexport function isVisible(node) {\n\tif (isElement(node) && window.getComputedStyle(node).display !== \"none\") {\n\t\treturn true;\n\t} else if (isText(node) &&\n\t\t\thasTextContent(node) &&\n\t\t\twindow.getComputedStyle(node.parentNode).display !== \"none\") {\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport function hasContent(node) {\n\tif (isElement(node)) {\n\t\treturn true;\n\t} else if (isText(node) &&\n\t\t\tnode.textContent.trim().length) {\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport function hasTextContent(node) {\n\tif (isElement(node)) {\n\t\tlet child;\n\t\tfor (var i = 0; i < node.childNodes.length; i++) {\n\t\t\tchild = node.childNodes[i];\n\t\t\tif (child && isText(child) && child.textContent.trim().length) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t} else if (isText(node) &&\n\t\t\tnode.textContent.trim().length) {\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport function indexOfTextNode(node, parent) {\n\tif (!isText(node)) {\n\t\treturn -1;\n\t}\n\tlet nodeTextContent = node.textContent;\n\tlet child;\n\tlet index = -1;\n\tfor (var i = 0; i < parent.childNodes.length; i++) {\n\t\tchild = parent.childNodes[i];\n\t\tif (child.nodeType === 3) {\n\t\t\tlet text = parent.childNodes[i].textContent;\n\t\t\tif (text.includes(nodeTextContent)) {\n\t\t\t\tindex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn index;\n}\n\n\n/**\n * Throughout, whitespace is defined as one of the characters\n *  \"\\t\" TAB \\u0009\n *  \"\\n\" LF  \\u000A\n *  \"\\r\" CR  \\u000D\n *  \" \"  SPC \\u0020\n *\n * This does not use Javascript's \"\\s\" because that includes non-breaking\n * spaces (and also some other characters).\n */\n\n/**\n * Determine if a node should be ignored by the iterator functions.\n * taken from https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model/Whitespace#Whitespace_helper_functions\n *\n * @param {Node} node An object implementing the DOM1 |Node| interface.\n * @return {boolean} true if the node is:\n *  1) A |Text| node that is all whitespace\n *  2) A |Comment| node\n *  and otherwise false.\n */\nexport function isIgnorable(node) {\n\treturn (node.nodeType === 8) || // A comment node\n\t\t((node.nodeType === 3) && isAllWhitespace(node)); // a text node, all whitespace\n}\n\n/**\n * Determine whether a node's text content is entirely whitespace.\n *\n * @param {Node} node  A node implementing the |CharacterData| interface (i.e., a |Text|, |Comment|, or |CDATASection| node\n * @return {boolean} true if all of the text content of |nod| is whitespace, otherwise false.\n */\nexport function isAllWhitespace(node) {\n\treturn !(/[^\\t\\n\\r ]/.test(node.textContent));\n}\n\n/**\n * Version of |previousSibling| that skips nodes that are entirely\n * whitespace or comments.  (Normally |previousSibling| is a property\n * of all DOM nodes that gives the sibling node, the node that is\n * a child of the same parent, that occurs immediately before the\n * reference node.)\n *\n * @param {ChildNode} sib  The reference node.\n * @return {Node|null} Either:\n *  1) The closest previous sibling to |sib| that is not ignorable according to |is_ignorable|, or\n *  2) null if no such node exists.\n */\nexport function previousSignificantNode(sib) {\n\twhile ((sib = sib.previousSibling)) {\n\t\tif (!isIgnorable(sib)) return sib;\n\t}\n\treturn null;\n}\n\nfunction getNodeWithNamedPage(node, limiter) {\n\tif (node && node.dataset && node.dataset.page) {\n\t\treturn node;\n\t}\n\tif (node.parentNode) {\n\t\twhile ((node = node.parentNode)) {\n\t\t\tif (limiter && node === limiter) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (node.dataset && node.dataset.page) {\n\t\t\t\treturn node;\n\t\t\t}\n\t\t}\n\t}\n\treturn null;\n}\n\nexport function breakInsideAvoidParentNode(node) {\n\twhile ((node = node.parentNode)) {\n\t\tif (node && node.dataset && node.dataset.breakInside === \"avoid\") {\n\t\t\treturn node;\n\t\t}\n\t}\n\treturn null;\n}\n\n/**\n * Find a parent with a given node name.\n * @param {Node} node - initial Node\n * @param {string} nodeName - node name (eg. \"TD\", \"TABLE\", \"STRONG\"...)\n * @param {Node} limiter - go up to the parent until there's no more parent or the current node is equals to the limiter\n * @returns {Node|undefined} - Either:\n *  1) The closest parent for a the given node name, or\n *  2) undefined if no such node exists.\n */\nexport function parentOf(node, nodeName, limiter) {\n\tif (limiter && node === limiter) {\n\t\treturn;\n\t}\n\tif (node.parentNode) {\n\t\twhile ((node = node.parentNode)) {\n\t\t\tif (limiter && node === limiter) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (node.nodeName === nodeName) {\n\t\t\t\treturn node;\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * Version of |nextSibling| that skips nodes that are entirely\n * whitespace or comments.\n *\n * @param {ChildNode} sib  The reference node.\n * @return {Node|null} Either:\n *  1) The closest next sibling to |sib| that is not ignorable according to |is_ignorable|, or\n *  2) null if no such node exists.\n */\nexport function nextSignificantNode(sib) {\n\twhile ((sib = sib.nextSibling)) {\n\t\tif (!isIgnorable(sib)) return sib;\n\t}\n\treturn null;\n}\n\nexport function filterTree(content, func, what) {\n\tconst treeWalker = document.createTreeWalker(\n\t\tcontent || this.dom,\n\t\twhat || NodeFilter.SHOW_ALL,\n\t\tfunc ? { acceptNode: func } : null,\n\t\tfalse\n\t);\n\n\tlet node;\n\tlet current;\n\tnode = treeWalker.nextNode();\n\twhile(node) {\n\t\tcurrent = node;\n\t\tnode = treeWalker.nextNode();\n\t\tcurrent.parentNode.removeChild(current);\n\t}\n}\n","import {\n\tisElement\n} from \"../utils/dom.js\";\n\n/**\n * BreakToken\n * @class\n */\nclass BreakToken {\n\n\tconstructor(node, offset) {\n\t\tthis.node = node;\n\t\tthis.offset = offset;\n\t}\n\n\tequals(otherBreakToken) {\n\t\tif (!otherBreakToken) {\n\t\t\treturn false;\n\t\t}\n\t\tif (this[\"node\"] && otherBreakToken[\"node\"] &&\n\t\t\tthis[\"node\"] !== otherBreakToken[\"node\"]) {\n\t\t\treturn false;\n\t\t}\n\t\tif (this[\"offset\"] && otherBreakToken[\"offset\"] &&\n\t\t\tthis[\"offset\"] !== otherBreakToken[\"offset\"]) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\ttoJSON(hash) {\n\t\tlet node;\n\t\tlet index = 0;\n\t\tif (!this.node) {\n\t\t\treturn {};\n\t\t}\n\t\tif (isElement(this.node) && this.node.dataset.ref) {\n\t\t\tnode = this.node.dataset.ref;\n\t\t} else if (hash) {\n\t\t\tnode = this.node.parentElement.dataset.ref;\n\t\t}\n\n\t\tif (this.node.parentElement) {\n\t\t\tconst children = Array.from(this.node.parentElement.childNodes);\n\t\t\tindex = children.indexOf(this.node);\n\t\t}\n\n\t\treturn JSON.stringify({\n\t\t\t\"node\": node,\n\t\t\t\"index\" : index,\n\t\t\t\"offset\": this.offset\n\t\t});\n\t}\n\n}\n\nexport default BreakToken;","/**\n * Render result.\n * @class\n */\nclass RenderResult {\n\n\tconstructor(breakToken, error) {\n\t\tthis.breakToken = breakToken;\n\t\tthis.error = error;\n\t}\n}\n\nexport class OverflowContentError extends Error {\n\tconstructor(message, items) {\n\t\tsuper(message);\n\t\tthis.items = items;\n\t}\n}\n\nexport default RenderResult;\n","\"use strict\";\n\n// ES3 safe\nvar _undefined = void 0;\n\nmodule.exports = function (value) { return value !== _undefined && value !== null; };\n","\"use strict\";\n\nvar isValue = require(\"../value/is\");\n\n// prettier-ignore\nvar possibleTypes = { \"object\": true, \"function\": true, \"undefined\": true /* document.all */ };\n\nmodule.exports = function (value) {\n\tif (!isValue(value)) return false;\n\treturn hasOwnProperty.call(possibleTypes, typeof value);\n};\n","\"use strict\";\n\nvar isObject = require(\"../object/is\");\n\nmodule.exports = function (value) {\n\tif (!isObject(value)) return false;\n\ttry {\n\t\tif (!value.constructor) return false;\n\t\treturn value.constructor.prototype === value;\n\t} catch (error) {\n\t\treturn false;\n\t}\n};\n","\"use strict\";\n\nvar isPrototype = require(\"../prototype/is\");\n\nmodule.exports = function (value) {\n\tif (typeof value !== \"function\") return false;\n\n\tif (!hasOwnProperty.call(value, \"length\")) return false;\n\n\ttry {\n\t\tif (typeof value.length !== \"number\") return false;\n\t\tif (typeof value.call !== \"function\") return false;\n\t\tif (typeof value.apply !== \"function\") return false;\n\t} catch (error) {\n\t\treturn false;\n\t}\n\n\treturn !isPrototype(value);\n};\n","\"use strict\";\n\nvar isFunction = require(\"../function/is\");\n\nvar classRe = /^\\s*class[\\s{/}]/, functionToString = Function.prototype.toString;\n\nmodule.exports = function (value) {\n\tif (!isFunction(value)) return false;\n\tif (classRe.test(functionToString.call(value))) return false;\n\treturn true;\n};\n","\"use strict\";\n\nmodule.exports = function () {\n\tvar assign = Object.assign, obj;\n\tif (typeof assign !== \"function\") return false;\n\tobj = { foo: \"raz\" };\n\tassign(obj, { bar: \"dwa\" }, { trzy: \"trzy\" });\n\treturn obj.foo + obj.bar + obj.trzy === \"razdwatrzy\";\n};\n","\"use strict\";\n\nmodule.exports = function () {\n\ttry {\n\t\tObject.keys(\"primitive\");\n\t\treturn true;\n\t} catch (e) {\n\t\treturn false;\n\t}\n};\n","\"use strict\";\n\n// eslint-disable-next-line no-empty-function\nmodule.exports = function () {};\n","\"use strict\";\n\nvar _undefined = require(\"../function/noop\")(); // Support ES3 engines\n\nmodule.exports = function (val) { return val !== _undefined && val !== null; };\n","\"use strict\";\n\nvar isValue = require(\"../is-value\");\n\nvar keys = Object.keys;\n\nmodule.exports = function (object) { return keys(isValue(object) ? Object(object) : object); };\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? Object.keys : require(\"./shim\");\n","\"use strict\";\n\nvar isValue = require(\"./is-value\");\n\nmodule.exports = function (value) {\n\tif (!isValue(value)) throw new TypeError(\"Cannot use null or undefined\");\n\treturn value;\n};\n","\"use strict\";\n\nvar keys  = require(\"../keys\")\n  , value = require(\"../valid-value\")\n  , max   = Math.max;\n\nmodule.exports = function (dest, src /*, …srcn*/) {\n\tvar error, i, length = max(arguments.length, 2), assign;\n\tdest = Object(value(dest));\n\tassign = function (key) {\n\t\ttry {\n\t\t\tdest[key] = src[key];\n\t\t} catch (e) {\n\t\t\tif (!error) error = e;\n\t\t}\n\t};\n\tfor (i = 1; i < length; ++i) {\n\t\tsrc = arguments[i];\n\t\tkeys(src).forEach(assign);\n\t}\n\tif (error !== undefined) throw error;\n\treturn dest;\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? Object.assign : require(\"./shim\");\n","\"use strict\";\n\nvar isValue = require(\"./is-value\");\n\nvar forEach = Array.prototype.forEach, create = Object.create;\n\nvar process = function (src, obj) {\n\tvar key;\n\tfor (key in src) obj[key] = src[key];\n};\n\n// eslint-disable-next-line no-unused-vars\nmodule.exports = function (opts1 /*, …options*/) {\n\tvar result = create(null);\n\tforEach.call(arguments, function (options) {\n\t\tif (!isValue(options)) return;\n\t\tprocess(Object(options), result);\n\t});\n\treturn result;\n};\n","\"use strict\";\n\nvar str = \"razdwatrzy\";\n\nmodule.exports = function () {\n\tif (typeof str.contains !== \"function\") return false;\n\treturn str.contains(\"dwa\") === true && str.contains(\"foo\") === false;\n};\n","\"use strict\";\n\nvar indexOf = String.prototype.indexOf;\n\nmodule.exports = function (searchString /*, position*/) {\n\treturn indexOf.call(this, searchString, arguments[1]) > -1;\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? String.prototype.contains : require(\"./shim\");\n","\"use strict\";\n\nvar isValue         = require(\"type/value/is\")\n  , isPlainFunction = require(\"type/plain-function/is\")\n  , assign          = require(\"es5-ext/object/assign\")\n  , normalizeOpts   = require(\"es5-ext/object/normalize-options\")\n  , contains        = require(\"es5-ext/string/#/contains\");\n\nvar d = (module.exports = function (dscr, value/*, options*/) {\n\tvar c, e, w, options, desc;\n\tif (arguments.length < 2 || typeof dscr !== \"string\") {\n\t\toptions = value;\n\t\tvalue = dscr;\n\t\tdscr = null;\n\t} else {\n\t\toptions = arguments[2];\n\t}\n\tif (isValue(dscr)) {\n\t\tc = contains.call(dscr, \"c\");\n\t\te = contains.call(dscr, \"e\");\n\t\tw = contains.call(dscr, \"w\");\n\t} else {\n\t\tc = w = true;\n\t\te = false;\n\t}\n\n\tdesc = { value: value, configurable: c, enumerable: e, writable: w };\n\treturn !options ? desc : assign(normalizeOpts(options), desc);\n});\n\nd.gs = function (dscr, get, set/*, options*/) {\n\tvar c, e, options, desc;\n\tif (typeof dscr !== \"string\") {\n\t\toptions = set;\n\t\tset = get;\n\t\tget = dscr;\n\t\tdscr = null;\n\t} else {\n\t\toptions = arguments[3];\n\t}\n\tif (!isValue(get)) {\n\t\tget = undefined;\n\t} else if (!isPlainFunction(get)) {\n\t\toptions = get;\n\t\tget = set = undefined;\n\t} else if (!isValue(set)) {\n\t\tset = undefined;\n\t} else if (!isPlainFunction(set)) {\n\t\toptions = set;\n\t\tset = undefined;\n\t}\n\tif (isValue(dscr)) {\n\t\tc = contains.call(dscr, \"c\");\n\t\te = contains.call(dscr, \"e\");\n\t} else {\n\t\tc = true;\n\t\te = false;\n\t}\n\n\tdesc = { get: get, set: set, configurable: c, enumerable: e };\n\treturn !options ? desc : assign(normalizeOpts(options), desc);\n};\n","\"use strict\";\n\nmodule.exports = function (fn) {\n\tif (typeof fn !== \"function\") throw new TypeError(fn + \" is not a function\");\n\treturn fn;\n};\n","'use strict';\n\nvar d        = require('d')\n  , callable = require('es5-ext/object/valid-callable')\n\n  , apply = Function.prototype.apply, call = Function.prototype.call\n  , create = Object.create, defineProperty = Object.defineProperty\n  , defineProperties = Object.defineProperties\n  , hasOwnProperty = Object.prototype.hasOwnProperty\n  , descriptor = { configurable: true, enumerable: false, writable: true }\n\n  , on, once, off, emit, methods, descriptors, base;\n\non = function (type, listener) {\n\tvar data;\n\n\tcallable(listener);\n\n\tif (!hasOwnProperty.call(this, '__ee__')) {\n\t\tdata = descriptor.value = create(null);\n\t\tdefineProperty(this, '__ee__', descriptor);\n\t\tdescriptor.value = null;\n\t} else {\n\t\tdata = this.__ee__;\n\t}\n\tif (!data[type]) data[type] = listener;\n\telse if (typeof data[type] === 'object') data[type].push(listener);\n\telse data[type] = [data[type], listener];\n\n\treturn this;\n};\n\nonce = function (type, listener) {\n\tvar once, self;\n\n\tcallable(listener);\n\tself = this;\n\ton.call(this, type, once = function () {\n\t\toff.call(self, type, once);\n\t\tapply.call(listener, this, arguments);\n\t});\n\n\tonce.__eeOnceListener__ = listener;\n\treturn this;\n};\n\noff = function (type, listener) {\n\tvar data, listeners, candidate, i;\n\n\tcallable(listener);\n\n\tif (!hasOwnProperty.call(this, '__ee__')) return this;\n\tdata = this.__ee__;\n\tif (!data[type]) return this;\n\tlisteners = data[type];\n\n\tif (typeof listeners === 'object') {\n\t\tfor (i = 0; (candidate = listeners[i]); ++i) {\n\t\t\tif ((candidate === listener) ||\n\t\t\t\t\t(candidate.__eeOnceListener__ === listener)) {\n\t\t\t\tif (listeners.length === 2) data[type] = listeners[i ? 0 : 1];\n\t\t\t\telse listeners.splice(i, 1);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif ((listeners === listener) ||\n\t\t\t\t(listeners.__eeOnceListener__ === listener)) {\n\t\t\tdelete data[type];\n\t\t}\n\t}\n\n\treturn this;\n};\n\nemit = function (type) {\n\tvar i, l, listener, listeners, args;\n\n\tif (!hasOwnProperty.call(this, '__ee__')) return;\n\tlisteners = this.__ee__[type];\n\tif (!listeners) return;\n\n\tif (typeof listeners === 'object') {\n\t\tl = arguments.length;\n\t\targs = new Array(l - 1);\n\t\tfor (i = 1; i < l; ++i) args[i - 1] = arguments[i];\n\n\t\tlisteners = listeners.slice();\n\t\tfor (i = 0; (listener = listeners[i]); ++i) {\n\t\t\tapply.call(listener, this, args);\n\t\t}\n\t} else {\n\t\tswitch (arguments.length) {\n\t\tcase 1:\n\t\t\tcall.call(listeners, this);\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tcall.call(listeners, this, arguments[1]);\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\tcall.call(listeners, this, arguments[1], arguments[2]);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tl = arguments.length;\n\t\t\targs = new Array(l - 1);\n\t\t\tfor (i = 1; i < l; ++i) {\n\t\t\t\targs[i - 1] = arguments[i];\n\t\t\t}\n\t\t\tapply.call(listeners, this, args);\n\t\t}\n\t}\n};\n\nmethods = {\n\ton: on,\n\tonce: once,\n\toff: off,\n\temit: emit\n};\n\ndescriptors = {\n\ton: d(on),\n\tonce: d(once),\n\toff: d(off),\n\temit: d(emit)\n};\n\nbase = defineProperties({}, descriptors);\n\nmodule.exports = exports = function (o) {\n\treturn (o == null) ? create(base) : defineProperties(Object(o), descriptors);\n};\nexports.methods = methods;\n","/**\n * Hooks allow for injecting functions that must all complete in order before finishing\n * They will execute in parallel but all must finish before continuing\n * Functions may return a promise if they are asycn.\n * From epubjs/src/utils/hooks\n * @param {any} context scope of this\n * @example this.content = new Hook(this);\n */\nclass Hook {\n\tconstructor(context){\n\t\tthis.context = context || this;\n\t\tthis.hooks = [];\n\t}\n\n\t/**\n\t * Adds a function to be run before a hook completes\n\t * @example this.content.register(function(){...});\n\t * @return {undefined} void\n\t */\n\tregister(){\n\t\tfor(var i = 0; i < arguments.length; ++i) {\n\t\t\tif (typeof arguments[i]  === \"function\") {\n\t\t\t\tthis.hooks.push(arguments[i]);\n\t\t\t} else {\n\t\t\t\t// unpack array\n\t\t\t\tfor(var j = 0; j < arguments[i].length; ++j) {\n\t\t\t\t\tthis.hooks.push(arguments[i][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Triggers a hook to run all functions\n\t * @example this.content.trigger(args).then(function(){...});\n\t * @return {Promise} results\n\t */\n\ttrigger(){\n\t\tvar args = arguments;\n\t\tvar context = this.context;\n\t\tvar promises = [];\n\n\t\tthis.hooks.forEach(function(task) {\n\t\t\tvar executing = task.apply(context, args);\n\n\t\t\tif(executing && typeof executing[\"then\"] === \"function\") {\n\t\t\t\t// Task is a function that returns a promise\n\t\t\t\tpromises.push(executing);\n\t\t\t} else {\n\t\t\t\t// Otherwise Task resolves immediately, add resolved promise with result\n\t\t\t\tpromises.push(new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(executing);\n\t\t\t\t}));\n\t\t\t}\n\t\t});\n\n\n\t\treturn Promise.all(promises);\n\t}\n\n\t/**\n   * Triggers a hook to run all functions synchronously\n   * @example this.content.trigger(args).then(function(){...});\n   * @return {Array} results\n   */\n\ttriggerSync(){\n\t\tvar args = arguments;\n\t\tvar context = this.context;\n\t\tvar results = [];\n\n\t\tthis.hooks.forEach(function(task) {\n\t\t\tvar executing = task.apply(context, args);\n\n\t\t\tresults.push(executing);\n\t\t});\n\n\n\t\treturn results;\n\t}\n\n\t// Adds a function to be run before a hook completes\n\tlist(){\n\t\treturn this.hooks;\n\t}\n\n\tclear(){\n\t\treturn this.hooks = [];\n\t}\n}\nexport default Hook;\n","import { getBoundingClientRect, getClientRects } from \"../utils/utils.js\";\nimport {\n\tbreakInsideAvoidParentNode,\n\tchild,\n\tcloneNode,\n\tfindElement,\n\thasContent,\n\tindexOf,\n\tindexOfTextNode,\n\tisContainer,\n\tisElement,\n\tisText,\n\tletters,\n\tneedsBreakBefore,\n\tneedsPageBreak,\n\tneedsPreviousBreakAfter,\n\tnodeAfter,\n\tnodeBefore,\n\tparentOf,\n\tprevValidNode,\n\trebuildAncestors,\n\tvalidNode,\n\twalk,\n\twords\n} from \"../utils/dom.js\";\nimport BreakToken from \"./breaktoken.js\";\nimport RenderResult, { OverflowContentError } from \"./renderresult.js\";\nimport EventEmitter from \"event-emitter\";\nimport Hook from \"../utils/hook.js\";\n\nconst MAX_CHARS_PER_BREAK = 1500;\n\n/**\n * Layout\n * @class\n */\nclass Layout {\n\n\tconstructor(element, hooks, options) {\n\t\tthis.element = element;\n\n\t\tthis.bounds = this.element.getBoundingClientRect();\n\t\tthis.parentBounds = this.element.offsetParent.getBoundingClientRect();\n\t\tlet gap = parseFloat(window.getComputedStyle(this.element).columnGap);\n\t\n\t\tif (gap) {\n\t\t\tlet leftMargin = this.bounds.left - this.parentBounds.left;\n\t\t\tthis.gap =  gap - leftMargin;\t\n\t\t} else {\n\t\t\tthis.gap = 0;\n\t\t}\n\n\t\tif (hooks) {\n\t\t\tthis.hooks = hooks;\n\t\t} else {\n\t\t\tthis.hooks = {};\n\t\t\tthis.hooks.onPageLayout = new Hook();\n\t\t\tthis.hooks.layout = new Hook();\n\t\t\tthis.hooks.renderNode = new Hook();\n\t\t\tthis.hooks.layoutNode = new Hook();\n\t\t\tthis.hooks.beforeOverflow = new Hook();\n\t\t\tthis.hooks.onOverflow = new Hook();\n\t\t\tthis.hooks.afterOverflowRemoved = new Hook();\n\t\t\tthis.hooks.onBreakToken = new Hook();\n\t\t\tthis.hooks.beforeRenderResult = new Hook();\n\t\t}\n\n\t\tthis.settings = options || {};\n\n\t\tthis.maxChars = this.settings.maxChars || MAX_CHARS_PER_BREAK;\n\t\tthis.forceRenderBreak = false;\n\t}\n\n\tasync renderTo(wrapper, source, breakToken, bounds = this.bounds) {\n\t\tlet start = this.getStart(source, breakToken);\n\t\tlet walker = walk(start, source);\n\n\t\tlet node;\n\t\tlet prevNode;\n\t\tlet done;\n\t\tlet next;\n\n\t\tlet hasRenderedContent = false;\n\t\tlet newBreakToken;\n\n\t\tlet length = 0;\n\n\t\tlet prevBreakToken = breakToken || new BreakToken(start);\n\n\t\tthis.hooks && this.hooks.onPageLayout.trigger(wrapper, prevBreakToken, this);\n\n\t\twhile (!done && !newBreakToken) {\n\t\t\tnext = walker.next();\n\t\t\tprevNode = node;\n\t\t\tnode = next.value;\n\t\t\tdone = next.done;\n\n\t\t\tif (!node) {\n\t\t\t\tthis.hooks && this.hooks.layout.trigger(wrapper, this);\n\n\t\t\t\tlet imgs = wrapper.querySelectorAll(\"img\");\n\t\t\t\tif (imgs.length) {\n\t\t\t\t\tawait this.waitForImages(imgs);\n\t\t\t\t}\n\n\t\t\t\tnewBreakToken = this.findBreakToken(wrapper, source, bounds, prevBreakToken);\n\n\t\t\t\tif (newBreakToken && newBreakToken.equals(prevBreakToken)) {\n\t\t\t\t\tconsole.warn(\"Unable to layout item: \", prevNode);\n\t\t\t\t\tthis.hooks && this.hooks.beforeRenderResult.trigger(undefined, wrapper, this);\n\t\t\t\t\treturn new RenderResult(undefined, new OverflowContentError(\"Unable to layout item\", [prevNode]));\n\t\t\t\t}\n\n\t\t\t\tthis.rebuildTableFromBreakToken(newBreakToken, wrapper);\n\n\t\t\t\tthis.hooks && this.hooks.beforeRenderResult.trigger(newBreakToken, wrapper, this);\n\t\t\t\treturn new RenderResult(newBreakToken);\n\t\t\t}\n\n\t\t\tthis.hooks && this.hooks.layoutNode.trigger(node);\n\n\t\t\t// Check if the rendered element has a break set\n\t\t\tif (hasRenderedContent && this.shouldBreak(node, start)) {\n\t\t\t\tthis.hooks && this.hooks.layout.trigger(wrapper, this);\n\n\t\t\t\tlet imgs = wrapper.querySelectorAll(\"img\");\n\t\t\t\tif (imgs.length) {\n\t\t\t\t\tawait this.waitForImages(imgs);\n\t\t\t\t}\n\n\t\t\t\tnewBreakToken = this.findBreakToken(wrapper, source, bounds, prevBreakToken);\n\n\t\t\t\tif (!newBreakToken) {\n\t\t\t\t\tnewBreakToken = this.breakAt(node);\n\t\t\t\t} else {\n\t\t\t\t\tthis.rebuildTableFromBreakToken(newBreakToken, wrapper);\n\t\t\t\t}\n\n\t\t\t\tif (newBreakToken && newBreakToken.equals(prevBreakToken)) {\n\t\t\t\t\tconsole.warn(\"Unable to layout item: \", node);\n\t\t\t\t\tlet after = newBreakToken.node && nodeAfter(newBreakToken.node);\n\t\t\t\t\tif (after) {\n\t\t\t\t\t\tnewBreakToken = new BreakToken(after);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn new RenderResult(undefined, new OverflowContentError(\"Unable to layout item\", [node]));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlength = 0;\n\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (node.dataset && node.dataset.page) {\n\t\t\t\tlet named = node.dataset.page;\n\t\t\t\tlet page = this.element.closest(\".pagedjs_page\");\n\t\t\t\tpage.classList.add(\"pagedjs_named_page\");\n\t\t\t\tpage.classList.add(\"pagedjs_\" + named + \"_page\");\n\n\t\t\t\tif (!node.dataset.splitFrom) {\n\t\t\t\t\tpage.classList.add(\"pagedjs_\" + named + \"_first_page\");\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Should the Node be a shallow or deep clone\n\t\t\tlet shallow = isContainer(node);\n\n\t\t\tlet rendered = this.append(node, wrapper, breakToken, shallow);\n\n\t\t\tlength += rendered.textContent.length;\n\n\t\t\t// Check if layout has content yet\n\t\t\tif (!hasRenderedContent) {\n\t\t\t\thasRenderedContent = hasContent(node);\n\t\t\t}\n\n\t\t\t// Skip to the next node if a deep clone was rendered\n\t\t\tif (!shallow) {\n\t\t\t\twalker = walk(nodeAfter(node, source), source);\n\t\t\t}\n\n\t\t\tif (this.forceRenderBreak) {\n\t\t\t\tthis.hooks && this.hooks.layout.trigger(wrapper, this);\n\n\t\t\t\tnewBreakToken = this.findBreakToken(wrapper, source, bounds, prevBreakToken);\n\n\t\t\t\tif (!newBreakToken) {\n\t\t\t\t\tnewBreakToken = this.breakAt(node);\n\t\t\t\t} else {\n\t\t\t\t\tthis.rebuildTableFromBreakToken(newBreakToken, wrapper);\n\t\t\t\t}\n\n\t\t\t\tlength = 0;\n\t\t\t\tthis.forceRenderBreak = false;\n\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// Only check x characters\n\t\t\tif (length >= this.maxChars) {\n\n\t\t\t\tthis.hooks && this.hooks.layout.trigger(wrapper, this);\n\n\t\t\t\tlet imgs = wrapper.querySelectorAll(\"img\");\n\t\t\t\tif (imgs.length) {\n\t\t\t\t\tawait this.waitForImages(imgs);\n\t\t\t\t}\n\n\t\t\t\tnewBreakToken = this.findBreakToken(wrapper, source, bounds, prevBreakToken);\n\n\t\t\t\tif (newBreakToken) {\n\t\t\t\t\tlength = 0;\n\t\t\t\t\tthis.rebuildTableFromBreakToken(newBreakToken, wrapper);\n\t\t\t\t}\n\n\t\t\t\tif (newBreakToken && newBreakToken.equals(prevBreakToken)) {\n\t\t\t\t\tconsole.warn(\"Unable to layout item: \", node);\n\t\t\t\t\tlet after = newBreakToken.node && nodeAfter(newBreakToken.node);\n\t\t\t\t\tif (after) {\n\t\t\t\t\t\tnewBreakToken = new BreakToken(after);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.hooks && this.hooks.beforeRenderResult.trigger(undefined, wrapper, this);\n\t\t\t\t\t\treturn new RenderResult(undefined, new OverflowContentError(\"Unable to layout item\", [node]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\tthis.hooks && this.hooks.beforeRenderResult.trigger(newBreakToken, wrapper, this);\n\t\treturn new RenderResult(newBreakToken);\n\t}\n\n\tbreakAt(node, offset = 0) {\n\t\tlet newBreakToken = new BreakToken(\n\t\t\tnode,\n\t\t\toffset\n\t\t);\n\t\tlet breakHooks = this.hooks.onBreakToken.triggerSync(newBreakToken, undefined, node, this);\n\t\tbreakHooks.forEach((newToken) => {\n\t\t\tif (typeof newToken != \"undefined\") {\n\t\t\t\tnewBreakToken = newToken;\n\t\t\t}\n\t\t});\n\n\t\treturn newBreakToken;\n\t}\n\n\tshouldBreak(node, limiter) {\n\t\tlet previousNode = nodeBefore(node, limiter);\n\t\tlet parentNode = node.parentNode;\n\t\tlet parentBreakBefore = needsBreakBefore(node) && parentNode && !previousNode && needsBreakBefore(parentNode);\n\t\tlet doubleBreakBefore;\n\n\t\tif (parentBreakBefore) {\n\t\t\tdoubleBreakBefore = node.dataset.breakBefore === parentNode.dataset.breakBefore;\n\t\t}\n\n\t\treturn !doubleBreakBefore && needsBreakBefore(node) || needsPreviousBreakAfter(node) || needsPageBreak(node, previousNode);\n\t}\n\n\tforceBreak() {\n\t\tthis.forceRenderBreak = true;\n\t}\n\n\tgetStart(source, breakToken) {\n\t\tlet start;\n\t\tlet node = breakToken && breakToken.node;\n\n\t\tif (node) {\n\t\t\tstart = node;\n\t\t} else {\n\t\t\tstart = source.firstChild;\n\t\t}\n\n\t\treturn start;\n\t}\n\n\tappend(node, dest, breakToken, shallow = true, rebuild = true) {\n\n\t\tlet clone = cloneNode(node, !shallow);\n\n\t\tif (node.parentNode && isElement(node.parentNode)) {\n\t\t\tlet parent = findElement(node.parentNode, dest);\n\t\t\t// Rebuild chain\n\t\t\tif (parent) {\n\t\t\t\tparent.appendChild(clone);\n\t\t\t} else if (rebuild) {\n\t\t\t\tlet fragment = rebuildAncestors(node);\n\t\t\t\tparent = findElement(node.parentNode, fragment);\n\t\t\t\tif (!parent) {\n\t\t\t\t\tdest.appendChild(clone);\n\t\t\t\t} else if (breakToken && isText(breakToken.node) && breakToken.offset > 0) {\n\t\t\t\t\tclone.textContent = clone.textContent.substring(breakToken.offset);\n\t\t\t\t\tparent.appendChild(clone);\n\t\t\t\t} else {\n\t\t\t\t\tparent.appendChild(clone);\n\t\t\t\t}\n\n\t\t\t\tdest.appendChild(fragment);\n\t\t\t} else {\n\t\t\t\tdest.appendChild(clone);\n\t\t\t}\n\n\n\t\t} else {\n\t\t\tdest.appendChild(clone);\n\t\t}\n\n\t\tif (clone.dataset && clone.dataset.ref) {\n\t\t\tif (!dest.indexOfRefs) {\n\t\t\t\tdest.indexOfRefs = {};\n\t\t\t}\n\t\t\tdest.indexOfRefs[clone.dataset.ref] = clone;\n\t\t}\n\n\t\tlet nodeHooks = this.hooks.renderNode.triggerSync(clone, node, this);\n\t\tnodeHooks.forEach((newNode) => {\n\t\t\tif (typeof newNode != \"undefined\") {\n\t\t\t\tclone = newNode;\n\t\t\t}\n\t\t});\n\n\t\treturn clone;\n\t}\n\n\trebuildTableFromBreakToken(breakToken, dest) {\n\t\tif (!breakToken || !breakToken.node) {\n\t\t\treturn;\n\t\t}\n\t\tlet node = breakToken.node;\n\t\tlet td = isElement(node) ? node.closest(\"td\") : node.parentElement.closest(\"td\");\n\t\tif (td) {\n\t\t\tlet rendered = findElement(td, dest, true);\n\t\t\tif (!rendered) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\twhile ((td = td.nextElementSibling)) {\n\t\t\t\tthis.append(td, dest, null, true);\n\t\t\t}\n\t\t}\n\t}\n\n\tasync waitForImages(imgs) {\n\t\tlet results = Array.from(imgs).map(async (img) => {\n\t\t\treturn this.awaitImageLoaded(img);\n\t\t});\n\t\tawait Promise.all(results);\n\t}\n\n\tasync awaitImageLoaded(image) {\n\t\treturn new Promise(resolve => {\n\t\t\tif (image.complete !== true) {\n\t\t\t\timage.onload = function () {\n\t\t\t\t\tlet {width, height} = window.getComputedStyle(image);\n\t\t\t\t\tresolve(width, height);\n\t\t\t\t};\n\t\t\t\timage.onerror = function (e) {\n\t\t\t\t\tlet {width, height} = window.getComputedStyle(image);\n\t\t\t\t\tresolve(width, height, e);\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tlet {width, height} = window.getComputedStyle(image);\n\t\t\t\tresolve(width, height);\n\t\t\t}\n\t\t});\n\t}\n\n\tavoidBreakInside(node, limiter) {\n\t\tlet breakNode;\n\n\t\tif (node === limiter) {\n\t\t\treturn;\n\t\t}\n\n\t\twhile (node.parentNode) {\n\t\t\tnode = node.parentNode;\n\n\t\t\tif (node === limiter) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (window.getComputedStyle(node)[\"break-inside\"] === \"avoid\") {\n\t\t\t\tbreakNode = node;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t}\n\t\treturn breakNode;\n\t}\n\n\tcreateBreakToken(overflow, rendered, source) {\n\t\tlet container = overflow.startContainer;\n\t\tlet offset = overflow.startOffset;\n\t\tlet node, renderedNode, parent, index, temp;\n\n\t\tif (isElement(container)) {\n\t\t\ttemp = child(container, offset);\n\n\t\t\tif (isElement(temp)) {\n\t\t\t\trenderedNode = findElement(temp, rendered);\n\n\t\t\t\tif (!renderedNode) {\n\t\t\t\t\t// Find closest element with data-ref\n\t\t\t\t\tlet prevNode = prevValidNode(temp);\n\t\t\t\t\tif (!isElement(prevNode)) {\n\t\t\t\t\t\tprevNode = prevNode.parentElement;\n\t\t\t\t\t}\n\t\t\t\t\trenderedNode = findElement(prevNode, rendered);\n\t\t\t\t\t// Check if temp is the last rendered node at its level.\n\t\t\t\t\tif (!temp.nextSibling) {\n\t\t\t\t\t\t// We need to ensure that the previous sibling of temp is fully rendered.\n\t\t\t\t\t\tconst renderedNodeFromSource = findElement(renderedNode, source);\n\t\t\t\t\t\tconst walker = document.createTreeWalker(renderedNodeFromSource, NodeFilter.SHOW_ELEMENT);\n\t\t\t\t\t\tconst lastChildOfRenderedNodeFromSource = walker.lastChild();\n\t\t\t\t\t\tconst lastChildOfRenderedNodeMatchingFromRendered = findElement(lastChildOfRenderedNodeFromSource, rendered);\n\t\t\t\t\t\t// Check if we found that the last child in source\n\t\t\t\t\t\tif (!lastChildOfRenderedNodeMatchingFromRendered) {\n\t\t\t\t\t\t\t// Pending content to be rendered before virtual break token\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Otherwise we will return a break token as per below\n\t\t\t\t\t}\n\t\t\t\t\t// renderedNode is actually the last unbroken box that does not overflow.\n\t\t\t\t\t// Break Token is therefore the next sibling of renderedNode within source node.\n\t\t\t\t\tnode = findElement(renderedNode, source).nextSibling;\n\t\t\t\t\toffset = 0;\n\t\t\t\t} else {\n\t\t\t\t\tnode = findElement(renderedNode, source);\n\t\t\t\t\toffset = 0;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\trenderedNode = findElement(container, rendered);\n\n\t\t\t\tif (!renderedNode) {\n\t\t\t\t\trenderedNode = findElement(prevValidNode(container), rendered);\n\t\t\t\t}\n\n\t\t\t\tparent = findElement(renderedNode, source);\n\t\t\t\tindex = indexOfTextNode(temp, parent);\n\t\t\t\t// No seperatation for the first textNode of an element\n\t\t\t\tif(index === 0) {\n\t\t\t\t\tnode = parent;\n\t\t\t\t\toffset = 0;\n\t\t\t\t} else {\n\t\t\t\t\tnode = child(parent, index);\n\t\t\t\t\toffset = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\trenderedNode = findElement(container.parentNode, rendered);\n\n\t\t\tif (!renderedNode) {\n\t\t\t\trenderedNode = findElement(prevValidNode(container.parentNode), rendered);\n\t\t\t}\n\n\t\t\tparent = findElement(renderedNode, source);\n\t\t\tindex = indexOfTextNode(container, parent);\n\n\t\t\tif (index === -1) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tnode = child(parent, index);\n\n\t\t\toffset += node.textContent.indexOf(container.textContent);\n\t\t}\n\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn new BreakToken(\n\t\t\tnode,\n\t\t\toffset\n\t\t);\n\n\t}\n\n\tfindBreakToken(rendered, source, bounds = this.bounds, prevBreakToken, extract = true) {\n\t\tlet overflow = this.findOverflow(rendered, bounds);\n\t\tlet breakToken, breakLetter;\n\n\t\tlet overflowHooks = this.hooks.onOverflow.triggerSync(overflow, rendered, bounds, this);\n\t\toverflowHooks.forEach((newOverflow) => {\n\t\t\tif (typeof newOverflow != \"undefined\") {\n\t\t\t\toverflow = newOverflow;\n\t\t\t}\n\t\t});\n\n\t\tif (overflow) {\n\t\t\tbreakToken = this.createBreakToken(overflow, rendered, source);\n\t\t\t// breakToken is nullable\n\t\t\tlet breakHooks = this.hooks.onBreakToken.triggerSync(breakToken, overflow, rendered, this);\n\t\t\tbreakHooks.forEach((newToken) => {\n\t\t\t\tif (typeof newToken != \"undefined\") {\n\t\t\t\t\tbreakToken = newToken;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Stop removal if we are in a loop\n\t\t\tif (breakToken && breakToken.equals(prevBreakToken)) {\n\t\t\t\treturn breakToken;\n\t\t\t}\n\n\t\t\tif (breakToken && breakToken[\"node\"] && breakToken[\"offset\"] && breakToken[\"node\"].textContent) {\n\t\t\t\tbreakLetter = breakToken[\"node\"].textContent.charAt(breakToken[\"offset\"]);\n\t\t\t} else {\n\t\t\t\tbreakLetter = undefined;\n\t\t\t}\n\n\t\t\tif (breakToken && breakToken.node && extract) {\n\t\t\t\tlet removed = this.removeOverflow(overflow, breakLetter);\n\t\t\t\tthis.hooks && this.hooks.afterOverflowRemoved.trigger(removed, rendered, this);\n\t\t\t}\n\n\t\t}\n\t\treturn breakToken;\n\t}\n\n\thasOverflow(element, bounds = this.bounds) {\n\t\tlet constrainingElement = element && element.parentNode; // this gets the element, instead of the wrapper for the width workaround\n\t\tlet {width, height} = element.getBoundingClientRect();\n\t\tlet scrollWidth = constrainingElement ? constrainingElement.scrollWidth : 0;\n\t\tlet scrollHeight = constrainingElement ? constrainingElement.scrollHeight : 0;\n\t\treturn Math.max(Math.floor(width), scrollWidth) > Math.round(bounds.width) ||\n\t\t\tMath.max(Math.floor(height), scrollHeight) > Math.round(bounds.height);\n\t}\n\n\tfindOverflow(rendered, bounds = this.bounds, gap = this.gap) {\n\t\tif (!this.hasOverflow(rendered, bounds)) return;\n\n\t\tlet start = Math.floor(bounds.left);\n\t\tlet end = Math.round(bounds.right + gap);\n\t\tlet vStart = Math.round(bounds.top);\n\t\tlet vEnd = Math.round(bounds.bottom);\n\t\tlet range;\n\n\t\tlet walker = walk(rendered.firstChild, rendered);\n\n\t\t// Find Start\n\t\tlet next, done, node, offset, skip, breakAvoid, prev, br;\n\t\twhile (!done) {\n\t\t\tnext = walker.next();\n\t\t\tdone = next.done;\n\t\t\tnode = next.value;\n\t\t\tskip = false;\n\t\t\tbreakAvoid = false;\n\t\t\tprev = undefined;\n\t\t\tbr = undefined;\n\n\t\t\tif (node) {\n\t\t\t\tlet pos = getBoundingClientRect(node);\n\t\t\t\tlet left = Math.round(pos.left);\n\t\t\t\tlet right = Math.floor(pos.right);\n\t\t\t\tlet top = Math.round(pos.top);\n\t\t\t\tlet bottom = Math.floor(pos.bottom);\n\n\t\t\t\tif (!range && (left >= end || top >= vEnd)) {\n\t\t\t\t\t// Check if it is a float\n\t\t\t\t\tlet isFloat = false;\n\n\t\t\t\t\t// Check if the node is inside a break-inside: avoid table cell\n\t\t\t\t\tconst insideTableCell = parentOf(node, \"TD\", rendered);\n\t\t\t\t\tif (insideTableCell && window.getComputedStyle(insideTableCell)[\"break-inside\"] === \"avoid\") {\n\t\t\t\t\t\t// breaking inside a table cell produces unexpected result, as a workaround, we forcibly avoid break inside in a cell.\n\t\t\t\t\t\t// But we take the whole row, not just the cell that is causing the break.\n\t\t\t\t\t\tprev = insideTableCell.parentElement;\n\t\t\t\t\t} else if (isElement(node)) {\n\t\t\t\t\t\tlet styles = window.getComputedStyle(node);\n\t\t\t\t\t\tisFloat = styles.getPropertyValue(\"float\") !== \"none\";\n\t\t\t\t\t\tskip = styles.getPropertyValue(\"break-inside\") === \"avoid\";\n\t\t\t\t\t\tbreakAvoid = node.dataset.breakBefore === \"avoid\" || node.dataset.previousBreakAfter === \"avoid\";\n\t\t\t\t\t\tprev = breakAvoid && nodeBefore(node, rendered);\n\t\t\t\t\t\tbr = node.tagName === \"BR\" || node.tagName === \"WBR\";\n\t\t\t\t\t}\n\n\t\t\t\t\tlet tableRow;\n\t\t\t\t\tif (node.nodeName === \"TR\") {\n\t\t\t\t\t\ttableRow = node;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttableRow = parentOf(node, \"TR\", rendered);\n\t\t\t\t\t}\n\t\t\t\t\tif (tableRow) {\n\t\t\t\t\t\t// honor break-inside=\"avoid\" in parent tbody/thead\n\t\t\t\t\t\tlet container = tableRow.parentElement;\n\t\t\t\t\t\tif ([\"TBODY\", \"THEAD\"].includes(container.nodeName)) {\n\t\t\t\t\t\t\tlet styles = window.getComputedStyle(container);\n\t\t\t\t\t\t\tif (styles.getPropertyValue(\"break-inside\") === \"avoid\") prev = container;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Check if the node is inside a row with a rowspan\n\t\t\t\t\t\tconst table = parentOf(tableRow, \"TABLE\", rendered);\n\t\t\t\t\t\tconst rowspan = table.querySelector(\"[colspan]\");\n\t\t\t\t\t\tif (table && rowspan) {\n\t\t\t\t\t\t\tlet columnCount = 0;\n\t\t\t\t\t\t\tfor (const cell of Array.from(table.rows[0].cells)) {\n\t\t\t\t\t\t\t\tcolumnCount += parseInt(cell.getAttribute(\"colspan\") || \"1\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (tableRow.cells.length !== columnCount) {\n\t\t\t\t\t\t\t\tlet previousRow = tableRow.previousElementSibling;\n\t\t\t\t\t\t\t\tlet previousRowColumnCount;\n\t\t\t\t\t\t\t\twhile (previousRow !== null) {\n\t\t\t\t\t\t\t\t\tpreviousRowColumnCount = 0;\n\t\t\t\t\t\t\t\t\tfor (const cell of Array.from(previousRow.cells)) {\n\t\t\t\t\t\t\t\t\t\tpreviousRowColumnCount += parseInt(cell.getAttribute(\"colspan\") || \"1\");\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (previousRowColumnCount === columnCount) {\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tpreviousRow = previousRow.previousElementSibling;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (previousRowColumnCount === columnCount) {\n\t\t\t\t\t\t\t\t\tprev = previousRow;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (prev) {\n\t\t\t\t\t\trange = document.createRange();\n\t\t\t\t\t\trange.selectNode(prev);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!br && !isFloat && isElement(node)) {\n\t\t\t\t\t\trange = document.createRange();\n\t\t\t\t\t\trange.selectNode(node);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (isText(node) && node.textContent.trim().length) {\n\t\t\t\t\t\trange = document.createRange();\n\t\t\t\t\t\trange.selectNode(node);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif (!range && isText(node) &&\n\t\t\t\t\tnode.textContent.trim().length &&\n\t\t\t\t\t!breakInsideAvoidParentNode(node.parentNode)) {\n\n\t\t\t\t\tlet rects = getClientRects(node);\n\t\t\t\t\tlet rect;\n\t\t\t\t\tleft = 0;\n\t\t\t\t\ttop = 0;\n\t\t\t\t\tfor (var i = 0; i != rects.length; i++) {\n\t\t\t\t\t\trect = rects[i];\n\t\t\t\t\t\tif (rect.width > 0 && (!left || rect.left > left)) {\n\t\t\t\t\t\t\tleft = rect.left;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (rect.height > 0 && (!top || rect.top > top)) {\n\t\t\t\t\t\t\ttop = rect.top;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (left >= end || top >= vEnd) {\n\t\t\t\t\t\trange = document.createRange();\n\t\t\t\t\t\toffset = this.textBreak(node, start, end, vStart, vEnd);\n\t\t\t\t\t\tif (!offset) {\n\t\t\t\t\t\t\trange = undefined;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trange.setStart(node, offset);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Skip children\n\t\t\t\tif (skip || (right <= end && bottom <= vEnd)) {\n\t\t\t\t\tnext = nodeAfter(node, rendered);\n\t\t\t\t\tif (next) {\n\t\t\t\t\t\twalker = walk(next, rendered);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\t// Find End\n\t\tif (range) {\n\t\t\trange.setEndAfter(rendered.lastChild);\n\t\t\treturn range;\n\t\t}\n\n\t}\n\n\tfindEndToken(rendered, source) {\n\t\tif (rendered.childNodes.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet lastChild = rendered.lastChild;\n\n\t\tlet lastNodeIndex;\n\t\twhile (lastChild && lastChild.lastChild) {\n\t\t\tif (!validNode(lastChild)) {\n\t\t\t\t// Only get elements with refs\n\t\t\t\tlastChild = lastChild.previousSibling;\n\t\t\t} else if (!validNode(lastChild.lastChild)) {\n\t\t\t\t// Deal with invalid dom items\n\t\t\t\tlastChild = prevValidNode(lastChild.lastChild);\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\tlastChild = lastChild.lastChild;\n\t\t\t}\n\t\t}\n\n\t\tif (isText(lastChild)) {\n\n\t\t\tif (lastChild.parentNode.dataset.ref) {\n\t\t\t\tlastNodeIndex = indexOf(lastChild);\n\t\t\t\tlastChild = lastChild.parentNode;\n\t\t\t} else {\n\t\t\t\tlastChild = lastChild.previousSibling;\n\t\t\t}\n\t\t}\n\n\t\tlet original = findElement(lastChild, source);\n\n\t\tif (lastNodeIndex) {\n\t\t\toriginal = original.childNodes[lastNodeIndex];\n\t\t}\n\n\t\tlet after = nodeAfter(original);\n\n\t\treturn this.breakAt(after);\n\t}\n\n\ttextBreak(node, start, end, vStart, vEnd) {\n\t\tlet wordwalker = words(node);\n\t\tlet left = 0;\n\t\tlet right = 0;\n\t\tlet top = 0;\n\t\tlet bottom = 0;\n\t\tlet word, next, done, pos;\n\t\tlet offset;\n\t\twhile (!done) {\n\t\t\tnext = wordwalker.next();\n\t\t\tword = next.value;\n\t\t\tdone = next.done;\n\n\t\t\tif (!word) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tpos = getBoundingClientRect(word);\n\n\t\t\tleft = Math.floor(pos.left);\n\t\t\tright = Math.floor(pos.right);\n\t\t\ttop = Math.floor(pos.top);\n\t\t\tbottom = Math.floor(pos.bottom);\n\n\t\t\tif (left >= end || top >= vEnd) {\n\t\t\t\toffset = word.startOffset;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (right > end || bottom > vEnd) {\n\t\t\t\tlet letterwalker = letters(word);\n\t\t\t\tlet letter, nextLetter, doneLetter;\n\n\t\t\t\twhile (!doneLetter) {\n\t\t\t\t\tnextLetter = letterwalker.next();\n\t\t\t\t\tletter = nextLetter.value;\n\t\t\t\t\tdoneLetter = nextLetter.done;\n\n\t\t\t\t\tif (!letter) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tpos = getBoundingClientRect(letter);\n\t\t\t\t\tleft = Math.floor(pos.left);\n\t\t\t\t\ttop = Math.floor(pos.top);\n\n\t\t\t\t\tif (left >= end || top >= vEnd) {\n\t\t\t\t\t\toffset = letter.startOffset;\n\t\t\t\t\t\tdone = true;\n\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\treturn offset;\n\t}\n\n\tremoveOverflow(overflow, breakLetter) {\n\t\tlet {startContainer} = overflow;\n\t\tlet extracted = overflow.extractContents();\n\n\t\tthis.hyphenateAtBreak(startContainer, breakLetter);\n\n\t\treturn extracted;\n\t}\n\n\thyphenateAtBreak(startContainer, breakLetter) {\n\t\tif (isText(startContainer)) {\n\t\t\tlet startText = startContainer.textContent;\n\t\t\tlet prevLetter = startText[startText.length - 1];\n\n\t\t\t// Add a hyphen if previous character is a letter or soft hyphen\n\t\t\tif (\n\t\t\t\t(breakLetter && /^\\w|\\u00AD$/.test(prevLetter) && /^\\w|\\u00AD$/.test(breakLetter)) ||\n\t\t\t\t(!breakLetter && /^\\w|\\u00AD$/.test(prevLetter))\n\t\t\t) {\n\t\t\t\tstartContainer.parentNode.classList.add(\"pagedjs_hyphen\");\n\t\t\t\tstartContainer.textContent += this.settings.hyphenGlyph || \"\\u2011\";\n\t\t\t}\n\t\t}\n\t}\n\n\tequalTokens(a, b) {\n\t\tif (!a || !b) {\n\t\t\treturn false;\n\t\t}\n\t\tif (a[\"node\"] && b[\"node\"] && a[\"node\"] !== b[\"node\"]) {\n\t\t\treturn false;\n\t\t}\n\t\tif (a[\"offset\"] && b[\"offset\"] && a[\"offset\"] !== b[\"offset\"]) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n}\n\nEventEmitter(Layout.prototype);\n\nexport default Layout;\n","import Layout from \"./layout.js\";\nimport EventEmitter from \"event-emitter\";\n\n/**\n * Render a page\n * @class\n */\nclass Page {\n\tconstructor(pagesArea, pageTemplate, blank, hooks, options) {\n\t\tthis.pagesArea = pagesArea;\n\t\tthis.pageTemplate = pageTemplate;\n\t\tthis.blank = blank;\n\n\t\tthis.width = undefined;\n\t\tthis.height = undefined;\n\n\t\tthis.hooks = hooks;\n\n\t\tthis.settings = options || {};\n\n\t\t// this.element = this.create(this.pageTemplate);\n\t}\n\n\tcreate(template, after) {\n\t\t//let documentFragment = document.createRange().createContextualFragment( TEMPLATE );\n\t\t//let page = documentFragment.children[0];\n\t\tlet clone = document.importNode(this.pageTemplate.content, true);\n\n\t\tlet page, index;\n\t\tif (after) {\n\t\t\tthis.pagesArea.insertBefore(clone, after.nextElementSibling);\n\t\t\tindex = Array.prototype.indexOf.call(this.pagesArea.children, after.nextElementSibling);\n\t\t\tpage = this.pagesArea.children[index];\n\t\t} else {\n\t\t\tthis.pagesArea.appendChild(clone);\n\t\t\tpage = this.pagesArea.lastChild;\n\t\t}\n\n\t\tlet pagebox = page.querySelector(\".pagedjs_pagebox\");\n\t\tlet area = page.querySelector(\".pagedjs_page_content\");\n\t\tlet footnotesArea = page.querySelector(\".pagedjs_footnote_area\");\n\n\n\t\tlet size = area.getBoundingClientRect();\n\n\n\t\tarea.style.columnWidth = Math.round(size.width) + \"px\";\n\t\tarea.style.columnGap = \"calc(var(--pagedjs-margin-right) + var(--pagedjs-margin-left) + var(--pagedjs-bleed-right) + var(--pagedjs-bleed-left) + var(--pagedjs-column-gap-offset))\";\n\t\t// area.style.overflow = \"scroll\";\n\n\t\tthis.width = Math.round(size.width);\n\t\tthis.height = Math.round(size.height);\n\n\t\tthis.element = page;\n\t\tthis.pagebox = pagebox;\n\t\tthis.area = area;\n\t\tthis.footnotesArea = footnotesArea;\n\n\t\treturn page;\n\t}\n\n\tcreateWrapper() {\n\t\tlet wrapper = document.createElement(\"div\");\n\n\t\tthis.area.appendChild(wrapper);\n\n\t\tthis.wrapper = wrapper;\n\n\t\treturn wrapper;\n\t}\n\n\tindex(pgnum) {\n\t\tthis.position = pgnum;\n\n\t\tlet page = this.element;\n\t\t// let pagebox = this.pagebox;\n\n\t\tlet index = pgnum + 1;\n\n\t\tlet id = `page-${index}`;\n\n\t\tthis.id = id;\n\n\t\t// page.dataset.pageNumber = index;\n\n\t\tpage.dataset.pageNumber = index;\n\t\tpage.setAttribute(\"id\", id);\n\n\t\tif (this.name) {\n\t\t\tpage.classList.add(\"pagedjs_\" + this.name + \"_page\");\n\t\t}\n\n\t\tif (this.blank) {\n\t\t\tpage.classList.add(\"pagedjs_blank_page\");\n\t\t}\n\n\t\tif (pgnum === 0) {\n\t\t\tpage.classList.add(\"pagedjs_first_page\");\n\t\t}\n\n\t\tif (pgnum % 2 !== 1) {\n\t\t\tpage.classList.remove(\"pagedjs_left_page\");\n\t\t\tpage.classList.add(\"pagedjs_right_page\");\n\t\t} else {\n\t\t\tpage.classList.remove(\"pagedjs_right_page\");\n\t\t\tpage.classList.add(\"pagedjs_left_page\");\n\t\t}\n\t}\n\n\t/*\n\tsize(width, height) {\n\t\tif (width === this.width && height === this.height) {\n\t\t\treturn;\n\t\t}\n\t\tthis.width = width;\n\t\tthis.height = height;\n\n\t\tthis.element.style.width = Math.round(width) + \"px\";\n\t\tthis.element.style.height = Math.round(height) + \"px\";\n\t\tthis.element.style.columnWidth = Math.round(width) + \"px\";\n\t}\n\t*/\n\n\tasync layout(contents, breakToken, maxChars) {\n\n\t\tthis.clear();\n\n\t\tthis.startToken = breakToken;\n\n\t\tlet settings = this.settings;\n\t\tif (!settings.maxChars && maxChars) {\n\t\t\tsettings.maxChars = maxChars;\n\t\t}\n\n\t\tthis.layoutMethod = new Layout(this.area, this.hooks, settings);\n\n\t\tlet renderResult = await this.layoutMethod.renderTo(this.wrapper, contents, breakToken);\n\t\tlet newBreakToken = renderResult.breakToken;\n\n\t\tthis.addListeners(contents);\n\n\t\tthis.endToken = newBreakToken;\n\n\t\treturn newBreakToken;\n\t}\n\n\tasync append(contents, breakToken) {\n\n\t\tif (!this.layoutMethod) {\n\t\t\treturn this.layout(contents, breakToken);\n\t\t}\n\n\t\tlet renderResult = await this.layoutMethod.renderTo(this.wrapper, contents, breakToken);\n\t\tlet newBreakToken = renderResult.breakToken;\n\n\t\tthis.endToken = newBreakToken;\n\n\t\treturn newBreakToken;\n\t}\n\n\tgetByParent(ref, entries) {\n\t\tlet e;\n\t\tfor (var i = 0; i < entries.length; i++) {\n\t\t\te = entries[i];\n\t\t\tif (e.dataset.ref === ref) {\n\t\t\t\treturn e;\n\t\t\t}\n\t\t}\n\t}\n\n\tonOverflow(func) {\n\t\tthis._onOverflow = func;\n\t}\n\n\tonUnderflow(func) {\n\t\tthis._onUnderflow = func;\n\t}\n\n\tclear() {\n\t\tthis.removeListeners();\n\t\tthis.wrapper && this.wrapper.remove();\n\t\tthis.createWrapper();\n\t}\n\n\taddListeners(contents) {\n\t\tif (typeof ResizeObserver !== \"undefined\") {\n\t\t\tthis.addResizeObserver(contents);\n\t\t} else {\n\t\t\tthis._checkOverflowAfterResize = this.checkOverflowAfterResize.bind(this, contents);\n\t\t\tthis.element.addEventListener(\"overflow\", this._checkOverflowAfterResize, false);\n\t\t\tthis.element.addEventListener(\"underflow\", this._checkOverflowAfterResize, false);\n\t\t}\n\t\t// TODO: fall back to mutation observer?\n\n\t\tthis._onScroll = function () {\n\t\t\tif (this.listening) {\n\t\t\t\tthis.element.scrollLeft = 0;\n\t\t\t}\n\t\t}.bind(this);\n\n\t\t// Keep scroll left from changing\n\t\tthis.element.addEventListener(\"scroll\", this._onScroll);\n\n\t\tthis.listening = true;\n\n\t\treturn true;\n\t}\n\n\tremoveListeners() {\n\t\tthis.listening = false;\n\n\t\tif (typeof ResizeObserver !== \"undefined\" && this.ro) {\n\t\t\tthis.ro.disconnect();\n\t\t} else if (this.element) {\n\t\t\tthis.element.removeEventListener(\"overflow\", this._checkOverflowAfterResize, false);\n\t\t\tthis.element.removeEventListener(\"underflow\", this._checkOverflowAfterResize, false);\n\t\t}\n\n\t\tthis.element && this.element.removeEventListener(\"scroll\", this._onScroll);\n\n\t}\n\n\taddResizeObserver(contents) {\n\t\tlet wrapper = this.wrapper;\n\t\tlet prevHeight = wrapper.getBoundingClientRect().height;\n\t\tthis.ro = new ResizeObserver(entries => {\n\n\t\t\tif (!this.listening) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tfor (let entry of entries) {\n\t\t\t\t\tconst cr = entry.contentRect;\n\n\t\t\t\t\tif (cr.height > prevHeight) {\n\t\t\t\t\t\tthis.checkOverflowAfterResize(contents);\n\t\t\t\t\t\tprevHeight = wrapper.getBoundingClientRect().height;\n\t\t\t\t\t} else if (cr.height < prevHeight) { // TODO: calc line height && (prevHeight - cr.height) >= 22\n\t\t\t\t\t\tthis.checkUnderflowAfterResize(contents);\n\t\t\t\t\t\tprevHeight = cr.height;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tthis.ro.observe(wrapper);\n\t}\n\n\tcheckOverflowAfterResize(contents) {\n\t\tif (!this.listening || !this.layoutMethod) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet newBreakToken = this.layoutMethod.findBreakToken(this.wrapper, contents, this.startToken);\n\n\t\tif (newBreakToken) {\n\t\t\tthis.endToken = newBreakToken;\n\t\t\tthis._onOverflow && this._onOverflow(newBreakToken);\n\t\t}\n\t}\n\n\tcheckUnderflowAfterResize(contents) {\n\t\tif (!this.listening || !this.layoutMethod) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet endToken = this.layoutMethod.findEndToken(this.wrapper, contents);\n\n\t\tif (endToken) {\n\t\t\tthis._onUnderflow && this._onUnderflow(endToken);\n\t\t}\n\t}\n\n\n\tdestroy() {\n\t\tthis.removeListeners();\n\n\t\tthis.element.remove();\n\n\t\tthis.element = undefined;\n\t\tthis.wrapper = undefined;\n\t}\n}\n\nEventEmitter(Page.prototype);\n\n\nexport default Page;\n","import {UUID} from \"../utils/utils.js\";\n\n/**\n * Render a flow of text offscreen\n * @class\n */\nclass ContentParser {\n\n\tconstructor(content, cb) {\n\t\tif (content && content.nodeType) {\n\t\t\t// handle dom\n\t\t\tthis.dom = this.add(content);\n\t\t} else if (typeof content === \"string\") {\n\t\t\tthis.dom = this.parse(content);\n\t\t}\n\n\t\treturn this.dom;\n\t}\n\n\tparse(markup, mime) {\n\t\tlet range = document.createRange();\n\t\tlet fragment = range.createContextualFragment(markup);\n\n\t\tthis.addRefs(fragment);\n\n\t\treturn fragment;\n\t}\n\n\tadd(contents) {\n\t\t// let fragment = document.createDocumentFragment();\n\t\t//\n\t\t// let children = [...contents.childNodes];\n\t\t// for (let child of children) {\n\t\t// \tlet clone = child.cloneNode(true);\n\t\t// \tfragment.appendChild(clone);\n\t\t// }\n\n\t\tthis.addRefs(contents);\n\n\t\treturn contents;\n\t}\n\n\taddRefs(content) {\n\t\tvar treeWalker = document.createTreeWalker(\n\t\t\tcontent,\n\t\t\tNodeFilter.SHOW_ELEMENT,\n\t\t\tnull,\n\t\t\tfalse\n\t\t);\n\n\t\tlet node = treeWalker.nextNode();\n\t\twhile(node) {\n\n\t\t\tif (!node.hasAttribute(\"data-ref\")) {\n\t\t\t\tlet uuid = UUID();\n\t\t\t\tnode.setAttribute(\"data-ref\", uuid);\n\t\t\t}\n\n\t\t\tif (node.id) {\n\t\t\t\tnode.setAttribute(\"data-id\", node.id);\n\t\t\t}\n\n\t\t\t// node.setAttribute(\"data-children\", node.childNodes.length);\n\n\t\t\t// node.setAttribute(\"data-text\", node.textContent.trim().length);\n\t\t\tnode = treeWalker.nextNode();\n\t\t}\n\t}\n\n\tfind(ref) {\n\t\treturn this.refs[ref];\n\t}\n\n\tdestroy() {\n\t\tthis.refs = undefined;\n\t\tthis.dom = undefined;\n\t}\n}\n\nexport default ContentParser;\n","import {defer} from \"./utils.js\";\n\n/**\n * Queue for handling tasks one at a time\n * @class\n * @param {scope} context what this will resolve to in the tasks\n */\nclass Queue {\n\tconstructor(context){\n\t\tthis._q = [];\n\t\tthis.context = context;\n\t\tthis.tick = requestAnimationFrame;\n\t\tthis.running = false;\n\t\tthis.paused = false;\n\t}\n\n\t/**\n\t * Add an item to the queue\n\t * @return {Promise} enqueued\n\t */\n\tenqueue() {\n\t\tvar deferred, promise;\n\t\tvar queued;\n\t\tvar task = [].shift.call(arguments);\n\t\tvar args = arguments;\n\n\t\t// Handle single args without context\n\t\t// if(args && !Array.isArray(args)) {\n\t\t//   args = [args];\n\t\t// }\n\t\tif(!task) {\n\t\t\tthrow new Error(\"No Task Provided\");\n\t\t}\n\n\t\tif(typeof task === \"function\"){\n\n\t\t\tdeferred = new defer();\n\t\t\tpromise = deferred.promise;\n\n\t\t\tqueued = {\n\t\t\t\t\"task\" : task,\n\t\t\t\t\"args\"     : args,\n\t\t\t\t//\"context\"  : context,\n\t\t\t\t\"deferred\" : deferred,\n\t\t\t\t\"promise\" : promise\n\t\t\t};\n\n\t\t} else {\n\t\t\t// Task is a promise\n\t\t\tqueued = {\n\t\t\t\t\"promise\" : task\n\t\t\t};\n\n\t\t}\n\n\t\tthis._q.push(queued);\n\n\t\t// Wait to start queue flush\n\t\tif (this.paused == false && !this.running) {\n\t\t\tthis.run();\n\t\t}\n\n\t\treturn queued.promise;\n\t}\n\n\t/**\n\t * Run one item\n\t * @return {Promise} dequeued\n\t */\n\tdequeue(){\n\t\tvar inwait, task, result;\n\n\t\tif(this._q.length && !this.paused) {\n\t\t\tinwait = this._q.shift();\n\t\t\ttask = inwait.task;\n\t\t\tif(task){\n\t\t\t\t// console.log(task)\n\n\t\t\t\tresult = task.apply(this.context, inwait.args);\n\n\t\t\t\tif(result && typeof result[\"then\"] === \"function\") {\n\t\t\t\t\t// Task is a function that returns a promise\n\t\t\t\t\treturn result.then(function(){\n\t\t\t\t\t\tinwait.deferred.resolve.apply(this.context, arguments);\n\t\t\t\t\t}.bind(this), function() {\n\t\t\t\t\t\tinwait.deferred.reject.apply(this.context, arguments);\n\t\t\t\t\t}.bind(this));\n\t\t\t\t} else {\n\t\t\t\t\t// Task resolves immediately\n\t\t\t\t\tinwait.deferred.resolve.apply(this.context, result);\n\t\t\t\t\treturn inwait.promise;\n\t\t\t\t}\n\n\n\n\t\t\t} else if(inwait.promise) {\n\t\t\t\t// Task is a promise\n\t\t\t\treturn inwait.promise;\n\t\t\t}\n\n\t\t} else {\n\t\t\tinwait = new defer();\n\t\t\tinwait.deferred.resolve();\n\t\t\treturn inwait.promise;\n\t\t}\n\n\t}\n\n\t// Run All Immediately\n\tdump(){\n\t\twhile(this._q.length) {\n\t\t\tthis.dequeue();\n\t\t}\n\t}\n\n\t/**\n\t * Run all tasks sequentially, at convince\n\t * @return {Promise} all run\n\t */\n\trun(){\n\n\t\tif(!this.running){\n\t\t\tthis.running = true;\n\t\t\tthis.defered = new defer();\n\t\t}\n\n\t\tthis.tick.call(window, () => {\n\n\t\t\tif(this._q.length) {\n\n\t\t\t\tthis.dequeue()\n\t\t\t\t\t.then(function(){\n\t\t\t\t\t\tthis.run();\n\t\t\t\t\t}.bind(this));\n\n\t\t\t} else {\n\t\t\t\tthis.defered.resolve();\n\t\t\t\tthis.running = undefined;\n\t\t\t}\n\n\t\t});\n\n\t\t// Unpause\n\t\tif(this.paused == true) {\n\t\t\tthis.paused = false;\n\t\t}\n\n\t\treturn this.defered.promise;\n\t}\n\n\t/**\n\t * Flush all, as quickly as possible\n\t * @return {Promise} ran\n\t */\n\tflush(){\n\n\t\tif(this.running){\n\t\t\treturn this.running;\n\t\t}\n\n\t\tif(this._q.length) {\n\t\t\tthis.running = this.dequeue()\n\t\t\t\t.then(function(){\n\t\t\t\t\tthis.running = undefined;\n\t\t\t\t\treturn this.flush();\n\t\t\t\t}.bind(this));\n\n\t\t\treturn this.running;\n\t\t}\n\n\t}\n\n\t/**\n\t * Clear all items in wait\n\t * @return {void}\n\t */\n\tclear(){\n\t\tthis._q = [];\n\t}\n\n\t/**\n\t * Get the number of tasks in the queue\n\t * @return {number} tasks\n\t */\n\tlength(){\n\t\treturn this._q.length;\n\t}\n\n\t/**\n\t * Pause a running queue\n\t * @return {void}\n\t */\n\tpause(){\n\t\tthis.paused = true;\n\t}\n\n\t/**\n\t * End the queue\n\t * @return {void}\n\t */\n\tstop(){\n\t\tthis._q = [];\n\t\tthis.running = false;\n\t\tthis.paused = true;\n\t}\n}\n\n\n/**\n * Create a new task from a callback\n * @class\n * @private\n * @param {function} task task to complete\n * @param {array} args arguments for the task\n * @param {scope} context scope of the task\n * @return {function} task\n */\nclass Task {\n\tconstructor(task, args, context){\n\n\t\treturn function(){\n\t\t\tvar toApply = arguments || [];\n\n\t\t\treturn new Promise( (resolve, reject) => {\n\t\t\t\tvar callback = function(value, err){\n\t\t\t\t\tif (!value && err) {\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresolve(value);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\t// Add the callback to the arguments list\n\t\t\t\ttoApply.push(callback);\n\n\t\t\t\t// Apply all arguments to the functions\n\t\t\t\ttask.apply(context || this, toApply);\n\n\t\t\t});\n\n\t\t};\n\n\t}\n}\n\n\nexport default Queue;\nexport { Task };\n","import Page from \"./page.js\";\nimport ContentParser from \"./parser.js\";\nimport EventEmitter from \"event-emitter\";\nimport Hook from \"../utils/hook.js\";\nimport Queue from \"../utils/queue.js\";\nimport {\n\trequestIdleCallback\n} from \"../utils/utils.js\";\nimport { OverflowContentError } from \"./renderresult.js\";\n\nconst MAX_PAGES = false;\nconst MAX_LAYOUTS = false;\n\nconst TEMPLATE = `\n<div class=\"pagedjs_page\">\n\t<div class=\"pagedjs_sheet\">\n\t\t<div class=\"pagedjs_bleed pagedjs_bleed-top\">\n\t\t\t<div class=\"pagedjs_marks-crop\"></div>\n\t\t\t<div class=\"pagedjs_marks-middle\">\n\t\t\t\t<div class=\"pagedjs_marks-cross\"></div>\n\t\t\t</div>\n\t\t\t<div class=\"pagedjs_marks-crop\"></div>\n\t\t</div>\n\t\t<div class=\"pagedjs_bleed pagedjs_bleed-bottom\">\n\t\t\t<div class=\"pagedjs_marks-crop\"></div>\n\t\t\t<div class=\"pagedjs_marks-middle\">\n\t\t\t\t<div class=\"pagedjs_marks-cross\"></div>\n\t\t\t</div>\t\t<div class=\"pagedjs_marks-crop\"></div>\n\t\t</div>\n\t\t<div class=\"pagedjs_bleed pagedjs_bleed-left\">\n\t\t\t<div class=\"pagedjs_marks-crop\"></div>\n\t\t\t<div class=\"pagedjs_marks-middle\">\n\t\t\t\t<div class=\"pagedjs_marks-cross\"></div>\n\t\t\t</div>\t\t<div class=\"pagedjs_marks-crop\"></div>\n\t\t</div>\n\t\t<div class=\"pagedjs_bleed pagedjs_bleed-right\">\n\t\t\t<div class=\"pagedjs_marks-crop\"></div>\n\t\t\t<div class=\"pagedjs_marks-middle\">\n\t\t\t\t<div class=\"pagedjs_marks-cross\"></div>\n\t\t\t</div>\n\t\t\t<div class=\"pagedjs_marks-crop\"></div>\n\t\t</div>\n\t\t<div class=\"pagedjs_pagebox\">\n\t\t\t<div class=\"pagedjs_margin-top-left-corner-holder\">\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-top-left-corner\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t</div>\n\t\t\t<div class=\"pagedjs_margin-top\">\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-top-left\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-top-center\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-top-right\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t</div>\n\t\t\t<div class=\"pagedjs_margin-top-right-corner-holder\">\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-top-right-corner\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t</div>\n\t\t\t<div class=\"pagedjs_margin-right\">\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-right-top\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-right-middle\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-right-bottom\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t</div>\n\t\t\t<div class=\"pagedjs_margin-left\">\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-left-top\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-left-middle\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-left-bottom\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t</div>\n\t\t\t<div class=\"pagedjs_margin-bottom-left-corner-holder\">\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-bottom-left-corner\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t</div>\n\t\t\t<div class=\"pagedjs_margin-bottom\">\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-bottom-left\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-bottom-center\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-bottom-right\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t</div>\n\t\t\t<div class=\"pagedjs_margin-bottom-right-corner-holder\">\n\t\t\t\t<div class=\"pagedjs_margin pagedjs_margin-bottom-right-corner\"><div class=\"pagedjs_margin-content\"></div></div>\n\t\t\t</div>\n\t\t\t<div class=\"pagedjs_area\">\n\t\t\t\t<div class=\"pagedjs_page_content\"></div>\n\t\t\t\t<div class=\"pagedjs_footnote_area\">\n\t\t\t\t\t<div class=\"pagedjs_footnote_content pagedjs_footnote_empty\">\n\t\t\t\t\t\t<div class=\"pagedjs_footnote_inner_content\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>`;\n\n/**\n * Chop up text into flows\n * @class\n */\nclass Chunker {\n\tconstructor(content, renderTo, options) {\n\t\t// this.preview = preview;\n\n\t\tthis.settings = options || {};\n\n\t\tthis.hooks = {};\n\t\tthis.hooks.beforeParsed = new Hook(this);\n\t\tthis.hooks.filter = new Hook(this);\n\t\tthis.hooks.afterParsed = new Hook(this);\n\t\tthis.hooks.beforePageLayout = new Hook(this);\n\t\tthis.hooks.onPageLayout = new Hook(this);\n\t\tthis.hooks.layout = new Hook(this);\n\t\tthis.hooks.renderNode = new Hook(this);\n\t\tthis.hooks.layoutNode = new Hook(this);\n\t\tthis.hooks.onOverflow = new Hook(this);\n\t\tthis.hooks.afterOverflowRemoved = new Hook(this);\n\t\tthis.hooks.onBreakToken = new Hook();\n\t\tthis.hooks.beforeRenderResult = new Hook(this);\n\t\tthis.hooks.afterPageLayout = new Hook(this);\n\t\tthis.hooks.finalizePage = new Hook(this);\n\t\tthis.hooks.afterRendered = new Hook(this);\n\n\t\tthis.pages = [];\n\t\tthis.total = 0;\n\n\t\tthis.q = new Queue(this);\n\t\tthis.stopped = false;\n\t\tthis.rendered = false;\n\n\t\tthis.content = content;\n\n\t\tthis.charsPerBreak = [];\n\t\tthis.maxChars;\n\n\t\tif (content) {\n\t\t\tthis.flow(content, renderTo);\n\t\t}\n\t}\n\n\tsetup(renderTo) {\n\t\tthis.pagesArea = document.createElement(\"div\");\n\t\tthis.pagesArea.classList.add(\"pagedjs_pages\");\n\n\t\tif (renderTo) {\n\t\t\trenderTo.appendChild(this.pagesArea);\n\t\t} else {\n\t\t\tdocument.querySelector(\"body\").appendChild(this.pagesArea);\n\t\t}\n\n\t\tthis.pageTemplate = document.createElement(\"template\");\n\t\tthis.pageTemplate.innerHTML = TEMPLATE;\n\n\t}\n\n\tasync flow(content, renderTo) {\n\t\tlet parsed;\n\n\t\tawait this.hooks.beforeParsed.trigger(content, this);\n\n\t\tparsed = new ContentParser(content);\n\n\t\tthis.hooks.filter.triggerSync(parsed);\n\n\t\tthis.source = parsed;\n\t\tthis.breakToken = undefined;\n\n\t\tif (this.pagesArea && this.pageTemplate) {\n\t\t\tthis.q.clear();\n\t\t\tthis.removePages();\n\t\t} else {\n\t\t\tthis.setup(renderTo);\n\t\t}\n\n\t\tthis.emit(\"rendering\", parsed);\n\n\t\tawait this.hooks.afterParsed.trigger(parsed, this);\n\n\t\tawait this.loadFonts();\n\n\t\tlet rendered = await this.render(parsed, this.breakToken);\n\t\twhile (rendered.canceled) {\n\t\t\tthis.start();\n\t\t\trendered = await this.render(parsed, this.breakToken);\n\t\t}\n\n\t\tthis.rendered = true;\n\t\tthis.pagesArea.style.setProperty(\"--pagedjs-page-count\", this.total);\n\n\t\tawait this.hooks.afterRendered.trigger(this.pages, this);\n\n\t\tthis.emit(\"rendered\", this.pages);\n\n\n\n\t\treturn this;\n\t}\n\n\t// oversetPages() {\n\t// \tlet overset = [];\n\t// \tfor (let i = 0; i < this.pages.length; i++) {\n\t// \t\tlet page = this.pages[i];\n\t// \t\tif (page.overset) {\n\t// \t\t\toverset.push(page);\n\t// \t\t\t// page.overset = false;\n\t// \t\t}\n\t// \t}\n\t// \treturn overset;\n\t// }\n\t//\n\t// async handleOverset(parsed) {\n\t// \tlet overset = this.oversetPages();\n\t// \tif (overset.length) {\n\t// \t\tconsole.log(\"overset\", overset);\n\t// \t\tlet index = this.pages.indexOf(overset[0]) + 1;\n\t// \t\tconsole.log(\"INDEX\", index);\n\t//\n\t// \t\t// Remove pages\n\t// \t\t// this.removePages(index);\n\t//\n\t// \t\t// await this.render(parsed, overset[0].overset);\n\t//\n\t// \t\t// return this.handleOverset(parsed);\n\t// \t}\n\t// }\n\n\tasync render(parsed, startAt) {\n\t\tlet renderer = this.layout(parsed, startAt);\n\n\t\tlet done = false;\n\t\tlet result;\n\n\t\tlet loops = 0;\n\t\twhile (!done) {\n\t\t\tresult = await this.q.enqueue(() => { return this.renderAsync(renderer); });\n\t\t\tdone = result.done;\n\t\t\tif(MAX_LAYOUTS) {\n\t\t\t\tloops += 1;\n\t\t\t\tif (loops >= MAX_LAYOUTS) {\n\t\t\t\t\tthis.stop();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tstart() {\n\t\tthis.rendered = false;\n\t\tthis.stopped = false;\n\t}\n\n\tstop() {\n\t\tthis.stopped = true;\n\t\t// this.q.clear();\n\t}\n\n\trenderOnIdle(renderer) {\n\t\treturn new Promise(resolve => {\n\t\t\trequestIdleCallback(async () => {\n\t\t\t\tif (this.stopped) {\n\t\t\t\t\treturn resolve({ done: true, canceled: true });\n\t\t\t\t}\n\t\t\t\tlet result = await renderer.next();\n\t\t\t\tif (this.stopped) {\n\t\t\t\t\tresolve({ done: true, canceled: true });\n\t\t\t\t} else {\n\t\t\t\t\tresolve(result);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tasync renderAsync(renderer) {\n\t\tif (this.stopped) {\n\t\t\treturn { done: true, canceled: true };\n\t\t}\n\t\tlet result = await renderer.next();\n\t\tif (this.stopped) {\n\t\t\treturn { done: true, canceled: true };\n\t\t} else {\n\t\t\treturn result;\n\t\t}\n\t}\n\n\tasync handleBreaks(node, force) {\n\t\tlet currentPage = this.total + 1;\n\t\tlet currentPosition = currentPage % 2 === 0 ? \"left\" : \"right\";\n\t\t// TODO: Recto and Verso should reverse for rtl languages\n\t\tlet currentSide = currentPage % 2 === 0 ? \"verso\" : \"recto\";\n\t\tlet previousBreakAfter;\n\t\tlet breakBefore;\n\t\tlet page;\n\n\t\tif (currentPage === 1) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (node &&\n\t\t\t\ttypeof node.dataset !== \"undefined\" &&\n\t\t\t\ttypeof node.dataset.previousBreakAfter !== \"undefined\") {\n\t\t\tpreviousBreakAfter = node.dataset.previousBreakAfter;\n\t\t}\n\n\t\tif (node &&\n\t\t\t\ttypeof node.dataset !== \"undefined\" &&\n\t\t\t\ttypeof node.dataset.breakBefore !== \"undefined\") {\n\t\t\tbreakBefore = node.dataset.breakBefore;\n\t\t}\n\n\t\tif (force) {\n\t\t\tpage = this.addPage(true);\n\t\t} else if( previousBreakAfter &&\n\t\t\t\t(previousBreakAfter === \"left\" || previousBreakAfter === \"right\") &&\n\t\t\t\tpreviousBreakAfter !== currentPosition) {\n\t\t\tpage = this.addPage(true);\n\t\t} else if( previousBreakAfter &&\n\t\t\t\t(previousBreakAfter === \"verso\" || previousBreakAfter === \"recto\") &&\n\t\t\t\tpreviousBreakAfter !== currentSide) {\n\t\t\tpage = this.addPage(true);\n\t\t} else if( breakBefore &&\n\t\t\t\t(breakBefore === \"left\" || breakBefore === \"right\") &&\n\t\t\t\tbreakBefore !== currentPosition) {\n\t\t\tpage = this.addPage(true);\n\t\t} else if( breakBefore &&\n\t\t\t\t(breakBefore === \"verso\" || breakBefore === \"recto\") &&\n\t\t\t\tbreakBefore !== currentSide) {\n\t\t\tpage = this.addPage(true);\n\t\t}\n\n\t\tif (page) {\n\t\t\tawait this.hooks.beforePageLayout.trigger(page, undefined, undefined, this);\n\t\t\tthis.emit(\"page\", page);\n\t\t\t// await this.hooks.layout.trigger(page.element, page, undefined, this);\n\t\t\tawait this.hooks.afterPageLayout.trigger(page.element, page, undefined, this);\n\t\t\tawait this.hooks.finalizePage.trigger(page.element, page, undefined, this);\n\t\t\tthis.emit(\"renderedPage\", page);\n\t\t}\n\t}\n\n\tasync *layout(content, startAt) {\n\t\tlet breakToken = startAt || false;\n\t\tlet tokens = [];\n\n\t\twhile (breakToken !== undefined && (MAX_PAGES ? this.total < MAX_PAGES : true)) {\n\n\t\t\tif (breakToken && breakToken.node) {\n\t\t\t\tawait this.handleBreaks(breakToken.node);\n\t\t\t} else {\n\t\t\t\tawait this.handleBreaks(content.firstChild);\n\t\t\t}\n\n\t\t\tlet page = this.addPage();\n\n\t\t\tawait this.hooks.beforePageLayout.trigger(page, content, breakToken, this);\n\t\t\tthis.emit(\"page\", page);\n\n\t\t\t// Layout content in the page, starting from the breakToken\n\t\t\tbreakToken = await page.layout(content, breakToken, this.maxChars);\n\n\t\t\tif (breakToken) {\n\t\t\t\tlet newToken = breakToken.toJSON(true);\n\t\t\t\tif (tokens.lastIndexOf(newToken) > -1) {\n\t\t\t\t\t// loop\n\t\t\t\t\tlet err = new OverflowContentError(\"Layout repeated\", [breakToken.node]);\n\t\t\t\t\tconsole.error(\"Layout repeated at: \", breakToken.node);\n\t\t\t\t\treturn err;\n\t\t\t\t} else {\n\t\t\t\t\ttokens.push(newToken);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tawait this.hooks.afterPageLayout.trigger(page.element, page, breakToken, this);\n\t\t\tawait this.hooks.finalizePage.trigger(page.element, page, undefined, this);\n\t\t\tthis.emit(\"renderedPage\", page);\n\n\t\t\tthis.recoredCharLength(page.wrapper.textContent.length);\n\n\t\t\tyield breakToken;\n\n\t\t\t// Stop if we get undefined, showing we have reached the end of the content\n\t\t}\n\n\n\t}\n\n\trecoredCharLength(length) {\n\t\tif (length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.charsPerBreak.push(length);\n\n\t\t// Keep the length of the last few breaks\n\t\tif (this.charsPerBreak.length > 4) {\n\t\t\tthis.charsPerBreak.shift();\n\t\t}\n\n\t\tthis.maxChars = this.charsPerBreak.reduce((a, b) => a + b, 0) / (this.charsPerBreak.length);\n\t}\n\n\tremovePages(fromIndex=0) {\n\n\t\tif (fromIndex >= this.pages.length) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Remove pages\n\t\tfor (let i = fromIndex; i < this.pages.length; i++) {\n\t\t\tthis.pages[i].destroy();\n\t\t}\n\n\t\tif (fromIndex > 0) {\n\t\t\tthis.pages.splice(fromIndex);\n\t\t} else {\n\t\t\tthis.pages = [];\n\t\t}\n\n\t\tthis.total = this.pages.length;\n\t}\n\n\taddPage(blank) {\n\t\tlet lastPage = this.pages[this.pages.length - 1];\n\t\t// Create a new page from the template\n\t\tlet page = new Page(this.pagesArea, this.pageTemplate, blank, this.hooks, this.settings);\n\n\t\tthis.pages.push(page);\n\n\t\t// Create the pages\n\t\tpage.create(undefined, lastPage && lastPage.element);\n\n\t\tpage.index(this.total);\n\n\t\tif (!blank) {\n\t\t\t// Listen for page overflow\n\t\t\tpage.onOverflow((overflowToken) => {\n\t\t\t\tconsole.warn(\"overflow on\", page.id, overflowToken);\n\n\t\t\t\t// Only reflow while rendering\n\t\t\t\tif (this.rendered) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet index = this.pages.indexOf(page) + 1;\n\n\t\t\t\t// Stop the rendering\n\t\t\t\tthis.stop();\n\n\t\t\t\t// Set the breakToken to resume at\n\t\t\t\tthis.breakToken = overflowToken;\n\n\t\t\t\t// Remove pages\n\t\t\t\tthis.removePages(index);\n\n\t\t\t\tif (this.rendered === true) {\n\t\t\t\t\tthis.rendered = false;\n\n\t\t\t\t\tthis.q.enqueue(async () => {\n\n\t\t\t\t\t\tthis.start();\n\n\t\t\t\t\t\tawait this.render(this.source, this.breakToken);\n\n\t\t\t\t\t\tthis.rendered = true;\n\n\t\t\t\t\t});\n\t\t\t\t}\n\n\n\t\t\t});\n\n\t\t\tpage.onUnderflow((overflowToken) => {\n\t\t\t\t// console.log(\"underflow on\", page.id, overflowToken);\n\n\t\t\t\t// page.append(this.source, overflowToken);\n\n\t\t\t});\n\t\t}\n\n\t\tthis.total = this.pages.length;\n\n\t\treturn page;\n\t}\n\t/*\n\tinsertPage(index, blank) {\n\t\tlet lastPage = this.pages[index];\n\t\t// Create a new page from the template\n\t\tlet page = new Page(this.pagesArea, this.pageTemplate, blank, this.hooks);\n\n\t\tlet total = this.pages.splice(index, 0, page);\n\n\t\t// Create the pages\n\t\tpage.create(undefined, lastPage && lastPage.element);\n\n\t\tpage.index(index + 1);\n\n\t\tfor (let i = index + 2; i < this.pages.length; i++) {\n\t\t\tthis.pages[i].index(i);\n\t\t}\n\n\t\tif (!blank) {\n\t\t\t// Listen for page overflow\n\t\t\tpage.onOverflow((overflowToken) => {\n\t\t\t\tif (total < this.pages.length) {\n\t\t\t\t\tthis.pages[total].layout(this.source, overflowToken);\n\t\t\t\t} else {\n\t\t\t\t\tlet newPage = this.addPage();\n\t\t\t\t\tnewPage.layout(this.source, overflowToken);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tpage.onUnderflow(() => {\n\t\t\t\t// console.log(\"underflow on\", page.id);\n\t\t\t});\n\t\t}\n\n\t\tthis.total += 1;\n\n\t\treturn page;\n\t}\n\t*/\n\n\tasync clonePage(originalPage) {\n\t\tlet lastPage = this.pages[this.pages.length - 1];\n\n\t\tlet page = new Page(this.pagesArea, this.pageTemplate, false, this.hooks);\n\n\t\tthis.pages.push(page);\n\n\t\t// Create the pages\n\t\tpage.create(undefined, lastPage && lastPage.element);\n\n\t\tpage.index(this.total);\n\n\t\tawait this.hooks.beforePageLayout.trigger(page, undefined, undefined, this);\n\t\tthis.emit(\"page\", page);\n\n\t\tfor (const className of originalPage.element.classList) {\n\t\t\tif (className !== \"pagedjs_left_page\" && className !== \"pagedjs_right_page\") {\n\t\t\t\tpage.element.classList.add(className);\n\t\t\t}\n\t\t}\n\n\t\tawait this.hooks.afterPageLayout.trigger(page.element, page, undefined, this);\n\t\tawait this.hooks.finalizePage.trigger(page.element, page, undefined, this);\n\t\tthis.emit(\"renderedPage\", page);\n\t}\n\n\tloadFonts() {\n\t\tlet fontPromises = [];\n\t\t(document.fonts || []).forEach((fontFace) => {\n\t\t\tif (fontFace.status !== \"loaded\") {\n\t\t\t\tlet fontLoaded = fontFace.load().then((r) => {\n\t\t\t\t\treturn fontFace.family;\n\t\t\t\t}, (r) => {\n\t\t\t\t\tconsole.warn(\"Failed to preload font-family:\", fontFace.family);\n\t\t\t\t\treturn fontFace.family;\n\t\t\t\t});\n\t\t\t\tfontPromises.push(fontLoaded);\n\t\t\t}\n\t\t});\n\t\treturn Promise.all(fontPromises).catch((err) => {\n\t\t\tconsole.warn(err);\n\t\t});\n\t}\n\n\tdestroy() {\n\t\tthis.pagesArea.remove();\n\t\tthis.pageTemplate.remove();\n\t}\n\n}\n\nEventEmitter(Chunker.prototype);\n\nexport default Chunker;\n","//\n//                              list\n//                            ┌──────┐\n//             ┌──────────────┼─head │\n//             │              │ tail─┼──────────────┐\n//             │              └──────┘              │\n//             ▼                                    ▼\n//            item        item        item        item\n//          ┌──────┐    ┌──────┐    ┌──────┐    ┌──────┐\n//  null ◀──┼─prev │◀───┼─prev │◀───┼─prev │◀───┼─prev │\n//          │ next─┼───▶│ next─┼───▶│ next─┼───▶│ next─┼──▶ null\n//          ├──────┤    ├──────┤    ├──────┤    ├──────┤\n//          │ data │    │ data │    │ data │    │ data │\n//          └──────┘    └──────┘    └──────┘    └──────┘\n//\n\nfunction createItem(data) {\n    return {\n        prev: null,\n        next: null,\n        data: data\n    };\n}\n\nfunction allocateCursor(node, prev, next) {\n    var cursor;\n\n    if (cursors !== null) {\n        cursor = cursors;\n        cursors = cursors.cursor;\n        cursor.prev = prev;\n        cursor.next = next;\n        cursor.cursor = node.cursor;\n    } else {\n        cursor = {\n            prev: prev,\n            next: next,\n            cursor: node.cursor\n        };\n    }\n\n    node.cursor = cursor;\n\n    return cursor;\n}\n\nfunction releaseCursor(node) {\n    var cursor = node.cursor;\n\n    node.cursor = cursor.cursor;\n    cursor.prev = null;\n    cursor.next = null;\n    cursor.cursor = cursors;\n    cursors = cursor;\n}\n\nvar cursors = null;\nvar List = function() {\n    this.cursor = null;\n    this.head = null;\n    this.tail = null;\n};\n\nList.createItem = createItem;\nList.prototype.createItem = createItem;\n\nList.prototype.updateCursors = function(prevOld, prevNew, nextOld, nextNew) {\n    var cursor = this.cursor;\n\n    while (cursor !== null) {\n        if (cursor.prev === prevOld) {\n            cursor.prev = prevNew;\n        }\n\n        if (cursor.next === nextOld) {\n            cursor.next = nextNew;\n        }\n\n        cursor = cursor.cursor;\n    }\n};\n\nList.prototype.getSize = function() {\n    var size = 0;\n    var cursor = this.head;\n\n    while (cursor) {\n        size++;\n        cursor = cursor.next;\n    }\n\n    return size;\n};\n\nList.prototype.fromArray = function(array) {\n    var cursor = null;\n\n    this.head = null;\n\n    for (var i = 0; i < array.length; i++) {\n        var item = createItem(array[i]);\n\n        if (cursor !== null) {\n            cursor.next = item;\n        } else {\n            this.head = item;\n        }\n\n        item.prev = cursor;\n        cursor = item;\n    }\n\n    this.tail = cursor;\n\n    return this;\n};\n\nList.prototype.toArray = function() {\n    var cursor = this.head;\n    var result = [];\n\n    while (cursor) {\n        result.push(cursor.data);\n        cursor = cursor.next;\n    }\n\n    return result;\n};\n\nList.prototype.toJSON = List.prototype.toArray;\n\nList.prototype.isEmpty = function() {\n    return this.head === null;\n};\n\nList.prototype.first = function() {\n    return this.head && this.head.data;\n};\n\nList.prototype.last = function() {\n    return this.tail && this.tail.data;\n};\n\nList.prototype.each = function(fn, context) {\n    var item;\n\n    if (context === undefined) {\n        context = this;\n    }\n\n    // push cursor\n    var cursor = allocateCursor(this, null, this.head);\n\n    while (cursor.next !== null) {\n        item = cursor.next;\n        cursor.next = item.next;\n\n        fn.call(context, item.data, item, this);\n    }\n\n    // pop cursor\n    releaseCursor(this);\n};\n\nList.prototype.forEach = List.prototype.each;\n\nList.prototype.eachRight = function(fn, context) {\n    var item;\n\n    if (context === undefined) {\n        context = this;\n    }\n\n    // push cursor\n    var cursor = allocateCursor(this, this.tail, null);\n\n    while (cursor.prev !== null) {\n        item = cursor.prev;\n        cursor.prev = item.prev;\n\n        fn.call(context, item.data, item, this);\n    }\n\n    // pop cursor\n    releaseCursor(this);\n};\n\nList.prototype.forEachRight = List.prototype.eachRight;\n\nList.prototype.reduce = function(fn, initialValue, context) {\n    var item;\n\n    if (context === undefined) {\n        context = this;\n    }\n\n    // push cursor\n    var cursor = allocateCursor(this, null, this.head);\n    var acc = initialValue;\n\n    while (cursor.next !== null) {\n        item = cursor.next;\n        cursor.next = item.next;\n\n        acc = fn.call(context, acc, item.data, item, this);\n    }\n\n    // pop cursor\n    releaseCursor(this);\n\n    return acc;\n};\n\nList.prototype.reduceRight = function(fn, initialValue, context) {\n    var item;\n\n    if (context === undefined) {\n        context = this;\n    }\n\n    // push cursor\n    var cursor = allocateCursor(this, this.tail, null);\n    var acc = initialValue;\n\n    while (cursor.prev !== null) {\n        item = cursor.prev;\n        cursor.prev = item.prev;\n\n        acc = fn.call(context, acc, item.data, item, this);\n    }\n\n    // pop cursor\n    releaseCursor(this);\n\n    return acc;\n};\n\nList.prototype.nextUntil = function(start, fn, context) {\n    if (start === null) {\n        return;\n    }\n\n    var item;\n\n    if (context === undefined) {\n        context = this;\n    }\n\n    // push cursor\n    var cursor = allocateCursor(this, null, start);\n\n    while (cursor.next !== null) {\n        item = cursor.next;\n        cursor.next = item.next;\n\n        if (fn.call(context, item.data, item, this)) {\n            break;\n        }\n    }\n\n    // pop cursor\n    releaseCursor(this);\n};\n\nList.prototype.prevUntil = function(start, fn, context) {\n    if (start === null) {\n        return;\n    }\n\n    var item;\n\n    if (context === undefined) {\n        context = this;\n    }\n\n    // push cursor\n    var cursor = allocateCursor(this, start, null);\n\n    while (cursor.prev !== null) {\n        item = cursor.prev;\n        cursor.prev = item.prev;\n\n        if (fn.call(context, item.data, item, this)) {\n            break;\n        }\n    }\n\n    // pop cursor\n    releaseCursor(this);\n};\n\nList.prototype.some = function(fn, context) {\n    var cursor = this.head;\n\n    if (context === undefined) {\n        context = this;\n    }\n\n    while (cursor !== null) {\n        if (fn.call(context, cursor.data, cursor, this)) {\n            return true;\n        }\n\n        cursor = cursor.next;\n    }\n\n    return false;\n};\n\nList.prototype.map = function(fn, context) {\n    var result = new List();\n    var cursor = this.head;\n\n    if (context === undefined) {\n        context = this;\n    }\n\n    while (cursor !== null) {\n        result.appendData(fn.call(context, cursor.data, cursor, this));\n        cursor = cursor.next;\n    }\n\n    return result;\n};\n\nList.prototype.filter = function(fn, context) {\n    var result = new List();\n    var cursor = this.head;\n\n    if (context === undefined) {\n        context = this;\n    }\n\n    while (cursor !== null) {\n        if (fn.call(context, cursor.data, cursor, this)) {\n            result.appendData(cursor.data);\n        }\n        cursor = cursor.next;\n    }\n\n    return result;\n};\n\nList.prototype.clear = function() {\n    this.head = null;\n    this.tail = null;\n};\n\nList.prototype.copy = function() {\n    var result = new List();\n    var cursor = this.head;\n\n    while (cursor !== null) {\n        result.insert(createItem(cursor.data));\n        cursor = cursor.next;\n    }\n\n    return result;\n};\n\nList.prototype.prepend = function(item) {\n    //      head\n    //    ^\n    // item\n    this.updateCursors(null, item, this.head, item);\n\n    // insert to the beginning of the list\n    if (this.head !== null) {\n        // new item <- first item\n        this.head.prev = item;\n\n        // new item -> first item\n        item.next = this.head;\n    } else {\n        // if list has no head, then it also has no tail\n        // in this case tail points to the new item\n        this.tail = item;\n    }\n\n    // head always points to new item\n    this.head = item;\n\n    return this;\n};\n\nList.prototype.prependData = function(data) {\n    return this.prepend(createItem(data));\n};\n\nList.prototype.append = function(item) {\n    return this.insert(item);\n};\n\nList.prototype.appendData = function(data) {\n    return this.insert(createItem(data));\n};\n\nList.prototype.insert = function(item, before) {\n    if (before !== undefined && before !== null) {\n        // prev   before\n        //      ^\n        //     item\n        this.updateCursors(before.prev, item, before, item);\n\n        if (before.prev === null) {\n            // insert to the beginning of list\n            if (this.head !== before) {\n                throw new Error('before doesn\\'t belong to list');\n            }\n\n            // since head points to before therefore list doesn't empty\n            // no need to check tail\n            this.head = item;\n            before.prev = item;\n            item.next = before;\n\n            this.updateCursors(null, item);\n        } else {\n\n            // insert between two items\n            before.prev.next = item;\n            item.prev = before.prev;\n\n            before.prev = item;\n            item.next = before;\n        }\n    } else {\n        // tail\n        //      ^\n        //      item\n        this.updateCursors(this.tail, item, null, item);\n\n        // insert to the ending of the list\n        if (this.tail !== null) {\n            // last item -> new item\n            this.tail.next = item;\n\n            // last item <- new item\n            item.prev = this.tail;\n        } else {\n            // if list has no tail, then it also has no head\n            // in this case head points to new item\n            this.head = item;\n        }\n\n        // tail always points to new item\n        this.tail = item;\n    }\n\n    return this;\n};\n\nList.prototype.insertData = function(data, before) {\n    return this.insert(createItem(data), before);\n};\n\nList.prototype.remove = function(item) {\n    //      item\n    //       ^\n    // prev     next\n    this.updateCursors(item, item.prev, item, item.next);\n\n    if (item.prev !== null) {\n        item.prev.next = item.next;\n    } else {\n        if (this.head !== item) {\n            throw new Error('item doesn\\'t belong to list');\n        }\n\n        this.head = item.next;\n    }\n\n    if (item.next !== null) {\n        item.next.prev = item.prev;\n    } else {\n        if (this.tail !== item) {\n            throw new Error('item doesn\\'t belong to list');\n        }\n\n        this.tail = item.prev;\n    }\n\n    item.prev = null;\n    item.next = null;\n\n    return item;\n};\n\nList.prototype.push = function(data) {\n    this.insert(createItem(data));\n};\n\nList.prototype.pop = function() {\n    if (this.tail !== null) {\n        return this.remove(this.tail);\n    }\n};\n\nList.prototype.unshift = function(data) {\n    this.prepend(createItem(data));\n};\n\nList.prototype.shift = function() {\n    if (this.head !== null) {\n        return this.remove(this.head);\n    }\n};\n\nList.prototype.prependList = function(list) {\n    return this.insertList(list, this.head);\n};\n\nList.prototype.appendList = function(list) {\n    return this.insertList(list);\n};\n\nList.prototype.insertList = function(list, before) {\n    // ignore empty lists\n    if (list.head === null) {\n        return this;\n    }\n\n    if (before !== undefined && before !== null) {\n        this.updateCursors(before.prev, list.tail, before, list.head);\n\n        // insert in the middle of dist list\n        if (before.prev !== null) {\n            // before.prev <-> list.head\n            before.prev.next = list.head;\n            list.head.prev = before.prev;\n        } else {\n            this.head = list.head;\n        }\n\n        before.prev = list.tail;\n        list.tail.next = before;\n    } else {\n        this.updateCursors(this.tail, list.tail, null, list.head);\n\n        // insert to end of the list\n        if (this.tail !== null) {\n            // if destination list has a tail, then it also has a head,\n            // but head doesn't change\n\n            // dest tail -> source head\n            this.tail.next = list.head;\n\n            // dest tail <- source head\n            list.head.prev = this.tail;\n        } else {\n            // if list has no a tail, then it also has no a head\n            // in this case points head to new item\n            this.head = list.head;\n        }\n\n        // tail always start point to new item\n        this.tail = list.tail;\n    }\n\n    list.head = null;\n    list.tail = null;\n\n    return this;\n};\n\nList.prototype.replace = function(oldItem, newItemOrList) {\n    if ('head' in newItemOrList) {\n        this.insertList(newItemOrList, oldItem);\n    } else {\n        this.insert(newItemOrList, oldItem);\n    }\n\n    this.remove(oldItem);\n};\n\nmodule.exports = List;\n","module.exports = function createCustomError(name, message) {\n    // use Object.create(), because some VMs prevent setting line/column otherwise\n    // (iOS Safari 10 even throws an exception)\n    var error = Object.create(SyntaxError.prototype);\n    var errorStack = new Error();\n\n    error.name = name;\n    error.message = message;\n\n    Object.defineProperty(error, 'stack', {\n        get: function() {\n            return (errorStack.stack || '').replace(/^(.+\\n){1,3}/, name + ': ' + message + '\\n');\n        }\n    });\n\n    return error;\n};\n","var createCustomError = require('../utils/createCustomError');\nvar MAX_LINE_LENGTH = 100;\nvar OFFSET_CORRECTION = 60;\nvar TAB_REPLACEMENT = '    ';\n\nfunction sourceFragment(error, extraLines) {\n    function processLines(start, end) {\n        return lines.slice(start, end).map(function(line, idx) {\n            var num = String(start + idx + 1);\n\n            while (num.length < maxNumLength) {\n                num = ' ' + num;\n            }\n\n            return num + ' |' + line;\n        }).join('\\n');\n    }\n\n    var lines = error.source.split(/\\r\\n?|\\n|\\f/);\n    var line = error.line;\n    var column = error.column;\n    var startLine = Math.max(1, line - extraLines) - 1;\n    var endLine = Math.min(line + extraLines, lines.length + 1);\n    var maxNumLength = Math.max(4, String(endLine).length) + 1;\n    var cutLeft = 0;\n\n    // column correction according to replaced tab before column\n    column += (TAB_REPLACEMENT.length - 1) * (lines[line - 1].substr(0, column - 1).match(/\\t/g) || []).length;\n\n    if (column > MAX_LINE_LENGTH) {\n        cutLeft = column - OFFSET_CORRECTION + 3;\n        column = OFFSET_CORRECTION - 2;\n    }\n\n    for (var i = startLine; i <= endLine; i++) {\n        if (i >= 0 && i < lines.length) {\n            lines[i] = lines[i].replace(/\\t/g, TAB_REPLACEMENT);\n            lines[i] =\n                (cutLeft > 0 && lines[i].length > cutLeft ? '\\u2026' : '') +\n                lines[i].substr(cutLeft, MAX_LINE_LENGTH - 2) +\n                (lines[i].length > cutLeft + MAX_LINE_LENGTH - 1 ? '\\u2026' : '');\n        }\n    }\n\n    return [\n        processLines(startLine, line),\n        new Array(column + maxNumLength + 2).join('-') + '^',\n        processLines(line, endLine)\n    ].filter(Boolean).join('\\n');\n}\n\nvar SyntaxError = function(message, source, offset, line, column) {\n    var error = createCustomError('SyntaxError', message);\n\n    error.source = source;\n    error.offset = offset;\n    error.line = line;\n    error.column = column;\n\n    error.sourceFragment = function(extraLines) {\n        return sourceFragment(error, isNaN(extraLines) ? 0 : extraLines);\n    };\n    Object.defineProperty(error, 'formattedMessage', {\n        get: function() {\n            return (\n                'Parse error: ' + error.message + '\\n' +\n                sourceFragment(error, 2)\n            );\n        }\n    });\n\n    // for backward capability\n    error.parseError = {\n        offset: offset,\n        line: line,\n        column: column\n    };\n\n    return error;\n};\n\nmodule.exports = SyntaxError;\n","// CSS Syntax Module Level 3\n// https://www.w3.org/TR/css-syntax-3/\nvar TYPE = {\n    EOF: 0,                 // <EOF-token>\n    Ident: 1,               // <ident-token>\n    Function: 2,            // <function-token>\n    AtKeyword: 3,           // <at-keyword-token>\n    Hash: 4,                // <hash-token>\n    String: 5,              // <string-token>\n    BadString: 6,           // <bad-string-token>\n    Url: 7,                 // <url-token>\n    BadUrl: 8,              // <bad-url-token>\n    Delim: 9,               // <delim-token>\n    Number: 10,             // <number-token>\n    Percentage: 11,         // <percentage-token>\n    Dimension: 12,          // <dimension-token>\n    WhiteSpace: 13,         // <whitespace-token>\n    CDO: 14,                // <CDO-token>\n    CDC: 15,                // <CDC-token>\n    Colon: 16,              // <colon-token>     :\n    Semicolon: 17,          // <semicolon-token> ;\n    Comma: 18,              // <comma-token>     ,\n    LeftSquareBracket: 19,  // <[-token>\n    RightSquareBracket: 20, // <]-token>\n    LeftParenthesis: 21,    // <(-token>\n    RightParenthesis: 22,   // <)-token>\n    LeftCurlyBracket: 23,   // <{-token>\n    RightCurlyBracket: 24,  // <}-token>\n    Comment: 25\n};\n\nvar NAME = Object.keys(TYPE).reduce(function(result, key) {\n    result[TYPE[key]] = key;\n    return result;\n}, {});\n\nmodule.exports = {\n    TYPE: TYPE,\n    NAME: NAME\n};\n","var EOF = 0;\n\n// https://drafts.csswg.org/css-syntax-3/\n// § 4.2. Definitions\n\n// digit\n// A code point between U+0030 DIGIT ZERO (0) and U+0039 DIGIT NINE (9).\nfunction isDigit(code) {\n    return code >= 0x0030 && code <= 0x0039;\n}\n\n// hex digit\n// A digit, or a code point between U+0041 LATIN CAPITAL LETTER A (A) and U+0046 LATIN CAPITAL LETTER F (F),\n// or a code point between U+0061 LATIN SMALL LETTER A (a) and U+0066 LATIN SMALL LETTER F (f).\nfunction isHexDigit(code) {\n    return (\n        isDigit(code) || // 0 .. 9\n        (code >= 0x0041 && code <= 0x0046) || // A .. F\n        (code >= 0x0061 && code <= 0x0066)    // a .. f\n    );\n}\n\n// uppercase letter\n// A code point between U+0041 LATIN CAPITAL LETTER A (A) and U+005A LATIN CAPITAL LETTER Z (Z).\nfunction isUppercaseLetter(code) {\n    return code >= 0x0041 && code <= 0x005A;\n}\n\n// lowercase letter\n// A code point between U+0061 LATIN SMALL LETTER A (a) and U+007A LATIN SMALL LETTER Z (z).\nfunction isLowercaseLetter(code) {\n    return code >= 0x0061 && code <= 0x007A;\n}\n\n// letter\n// An uppercase letter or a lowercase letter.\nfunction isLetter(code) {\n    return isUppercaseLetter(code) || isLowercaseLetter(code);\n}\n\n// non-ASCII code point\n// A code point with a value equal to or greater than U+0080 <control>.\nfunction isNonAscii(code) {\n    return code >= 0x0080;\n}\n\n// name-start code point\n// A letter, a non-ASCII code point, or U+005F LOW LINE (_).\nfunction isNameStart(code) {\n    return isLetter(code) || isNonAscii(code) || code === 0x005F;\n}\n\n// name code point\n// A name-start code point, a digit, or U+002D HYPHEN-MINUS (-).\nfunction isName(code) {\n    return isNameStart(code) || isDigit(code) || code === 0x002D;\n}\n\n// non-printable code point\n// A code point between U+0000 NULL and U+0008 BACKSPACE, or U+000B LINE TABULATION,\n// or a code point between U+000E SHIFT OUT and U+001F INFORMATION SEPARATOR ONE, or U+007F DELETE.\nfunction isNonPrintable(code) {\n    return (\n        (code >= 0x0000 && code <= 0x0008) ||\n        (code === 0x000B) ||\n        (code >= 0x000E && code <= 0x001F) ||\n        (code === 0x007F)\n    );\n}\n\n// newline\n// U+000A LINE FEED. Note that U+000D CARRIAGE RETURN and U+000C FORM FEED are not included in this definition,\n// as they are converted to U+000A LINE FEED during preprocessing.\n// TODO: we doesn't do a preprocessing, so check a code point for U+000D CARRIAGE RETURN and U+000C FORM FEED\nfunction isNewline(code) {\n    return code === 0x000A || code === 0x000D || code === 0x000C;\n}\n\n// whitespace\n// A newline, U+0009 CHARACTER TABULATION, or U+0020 SPACE.\nfunction isWhiteSpace(code) {\n    return isNewline(code) || code === 0x0020 || code === 0x0009;\n}\n\n// § 4.3.8. Check if two code points are a valid escape\nfunction isValidEscape(first, second) {\n    // If the first code point is not U+005C REVERSE SOLIDUS (\\), return false.\n    if (first !== 0x005C) {\n        return false;\n    }\n\n    // Otherwise, if the second code point is a newline or EOF, return false.\n    if (isNewline(second) || second === EOF) {\n        return false;\n    }\n\n    // Otherwise, return true.\n    return true;\n}\n\n// § 4.3.9. Check if three code points would start an identifier\nfunction isIdentifierStart(first, second, third) {\n    // Look at the first code point:\n\n    // U+002D HYPHEN-MINUS\n    if (first === 0x002D) {\n        // If the second code point is a name-start code point or a U+002D HYPHEN-MINUS,\n        // or the second and third code points are a valid escape, return true. Otherwise, return false.\n        return (\n            isNameStart(second) ||\n            second === 0x002D ||\n            isValidEscape(second, third)\n        );\n    }\n\n    // name-start code point\n    if (isNameStart(first)) {\n        // Return true.\n        return true;\n    }\n\n    // U+005C REVERSE SOLIDUS (\\)\n    if (first === 0x005C) {\n        // If the first and second code points are a valid escape, return true. Otherwise, return false.\n        return isValidEscape(first, second);\n    }\n\n    // anything else\n    // Return false.\n    return false;\n}\n\n// § 4.3.10. Check if three code points would start a number\nfunction isNumberStart(first, second, third) {\n    // Look at the first code point:\n\n    // U+002B PLUS SIGN (+)\n    // U+002D HYPHEN-MINUS (-)\n    if (first === 0x002B || first === 0x002D) {\n        // If the second code point is a digit, return true.\n        if (isDigit(second)) {\n            return 2;\n        }\n\n        // Otherwise, if the second code point is a U+002E FULL STOP (.)\n        // and the third code point is a digit, return true.\n        // Otherwise, return false.\n        return second === 0x002E && isDigit(third) ? 3 : 0;\n    }\n\n    // U+002E FULL STOP (.)\n    if (first === 0x002E) {\n        // If the second code point is a digit, return true. Otherwise, return false.\n        return isDigit(second) ? 2 : 0;\n    }\n\n    // digit\n    if (isDigit(first)) {\n        // Return true.\n        return 1;\n    }\n\n    // anything else\n    // Return false.\n    return 0;\n}\n\n//\n// Misc\n//\n\n// detect BOM (https://en.wikipedia.org/wiki/Byte_order_mark)\nfunction isBOM(code) {\n    // UTF-16BE\n    if (code === 0xFEFF) {\n        return 1;\n    }\n\n    // UTF-16LE\n    if (code === 0xFFFE) {\n        return 1;\n    }\n\n    return 0;\n}\n\n// Fast code category\n//\n// https://drafts.csswg.org/css-syntax/#tokenizer-definitions\n// > non-ASCII code point\n// >   A code point with a value equal to or greater than U+0080 <control>\n// > name-start code point\n// >   A letter, a non-ASCII code point, or U+005F LOW LINE (_).\n// > name code point\n// >   A name-start code point, a digit, or U+002D HYPHEN-MINUS (-)\n// That means only ASCII code points has a special meaning and we define a maps for 0..127 codes only\nvar CATEGORY = new Array(0x80);\ncharCodeCategory.Eof = 0x80;\ncharCodeCategory.WhiteSpace = 0x82;\ncharCodeCategory.Digit = 0x83;\ncharCodeCategory.NameStart = 0x84;\ncharCodeCategory.NonPrintable = 0x85;\n\nfor (var i = 0; i < CATEGORY.length; i++) {\n    switch (true) {\n        case isWhiteSpace(i):\n            CATEGORY[i] = charCodeCategory.WhiteSpace;\n            break;\n\n        case isDigit(i):\n            CATEGORY[i] = charCodeCategory.Digit;\n            break;\n\n        case isNameStart(i):\n            CATEGORY[i] = charCodeCategory.NameStart;\n            break;\n\n        case isNonPrintable(i):\n            CATEGORY[i] = charCodeCategory.NonPrintable;\n            break;\n\n        default:\n            CATEGORY[i] = i || charCodeCategory.Eof;\n    }\n}\n\nfunction charCodeCategory(code) {\n    return code < 0x80 ? CATEGORY[code] : charCodeCategory.NameStart;\n};\n\nmodule.exports = {\n    isDigit: isDigit,\n    isHexDigit: isHexDigit,\n    isUppercaseLetter: isUppercaseLetter,\n    isLowercaseLetter: isLowercaseLetter,\n    isLetter: isLetter,\n    isNonAscii: isNonAscii,\n    isNameStart: isNameStart,\n    isName: isName,\n    isNonPrintable: isNonPrintable,\n    isNewline: isNewline,\n    isWhiteSpace: isWhiteSpace,\n    isValidEscape: isValidEscape,\n    isIdentifierStart: isIdentifierStart,\n    isNumberStart: isNumberStart,\n\n    isBOM: isBOM,\n    charCodeCategory: charCodeCategory\n};\n","var charCodeDef = require('./char-code-definitions');\nvar isDigit = charCodeDef.isDigit;\nvar isHexDigit = charCodeDef.isHexDigit;\nvar isUppercaseLetter = charCodeDef.isUppercaseLetter;\nvar isName = charCodeDef.isName;\nvar isWhiteSpace = charCodeDef.isWhiteSpace;\nvar isValidEscape = charCodeDef.isValidEscape;\n\nfunction getCharCode(source, offset) {\n    return offset < source.length ? source.charCodeAt(offset) : 0;\n}\n\nfunction getNewlineLength(source, offset, code) {\n    if (code === 13 /* \\r */ && getCharCode(source, offset + 1) === 10 /* \\n */) {\n        return 2;\n    }\n\n    return 1;\n}\n\nfunction cmpChar(testStr, offset, referenceCode) {\n    var code = testStr.charCodeAt(offset);\n\n    // code.toLowerCase() for A..Z\n    if (isUppercaseLetter(code)) {\n        code = code | 32;\n    }\n\n    return code === referenceCode;\n}\n\nfunction cmpStr(testStr, start, end, referenceStr) {\n    if (end - start !== referenceStr.length) {\n        return false;\n    }\n\n    if (start < 0 || end > testStr.length) {\n        return false;\n    }\n\n    for (var i = start; i < end; i++) {\n        var testCode = testStr.charCodeAt(i);\n        var referenceCode = referenceStr.charCodeAt(i - start);\n\n        // testCode.toLowerCase() for A..Z\n        if (isUppercaseLetter(testCode)) {\n            testCode = testCode | 32;\n        }\n\n        if (testCode !== referenceCode) {\n            return false;\n        }\n    }\n\n    return true;\n}\n\nfunction findWhiteSpaceStart(source, offset) {\n    for (; offset >= 0; offset--) {\n        if (!isWhiteSpace(source.charCodeAt(offset))) {\n            break;\n        }\n    }\n\n    return offset + 1;\n}\n\nfunction findWhiteSpaceEnd(source, offset) {\n    for (; offset < source.length; offset++) {\n        if (!isWhiteSpace(source.charCodeAt(offset))) {\n            break;\n        }\n    }\n\n    return offset;\n}\n\nfunction findDecimalNumberEnd(source, offset) {\n    for (; offset < source.length; offset++) {\n        if (!isDigit(source.charCodeAt(offset))) {\n            break;\n        }\n    }\n\n    return offset;\n}\n\n// § 4.3.7. Consume an escaped code point\nfunction consumeEscaped(source, offset) {\n    // It assumes that the U+005C REVERSE SOLIDUS (\\) has already been consumed and\n    // that the next input code point has already been verified to be part of a valid escape.\n    offset += 2;\n\n    // hex digit\n    if (isHexDigit(getCharCode(source, offset - 1))) {\n        // Consume as many hex digits as possible, but no more than 5.\n        // Note that this means 1-6 hex digits have been consumed in total.\n        for (var maxOffset = Math.min(source.length, offset + 5); offset < maxOffset; offset++) {\n            if (!isHexDigit(getCharCode(source, offset))) {\n                break;\n            }\n        }\n\n        // If the next input code point is whitespace, consume it as well.\n        var code = getCharCode(source, offset);\n        if (isWhiteSpace(code)) {\n            offset += getNewlineLength(source, offset, code);\n        }\n    }\n\n    return offset;\n}\n\n// §4.3.11. Consume a name\n// Note: This algorithm does not do the verification of the first few code points that are necessary\n// to ensure the returned code points would constitute an <ident-token>. If that is the intended use,\n// ensure that the stream starts with an identifier before calling this algorithm.\nfunction consumeName(source, offset) {\n    // Let result initially be an empty string.\n    // Repeatedly consume the next input code point from the stream:\n    for (; offset < source.length; offset++) {\n        var code = source.charCodeAt(offset);\n\n        // name code point\n        if (isName(code)) {\n            // Append the code point to result.\n            continue;\n        }\n\n        // the stream starts with a valid escape\n        if (isValidEscape(code, getCharCode(source, offset + 1))) {\n            // Consume an escaped code point. Append the returned code point to result.\n            offset = consumeEscaped(source, offset) - 1;\n            continue;\n        }\n\n        // anything else\n        // Reconsume the current input code point. Return result.\n        break;\n    }\n\n    return offset;\n}\n\n// §4.3.12. Consume a number\nfunction consumeNumber(source, offset) {\n    var code = source.charCodeAt(offset);\n\n    // 2. If the next input code point is U+002B PLUS SIGN (+) or U+002D HYPHEN-MINUS (-),\n    // consume it and append it to repr.\n    if (code === 0x002B || code === 0x002D) {\n        code = source.charCodeAt(offset += 1);\n    }\n\n    // 3. While the next input code point is a digit, consume it and append it to repr.\n    if (isDigit(code)) {\n        offset = findDecimalNumberEnd(source, offset + 1);\n        code = source.charCodeAt(offset);\n    }\n\n    // 4. If the next 2 input code points are U+002E FULL STOP (.) followed by a digit, then:\n    if (code === 0x002E && isDigit(source.charCodeAt(offset + 1))) {\n        // 4.1 Consume them.\n        // 4.2 Append them to repr.\n        code = source.charCodeAt(offset += 2);\n\n        // 4.3 Set type to \"number\".\n        // TODO\n\n        // 4.4 While the next input code point is a digit, consume it and append it to repr.\n\n        offset = findDecimalNumberEnd(source, offset);\n    }\n\n    // 5. If the next 2 or 3 input code points are U+0045 LATIN CAPITAL LETTER E (E)\n    // or U+0065 LATIN SMALL LETTER E (e), ... , followed by a digit, then:\n    if (cmpChar(source, offset, 101 /* e */)) {\n        var sign = 0;\n        code = source.charCodeAt(offset + 1);\n\n        // ... optionally followed by U+002D HYPHEN-MINUS (-) or U+002B PLUS SIGN (+) ...\n        if (code === 0x002D || code === 0x002B) {\n            sign = 1;\n            code = source.charCodeAt(offset + 2);\n        }\n\n        // ... followed by a digit\n        if (isDigit(code)) {\n            // 5.1 Consume them.\n            // 5.2 Append them to repr.\n\n            // 5.3 Set type to \"number\".\n            // TODO\n\n            // 5.4 While the next input code point is a digit, consume it and append it to repr.\n            offset = findDecimalNumberEnd(source, offset + 1 + sign + 1);\n        }\n    }\n\n    return offset;\n}\n\n// § 4.3.14. Consume the remnants of a bad url\n// ... its sole use is to consume enough of the input stream to reach a recovery point\n// where normal tokenizing can resume.\nfunction consumeBadUrlRemnants(source, offset) {\n    // Repeatedly consume the next input code point from the stream:\n    for (; offset < source.length; offset++) {\n        var code = source.charCodeAt(offset);\n\n        // U+0029 RIGHT PARENTHESIS ())\n        // EOF\n        if (code === 0x0029) {\n            // Return.\n            offset++;\n            break;\n        }\n\n        if (isValidEscape(code, getCharCode(source, offset + 1))) {\n            // Consume an escaped code point.\n            // Note: This allows an escaped right parenthesis (\"\\)\") to be encountered\n            // without ending the <bad-url-token>. This is otherwise identical to\n            // the \"anything else\" clause.\n            offset = consumeEscaped(source, offset);\n        }\n    }\n\n    return offset;\n}\n\nmodule.exports = {\n    consumeEscaped: consumeEscaped,\n    consumeName: consumeName,\n    consumeNumber: consumeNumber,\n    consumeBadUrlRemnants: consumeBadUrlRemnants,\n\n    cmpChar: cmpChar,\n    cmpStr: cmpStr,\n\n    getNewlineLength: getNewlineLength,\n    findWhiteSpaceStart: findWhiteSpaceStart,\n    findWhiteSpaceEnd: findWhiteSpaceEnd\n};\n","var constants = require('../tokenizer/const');\nvar TYPE = constants.TYPE;\nvar NAME = constants.NAME;\n\nvar utils = require('../tokenizer/utils');\nvar cmpStr = utils.cmpStr;\n\nvar EOF = TYPE.EOF;\nvar WHITESPACE = TYPE.WhiteSpace;\nvar COMMENT = TYPE.Comment;\n\nvar OFFSET_MASK = 0x00FFFFFF;\nvar TYPE_SHIFT = 24;\n\nvar TokenStream = function() {\n    this.offsetAndType = null;\n    this.balance = null;\n\n    this.reset();\n};\n\nTokenStream.prototype = {\n    reset: function() {\n        this.eof = false;\n        this.tokenIndex = -1;\n        this.tokenType = 0;\n        this.tokenStart = this.firstCharOffset;\n        this.tokenEnd = this.firstCharOffset;\n    },\n\n    lookupType: function(offset) {\n        offset += this.tokenIndex;\n\n        if (offset < this.tokenCount) {\n            return this.offsetAndType[offset] >> TYPE_SHIFT;\n        }\n\n        return EOF;\n    },\n    lookupOffset: function(offset) {\n        offset += this.tokenIndex;\n\n        if (offset < this.tokenCount) {\n            return this.offsetAndType[offset - 1] & OFFSET_MASK;\n        }\n\n        return this.source.length;\n    },\n    lookupValue: function(offset, referenceStr) {\n        offset += this.tokenIndex;\n\n        if (offset < this.tokenCount) {\n            return cmpStr(\n                this.source,\n                this.offsetAndType[offset - 1] & OFFSET_MASK,\n                this.offsetAndType[offset] & OFFSET_MASK,\n                referenceStr\n            );\n        }\n\n        return false;\n    },\n    getTokenStart: function(tokenIndex) {\n        if (tokenIndex === this.tokenIndex) {\n            return this.tokenStart;\n        }\n\n        if (tokenIndex > 0) {\n            return tokenIndex < this.tokenCount\n                ? this.offsetAndType[tokenIndex - 1] & OFFSET_MASK\n                : this.offsetAndType[this.tokenCount] & OFFSET_MASK;\n        }\n\n        return this.firstCharOffset;\n    },\n\n    // TODO: -> skipUntilBalanced\n    getRawLength: function(startToken, mode) {\n        var cursor = startToken;\n        var balanceEnd;\n        var offset = this.offsetAndType[Math.max(cursor - 1, 0)] & OFFSET_MASK;\n        var type;\n\n        loop:\n        for (; cursor < this.tokenCount; cursor++) {\n            balanceEnd = this.balance[cursor];\n\n            // stop scanning on balance edge that points to offset before start token\n            if (balanceEnd < startToken) {\n                break loop;\n            }\n\n            type = this.offsetAndType[cursor] >> TYPE_SHIFT;\n\n            // check token is stop type\n            switch (mode(type, this.source, offset)) {\n                case 1:\n                    break loop;\n\n                case 2:\n                    cursor++;\n                    break loop;\n\n                default:\n                    // fast forward to the end of balanced block\n                    if (this.balance[balanceEnd] === cursor) {\n                        cursor = balanceEnd;\n                    }\n\n                    offset = this.offsetAndType[cursor] & OFFSET_MASK;\n            }\n        }\n\n        return cursor - this.tokenIndex;\n    },\n    isBalanceEdge: function(pos) {\n        return this.balance[this.tokenIndex] < pos;\n    },\n    isDelim: function(code, offset) {\n        if (offset) {\n            return (\n                this.lookupType(offset) === TYPE.Delim &&\n                this.source.charCodeAt(this.lookupOffset(offset)) === code\n            );\n        }\n\n        return (\n            this.tokenType === TYPE.Delim &&\n            this.source.charCodeAt(this.tokenStart) === code\n        );\n    },\n\n    getTokenValue: function() {\n        return this.source.substring(this.tokenStart, this.tokenEnd);\n    },\n    getTokenLength: function() {\n        return this.tokenEnd - this.tokenStart;\n    },\n    substrToCursor: function(start) {\n        return this.source.substring(start, this.tokenStart);\n    },\n\n    skipWS: function() {\n        for (var i = this.tokenIndex, skipTokenCount = 0; i < this.tokenCount; i++, skipTokenCount++) {\n            if ((this.offsetAndType[i] >> TYPE_SHIFT) !== WHITESPACE) {\n                break;\n            }\n        }\n\n        if (skipTokenCount > 0) {\n            this.skip(skipTokenCount);\n        }\n    },\n    skipSC: function() {\n        while (this.tokenType === WHITESPACE || this.tokenType === COMMENT) {\n            this.next();\n        }\n    },\n    skip: function(tokenCount) {\n        var next = this.tokenIndex + tokenCount;\n\n        if (next < this.tokenCount) {\n            this.tokenIndex = next;\n            this.tokenStart = this.offsetAndType[next - 1] & OFFSET_MASK;\n            next = this.offsetAndType[next];\n            this.tokenType = next >> TYPE_SHIFT;\n            this.tokenEnd = next & OFFSET_MASK;\n        } else {\n            this.tokenIndex = this.tokenCount;\n            this.next();\n        }\n    },\n    next: function() {\n        var next = this.tokenIndex + 1;\n\n        if (next < this.tokenCount) {\n            this.tokenIndex = next;\n            this.tokenStart = this.tokenEnd;\n            next = this.offsetAndType[next];\n            this.tokenType = next >> TYPE_SHIFT;\n            this.tokenEnd = next & OFFSET_MASK;\n        } else {\n            this.tokenIndex = this.tokenCount;\n            this.eof = true;\n            this.tokenType = EOF;\n            this.tokenStart = this.tokenEnd = this.source.length;\n        }\n    },\n\n    forEachToken(fn) {\n        for (var i = 0, offset = this.firstCharOffset; i < this.tokenCount; i++) {\n            var start = offset;\n            var item = this.offsetAndType[i];\n            var end = item & OFFSET_MASK;\n            var type = item >> TYPE_SHIFT;\n\n            offset = end;\n\n            fn(type, start, end, i);\n        }\n    },\n\n    dump() {\n        var tokens = new Array(this.tokenCount);\n\n        this.forEachToken((type, start, end, index) => {\n            tokens[index] = {\n                idx: index,\n                type: NAME[type],\n                chunk: this.source.substring(start, end),\n                balance: this.balance[index]\n            };\n        });\n\n        return tokens;\n    }\n};\n\nmodule.exports = TokenStream;\n","function noop(value) {\n    return value;\n}\n\nfunction generateMultiplier(multiplier) {\n    if (multiplier.min === 0 && multiplier.max === 0) {\n        return '*';\n    }\n\n    if (multiplier.min === 0 && multiplier.max === 1) {\n        return '?';\n    }\n\n    if (multiplier.min === 1 && multiplier.max === 0) {\n        return multiplier.comma ? '#' : '+';\n    }\n\n    if (multiplier.min === 1 && multiplier.max === 1) {\n        return '';\n    }\n\n    return (\n        (multiplier.comma ? '#' : '') +\n        (multiplier.min === multiplier.max\n            ? '{' + multiplier.min + '}'\n            : '{' + multiplier.min + ',' + (multiplier.max !== 0 ? multiplier.max : '') + '}'\n        )\n    );\n}\n\nfunction generateTypeOpts(node) {\n    switch (node.type) {\n        case 'Range':\n            return (\n                ' [' +\n                (node.min === null ? '-∞' : node.min) +\n                ',' +\n                (node.max === null ? '∞' : node.max) +\n                ']'\n            );\n\n        default:\n            throw new Error('Unknown node type `' + node.type + '`');\n    }\n}\n\nfunction generateSequence(node, decorate, forceBraces, compact) {\n    var combinator = node.combinator === ' ' || compact ? node.combinator : ' ' + node.combinator + ' ';\n    var result = node.terms.map(function(term) {\n        return generate(term, decorate, forceBraces, compact);\n    }).join(combinator);\n\n    if (node.explicit || forceBraces) {\n        result = (compact || result[0] === ',' ? '[' : '[ ') + result + (compact ? ']' : ' ]');\n    }\n\n    return result;\n}\n\nfunction generate(node, decorate, forceBraces, compact) {\n    var result;\n\n    switch (node.type) {\n        case 'Group':\n            result =\n                generateSequence(node, decorate, forceBraces, compact) +\n                (node.disallowEmpty ? '!' : '');\n            break;\n\n        case 'Multiplier':\n            // return since node is a composition\n            return (\n                generate(node.term, decorate, forceBraces, compact) +\n                decorate(generateMultiplier(node), node)\n            );\n\n        case 'Type':\n            result = '<' + node.name + (node.opts ? decorate(generateTypeOpts(node.opts), node.opts) : '') + '>';\n            break;\n\n        case 'Property':\n            result = '<\\'' + node.name + '\\'>';\n            break;\n\n        case 'Keyword':\n            result = node.name;\n            break;\n\n        case 'AtKeyword':\n            result = '@' + node.name;\n            break;\n\n        case 'Function':\n            result = node.name + '(';\n            break;\n\n        case 'String':\n        case 'Token':\n            result = node.value;\n            break;\n\n        case 'Comma':\n            result = ',';\n            break;\n\n        default:\n            throw new Error('Unknown node type `' + node.type + '`');\n    }\n\n    return decorate(result, node);\n}\n\nmodule.exports = function(node, options) {\n    var decorate = noop;\n    var forceBraces = false;\n    var compact = false;\n\n    if (typeof options === 'function') {\n        decorate = options;\n    } else if (options) {\n        forceBraces = Boolean(options.forceBraces);\n        compact = Boolean(options.compact);\n        if (typeof options.decorate === 'function') {\n            decorate = options.decorate;\n        }\n    }\n\n    return generate(node, decorate, forceBraces, compact);\n};\n","const createCustomError = require('../utils/createCustomError');\nconst generate = require('../definition-syntax/generate');\nconst defaultLoc = { offset: 0, line: 1, column: 1 };\n\nfunction locateMismatch(matchResult, node) {\n    const tokens = matchResult.tokens;\n    const longestMatch = matchResult.longestMatch;\n    const mismatchNode = longestMatch < tokens.length ? tokens[longestMatch].node || null : null;\n    const badNode = mismatchNode !== node ? mismatchNode : null;\n    let mismatchOffset = 0;\n    let mismatchLength = 0;\n    let entries = 0;\n    let css = '';\n    let start;\n    let end;\n\n    for (let i = 0; i < tokens.length; i++) {\n        const token = tokens[i].value;\n\n        if (i === longestMatch) {\n            mismatchLength = token.length;\n            mismatchOffset = css.length;\n        }\n\n        if (badNode !== null && tokens[i].node === badNode) {\n            if (i <= longestMatch) {\n                entries++;\n            } else {\n                entries = 0;\n            }\n        }\n\n        css += token;\n    }\n\n    if (longestMatch === tokens.length || entries > 1) { // last\n        start = fromLoc(badNode || node, 'end') || buildLoc(defaultLoc, css);\n        end = buildLoc(start);\n    } else {\n        start = fromLoc(badNode, 'start') ||\n            buildLoc(fromLoc(node, 'start') || defaultLoc, css.slice(0, mismatchOffset));\n        end = fromLoc(badNode, 'end') ||\n            buildLoc(start, css.substr(mismatchOffset, mismatchLength));\n    }\n\n    return {\n        css,\n        mismatchOffset,\n        mismatchLength,\n        start,\n        end\n    };\n}\n\nfunction fromLoc(node, point) {\n    const value = node && node.loc && node.loc[point];\n\n    if (value) {\n        return 'line' in value ? buildLoc(value) : value;\n    }\n\n    return null;\n}\n\nfunction buildLoc({ offset, line, column }, extra) {\n    const loc = {\n        offset,\n        line,\n        column\n    };\n\n    if (extra) {\n        const lines = extra.split(/\\n|\\r\\n?|\\f/);\n\n        loc.offset += extra.length;\n        loc.line += lines.length - 1;\n        loc.column = lines.length === 1 ? loc.column + extra.length : lines.pop().length + 1;\n    }\n\n    return loc;\n}\n\nconst SyntaxReferenceError = function(type, referenceName) {\n    const error = createCustomError(\n        'SyntaxReferenceError',\n        type + (referenceName ? ' `' + referenceName + '`' : '')\n    );\n\n    error.reference = referenceName;\n\n    return error;\n};\n\nconst SyntaxMatchError = function(message, syntax, node, matchResult) {\n    const error = createCustomError('SyntaxMatchError', message);\n    const {\n        css,\n        mismatchOffset,\n        mismatchLength,\n        start,\n        end\n    } = locateMismatch(matchResult, node);\n\n    error.rawMessage = message;\n    error.syntax = syntax ? generate(syntax) : '<generic>';\n    error.css = css;\n    error.mismatchOffset = mismatchOffset;\n    error.mismatchLength = mismatchLength;\n    error.message = message + '\\n' +\n        '  syntax: ' + error.syntax + '\\n' +\n        '   value: ' + (css || '<empty string>') + '\\n' +\n        '  --------' + new Array(error.mismatchOffset + 1).join('-') + '^';\n\n    Object.assign(error, start);\n    error.loc = {\n        source: (node && node.loc && node.loc.source) || '<unknown>',\n        start,\n        end\n    };\n\n    return error;\n};\n\nmodule.exports = {\n    SyntaxReferenceError,\n    SyntaxMatchError\n};\n","var hasOwnProperty = Object.prototype.hasOwnProperty;\nvar keywords = Object.create(null);\nvar properties = Object.create(null);\nvar HYPHENMINUS = 45; // '-'.charCodeAt()\n\nfunction isCustomProperty(str, offset) {\n    offset = offset || 0;\n\n    return str.length - offset >= 2 &&\n           str.charCodeAt(offset) === HYPHENMINUS &&\n           str.charCodeAt(offset + 1) === HYPHENMINUS;\n}\n\nfunction getVendorPrefix(str, offset) {\n    offset = offset || 0;\n\n    // verdor prefix should be at least 3 chars length\n    if (str.length - offset >= 3) {\n        // vendor prefix starts with hyper minus following non-hyper minus\n        if (str.charCodeAt(offset) === HYPHENMINUS &&\n            str.charCodeAt(offset + 1) !== HYPHENMINUS) {\n            // vendor prefix should contain a hyper minus at the ending\n            var secondDashIndex = str.indexOf('-', offset + 2);\n\n            if (secondDashIndex !== -1) {\n                return str.substring(offset, secondDashIndex + 1);\n            }\n        }\n    }\n\n    return '';\n}\n\nfunction getKeywordDescriptor(keyword) {\n    if (hasOwnProperty.call(keywords, keyword)) {\n        return keywords[keyword];\n    }\n\n    var name = keyword.toLowerCase();\n\n    if (hasOwnProperty.call(keywords, name)) {\n        return keywords[keyword] = keywords[name];\n    }\n\n    var custom = isCustomProperty(name, 0);\n    var vendor = !custom ? getVendorPrefix(name, 0) : '';\n\n    return keywords[keyword] = Object.freeze({\n        basename: name.substr(vendor.length),\n        name: name,\n        vendor: vendor,\n        prefix: vendor,\n        custom: custom\n    });\n}\n\nfunction getPropertyDescriptor(property) {\n    if (hasOwnProperty.call(properties, property)) {\n        return properties[property];\n    }\n\n    var name = property;\n    var hack = property[0];\n\n    if (hack === '/') {\n        hack = property[1] === '/' ? '//' : '/';\n    } else if (hack !== '_' &&\n               hack !== '*' &&\n               hack !== '$' &&\n               hack !== '#' &&\n               hack !== '+' &&\n               hack !== '&') {\n        hack = '';\n    }\n\n    var custom = isCustomProperty(name, hack.length);\n\n    // re-use result when possible (the same as for lower case)\n    if (!custom) {\n        name = name.toLowerCase();\n        if (hasOwnProperty.call(properties, name)) {\n            return properties[property] = properties[name];\n        }\n    }\n\n    var vendor = !custom ? getVendorPrefix(name, hack.length) : '';\n    var prefix = name.substr(0, hack.length + vendor.length);\n\n    return properties[property] = Object.freeze({\n        basename: name.substr(prefix.length),\n        name: name.substr(hack.length),\n        hack: hack,\n        vendor: vendor,\n        prefix: prefix,\n        custom: custom\n    });\n}\n\nmodule.exports = {\n    keyword: getKeywordDescriptor,\n    property: getPropertyDescriptor,\n    isCustomProperty: isCustomProperty,\n    vendorPrefix: getVendorPrefix\n};\n","var MIN_SIZE = 16 * 1024;\nvar SafeUint32Array = typeof Uint32Array !== 'undefined' ? Uint32Array : Array; // fallback on Array when TypedArray is not supported\n\nmodule.exports = function adoptBuffer(buffer, size) {\n    if (buffer === null || buffer.length < size) {\n        return new SafeUint32Array(Math.max(size + 1024, MIN_SIZE));\n    }\n\n    return buffer;\n};\n","var TokenStream = require('../common/TokenStream');\nvar adoptBuffer = require('../common/adopt-buffer');\n\nvar constants = require('./const');\nvar TYPE = constants.TYPE;\n\nvar charCodeDefinitions = require('./char-code-definitions');\nvar isNewline = charCodeDefinitions.isNewline;\nvar isName = charCodeDefinitions.isName;\nvar isValidEscape = charCodeDefinitions.isValidEscape;\nvar isNumberStart = charCodeDefinitions.isNumberStart;\nvar isIdentifierStart = charCodeDefinitions.isIdentifierStart;\nvar charCodeCategory = charCodeDefinitions.charCodeCategory;\nvar isBOM = charCodeDefinitions.isBOM;\n\nvar utils = require('./utils');\nvar cmpStr = utils.cmpStr;\nvar getNewlineLength = utils.getNewlineLength;\nvar findWhiteSpaceEnd = utils.findWhiteSpaceEnd;\nvar consumeEscaped = utils.consumeEscaped;\nvar consumeName = utils.consumeName;\nvar consumeNumber = utils.consumeNumber;\nvar consumeBadUrlRemnants = utils.consumeBadUrlRemnants;\n\nvar OFFSET_MASK = 0x00FFFFFF;\nvar TYPE_SHIFT = 24;\n\nfunction tokenize(source, stream) {\n    function getCharCode(offset) {\n        return offset < sourceLength ? source.charCodeAt(offset) : 0;\n    }\n\n    // § 4.3.3. Consume a numeric token\n    function consumeNumericToken() {\n        // Consume a number and let number be the result.\n        offset = consumeNumber(source, offset);\n\n        // If the next 3 input code points would start an identifier, then:\n        if (isIdentifierStart(getCharCode(offset), getCharCode(offset + 1), getCharCode(offset + 2))) {\n            // Create a <dimension-token> with the same value and type flag as number, and a unit set initially to the empty string.\n            // Consume a name. Set the <dimension-token>’s unit to the returned value.\n            // Return the <dimension-token>.\n            type = TYPE.Dimension;\n            offset = consumeName(source, offset);\n            return;\n        }\n\n        // Otherwise, if the next input code point is U+0025 PERCENTAGE SIGN (%), consume it.\n        if (getCharCode(offset) === 0x0025) {\n            // Create a <percentage-token> with the same value as number, and return it.\n            type = TYPE.Percentage;\n            offset++;\n            return;\n        }\n\n        // Otherwise, create a <number-token> with the same value and type flag as number, and return it.\n        type = TYPE.Number;\n    }\n\n    // § 4.3.4. Consume an ident-like token\n    function consumeIdentLikeToken() {\n        const nameStartOffset = offset;\n\n        // Consume a name, and let string be the result.\n        offset = consumeName(source, offset);\n\n        // If string’s value is an ASCII case-insensitive match for \"url\",\n        // and the next input code point is U+0028 LEFT PARENTHESIS ((), consume it.\n        if (cmpStr(source, nameStartOffset, offset, 'url') && getCharCode(offset) === 0x0028) {\n            // While the next two input code points are whitespace, consume the next input code point.\n            offset = findWhiteSpaceEnd(source, offset + 1);\n\n            // If the next one or two input code points are U+0022 QUOTATION MARK (\"), U+0027 APOSTROPHE ('),\n            // or whitespace followed by U+0022 QUOTATION MARK (\") or U+0027 APOSTROPHE ('),\n            // then create a <function-token> with its value set to string and return it.\n            if (getCharCode(offset) === 0x0022 ||\n                getCharCode(offset) === 0x0027) {\n                type = TYPE.Function;\n                offset = nameStartOffset + 4;\n                return;\n            }\n\n            // Otherwise, consume a url token, and return it.\n            consumeUrlToken();\n            return;\n        }\n\n        // Otherwise, if the next input code point is U+0028 LEFT PARENTHESIS ((), consume it.\n        // Create a <function-token> with its value set to string and return it.\n        if (getCharCode(offset) === 0x0028) {\n            type = TYPE.Function;\n            offset++;\n            return;\n        }\n\n        // Otherwise, create an <ident-token> with its value set to string and return it.\n        type = TYPE.Ident;\n    }\n\n    // § 4.3.5. Consume a string token\n    function consumeStringToken(endingCodePoint) {\n        // This algorithm may be called with an ending code point, which denotes the code point\n        // that ends the string. If an ending code point is not specified,\n        // the current input code point is used.\n        if (!endingCodePoint) {\n            endingCodePoint = getCharCode(offset++);\n        }\n\n        // Initially create a <string-token> with its value set to the empty string.\n        type = TYPE.String;\n\n        // Repeatedly consume the next input code point from the stream:\n        for (; offset < source.length; offset++) {\n            var code = source.charCodeAt(offset);\n\n            switch (charCodeCategory(code)) {\n                // ending code point\n                case endingCodePoint:\n                    // Return the <string-token>.\n                    offset++;\n                    return;\n\n                // EOF\n                case charCodeCategory.Eof:\n                    // This is a parse error. Return the <string-token>.\n                    return;\n\n                // newline\n                case charCodeCategory.WhiteSpace:\n                    if (isNewline(code)) {\n                        // This is a parse error. Reconsume the current input code point,\n                        // create a <bad-string-token>, and return it.\n                        offset += getNewlineLength(source, offset, code);\n                        type = TYPE.BadString;\n                        return;\n                    }\n                    break;\n\n                // U+005C REVERSE SOLIDUS (\\)\n                case 0x005C:\n                    // If the next input code point is EOF, do nothing.\n                    if (offset === source.length - 1) {\n                        break;\n                    }\n\n                    var nextCode = getCharCode(offset + 1);\n\n                    // Otherwise, if the next input code point is a newline, consume it.\n                    if (isNewline(nextCode)) {\n                        offset += getNewlineLength(source, offset + 1, nextCode);\n                    } else if (isValidEscape(code, nextCode)) {\n                        // Otherwise, (the stream starts with a valid escape) consume\n                        // an escaped code point and append the returned code point to\n                        // the <string-token>’s value.\n                        offset = consumeEscaped(source, offset) - 1;\n                    }\n                    break;\n\n                // anything else\n                // Append the current input code point to the <string-token>’s value.\n            }\n        }\n    }\n\n    // § 4.3.6. Consume a url token\n    // Note: This algorithm assumes that the initial \"url(\" has already been consumed.\n    // This algorithm also assumes that it’s being called to consume an \"unquoted\" value, like url(foo).\n    // A quoted value, like url(\"foo\"), is parsed as a <function-token>. Consume an ident-like token\n    // automatically handles this distinction; this algorithm shouldn’t be called directly otherwise.\n    function consumeUrlToken() {\n        // Initially create a <url-token> with its value set to the empty string.\n        type = TYPE.Url;\n\n        // Consume as much whitespace as possible.\n        offset = findWhiteSpaceEnd(source, offset);\n\n        // Repeatedly consume the next input code point from the stream:\n        for (; offset < source.length; offset++) {\n            var code = source.charCodeAt(offset);\n\n            switch (charCodeCategory(code)) {\n                // U+0029 RIGHT PARENTHESIS ())\n                case 0x0029:\n                    // Return the <url-token>.\n                    offset++;\n                    return;\n\n                // EOF\n                case charCodeCategory.Eof:\n                    // This is a parse error. Return the <url-token>.\n                    return;\n\n                // whitespace\n                case charCodeCategory.WhiteSpace:\n                    // Consume as much whitespace as possible.\n                    offset = findWhiteSpaceEnd(source, offset);\n\n                    // If the next input code point is U+0029 RIGHT PARENTHESIS ()) or EOF,\n                    // consume it and return the <url-token>\n                    // (if EOF was encountered, this is a parse error);\n                    if (getCharCode(offset) === 0x0029 || offset >= source.length) {\n                        if (offset < source.length) {\n                            offset++;\n                        }\n                        return;\n                    }\n\n                    // otherwise, consume the remnants of a bad url, create a <bad-url-token>,\n                    // and return it.\n                    offset = consumeBadUrlRemnants(source, offset);\n                    type = TYPE.BadUrl;\n                    return;\n\n                // U+0022 QUOTATION MARK (\")\n                // U+0027 APOSTROPHE (')\n                // U+0028 LEFT PARENTHESIS (()\n                // non-printable code point\n                case 0x0022:\n                case 0x0027:\n                case 0x0028:\n                case charCodeCategory.NonPrintable:\n                    // This is a parse error. Consume the remnants of a bad url,\n                    // create a <bad-url-token>, and return it.\n                    offset = consumeBadUrlRemnants(source, offset);\n                    type = TYPE.BadUrl;\n                    return;\n\n                // U+005C REVERSE SOLIDUS (\\)\n                case 0x005C:\n                    // If the stream starts with a valid escape, consume an escaped code point and\n                    // append the returned code point to the <url-token>’s value.\n                    if (isValidEscape(code, getCharCode(offset + 1))) {\n                        offset = consumeEscaped(source, offset) - 1;\n                        break;\n                    }\n\n                    // Otherwise, this is a parse error. Consume the remnants of a bad url,\n                    // create a <bad-url-token>, and return it.\n                    offset = consumeBadUrlRemnants(source, offset);\n                    type = TYPE.BadUrl;\n                    return;\n\n                // anything else\n                // Append the current input code point to the <url-token>’s value.\n            }\n        }\n    }\n\n    if (!stream) {\n        stream = new TokenStream();\n    }\n\n    // ensure source is a string\n    source = String(source || '');\n\n    var sourceLength = source.length;\n    var offsetAndType = adoptBuffer(stream.offsetAndType, sourceLength + 1); // +1 because of eof-token\n    var balance = adoptBuffer(stream.balance, sourceLength + 1);\n    var tokenCount = 0;\n    var start = isBOM(getCharCode(0));\n    var offset = start;\n    var balanceCloseType = 0;\n    var balanceStart = 0;\n    var balancePrev = 0;\n\n    // https://drafts.csswg.org/css-syntax-3/#consume-token\n    // § 4.3.1. Consume a token\n    while (offset < sourceLength) {\n        var code = source.charCodeAt(offset);\n        var type = 0;\n\n        balance[tokenCount] = sourceLength;\n\n        switch (charCodeCategory(code)) {\n            // whitespace\n            case charCodeCategory.WhiteSpace:\n                // Consume as much whitespace as possible. Return a <whitespace-token>.\n                type = TYPE.WhiteSpace;\n                offset = findWhiteSpaceEnd(source, offset + 1);\n                break;\n\n            // U+0022 QUOTATION MARK (\")\n            case 0x0022:\n                // Consume a string token and return it.\n                consumeStringToken();\n                break;\n\n            // U+0023 NUMBER SIGN (#)\n            case 0x0023:\n                // If the next input code point is a name code point or the next two input code points are a valid escape, then:\n                if (isName(getCharCode(offset + 1)) || isValidEscape(getCharCode(offset + 1), getCharCode(offset + 2))) {\n                    // Create a <hash-token>.\n                    type = TYPE.Hash;\n\n                    // If the next 3 input code points would start an identifier, set the <hash-token>’s type flag to \"id\".\n                    // if (isIdentifierStart(getCharCode(offset + 1), getCharCode(offset + 2), getCharCode(offset + 3))) {\n                    //     // TODO: set id flag\n                    // }\n\n                    // Consume a name, and set the <hash-token>’s value to the returned string.\n                    offset = consumeName(source, offset + 1);\n\n                    // Return the <hash-token>.\n                } else {\n                    // Otherwise, return a <delim-token> with its value set to the current input code point.\n                    type = TYPE.Delim;\n                    offset++;\n                }\n\n                break;\n\n            // U+0027 APOSTROPHE (')\n            case 0x0027:\n                // Consume a string token and return it.\n                consumeStringToken();\n                break;\n\n            // U+0028 LEFT PARENTHESIS (()\n            case 0x0028:\n                // Return a <(-token>.\n                type = TYPE.LeftParenthesis;\n                offset++;\n                break;\n\n            // U+0029 RIGHT PARENTHESIS ())\n            case 0x0029:\n                // Return a <)-token>.\n                type = TYPE.RightParenthesis;\n                offset++;\n                break;\n\n            // U+002B PLUS SIGN (+)\n            case 0x002B:\n                // If the input stream starts with a number, ...\n                if (isNumberStart(code, getCharCode(offset + 1), getCharCode(offset + 2))) {\n                    // ... reconsume the current input code point, consume a numeric token, and return it.\n                    consumeNumericToken();\n                } else {\n                    // Otherwise, return a <delim-token> with its value set to the current input code point.\n                    type = TYPE.Delim;\n                    offset++;\n                }\n                break;\n\n            // U+002C COMMA (,)\n            case 0x002C:\n                // Return a <comma-token>.\n                type = TYPE.Comma;\n                offset++;\n                break;\n\n            // U+002D HYPHEN-MINUS (-)\n            case 0x002D:\n                // If the input stream starts with a number, reconsume the current input code point, consume a numeric token, and return it.\n                if (isNumberStart(code, getCharCode(offset + 1), getCharCode(offset + 2))) {\n                    consumeNumericToken();\n                } else {\n                    // Otherwise, if the next 2 input code points are U+002D HYPHEN-MINUS U+003E GREATER-THAN SIGN (->), consume them and return a <CDC-token>.\n                    if (getCharCode(offset + 1) === 0x002D &&\n                        getCharCode(offset + 2) === 0x003E) {\n                        type = TYPE.CDC;\n                        offset = offset + 3;\n                    } else {\n                        // Otherwise, if the input stream starts with an identifier, ...\n                        if (isIdentifierStart(code, getCharCode(offset + 1), getCharCode(offset + 2))) {\n                            // ... reconsume the current input code point, consume an ident-like token, and return it.\n                            consumeIdentLikeToken();\n                        } else {\n                            // Otherwise, return a <delim-token> with its value set to the current input code point.\n                            type = TYPE.Delim;\n                            offset++;\n                        }\n                    }\n                }\n                break;\n\n            // U+002E FULL STOP (.)\n            case 0x002E:\n                // If the input stream starts with a number, ...\n                if (isNumberStart(code, getCharCode(offset + 1), getCharCode(offset + 2))) {\n                    // ... reconsume the current input code point, consume a numeric token, and return it.\n                    consumeNumericToken();\n                } else {\n                    // Otherwise, return a <delim-token> with its value set to the current input code point.\n                    type = TYPE.Delim;\n                    offset++;\n                }\n\n                break;\n\n            // U+002F SOLIDUS (/)\n            case 0x002F:\n                // If the next two input code point are U+002F SOLIDUS (/) followed by a U+002A ASTERISK (*),\n                if (getCharCode(offset + 1) === 0x002A) {\n                    // ... consume them and all following code points up to and including the first U+002A ASTERISK (*)\n                    // followed by a U+002F SOLIDUS (/), or up to an EOF code point.\n                    type = TYPE.Comment;\n                    offset = source.indexOf('*/', offset + 2) + 2;\n                    if (offset === 1) {\n                        offset = source.length;\n                    }\n                } else {\n                    type = TYPE.Delim;\n                    offset++;\n                }\n                break;\n\n            // U+003A COLON (:)\n            case 0x003A:\n                // Return a <colon-token>.\n                type = TYPE.Colon;\n                offset++;\n                break;\n\n            // U+003B SEMICOLON (;)\n            case 0x003B:\n                // Return a <semicolon-token>.\n                type = TYPE.Semicolon;\n                offset++;\n                break;\n\n            // U+003C LESS-THAN SIGN (<)\n            case 0x003C:\n                // If the next 3 input code points are U+0021 EXCLAMATION MARK U+002D HYPHEN-MINUS U+002D HYPHEN-MINUS (!--), ...\n                if (getCharCode(offset + 1) === 0x0021 &&\n                    getCharCode(offset + 2) === 0x002D &&\n                    getCharCode(offset + 3) === 0x002D) {\n                    // ... consume them and return a <CDO-token>.\n                    type = TYPE.CDO;\n                    offset = offset + 4;\n                } else {\n                    // Otherwise, return a <delim-token> with its value set to the current input code point.\n                    type = TYPE.Delim;\n                    offset++;\n                }\n\n                break;\n\n            // U+0040 COMMERCIAL AT (@)\n            case 0x0040:\n                // If the next 3 input code points would start an identifier, ...\n                if (isIdentifierStart(getCharCode(offset + 1), getCharCode(offset + 2), getCharCode(offset + 3))) {\n                    // ... consume a name, create an <at-keyword-token> with its value set to the returned value, and return it.\n                    type = TYPE.AtKeyword;\n                    offset = consumeName(source, offset + 1);\n                } else {\n                    // Otherwise, return a <delim-token> with its value set to the current input code point.\n                    type = TYPE.Delim;\n                    offset++;\n                }\n\n                break;\n\n            // U+005B LEFT SQUARE BRACKET ([)\n            case 0x005B:\n                // Return a <[-token>.\n                type = TYPE.LeftSquareBracket;\n                offset++;\n                break;\n\n            // U+005C REVERSE SOLIDUS (\\)\n            case 0x005C:\n                // If the input stream starts with a valid escape, ...\n                if (isValidEscape(code, getCharCode(offset + 1))) {\n                    // ... reconsume the current input code point, consume an ident-like token, and return it.\n                    consumeIdentLikeToken();\n                } else {\n                    // Otherwise, this is a parse error. Return a <delim-token> with its value set to the current input code point.\n                    type = TYPE.Delim;\n                    offset++;\n                }\n                break;\n\n            // U+005D RIGHT SQUARE BRACKET (])\n            case 0x005D:\n                // Return a <]-token>.\n                type = TYPE.RightSquareBracket;\n                offset++;\n                break;\n\n            // U+007B LEFT CURLY BRACKET ({)\n            case 0x007B:\n                // Return a <{-token>.\n                type = TYPE.LeftCurlyBracket;\n                offset++;\n                break;\n\n            // U+007D RIGHT CURLY BRACKET (})\n            case 0x007D:\n                // Return a <}-token>.\n                type = TYPE.RightCurlyBracket;\n                offset++;\n                break;\n\n            // digit\n            case charCodeCategory.Digit:\n                // Reconsume the current input code point, consume a numeric token, and return it.\n                consumeNumericToken();\n                break;\n\n            // name-start code point\n            case charCodeCategory.NameStart:\n                // Reconsume the current input code point, consume an ident-like token, and return it.\n                consumeIdentLikeToken();\n                break;\n\n            // EOF\n            case charCodeCategory.Eof:\n                // Return an <EOF-token>.\n                break;\n\n            // anything else\n            default:\n                // Return a <delim-token> with its value set to the current input code point.\n                type = TYPE.Delim;\n                offset++;\n        }\n\n        switch (type) {\n            case balanceCloseType:\n                balancePrev = balanceStart & OFFSET_MASK;\n                balanceStart = balance[balancePrev];\n                balanceCloseType = balanceStart >> TYPE_SHIFT;\n                balance[tokenCount] = balancePrev;\n                balance[balancePrev++] = tokenCount;\n                for (; balancePrev < tokenCount; balancePrev++) {\n                    if (balance[balancePrev] === sourceLength) {\n                        balance[balancePrev] = tokenCount;\n                    }\n                }\n                break;\n\n            case TYPE.LeftParenthesis:\n            case TYPE.Function:\n                balance[tokenCount] = balanceStart;\n                balanceCloseType = TYPE.RightParenthesis;\n                balanceStart = (balanceCloseType << TYPE_SHIFT) | tokenCount;\n                break;\n\n            case TYPE.LeftSquareBracket:\n                balance[tokenCount] = balanceStart;\n                balanceCloseType = TYPE.RightSquareBracket;\n                balanceStart = (balanceCloseType << TYPE_SHIFT) | tokenCount;\n                break;\n\n            case TYPE.LeftCurlyBracket:\n                balance[tokenCount] = balanceStart;\n                balanceCloseType = TYPE.RightCurlyBracket;\n                balanceStart = (balanceCloseType << TYPE_SHIFT) | tokenCount;\n                break;\n        }\n\n        offsetAndType[tokenCount++] = (type << TYPE_SHIFT) | offset;\n    }\n\n    // finalize buffers\n    offsetAndType[tokenCount] = (TYPE.EOF << TYPE_SHIFT) | offset; // <EOF-token>\n    balance[tokenCount] = sourceLength;\n    balance[sourceLength] = sourceLength; // prevents false positive balance match with any token\n    while (balanceStart !== 0) {\n        balancePrev = balanceStart & OFFSET_MASK;\n        balanceStart = balance[balancePrev];\n        balance[balancePrev] = sourceLength;\n    }\n\n    // update stream\n    stream.source = source;\n    stream.firstCharOffset = start;\n    stream.offsetAndType = offsetAndType;\n    stream.tokenCount = tokenCount;\n    stream.balance = balance;\n    stream.reset();\n    stream.next();\n\n    return stream;\n}\n\n// extend tokenizer with constants\nObject.keys(constants).forEach(function(key) {\n    tokenize[key] = constants[key];\n});\n\n// extend tokenizer with static methods from utils\nObject.keys(charCodeDefinitions).forEach(function(key) {\n    tokenize[key] = charCodeDefinitions[key];\n});\nObject.keys(utils).forEach(function(key) {\n    tokenize[key] = utils[key];\n});\n\nmodule.exports = tokenize;\n","var isDigit = require('../tokenizer').isDigit;\nvar cmpChar = require('../tokenizer').cmpChar;\nvar TYPE = require('../tokenizer').TYPE;\n\nvar DELIM = TYPE.Delim;\nvar WHITESPACE = TYPE.WhiteSpace;\nvar COMMENT = TYPE.Comment;\nvar IDENT = TYPE.Ident;\nvar NUMBER = TYPE.Number;\nvar DIMENSION = TYPE.Dimension;\nvar PLUSSIGN = 0x002B;    // U+002B PLUS SIGN (+)\nvar HYPHENMINUS = 0x002D; // U+002D HYPHEN-MINUS (-)\nvar N = 0x006E;           // U+006E LATIN SMALL LETTER N (n)\nvar DISALLOW_SIGN = true;\nvar ALLOW_SIGN = false;\n\nfunction isDelim(token, code) {\n    return token !== null && token.type === DELIM && token.value.charCodeAt(0) === code;\n}\n\nfunction skipSC(token, offset, getNextToken) {\n    while (token !== null && (token.type === WHITESPACE || token.type === COMMENT)) {\n        token = getNextToken(++offset);\n    }\n\n    return offset;\n}\n\nfunction checkInteger(token, valueOffset, disallowSign, offset) {\n    if (!token) {\n        return 0;\n    }\n\n    var code = token.value.charCodeAt(valueOffset);\n\n    if (code === PLUSSIGN || code === HYPHENMINUS) {\n        if (disallowSign) {\n            // Number sign is not allowed\n            return 0;\n        }\n        valueOffset++;\n    }\n\n    for (; valueOffset < token.value.length; valueOffset++) {\n        if (!isDigit(token.value.charCodeAt(valueOffset))) {\n            // Integer is expected\n            return 0;\n        }\n    }\n\n    return offset + 1;\n}\n\n// ... <signed-integer>\n// ... ['+' | '-'] <signless-integer>\nfunction consumeB(token, offset_, getNextToken) {\n    var sign = false;\n    var offset = skipSC(token, offset_, getNextToken);\n\n    token = getNextToken(offset);\n\n    if (token === null) {\n        return offset_;\n    }\n\n    if (token.type !== NUMBER) {\n        if (isDelim(token, PLUSSIGN) || isDelim(token, HYPHENMINUS)) {\n            sign = true;\n            offset = skipSC(getNextToken(++offset), offset, getNextToken);\n            token = getNextToken(offset);\n\n            if (token === null && token.type !== NUMBER) {\n                return 0;\n            }\n        } else {\n            return offset_;\n        }\n    }\n\n    if (!sign) {\n        var code = token.value.charCodeAt(0);\n        if (code !== PLUSSIGN && code !== HYPHENMINUS) {\n            // Number sign is expected\n            return 0;\n        }\n    }\n\n    return checkInteger(token, sign ? 0 : 1, sign, offset);\n}\n\n// An+B microsyntax https://www.w3.org/TR/css-syntax-3/#anb\nmodule.exports = function anPlusB(token, getNextToken) {\n    /* eslint-disable brace-style*/\n    var offset = 0;\n\n    if (!token) {\n        return 0;\n    }\n\n    // <integer>\n    if (token.type === NUMBER) {\n        return checkInteger(token, 0, ALLOW_SIGN, offset); // b\n    }\n\n    // -n\n    // -n <signed-integer>\n    // -n ['+' | '-'] <signless-integer>\n    // -n- <signless-integer>\n    // <dashndashdigit-ident>\n    else if (token.type === IDENT && token.value.charCodeAt(0) === HYPHENMINUS) {\n        // expect 1st char is N\n        if (!cmpChar(token.value, 1, N)) {\n            return 0;\n        }\n\n        switch (token.value.length) {\n            // -n\n            // -n <signed-integer>\n            // -n ['+' | '-'] <signless-integer>\n            case 2:\n                return consumeB(getNextToken(++offset), offset, getNextToken);\n\n            // -n- <signless-integer>\n            case 3:\n                if (token.value.charCodeAt(2) !== HYPHENMINUS) {\n                    return 0;\n                }\n\n                offset = skipSC(getNextToken(++offset), offset, getNextToken);\n                token = getNextToken(offset);\n\n                return checkInteger(token, 0, DISALLOW_SIGN, offset);\n\n            // <dashndashdigit-ident>\n            default:\n                if (token.value.charCodeAt(2) !== HYPHENMINUS) {\n                    return 0;\n                }\n\n                return checkInteger(token, 3, DISALLOW_SIGN, offset);\n        }\n    }\n\n    // '+'? n\n    // '+'? n <signed-integer>\n    // '+'? n ['+' | '-'] <signless-integer>\n    // '+'? n- <signless-integer>\n    // '+'? <ndashdigit-ident>\n    else if (token.type === IDENT || (isDelim(token, PLUSSIGN) && getNextToken(offset + 1).type === IDENT)) {\n        // just ignore a plus\n        if (token.type !== IDENT) {\n            token = getNextToken(++offset);\n        }\n\n        if (token === null || !cmpChar(token.value, 0, N)) {\n            return 0;\n        }\n\n        switch (token.value.length) {\n            // '+'? n\n            // '+'? n <signed-integer>\n            // '+'? n ['+' | '-'] <signless-integer>\n            case 1:\n                return consumeB(getNextToken(++offset), offset, getNextToken);\n\n            // '+'? n- <signless-integer>\n            case 2:\n                if (token.value.charCodeAt(1) !== HYPHENMINUS) {\n                    return 0;\n                }\n\n                offset = skipSC(getNextToken(++offset), offset, getNextToken);\n                token = getNextToken(offset);\n\n                return checkInteger(token, 0, DISALLOW_SIGN, offset);\n\n            // '+'? <ndashdigit-ident>\n            default:\n                if (token.value.charCodeAt(1) !== HYPHENMINUS) {\n                    return 0;\n                }\n\n                return checkInteger(token, 2, DISALLOW_SIGN, offset);\n        }\n    }\n\n    // <ndashdigit-dimension>\n    // <ndash-dimension> <signless-integer>\n    // <n-dimension>\n    // <n-dimension> <signed-integer>\n    // <n-dimension> ['+' | '-'] <signless-integer>\n    else if (token.type === DIMENSION) {\n        var code = token.value.charCodeAt(0);\n        var sign = code === PLUSSIGN || code === HYPHENMINUS ? 1 : 0;\n\n        for (var i = sign; i < token.value.length; i++) {\n            if (!isDigit(token.value.charCodeAt(i))) {\n                break;\n            }\n        }\n\n        if (i === sign) {\n            // Integer is expected\n            return 0;\n        }\n\n        if (!cmpChar(token.value, i, N)) {\n            return 0;\n        }\n\n        // <n-dimension>\n        // <n-dimension> <signed-integer>\n        // <n-dimension> ['+' | '-'] <signless-integer>\n        if (i + 1 === token.value.length) {\n            return consumeB(getNextToken(++offset), offset, getNextToken);\n        } else {\n            if (token.value.charCodeAt(i + 1) !== HYPHENMINUS) {\n                return 0;\n            }\n\n            // <ndash-dimension> <signless-integer>\n            if (i + 2 === token.value.length) {\n                offset = skipSC(getNextToken(++offset), offset, getNextToken);\n                token = getNextToken(offset);\n\n                return checkInteger(token, 0, DISALLOW_SIGN, offset);\n            }\n            // <ndashdigit-dimension>\n            else {\n                return checkInteger(token, i + 2, DISALLOW_SIGN, offset);\n            }\n        }\n    }\n\n    return 0;\n};\n","var isHexDigit = require('../tokenizer').isHexDigit;\nvar cmpChar = require('../tokenizer').cmpChar;\nvar TYPE = require('../tokenizer').TYPE;\n\nvar IDENT = TYPE.Ident;\nvar DELIM = TYPE.Delim;\nvar NUMBER = TYPE.Number;\nvar DIMENSION = TYPE.Dimension;\nvar PLUSSIGN = 0x002B;     // U+002B PLUS SIGN (+)\nvar HYPHENMINUS = 0x002D;  // U+002D HYPHEN-MINUS (-)\nvar QUESTIONMARK = 0x003F; // U+003F QUESTION MARK (?)\nvar U = 0x0075;            // U+0075 LATIN SMALL LETTER U (u)\n\nfunction isDelim(token, code) {\n    return token !== null && token.type === DELIM && token.value.charCodeAt(0) === code;\n}\n\nfunction startsWith(token, code) {\n    return token.value.charCodeAt(0) === code;\n}\n\nfunction hexSequence(token, offset, allowDash) {\n    for (var pos = offset, hexlen = 0; pos < token.value.length; pos++) {\n        var code = token.value.charCodeAt(pos);\n\n        if (code === HYPHENMINUS && allowDash && hexlen !== 0) {\n            if (hexSequence(token, offset + hexlen + 1, false) > 0) {\n                return 6; // dissallow following question marks\n            }\n\n            return 0; // dash at the ending of a hex sequence is not allowed\n        }\n\n        if (!isHexDigit(code)) {\n            return 0; // not a hex digit\n        }\n\n        if (++hexlen > 6) {\n            return 0; // too many hex digits\n        };\n    }\n\n    return hexlen;\n}\n\nfunction withQuestionMarkSequence(consumed, length, getNextToken) {\n    if (!consumed) {\n        return 0; // nothing consumed\n    }\n\n    while (isDelim(getNextToken(length), QUESTIONMARK)) {\n        if (++consumed > 6) {\n            return 0; // too many question marks\n        }\n\n        length++;\n    }\n\n    return length;\n}\n\n// https://drafts.csswg.org/css-syntax/#urange\n// Informally, the <urange> production has three forms:\n// U+0001\n//      Defines a range consisting of a single code point, in this case the code point \"1\".\n// U+0001-00ff\n//      Defines a range of codepoints between the first and the second value, in this case\n//      the range between \"1\" and \"ff\" (255 in decimal) inclusive.\n// U+00??\n//      Defines a range of codepoints where the \"?\" characters range over all hex digits,\n//      in this case defining the same as the value U+0000-00ff.\n// In each form, a maximum of 6 digits is allowed for each hexadecimal number (if you treat \"?\" as a hexadecimal digit).\n//\n// <urange> =\n//   u '+' <ident-token> '?'* |\n//   u <dimension-token> '?'* |\n//   u <number-token> '?'* |\n//   u <number-token> <dimension-token> |\n//   u <number-token> <number-token> |\n//   u '+' '?'+\nmodule.exports = function urange(token, getNextToken) {\n    var length = 0;\n\n    // should start with `u` or `U`\n    if (token === null || token.type !== IDENT || !cmpChar(token.value, 0, U)) {\n        return 0;\n    }\n\n    token = getNextToken(++length);\n    if (token === null) {\n        return 0;\n    }\n\n    // u '+' <ident-token> '?'*\n    // u '+' '?'+\n    if (isDelim(token, PLUSSIGN)) {\n        token = getNextToken(++length);\n        if (token === null) {\n            return 0;\n        }\n\n        if (token.type === IDENT) {\n            // u '+' <ident-token> '?'*\n            return withQuestionMarkSequence(hexSequence(token, 0, true), ++length, getNextToken);\n        }\n\n        if (isDelim(token, QUESTIONMARK)) {\n            // u '+' '?'+\n            return withQuestionMarkSequence(1, ++length, getNextToken);\n        }\n\n        // Hex digit or question mark is expected\n        return 0;\n    }\n\n    // u <number-token> '?'*\n    // u <number-token> <dimension-token>\n    // u <number-token> <number-token>\n    if (token.type === NUMBER) {\n        if (!startsWith(token, PLUSSIGN)) {\n            return 0;\n        }\n\n        var consumedHexLength = hexSequence(token, 1, true);\n        if (consumedHexLength === 0) {\n            return 0;\n        }\n\n        token = getNextToken(++length);\n        if (token === null) {\n            // u <number-token> <eof>\n            return length;\n        }\n\n        if (token.type === DIMENSION || token.type === NUMBER) {\n            // u <number-token> <dimension-token>\n            // u <number-token> <number-token>\n            if (!startsWith(token, HYPHENMINUS) || !hexSequence(token, 1, false)) {\n                return 0;\n            }\n\n            return length + 1;\n        }\n\n        // u <number-token> '?'*\n        return withQuestionMarkSequence(consumedHexLength, length, getNextToken);\n    }\n\n    // u <dimension-token> '?'*\n    if (token.type === DIMENSION) {\n        if (!startsWith(token, PLUSSIGN)) {\n            return 0;\n        }\n\n        return withQuestionMarkSequence(hexSequence(token, 1, true), ++length, getNextToken);\n    }\n\n    return 0;\n};\n","var tokenizer = require('../tokenizer');\nvar isIdentifierStart = tokenizer.isIdentifierStart;\nvar isHexDigit = tokenizer.isHexDigit;\nvar isDigit = tokenizer.isDigit;\nvar cmpStr = tokenizer.cmpStr;\nvar consumeNumber = tokenizer.consumeNumber;\nvar TYPE = tokenizer.TYPE;\nvar anPlusB = require('./generic-an-plus-b');\nvar urange = require('./generic-urange');\n\nvar cssWideKeywords = ['unset', 'initial', 'inherit'];\nvar calcFunctionNames = ['calc(', '-moz-calc(', '-webkit-calc('];\n\n// https://www.w3.org/TR/css-values-3/#lengths\nvar LENGTH = {\n    // absolute length units\n    'px': true,\n    'mm': true,\n    'cm': true,\n    'in': true,\n    'pt': true,\n    'pc': true,\n    'q': true,\n\n    // relative length units\n    'em': true,\n    'ex': true,\n    'ch': true,\n    'rem': true,\n\n    // viewport-percentage lengths\n    'vh': true,\n    'vw': true,\n    'vmin': true,\n    'vmax': true,\n    'vm': true\n};\n\nvar ANGLE = {\n    'deg': true,\n    'grad': true,\n    'rad': true,\n    'turn': true\n};\n\nvar TIME = {\n    's': true,\n    'ms': true\n};\n\nvar FREQUENCY = {\n    'hz': true,\n    'khz': true\n};\n\n// https://www.w3.org/TR/css-values-3/#resolution (https://drafts.csswg.org/css-values/#resolution)\nvar RESOLUTION = {\n    'dpi': true,\n    'dpcm': true,\n    'dppx': true,\n    'x': true      // https://github.com/w3c/csswg-drafts/issues/461\n};\n\n// https://drafts.csswg.org/css-grid/#fr-unit\nvar FLEX = {\n    'fr': true\n};\n\n// https://www.w3.org/TR/css3-speech/#mixing-props-voice-volume\nvar DECIBEL = {\n    'db': true\n};\n\n// https://www.w3.org/TR/css3-speech/#voice-props-voice-pitch\nvar SEMITONES = {\n    'st': true\n};\n\n// safe char code getter\nfunction charCode(str, index) {\n    return index < str.length ? str.charCodeAt(index) : 0;\n}\n\nfunction eqStr(actual, expected) {\n    return cmpStr(actual, 0, actual.length, expected);\n}\n\nfunction eqStrAny(actual, expected) {\n    for (var i = 0; i < expected.length; i++) {\n        if (eqStr(actual, expected[i])) {\n            return true;\n        }\n    }\n\n    return false;\n}\n\n// IE postfix hack, i.e. 123\\0 or 123px\\9\nfunction isPostfixIeHack(str, offset) {\n    if (offset !== str.length - 2) {\n        return false;\n    }\n\n    return (\n        str.charCodeAt(offset) === 0x005C &&  // U+005C REVERSE SOLIDUS (\\)\n        isDigit(str.charCodeAt(offset + 1))\n    );\n}\n\nfunction outOfRange(opts, value, numEnd) {\n    if (opts && opts.type === 'Range') {\n        var num = Number(\n            numEnd !== undefined && numEnd !== value.length\n                ? value.substr(0, numEnd)\n                : value\n        );\n\n        if (isNaN(num)) {\n            return true;\n        }\n\n        if (opts.min !== null && num < opts.min) {\n            return true;\n        }\n\n        if (opts.max !== null && num > opts.max) {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nfunction consumeFunction(token, getNextToken) {\n    var startIdx = token.index;\n    var length = 0;\n\n    // balanced token consuming\n    do {\n        length++;\n\n        if (token.balance <= startIdx) {\n            break;\n        }\n    } while (token = getNextToken(length));\n\n    return length;\n}\n\n// TODO: implement\n// can be used wherever <length>, <frequency>, <angle>, <time>, <percentage>, <number>, or <integer> values are allowed\n// https://drafts.csswg.org/css-values/#calc-notation\nfunction calc(next) {\n    return function(token, getNextToken, opts) {\n        if (token === null) {\n            return 0;\n        }\n\n        if (token.type === TYPE.Function && eqStrAny(token.value, calcFunctionNames)) {\n            return consumeFunction(token, getNextToken);\n        }\n\n        return next(token, getNextToken, opts);\n    };\n}\n\nfunction tokenType(expectedTokenType) {\n    return function(token) {\n        if (token === null || token.type !== expectedTokenType) {\n            return 0;\n        }\n\n        return 1;\n    };\n}\n\nfunction func(name) {\n    name = name + '(';\n\n    return function(token, getNextToken) {\n        if (token !== null && eqStr(token.value, name)) {\n            return consumeFunction(token, getNextToken);\n        }\n\n        return 0;\n    };\n}\n\n// =========================\n// Complex types\n//\n\n// https://drafts.csswg.org/css-values-4/#custom-idents\n// 4.2. Author-defined Identifiers: the <custom-ident> type\n// Some properties accept arbitrary author-defined identifiers as a component value.\n// This generic data type is denoted by <custom-ident>, and represents any valid CSS identifier\n// that would not be misinterpreted as a pre-defined keyword in that property’s value definition.\n//\n// See also: https://developer.mozilla.org/en-US/docs/Web/CSS/custom-ident\nfunction customIdent(token) {\n    if (token === null || token.type !== TYPE.Ident) {\n        return 0;\n    }\n\n    var name = token.value.toLowerCase();\n\n    // The CSS-wide keywords are not valid <custom-ident>s\n    if (eqStrAny(name, cssWideKeywords)) {\n        return 0;\n    }\n\n    // The default keyword is reserved and is also not a valid <custom-ident>\n    if (eqStr(name, 'default')) {\n        return 0;\n    }\n\n    // TODO: ignore property specific keywords (as described https://developer.mozilla.org/en-US/docs/Web/CSS/custom-ident)\n    // Specifications using <custom-ident> must specify clearly what other keywords\n    // are excluded from <custom-ident>, if any—for example by saying that any pre-defined keywords\n    // in that property’s value definition are excluded. Excluded keywords are excluded\n    // in all ASCII case permutations.\n\n    return 1;\n}\n\n// https://drafts.csswg.org/css-variables/#typedef-custom-property-name\n// A custom property is any property whose name starts with two dashes (U+002D HYPHEN-MINUS), like --foo.\n// The <custom-property-name> production corresponds to this: it’s defined as any valid identifier\n// that starts with two dashes, except -- itself, which is reserved for future use by CSS.\n// NOTE: Current implementation treat `--` as a valid name since most (all?) major browsers treat it as valid.\nfunction customPropertyName(token) {\n    // ... defined as any valid identifier\n    if (token === null || token.type !== TYPE.Ident) {\n        return 0;\n    }\n\n    // ... that starts with two dashes (U+002D HYPHEN-MINUS)\n    if (charCode(token.value, 0) !== 0x002D || charCode(token.value, 1) !== 0x002D) {\n        return 0;\n    }\n\n    return 1;\n}\n\n// https://drafts.csswg.org/css-color-4/#hex-notation\n// The syntax of a <hex-color> is a <hash-token> token whose value consists of 3, 4, 6, or 8 hexadecimal digits.\n// In other words, a hex color is written as a hash character, \"#\", followed by some number of digits 0-9 or\n// letters a-f (the case of the letters doesn’t matter - #00ff00 is identical to #00FF00).\nfunction hexColor(token) {\n    if (token === null || token.type !== TYPE.Hash) {\n        return 0;\n    }\n\n    var length = token.value.length;\n\n    // valid values (length): #rgb (4), #rgba (5), #rrggbb (7), #rrggbbaa (9)\n    if (length !== 4 && length !== 5 && length !== 7 && length !== 9) {\n        return 0;\n    }\n\n    for (var i = 1; i < length; i++) {\n        if (!isHexDigit(token.value.charCodeAt(i))) {\n            return 0;\n        }\n    }\n\n    return 1;\n}\n\nfunction idSelector(token) {\n    if (token === null || token.type !== TYPE.Hash) {\n        return 0;\n    }\n\n    if (!isIdentifierStart(charCode(token.value, 1), charCode(token.value, 2), charCode(token.value, 3))) {\n        return 0;\n    }\n\n    return 1;\n}\n\n// https://drafts.csswg.org/css-syntax/#any-value\n// It represents the entirety of what a valid declaration can have as its value.\nfunction declarationValue(token, getNextToken) {\n    if (!token) {\n        return 0;\n    }\n\n    var length = 0;\n    var level = 0;\n    var startIdx = token.index;\n\n    // The <declaration-value> production matches any sequence of one or more tokens,\n    // so long as the sequence ...\n    scan:\n    do {\n        switch (token.type) {\n            // ... does not contain <bad-string-token>, <bad-url-token>,\n            case TYPE.BadString:\n            case TYPE.BadUrl:\n                break scan;\n\n            // ... unmatched <)-token>, <]-token>, or <}-token>,\n            case TYPE.RightCurlyBracket:\n            case TYPE.RightParenthesis:\n            case TYPE.RightSquareBracket:\n                if (token.balance > token.index || token.balance < startIdx) {\n                    break scan;\n                }\n\n                level--;\n                break;\n\n            // ... or top-level <semicolon-token> tokens\n            case TYPE.Semicolon:\n                if (level === 0) {\n                    break scan;\n                }\n\n                break;\n\n            // ... or <delim-token> tokens with a value of \"!\"\n            case TYPE.Delim:\n                if (token.value === '!' && level === 0) {\n                    break scan;\n                }\n\n                break;\n\n            case TYPE.Function:\n            case TYPE.LeftParenthesis:\n            case TYPE.LeftSquareBracket:\n            case TYPE.LeftCurlyBracket:\n                level++;\n                break;\n        }\n\n        length++;\n\n        // until balance closing\n        if (token.balance <= startIdx) {\n            break;\n        }\n    } while (token = getNextToken(length));\n\n    return length;\n}\n\n// https://drafts.csswg.org/css-syntax/#any-value\n// The <any-value> production is identical to <declaration-value>, but also\n// allows top-level <semicolon-token> tokens and <delim-token> tokens\n// with a value of \"!\". It represents the entirety of what valid CSS can be in any context.\nfunction anyValue(token, getNextToken) {\n    if (!token) {\n        return 0;\n    }\n\n    var startIdx = token.index;\n    var length = 0;\n\n    // The <any-value> production matches any sequence of one or more tokens,\n    // so long as the sequence ...\n    scan:\n    do {\n        switch (token.type) {\n            // ... does not contain <bad-string-token>, <bad-url-token>,\n            case TYPE.BadString:\n            case TYPE.BadUrl:\n                break scan;\n\n            // ... unmatched <)-token>, <]-token>, or <}-token>,\n            case TYPE.RightCurlyBracket:\n            case TYPE.RightParenthesis:\n            case TYPE.RightSquareBracket:\n                if (token.balance > token.index || token.balance < startIdx) {\n                    break scan;\n                }\n\n                break;\n        }\n\n        length++;\n\n        // until balance closing\n        if (token.balance <= startIdx) {\n            break;\n        }\n    } while (token = getNextToken(length));\n\n    return length;\n}\n\n// =========================\n// Dimensions\n//\n\nfunction dimension(type) {\n    return function(token, getNextToken, opts) {\n        if (token === null || token.type !== TYPE.Dimension) {\n            return 0;\n        }\n\n        var numberEnd = consumeNumber(token.value, 0);\n\n        // check unit\n        if (type !== null) {\n            // check for IE postfix hack, i.e. 123px\\0 or 123px\\9\n            var reverseSolidusOffset = token.value.indexOf('\\\\', numberEnd);\n            var unit = reverseSolidusOffset === -1 || !isPostfixIeHack(token.value, reverseSolidusOffset)\n                ? token.value.substr(numberEnd)\n                : token.value.substring(numberEnd, reverseSolidusOffset);\n\n            if (type.hasOwnProperty(unit.toLowerCase()) === false) {\n                return 0;\n            }\n        }\n\n        // check range if specified\n        if (outOfRange(opts, token.value, numberEnd)) {\n            return 0;\n        }\n\n        return 1;\n    };\n}\n\n// =========================\n// Percentage\n//\n\n// §5.5. Percentages: the <percentage> type\n// https://drafts.csswg.org/css-values-4/#percentages\nfunction percentage(token, getNextToken, opts) {\n    // ... corresponds to the <percentage-token> production\n    if (token === null || token.type !== TYPE.Percentage) {\n        return 0;\n    }\n\n    // check range if specified\n    if (outOfRange(opts, token.value, token.value.length - 1)) {\n        return 0;\n    }\n\n    return 1;\n}\n\n// =========================\n// Numeric\n//\n\n// https://drafts.csswg.org/css-values-4/#numbers\n// The value <zero> represents a literal number with the value 0. Expressions that merely\n// evaluate to a <number> with the value 0 (for example, calc(0)) do not match <zero>;\n// only literal <number-token>s do.\nfunction zero(next) {\n    if (typeof next !== 'function') {\n        next = function() {\n            return 0;\n        };\n    }\n\n    return function(token, getNextToken, opts) {\n        if (token !== null && token.type === TYPE.Number) {\n            if (Number(token.value) === 0) {\n                return 1;\n            }\n        }\n\n        return next(token, getNextToken, opts);\n    };\n}\n\n// § 5.3. Real Numbers: the <number> type\n// https://drafts.csswg.org/css-values-4/#numbers\n// Number values are denoted by <number>, and represent real numbers, possibly with a fractional component.\n// ... It corresponds to the <number-token> production\nfunction number(token, getNextToken, opts) {\n    if (token === null) {\n        return 0;\n    }\n\n    var numberEnd = consumeNumber(token.value, 0);\n    var isNumber = numberEnd === token.value.length;\n    if (!isNumber && !isPostfixIeHack(token.value, numberEnd)) {\n        return 0;\n    }\n\n    // check range if specified\n    if (outOfRange(opts, token.value, numberEnd)) {\n        return 0;\n    }\n\n    return 1;\n}\n\n// §5.2. Integers: the <integer> type\n// https://drafts.csswg.org/css-values-4/#integers\nfunction integer(token, getNextToken, opts) {\n    // ... corresponds to a subset of the <number-token> production\n    if (token === null || token.type !== TYPE.Number) {\n        return 0;\n    }\n\n    // The first digit of an integer may be immediately preceded by `-` or `+` to indicate the integer’s sign.\n    var i = token.value.charCodeAt(0) === 0x002B ||       // U+002B PLUS SIGN (+)\n            token.value.charCodeAt(0) === 0x002D ? 1 : 0; // U+002D HYPHEN-MINUS (-)\n\n    // When written literally, an integer is one or more decimal digits 0 through 9 ...\n    for (; i < token.value.length; i++) {\n        if (!isDigit(token.value.charCodeAt(i))) {\n            return 0;\n        }\n    }\n\n    // check range if specified\n    if (outOfRange(opts, token.value, i)) {\n        return 0;\n    }\n\n    return 1;\n}\n\nmodule.exports = {\n    // token types\n    'ident-token': tokenType(TYPE.Ident),\n    'function-token': tokenType(TYPE.Function),\n    'at-keyword-token': tokenType(TYPE.AtKeyword),\n    'hash-token': tokenType(TYPE.Hash),\n    'string-token': tokenType(TYPE.String),\n    'bad-string-token': tokenType(TYPE.BadString),\n    'url-token': tokenType(TYPE.Url),\n    'bad-url-token': tokenType(TYPE.BadUrl),\n    'delim-token': tokenType(TYPE.Delim),\n    'number-token': tokenType(TYPE.Number),\n    'percentage-token': tokenType(TYPE.Percentage),\n    'dimension-token': tokenType(TYPE.Dimension),\n    'whitespace-token': tokenType(TYPE.WhiteSpace),\n    'CDO-token': tokenType(TYPE.CDO),\n    'CDC-token': tokenType(TYPE.CDC),\n    'colon-token': tokenType(TYPE.Colon),\n    'semicolon-token': tokenType(TYPE.Semicolon),\n    'comma-token': tokenType(TYPE.Comma),\n    '[-token': tokenType(TYPE.LeftSquareBracket),\n    ']-token': tokenType(TYPE.RightSquareBracket),\n    '(-token': tokenType(TYPE.LeftParenthesis),\n    ')-token': tokenType(TYPE.RightParenthesis),\n    '{-token': tokenType(TYPE.LeftCurlyBracket),\n    '}-token': tokenType(TYPE.RightCurlyBracket),\n\n    // token type aliases\n    'string': tokenType(TYPE.String),\n    'ident': tokenType(TYPE.Ident),\n\n    // complex types\n    'custom-ident': customIdent,\n    'custom-property-name': customPropertyName,\n    'hex-color': hexColor,\n    'id-selector': idSelector, // element( <id-selector> )\n    'an-plus-b': anPlusB,\n    'urange': urange,\n    'declaration-value': declarationValue,\n    'any-value': anyValue,\n\n    // dimensions\n    'dimension': calc(dimension(null)),\n    'angle': calc(dimension(ANGLE)),\n    'decibel': calc(dimension(DECIBEL)),\n    'frequency': calc(dimension(FREQUENCY)),\n    'flex': calc(dimension(FLEX)),\n    'length': calc(zero(dimension(LENGTH))),\n    'resolution': calc(dimension(RESOLUTION)),\n    'semitones': calc(dimension(SEMITONES)),\n    'time': calc(dimension(TIME)),\n\n    // percentage\n    'percentage': calc(percentage),\n\n    // numeric\n    'zero': zero(),\n    'number': calc(number),\n    'integer': calc(integer),\n\n    // old IE stuff\n    '-ms-legacy-expression': func('expression')\n};\n","var createCustomError = require('../utils/createCustomError');\n\nmodule.exports = function SyntaxError(message, input, offset) {\n    var error = createCustomError('SyntaxError', message);\n\n    error.input = input;\n    error.offset = offset;\n    error.rawMessage = message;\n    error.message = error.rawMessage + '\\n' +\n        '  ' + error.input + '\\n' +\n        '--' + new Array((error.offset || error.input.length) + 1).join('-') + '^';\n\n    return error;\n};\n","var SyntaxError = require('./SyntaxError');\n\nvar TAB = 9;\nvar N = 10;\nvar F = 12;\nvar R = 13;\nvar SPACE = 32;\n\nvar Tokenizer = function(str) {\n    this.str = str;\n    this.pos = 0;\n};\n\nTokenizer.prototype = {\n    charCodeAt: function(pos) {\n        return pos < this.str.length ? this.str.charCodeAt(pos) : 0;\n    },\n    charCode: function() {\n        return this.charCodeAt(this.pos);\n    },\n    nextCharCode: function() {\n        return this.charCodeAt(this.pos + 1);\n    },\n    nextNonWsCode: function(pos) {\n        return this.charCodeAt(this.findWsEnd(pos));\n    },\n    findWsEnd: function(pos) {\n        for (; pos < this.str.length; pos++) {\n            var code = this.str.charCodeAt(pos);\n            if (code !== R && code !== N && code !== F && code !== SPACE && code !== TAB) {\n                break;\n            }\n        }\n\n        return pos;\n    },\n    substringToPos: function(end) {\n        return this.str.substring(this.pos, this.pos = end);\n    },\n    eat: function(code) {\n        if (this.charCode() !== code) {\n            this.error('Expect `' + String.fromCharCode(code) + '`');\n        }\n\n        this.pos++;\n    },\n    peek: function() {\n        return this.pos < this.str.length ? this.str.charAt(this.pos++) : '';\n    },\n    error: function(message) {\n        throw new SyntaxError(message, this.str, this.pos);\n    }\n};\n\nmodule.exports = Tokenizer;\n","var Tokenizer = require('./tokenizer');\nvar TAB = 9;\nvar N = 10;\nvar F = 12;\nvar R = 13;\nvar SPACE = 32;\nvar EXCLAMATIONMARK = 33;    // !\nvar NUMBERSIGN = 35;         // #\nvar AMPERSAND = 38;          // &\nvar APOSTROPHE = 39;         // '\nvar LEFTPARENTHESIS = 40;    // (\nvar RIGHTPARENTHESIS = 41;   // )\nvar ASTERISK = 42;           // *\nvar PLUSSIGN = 43;           // +\nvar COMMA = 44;              // ,\nvar HYPERMINUS = 45;         // -\nvar LESSTHANSIGN = 60;       // <\nvar GREATERTHANSIGN = 62;    // >\nvar QUESTIONMARK = 63;       // ?\nvar COMMERCIALAT = 64;       // @\nvar LEFTSQUAREBRACKET = 91;  // [\nvar RIGHTSQUAREBRACKET = 93; // ]\nvar LEFTCURLYBRACKET = 123;  // {\nvar VERTICALLINE = 124;      // |\nvar RIGHTCURLYBRACKET = 125; // }\nvar INFINITY = 8734;         // ∞\nvar NAME_CHAR = createCharMap(function(ch) {\n    return /[a-zA-Z0-9\\-]/.test(ch);\n});\nvar COMBINATOR_PRECEDENCE = {\n    ' ': 1,\n    '&&': 2,\n    '||': 3,\n    '|': 4\n};\n\nfunction createCharMap(fn) {\n    var array = typeof Uint32Array === 'function' ? new Uint32Array(128) : new Array(128);\n    for (var i = 0; i < 128; i++) {\n        array[i] = fn(String.fromCharCode(i)) ? 1 : 0;\n    }\n    return array;\n}\n\nfunction scanSpaces(tokenizer) {\n    return tokenizer.substringToPos(\n        tokenizer.findWsEnd(tokenizer.pos)\n    );\n}\n\nfunction scanWord(tokenizer) {\n    var end = tokenizer.pos;\n\n    for (; end < tokenizer.str.length; end++) {\n        var code = tokenizer.str.charCodeAt(end);\n        if (code >= 128 || NAME_CHAR[code] === 0) {\n            break;\n        }\n    }\n\n    if (tokenizer.pos === end) {\n        tokenizer.error('Expect a keyword');\n    }\n\n    return tokenizer.substringToPos(end);\n}\n\nfunction scanNumber(tokenizer) {\n    var end = tokenizer.pos;\n\n    for (; end < tokenizer.str.length; end++) {\n        var code = tokenizer.str.charCodeAt(end);\n        if (code < 48 || code > 57) {\n            break;\n        }\n    }\n\n    if (tokenizer.pos === end) {\n        tokenizer.error('Expect a number');\n    }\n\n    return tokenizer.substringToPos(end);\n}\n\nfunction scanString(tokenizer) {\n    var end = tokenizer.str.indexOf('\\'', tokenizer.pos + 1);\n\n    if (end === -1) {\n        tokenizer.pos = tokenizer.str.length;\n        tokenizer.error('Expect an apostrophe');\n    }\n\n    return tokenizer.substringToPos(end + 1);\n}\n\nfunction readMultiplierRange(tokenizer) {\n    var min = null;\n    var max = null;\n\n    tokenizer.eat(LEFTCURLYBRACKET);\n\n    min = scanNumber(tokenizer);\n\n    if (tokenizer.charCode() === COMMA) {\n        tokenizer.pos++;\n        if (tokenizer.charCode() !== RIGHTCURLYBRACKET) {\n            max = scanNumber(tokenizer);\n        }\n    } else {\n        max = min;\n    }\n\n    tokenizer.eat(RIGHTCURLYBRACKET);\n\n    return {\n        min: Number(min),\n        max: max ? Number(max) : 0\n    };\n}\n\nfunction readMultiplier(tokenizer) {\n    var range = null;\n    var comma = false;\n\n    switch (tokenizer.charCode()) {\n        case ASTERISK:\n            tokenizer.pos++;\n\n            range = {\n                min: 0,\n                max: 0\n            };\n\n            break;\n\n        case PLUSSIGN:\n            tokenizer.pos++;\n\n            range = {\n                min: 1,\n                max: 0\n            };\n\n            break;\n\n        case QUESTIONMARK:\n            tokenizer.pos++;\n\n            range = {\n                min: 0,\n                max: 1\n            };\n\n            break;\n\n        case NUMBERSIGN:\n            tokenizer.pos++;\n\n            comma = true;\n\n            if (tokenizer.charCode() === LEFTCURLYBRACKET) {\n                range = readMultiplierRange(tokenizer);\n            } else {\n                range = {\n                    min: 1,\n                    max: 0\n                };\n            }\n\n            break;\n\n        case LEFTCURLYBRACKET:\n            range = readMultiplierRange(tokenizer);\n            break;\n\n        default:\n            return null;\n    }\n\n    return {\n        type: 'Multiplier',\n        comma: comma,\n        min: range.min,\n        max: range.max,\n        term: null\n    };\n}\n\nfunction maybeMultiplied(tokenizer, node) {\n    var multiplier = readMultiplier(tokenizer);\n\n    if (multiplier !== null) {\n        multiplier.term = node;\n        return multiplier;\n    }\n\n    return node;\n}\n\nfunction maybeToken(tokenizer) {\n    var ch = tokenizer.peek();\n\n    if (ch === '') {\n        return null;\n    }\n\n    return {\n        type: 'Token',\n        value: ch\n    };\n}\n\nfunction readProperty(tokenizer) {\n    var name;\n\n    tokenizer.eat(LESSTHANSIGN);\n    tokenizer.eat(APOSTROPHE);\n\n    name = scanWord(tokenizer);\n\n    tokenizer.eat(APOSTROPHE);\n    tokenizer.eat(GREATERTHANSIGN);\n\n    return maybeMultiplied(tokenizer, {\n        type: 'Property',\n        name: name\n    });\n}\n\n// https://drafts.csswg.org/css-values-3/#numeric-ranges\n// 4.1. Range Restrictions and Range Definition Notation\n//\n// Range restrictions can be annotated in the numeric type notation using CSS bracketed\n// range notation—[min,max]—within the angle brackets, after the identifying keyword,\n// indicating a closed range between (and including) min and max.\n// For example, <integer [0, 10]> indicates an integer between 0 and 10, inclusive.\nfunction readTypeRange(tokenizer) {\n    // use null for Infinity to make AST format JSON serializable/deserializable\n    var min = null; // -Infinity\n    var max = null; // Infinity\n    var sign = 1;\n\n    tokenizer.eat(LEFTSQUAREBRACKET);\n\n    if (tokenizer.charCode() === HYPERMINUS) {\n        tokenizer.peek();\n        sign = -1;\n    }\n\n    if (sign == -1 && tokenizer.charCode() === INFINITY) {\n        tokenizer.peek();\n    } else {\n        min = sign * Number(scanNumber(tokenizer));\n    }\n\n    scanSpaces(tokenizer);\n    tokenizer.eat(COMMA);\n    scanSpaces(tokenizer);\n\n    if (tokenizer.charCode() === INFINITY) {\n        tokenizer.peek();\n    } else {\n        sign = 1;\n\n        if (tokenizer.charCode() === HYPERMINUS) {\n            tokenizer.peek();\n            sign = -1;\n        }\n\n        max = sign * Number(scanNumber(tokenizer));\n    }\n\n    tokenizer.eat(RIGHTSQUAREBRACKET);\n\n    // If no range is indicated, either by using the bracketed range notation\n    // or in the property description, then [−∞,∞] is assumed.\n    if (min === null && max === null) {\n        return null;\n    }\n\n    return {\n        type: 'Range',\n        min: min,\n        max: max\n    };\n}\n\nfunction readType(tokenizer) {\n    var name;\n    var opts = null;\n\n    tokenizer.eat(LESSTHANSIGN);\n    name = scanWord(tokenizer);\n\n    if (tokenizer.charCode() === LEFTPARENTHESIS &&\n        tokenizer.nextCharCode() === RIGHTPARENTHESIS) {\n        tokenizer.pos += 2;\n        name += '()';\n    }\n\n    if (tokenizer.charCodeAt(tokenizer.findWsEnd(tokenizer.pos)) === LEFTSQUAREBRACKET) {\n        scanSpaces(tokenizer);\n        opts = readTypeRange(tokenizer);\n    }\n\n    tokenizer.eat(GREATERTHANSIGN);\n\n    return maybeMultiplied(tokenizer, {\n        type: 'Type',\n        name: name,\n        opts: opts\n    });\n}\n\nfunction readKeywordOrFunction(tokenizer) {\n    var name;\n\n    name = scanWord(tokenizer);\n\n    if (tokenizer.charCode() === LEFTPARENTHESIS) {\n        tokenizer.pos++;\n\n        return {\n            type: 'Function',\n            name: name\n        };\n    }\n\n    return maybeMultiplied(tokenizer, {\n        type: 'Keyword',\n        name: name\n    });\n}\n\nfunction regroupTerms(terms, combinators) {\n    function createGroup(terms, combinator) {\n        return {\n            type: 'Group',\n            terms: terms,\n            combinator: combinator,\n            disallowEmpty: false,\n            explicit: false\n        };\n    }\n\n    combinators = Object.keys(combinators).sort(function(a, b) {\n        return COMBINATOR_PRECEDENCE[a] - COMBINATOR_PRECEDENCE[b];\n    });\n\n    while (combinators.length > 0) {\n        var combinator = combinators.shift();\n        for (var i = 0, subgroupStart = 0; i < terms.length; i++) {\n            var term = terms[i];\n            if (term.type === 'Combinator') {\n                if (term.value === combinator) {\n                    if (subgroupStart === -1) {\n                        subgroupStart = i - 1;\n                    }\n                    terms.splice(i, 1);\n                    i--;\n                } else {\n                    if (subgroupStart !== -1 && i - subgroupStart > 1) {\n                        terms.splice(\n                            subgroupStart,\n                            i - subgroupStart,\n                            createGroup(terms.slice(subgroupStart, i), combinator)\n                        );\n                        i = subgroupStart + 1;\n                    }\n                    subgroupStart = -1;\n                }\n            }\n        }\n\n        if (subgroupStart !== -1 && combinators.length) {\n            terms.splice(\n                subgroupStart,\n                i - subgroupStart,\n                createGroup(terms.slice(subgroupStart, i), combinator)\n            );\n        }\n    }\n\n    return combinator;\n}\n\nfunction readImplicitGroup(tokenizer) {\n    var terms = [];\n    var combinators = {};\n    var token;\n    var prevToken = null;\n    var prevTokenPos = tokenizer.pos;\n\n    while (token = peek(tokenizer)) {\n        if (token.type !== 'Spaces') {\n            if (token.type === 'Combinator') {\n                // check for combinator in group beginning and double combinator sequence\n                if (prevToken === null || prevToken.type === 'Combinator') {\n                    tokenizer.pos = prevTokenPos;\n                    tokenizer.error('Unexpected combinator');\n                }\n\n                combinators[token.value] = true;\n            } else if (prevToken !== null && prevToken.type !== 'Combinator') {\n                combinators[' '] = true;  // a b\n                terms.push({\n                    type: 'Combinator',\n                    value: ' '\n                });\n            }\n\n            terms.push(token);\n            prevToken = token;\n            prevTokenPos = tokenizer.pos;\n        }\n    }\n\n    // check for combinator in group ending\n    if (prevToken !== null && prevToken.type === 'Combinator') {\n        tokenizer.pos -= prevTokenPos;\n        tokenizer.error('Unexpected combinator');\n    }\n\n    return {\n        type: 'Group',\n        terms: terms,\n        combinator: regroupTerms(terms, combinators) || ' ',\n        disallowEmpty: false,\n        explicit: false\n    };\n}\n\nfunction readGroup(tokenizer) {\n    var result;\n\n    tokenizer.eat(LEFTSQUAREBRACKET);\n    result = readImplicitGroup(tokenizer);\n    tokenizer.eat(RIGHTSQUAREBRACKET);\n\n    result.explicit = true;\n\n    if (tokenizer.charCode() === EXCLAMATIONMARK) {\n        tokenizer.pos++;\n        result.disallowEmpty = true;\n    }\n\n    return result;\n}\n\nfunction peek(tokenizer) {\n    var code = tokenizer.charCode();\n\n    if (code < 128 && NAME_CHAR[code] === 1) {\n        return readKeywordOrFunction(tokenizer);\n    }\n\n    switch (code) {\n        case RIGHTSQUAREBRACKET:\n            // don't eat, stop scan a group\n            break;\n\n        case LEFTSQUAREBRACKET:\n            return maybeMultiplied(tokenizer, readGroup(tokenizer));\n\n        case LESSTHANSIGN:\n            return tokenizer.nextCharCode() === APOSTROPHE\n                ? readProperty(tokenizer)\n                : readType(tokenizer);\n\n        case VERTICALLINE:\n            return {\n                type: 'Combinator',\n                value: tokenizer.substringToPos(\n                    tokenizer.nextCharCode() === VERTICALLINE\n                        ? tokenizer.pos + 2\n                        : tokenizer.pos + 1\n                )\n            };\n\n        case AMPERSAND:\n            tokenizer.pos++;\n            tokenizer.eat(AMPERSAND);\n\n            return {\n                type: 'Combinator',\n                value: '&&'\n            };\n\n        case COMMA:\n            tokenizer.pos++;\n            return {\n                type: 'Comma'\n            };\n\n        case APOSTROPHE:\n            return maybeMultiplied(tokenizer, {\n                type: 'String',\n                value: scanString(tokenizer)\n            });\n\n        case SPACE:\n        case TAB:\n        case N:\n        case R:\n        case F:\n            return {\n                type: 'Spaces',\n                value: scanSpaces(tokenizer)\n            };\n\n        case COMMERCIALAT:\n            code = tokenizer.nextCharCode();\n\n            if (code < 128 && NAME_CHAR[code] === 1) {\n                tokenizer.pos++;\n                return {\n                    type: 'AtKeyword',\n                    name: scanWord(tokenizer)\n                };\n            }\n\n            return maybeToken(tokenizer);\n\n        case ASTERISK:\n        case PLUSSIGN:\n        case QUESTIONMARK:\n        case NUMBERSIGN:\n        case EXCLAMATIONMARK:\n            // prohibited tokens (used as a multiplier start)\n            break;\n\n        case LEFTCURLYBRACKET:\n            // LEFTCURLYBRACKET is allowed since mdn/data uses it w/o quoting\n            // check next char isn't a number, because it's likely a disjoined multiplier\n            code = tokenizer.nextCharCode();\n\n            if (code < 48 || code > 57) {\n                return maybeToken(tokenizer);\n            }\n\n            break;\n\n        default:\n            return maybeToken(tokenizer);\n    }\n}\n\nfunction parse(source) {\n    var tokenizer = new Tokenizer(source);\n    var result = readImplicitGroup(tokenizer);\n\n    if (tokenizer.pos !== source.length) {\n        tokenizer.error('Unexpected input');\n    }\n\n    // reduce redundant groups with single group term\n    if (result.terms.length === 1 && result.terms[0].type === 'Group') {\n        result = result.terms[0];\n    }\n\n    return result;\n}\n\n// warm up parse to elimitate code branches that never execute\n// fix soft deoptimizations (insufficient type feedback)\nparse('[a&&<b>#|<\\'c\\'>*||e() f{2} /,(% g#{1,2} h{2,})]!');\n\nmodule.exports = parse;\n","var noop = function() {};\n\nfunction ensureFunction(value) {\n    return typeof value === 'function' ? value : noop;\n}\n\nmodule.exports = function(node, options, context) {\n    function walk(node) {\n        enter.call(context, node);\n\n        switch (node.type) {\n            case 'Group':\n                node.terms.forEach(walk);\n                break;\n\n            case 'Multiplier':\n                walk(node.term);\n                break;\n\n            case 'Type':\n            case 'Property':\n            case 'Keyword':\n            case 'AtKeyword':\n            case 'Function':\n            case 'String':\n            case 'Token':\n            case 'Comma':\n                break;\n\n            default:\n                throw new Error('Unknown type: ' + node.type);\n        }\n\n        leave.call(context, node);\n    }\n\n    var enter = noop;\n    var leave = noop;\n\n    if (typeof options === 'function') {\n        enter = options;\n    } else if (options) {\n        enter = ensureFunction(options.enter);\n        leave = ensureFunction(options.leave);\n    }\n\n    if (enter === noop && leave === noop) {\n        throw new Error('Neither `enter` nor `leave` walker handler is set or both aren\\'t a function');\n    }\n\n    walk(node, context);\n};\n","var tokenize = require('../tokenizer');\nvar TokenStream = require('../common/TokenStream');\nvar tokenStream = new TokenStream();\nvar astToTokens = {\n    decorator: function(handlers) {\n        var curNode = null;\n        var prev = { len: 0, node: null };\n        var nodes = [prev];\n        var buffer = '';\n\n        return {\n            children: handlers.children,\n            node: function(node) {\n                var tmp = curNode;\n                curNode = node;\n                handlers.node.call(this, node);\n                curNode = tmp;\n            },\n            chunk: function(chunk) {\n                buffer += chunk;\n                if (prev.node !== curNode) {\n                    nodes.push({\n                        len: chunk.length,\n                        node: curNode\n                    });\n                } else {\n                    prev.len += chunk.length;\n                }\n            },\n            result: function() {\n                return prepareTokens(buffer, nodes);\n            }\n        };\n    }\n};\n\nfunction prepareTokens(str, nodes) {\n    var tokens = [];\n    var nodesOffset = 0;\n    var nodesIndex = 0;\n    var currentNode = nodes ? nodes[nodesIndex].node : null;\n\n    tokenize(str, tokenStream);\n\n    while (!tokenStream.eof) {\n        if (nodes) {\n            while (nodesIndex < nodes.length && nodesOffset + nodes[nodesIndex].len <= tokenStream.tokenStart) {\n                nodesOffset += nodes[nodesIndex++].len;\n                currentNode = nodes[nodesIndex].node;\n            }\n        }\n\n        tokens.push({\n            type: tokenStream.tokenType,\n            value: tokenStream.getTokenValue(),\n            index: tokenStream.tokenIndex, // TODO: remove it, temporary solution\n            balance: tokenStream.balance[tokenStream.tokenIndex], // TODO: remove it, temporary solution\n            node: currentNode\n        });\n        tokenStream.next();\n        // console.log({ ...tokens[tokens.length - 1], node: undefined });\n    }\n\n    return tokens;\n}\n\nmodule.exports = function(value, syntax) {\n    if (typeof value === 'string') {\n        return prepareTokens(value, null);\n    }\n\n    return syntax.generate(value, astToTokens);\n};\n","var parse = require('../definition-syntax/parse');\n\nvar MATCH = { type: 'Match' };\nvar MISMATCH = { type: 'Mismatch' };\nvar DISALLOW_EMPTY = { type: 'DisallowEmpty' };\nvar LEFTPARENTHESIS = 40;  // (\nvar RIGHTPARENTHESIS = 41; // )\n\nfunction createCondition(match, thenBranch, elseBranch) {\n    // reduce node count\n    if (thenBranch === MATCH && elseBranch === MISMATCH) {\n        return match;\n    }\n\n    if (match === MATCH && thenBranch === MATCH && elseBranch === MATCH) {\n        return match;\n    }\n\n    if (match.type === 'If' && match.else === MISMATCH && thenBranch === MATCH) {\n        thenBranch = match.then;\n        match = match.match;\n    }\n\n    return {\n        type: 'If',\n        match: match,\n        then: thenBranch,\n        else: elseBranch\n    };\n}\n\nfunction isFunctionType(name) {\n    return (\n        name.length > 2 &&\n        name.charCodeAt(name.length - 2) === LEFTPARENTHESIS &&\n        name.charCodeAt(name.length - 1) === RIGHTPARENTHESIS\n    );\n}\n\nfunction isEnumCapatible(term) {\n    return (\n        term.type === 'Keyword' ||\n        term.type === 'AtKeyword' ||\n        term.type === 'Function' ||\n        term.type === 'Type' && isFunctionType(term.name)\n    );\n}\n\nfunction buildGroupMatchGraph(combinator, terms, atLeastOneTermMatched) {\n    switch (combinator) {\n        case ' ':\n            // Juxtaposing components means that all of them must occur, in the given order.\n            //\n            // a b c\n            // =\n            // match a\n            //   then match b\n            //     then match c\n            //       then MATCH\n            //       else MISMATCH\n            //     else MISMATCH\n            //   else MISMATCH\n            var result = MATCH;\n\n            for (var i = terms.length - 1; i >= 0; i--) {\n                var term = terms[i];\n\n                result = createCondition(\n                    term,\n                    result,\n                    MISMATCH\n                );\n            };\n\n            return result;\n\n        case '|':\n            // A bar (|) separates two or more alternatives: exactly one of them must occur.\n            //\n            // a | b | c\n            // =\n            // match a\n            //   then MATCH\n            //   else match b\n            //     then MATCH\n            //     else match c\n            //       then MATCH\n            //       else MISMATCH\n\n            var result = MISMATCH;\n            var map = null;\n\n            for (var i = terms.length - 1; i >= 0; i--) {\n                var term = terms[i];\n\n                // reduce sequence of keywords into a Enum\n                if (isEnumCapatible(term)) {\n                    if (map === null && i > 0 && isEnumCapatible(terms[i - 1])) {\n                        map = Object.create(null);\n                        result = createCondition(\n                            {\n                                type: 'Enum',\n                                map: map\n                            },\n                            MATCH,\n                            result\n                        );\n                    }\n\n                    if (map !== null) {\n                        var key = (isFunctionType(term.name) ? term.name.slice(0, -1) : term.name).toLowerCase();\n                        if (key in map === false) {\n                            map[key] = term;\n                            continue;\n                        }\n                    }\n                }\n\n                map = null;\n\n                // create a new conditonal node\n                result = createCondition(\n                    term,\n                    MATCH,\n                    result\n                );\n            };\n\n            return result;\n\n        case '&&':\n            // A double ampersand (&&) separates two or more components,\n            // all of which must occur, in any order.\n\n            // Use MatchOnce for groups with a large number of terms,\n            // since &&-groups produces at least N!-node trees\n            if (terms.length > 5) {\n                return {\n                    type: 'MatchOnce',\n                    terms: terms,\n                    all: true\n                };\n            }\n\n            // Use a combination tree for groups with small number of terms\n            //\n            // a && b && c\n            // =\n            // match a\n            //   then [b && c]\n            //   else match b\n            //     then [a && c]\n            //     else match c\n            //       then [a && b]\n            //       else MISMATCH\n            //\n            // a && b\n            // =\n            // match a\n            //   then match b\n            //     then MATCH\n            //     else MISMATCH\n            //   else match b\n            //     then match a\n            //       then MATCH\n            //       else MISMATCH\n            //     else MISMATCH\n            var result = MISMATCH;\n\n            for (var i = terms.length - 1; i >= 0; i--) {\n                var term = terms[i];\n                var thenClause;\n\n                if (terms.length > 1) {\n                    thenClause = buildGroupMatchGraph(\n                        combinator,\n                        terms.filter(function(newGroupTerm) {\n                            return newGroupTerm !== term;\n                        }),\n                        false\n                    );\n                } else {\n                    thenClause = MATCH;\n                }\n\n                result = createCondition(\n                    term,\n                    thenClause,\n                    result\n                );\n            };\n\n            return result;\n\n        case '||':\n            // A double bar (||) separates two or more options:\n            // one or more of them must occur, in any order.\n\n            // Use MatchOnce for groups with a large number of terms,\n            // since ||-groups produces at least N!-node trees\n            if (terms.length > 5) {\n                return {\n                    type: 'MatchOnce',\n                    terms: terms,\n                    all: false\n                };\n            }\n\n            // Use a combination tree for groups with small number of terms\n            //\n            // a || b || c\n            // =\n            // match a\n            //   then [b || c]\n            //   else match b\n            //     then [a || c]\n            //     else match c\n            //       then [a || b]\n            //       else MISMATCH\n            //\n            // a || b\n            // =\n            // match a\n            //   then match b\n            //     then MATCH\n            //     else MATCH\n            //   else match b\n            //     then match a\n            //       then MATCH\n            //       else MATCH\n            //     else MISMATCH\n            var result = atLeastOneTermMatched ? MATCH : MISMATCH;\n\n            for (var i = terms.length - 1; i >= 0; i--) {\n                var term = terms[i];\n                var thenClause;\n\n                if (terms.length > 1) {\n                    thenClause = buildGroupMatchGraph(\n                        combinator,\n                        terms.filter(function(newGroupTerm) {\n                            return newGroupTerm !== term;\n                        }),\n                        true\n                    );\n                } else {\n                    thenClause = MATCH;\n                }\n\n                result = createCondition(\n                    term,\n                    thenClause,\n                    result\n                );\n            };\n\n            return result;\n    }\n}\n\nfunction buildMultiplierMatchGraph(node) {\n    var result = MATCH;\n    var matchTerm = buildMatchGraph(node.term);\n\n    if (node.max === 0) {\n        // disable repeating of empty match to prevent infinite loop\n        matchTerm = createCondition(\n            matchTerm,\n            DISALLOW_EMPTY,\n            MISMATCH\n        );\n\n        // an occurrence count is not limited, make a cycle;\n        // to collect more terms on each following matching mismatch\n        result = createCondition(\n            matchTerm,\n            null, // will be a loop\n            MISMATCH\n        );\n\n        result.then = createCondition(\n            MATCH,\n            MATCH,\n            result // make a loop\n        );\n\n        if (node.comma) {\n            result.then.else = createCondition(\n                { type: 'Comma', syntax: node },\n                result,\n                MISMATCH\n            );\n        }\n    } else {\n        // create a match node chain for [min .. max] interval with optional matches\n        for (var i = node.min || 1; i <= node.max; i++) {\n            if (node.comma && result !== MATCH) {\n                result = createCondition(\n                    { type: 'Comma', syntax: node },\n                    result,\n                    MISMATCH\n                );\n            }\n\n            result = createCondition(\n                matchTerm,\n                createCondition(\n                    MATCH,\n                    MATCH,\n                    result\n                ),\n                MISMATCH\n            );\n        }\n    }\n\n    if (node.min === 0) {\n        // allow zero match\n        result = createCondition(\n            MATCH,\n            MATCH,\n            result\n        );\n    } else {\n        // create a match node chain to collect [0 ... min - 1] required matches\n        for (var i = 0; i < node.min - 1; i++) {\n            if (node.comma && result !== MATCH) {\n                result = createCondition(\n                    { type: 'Comma', syntax: node },\n                    result,\n                    MISMATCH\n                );\n            }\n\n            result = createCondition(\n                matchTerm,\n                result,\n                MISMATCH\n            );\n        }\n    }\n\n    return result;\n}\n\nfunction buildMatchGraph(node) {\n    if (typeof node === 'function') {\n        return {\n            type: 'Generic',\n            fn: node\n        };\n    }\n\n    switch (node.type) {\n        case 'Group':\n            var result = buildGroupMatchGraph(\n                node.combinator,\n                node.terms.map(buildMatchGraph),\n                false\n            );\n\n            if (node.disallowEmpty) {\n                result = createCondition(\n                    result,\n                    DISALLOW_EMPTY,\n                    MISMATCH\n                );\n            }\n\n            return result;\n\n        case 'Multiplier':\n            return buildMultiplierMatchGraph(node);\n\n        case 'Type':\n        case 'Property':\n            return {\n                type: node.type,\n                name: node.name,\n                syntax: node\n            };\n\n        case 'Keyword':\n            return {\n                type: node.type,\n                name: node.name.toLowerCase(),\n                syntax: node\n            };\n\n        case 'AtKeyword':\n            return {\n                type: node.type,\n                name: '@' + node.name.toLowerCase(),\n                syntax: node\n            };\n\n        case 'Function':\n            return {\n                type: node.type,\n                name: node.name.toLowerCase() + '(',\n                syntax: node\n            };\n\n        case 'String':\n            // convert a one char length String to a Token\n            if (node.value.length === 3) {\n                return {\n                    type: 'Token',\n                    value: node.value.charAt(1),\n                    syntax: node\n                };\n            }\n\n            // otherwise use it as is\n            return {\n                type: node.type,\n                value: node.value.substr(1, node.value.length - 2).replace(/\\\\'/g, '\\''),\n                syntax: node\n            };\n\n        case 'Token':\n            return {\n                type: node.type,\n                value: node.value,\n                syntax: node\n            };\n\n        case 'Comma':\n            return {\n                type: node.type,\n                syntax: node\n            };\n\n        default:\n            throw new Error('Unknown node type:', node.type);\n    }\n}\n\nmodule.exports = {\n    MATCH: MATCH,\n    MISMATCH: MISMATCH,\n    DISALLOW_EMPTY: DISALLOW_EMPTY,\n    buildMatchGraph: function(syntaxTree, ref) {\n        if (typeof syntaxTree === 'string') {\n            syntaxTree = parse(syntaxTree);\n        }\n\n        return {\n            type: 'MatchGraph',\n            match: buildMatchGraph(syntaxTree),\n            syntax: ref || null,\n            source: syntaxTree\n        };\n    }\n};\n","var hasOwnProperty = Object.prototype.hasOwnProperty;\nvar matchGraph = require('./match-graph');\nvar MATCH = matchGraph.MATCH;\nvar MISMATCH = matchGraph.MISMATCH;\nvar DISALLOW_EMPTY = matchGraph.DISALLOW_EMPTY;\nvar TYPE = require('../tokenizer/const').TYPE;\n\nvar STUB = 0;\nvar TOKEN = 1;\nvar OPEN_SYNTAX = 2;\nvar CLOSE_SYNTAX = 3;\n\nvar EXIT_REASON_MATCH = 'Match';\nvar EXIT_REASON_MISMATCH = 'Mismatch';\nvar EXIT_REASON_ITERATION_LIMIT = 'Maximum iteration number exceeded (please fill an issue on https://github.com/csstree/csstree/issues)';\n\nvar ITERATION_LIMIT = 15000;\nvar totalIterationCount = 0;\n\nfunction reverseList(list) {\n    var prev = null;\n    var next = null;\n    var item = list;\n\n    while (item !== null) {\n        next = item.prev;\n        item.prev = prev;\n        prev = item;\n        item = next;\n    }\n\n    return prev;\n}\n\nfunction areStringsEqualCaseInsensitive(testStr, referenceStr) {\n    if (testStr.length !== referenceStr.length) {\n        return false;\n    }\n\n    for (var i = 0; i < testStr.length; i++) {\n        var testCode = testStr.charCodeAt(i);\n        var referenceCode = referenceStr.charCodeAt(i);\n\n        // testCode.toLowerCase() for U+0041 LATIN CAPITAL LETTER A (A) .. U+005A LATIN CAPITAL LETTER Z (Z).\n        if (testCode >= 0x0041 && testCode <= 0x005A) {\n            testCode = testCode | 32;\n        }\n\n        if (testCode !== referenceCode) {\n            return false;\n        }\n    }\n\n    return true;\n}\n\nfunction isContextEdgeDelim(token) {\n    if (token.type !== TYPE.Delim) {\n        return false;\n    }\n\n    // Fix matching for unicode-range: U+30??, U+FF00-FF9F\n    // Probably we need to check out previous match instead\n    return token.value !== '?';\n}\n\nfunction isCommaContextStart(token) {\n    if (token === null) {\n        return true;\n    }\n\n    return (\n        token.type === TYPE.Comma ||\n        token.type === TYPE.Function ||\n        token.type === TYPE.LeftParenthesis ||\n        token.type === TYPE.LeftSquareBracket ||\n        token.type === TYPE.LeftCurlyBracket ||\n        isContextEdgeDelim(token)\n    );\n}\n\nfunction isCommaContextEnd(token) {\n    if (token === null) {\n        return true;\n    }\n\n    return (\n        token.type === TYPE.RightParenthesis ||\n        token.type === TYPE.RightSquareBracket ||\n        token.type === TYPE.RightCurlyBracket ||\n        token.type === TYPE.Delim\n    );\n}\n\nfunction internalMatch(tokens, state, syntaxes) {\n    function moveToNextToken() {\n        do {\n            tokenIndex++;\n            token = tokenIndex < tokens.length ? tokens[tokenIndex] : null;\n        } while (token !== null && (token.type === TYPE.WhiteSpace || token.type === TYPE.Comment));\n    }\n\n    function getNextToken(offset) {\n        var nextIndex = tokenIndex + offset;\n\n        return nextIndex < tokens.length ? tokens[nextIndex] : null;\n    }\n\n    function stateSnapshotFromSyntax(nextState, prev) {\n        return {\n            nextState: nextState,\n            matchStack: matchStack,\n            syntaxStack: syntaxStack,\n            thenStack: thenStack,\n            tokenIndex: tokenIndex,\n            prev: prev\n        };\n    }\n\n    function pushThenStack(nextState) {\n        thenStack = {\n            nextState: nextState,\n            matchStack: matchStack,\n            syntaxStack: syntaxStack,\n            prev: thenStack\n        };\n    }\n\n    function pushElseStack(nextState) {\n        elseStack = stateSnapshotFromSyntax(nextState, elseStack);\n    }\n\n    function addTokenToMatch() {\n        matchStack = {\n            type: TOKEN,\n            syntax: state.syntax,\n            token: token,\n            prev: matchStack\n        };\n\n        moveToNextToken();\n        syntaxStash = null;\n\n        if (tokenIndex > longestMatch) {\n            longestMatch = tokenIndex;\n        }\n    }\n\n    function openSyntax() {\n        syntaxStack = {\n            syntax: state.syntax,\n            opts: state.syntax.opts || (syntaxStack !== null && syntaxStack.opts) || null,\n            prev: syntaxStack\n        };\n\n        matchStack = {\n            type: OPEN_SYNTAX,\n            syntax: state.syntax,\n            token: matchStack.token,\n            prev: matchStack\n        };\n    }\n\n    function closeSyntax() {\n        if (matchStack.type === OPEN_SYNTAX) {\n            matchStack = matchStack.prev;\n        } else {\n            matchStack = {\n                type: CLOSE_SYNTAX,\n                syntax: syntaxStack.syntax,\n                token: matchStack.token,\n                prev: matchStack\n            };\n        }\n\n        syntaxStack = syntaxStack.prev;\n    }\n\n    var syntaxStack = null;\n    var thenStack = null;\n    var elseStack = null;\n\n    // null – stashing allowed, nothing stashed\n    // false – stashing disabled, nothing stashed\n    // anithing else – fail stashable syntaxes, some syntax stashed\n    var syntaxStash = null;\n\n    var iterationCount = 0; // count iterations and prevent infinite loop\n    var exitReason = null;\n\n    var token = null;\n    var tokenIndex = -1;\n    var longestMatch = 0;\n    var matchStack = {\n        type: STUB,\n        syntax: null,\n        token: null,\n        prev: null\n    };\n\n    moveToNextToken();\n\n    while (exitReason === null && ++iterationCount < ITERATION_LIMIT) {\n        // function mapList(list, fn) {\n        //     var result = [];\n        //     while (list) {\n        //         result.unshift(fn(list));\n        //         list = list.prev;\n        //     }\n        //     return result;\n        // }\n        // console.log('--\\n',\n        //     '#' + iterationCount,\n        //     require('util').inspect({\n        //         match: mapList(matchStack, x => x.type === TOKEN ? x.token && x.token.value : x.syntax ? ({ [OPEN_SYNTAX]: '<', [CLOSE_SYNTAX]: '</' }[x.type] || x.type) + '!' + x.syntax.name : null),\n        //         token: token && token.value,\n        //         tokenIndex,\n        //         syntax: syntax.type + (syntax.id ? ' #' + syntax.id : '')\n        //     }, { depth: null })\n        // );\n        switch (state.type) {\n            case 'Match':\n                if (thenStack === null) {\n                    // turn to MISMATCH when some tokens left unmatched\n                    if (token !== null) {\n                        // doesn't mismatch if just one token left and it's an IE hack\n                        if (tokenIndex !== tokens.length - 1 || (token.value !== '\\\\0' && token.value !== '\\\\9')) {\n                            state = MISMATCH;\n                            break;\n                        }\n                    }\n\n                    // break the main loop, return a result - MATCH\n                    exitReason = EXIT_REASON_MATCH;\n                    break;\n                }\n\n                // go to next syntax (`then` branch)\n                state = thenStack.nextState;\n\n                // check match is not empty\n                if (state === DISALLOW_EMPTY) {\n                    if (thenStack.matchStack === matchStack) {\n                        state = MISMATCH;\n                        break;\n                    } else {\n                        state = MATCH;\n                    }\n                }\n\n                // close syntax if needed\n                while (thenStack.syntaxStack !== syntaxStack) {\n                    closeSyntax();\n                }\n\n                // pop stack\n                thenStack = thenStack.prev;\n                break;\n\n            case 'Mismatch':\n                // when some syntax is stashed\n                if (syntaxStash !== null && syntaxStash !== false) {\n                    // there is no else branches or a branch reduce match stack\n                    if (elseStack === null || tokenIndex > elseStack.tokenIndex) {\n                        // restore state from the stash\n                        elseStack = syntaxStash;\n                        syntaxStash = false; // disable stashing\n                    }\n                } else if (elseStack === null) {\n                    // no else branches -> break the main loop\n                    // return a result - MISMATCH\n                    exitReason = EXIT_REASON_MISMATCH;\n                    break;\n                }\n\n                // go to next syntax (`else` branch)\n                state = elseStack.nextState;\n\n                // restore all the rest stack states\n                thenStack = elseStack.thenStack;\n                syntaxStack = elseStack.syntaxStack;\n                matchStack = elseStack.matchStack;\n                tokenIndex = elseStack.tokenIndex;\n                token = tokenIndex < tokens.length ? tokens[tokenIndex] : null;\n\n                // pop stack\n                elseStack = elseStack.prev;\n                break;\n\n            case 'MatchGraph':\n                state = state.match;\n                break;\n\n            case 'If':\n                // IMPORTANT: else stack push must go first,\n                // since it stores the state of thenStack before changes\n                if (state.else !== MISMATCH) {\n                    pushElseStack(state.else);\n                }\n\n                if (state.then !== MATCH) {\n                    pushThenStack(state.then);\n                }\n\n                state = state.match;\n                break;\n\n            case 'MatchOnce':\n                state = {\n                    type: 'MatchOnceBuffer',\n                    syntax: state,\n                    index: 0,\n                    mask: 0\n                };\n                break;\n\n            case 'MatchOnceBuffer':\n                var terms = state.syntax.terms;\n\n                if (state.index === terms.length) {\n                    // no matches at all or it's required all terms to be matched\n                    if (state.mask === 0 || state.syntax.all) {\n                        state = MISMATCH;\n                        break;\n                    }\n\n                    // a partial match is ok\n                    state = MATCH;\n                    break;\n                }\n\n                // all terms are matched\n                if (state.mask === (1 << terms.length) - 1) {\n                    state = MATCH;\n                    break;\n                }\n\n                for (; state.index < terms.length; state.index++) {\n                    var matchFlag = 1 << state.index;\n\n                    if ((state.mask & matchFlag) === 0) {\n                        // IMPORTANT: else stack push must go first,\n                        // since it stores the state of thenStack before changes\n                        pushElseStack(state);\n                        pushThenStack({\n                            type: 'AddMatchOnce',\n                            syntax: state.syntax,\n                            mask: state.mask | matchFlag\n                        });\n\n                        // match\n                        state = terms[state.index++];\n                        break;\n                    }\n                }\n                break;\n\n            case 'AddMatchOnce':\n                state = {\n                    type: 'MatchOnceBuffer',\n                    syntax: state.syntax,\n                    index: 0,\n                    mask: state.mask\n                };\n                break;\n\n            case 'Enum':\n                if (token !== null) {\n                    var name = token.value.toLowerCase();\n\n                    // drop \\0 and \\9 hack from keyword name\n                    if (name.indexOf('\\\\') !== -1) {\n                        name = name.replace(/\\\\[09].*$/, '');\n                    }\n\n                    if (hasOwnProperty.call(state.map, name)) {\n                        state = state.map[name];\n                        break;\n                    }\n                }\n\n                state = MISMATCH;\n                break;\n\n            case 'Generic':\n                var opts = syntaxStack !== null ? syntaxStack.opts : null;\n                var lastTokenIndex = tokenIndex + Math.floor(state.fn(token, getNextToken, opts));\n\n                if (!isNaN(lastTokenIndex) && lastTokenIndex > tokenIndex) {\n                    while (tokenIndex < lastTokenIndex) {\n                        addTokenToMatch();\n                    }\n\n                    state = MATCH;\n                } else {\n                    state = MISMATCH;\n                }\n\n                break;\n\n            case 'Type':\n            case 'Property':\n                var syntaxDict = state.type === 'Type' ? 'types' : 'properties';\n                var dictSyntax = hasOwnProperty.call(syntaxes, syntaxDict) ? syntaxes[syntaxDict][state.name] : null;\n\n                if (!dictSyntax || !dictSyntax.match) {\n                    throw new Error(\n                        'Bad syntax reference: ' +\n                        (state.type === 'Type'\n                            ? '<' + state.name + '>'\n                            : '<\\'' + state.name + '\\'>')\n                    );\n                }\n\n                // stash a syntax for types with low priority\n                if (syntaxStash !== false && token !== null && state.type === 'Type') {\n                    var lowPriorityMatching =\n                        // https://drafts.csswg.org/css-values-4/#custom-idents\n                        // When parsing positionally-ambiguous keywords in a property value, a <custom-ident> production\n                        // can only claim the keyword if no other unfulfilled production can claim it.\n                        (state.name === 'custom-ident' && token.type === TYPE.Ident) ||\n\n                        // https://drafts.csswg.org/css-values-4/#lengths\n                        // ... if a `0` could be parsed as either a <number> or a <length> in a property (such as line-height),\n                        // it must parse as a <number>\n                        (state.name === 'length' && token.value === '0');\n\n                    if (lowPriorityMatching) {\n                        if (syntaxStash === null) {\n                            syntaxStash = stateSnapshotFromSyntax(state, elseStack);\n                        }\n\n                        state = MISMATCH;\n                        break;\n                    }\n                }\n\n                openSyntax();\n                state = dictSyntax.match;\n                break;\n\n            case 'Keyword':\n                var name = state.name;\n\n                if (token !== null) {\n                    var keywordName = token.value;\n\n                    // drop \\0 and \\9 hack from keyword name\n                    if (keywordName.indexOf('\\\\') !== -1) {\n                        keywordName = keywordName.replace(/\\\\[09].*$/, '');\n                    }\n\n                    if (areStringsEqualCaseInsensitive(keywordName, name)) {\n                        addTokenToMatch();\n                        state = MATCH;\n                        break;\n                    }\n                }\n\n                state = MISMATCH;\n                break;\n\n            case 'AtKeyword':\n            case 'Function':\n                if (token !== null && areStringsEqualCaseInsensitive(token.value, state.name)) {\n                    addTokenToMatch();\n                    state = MATCH;\n                    break;\n                }\n\n                state = MISMATCH;\n                break;\n\n            case 'Token':\n                if (token !== null && token.value === state.value) {\n                    addTokenToMatch();\n                    state = MATCH;\n                    break;\n                }\n\n                state = MISMATCH;\n                break;\n\n            case 'Comma':\n                if (token !== null && token.type === TYPE.Comma) {\n                    if (isCommaContextStart(matchStack.token)) {\n                        state = MISMATCH;\n                    } else {\n                        addTokenToMatch();\n                        state = isCommaContextEnd(token) ? MISMATCH : MATCH;\n                    }\n                } else {\n                    state = isCommaContextStart(matchStack.token) || isCommaContextEnd(token) ? MATCH : MISMATCH;\n                }\n\n                break;\n\n            case 'String':\n                var string = '';\n\n                for (var lastTokenIndex = tokenIndex; lastTokenIndex < tokens.length && string.length < state.value.length; lastTokenIndex++) {\n                    string += tokens[lastTokenIndex].value;\n                }\n\n                if (areStringsEqualCaseInsensitive(string, state.value)) {\n                    while (tokenIndex < lastTokenIndex) {\n                        addTokenToMatch();\n                    }\n\n                    state = MATCH;\n                } else {\n                    state = MISMATCH;\n                }\n\n                break;\n\n            default:\n                throw new Error('Unknown node type: ' + state.type);\n        }\n    }\n\n    totalIterationCount += iterationCount;\n\n    switch (exitReason) {\n        case null:\n            console.warn('[csstree-match] BREAK after ' + ITERATION_LIMIT + ' iterations');\n            exitReason = EXIT_REASON_ITERATION_LIMIT;\n            matchStack = null;\n            break;\n\n        case EXIT_REASON_MATCH:\n            while (syntaxStack !== null) {\n                closeSyntax();\n            }\n            break;\n\n        default:\n            matchStack = null;\n    }\n\n    return {\n        tokens: tokens,\n        reason: exitReason,\n        iterations: iterationCount,\n        match: matchStack,\n        longestMatch: longestMatch\n    };\n}\n\nfunction matchAsList(tokens, matchGraph, syntaxes) {\n    var matchResult = internalMatch(tokens, matchGraph, syntaxes || {});\n\n    if (matchResult.match !== null) {\n        var item = reverseList(matchResult.match).prev;\n\n        matchResult.match = [];\n\n        while (item !== null) {\n            switch (item.type) {\n                case STUB:\n                    break;\n\n                case OPEN_SYNTAX:\n                case CLOSE_SYNTAX:\n                    matchResult.match.push({\n                        type: item.type,\n                        syntax: item.syntax\n                    });\n                    break;\n\n                default:\n                    matchResult.match.push({\n                        token: item.token.value,\n                        node: item.token.node\n                    });\n                    break;\n            }\n\n            item = item.prev;\n        }\n    }\n\n    return matchResult;\n}\n\nfunction matchAsTree(tokens, matchGraph, syntaxes) {\n    var matchResult = internalMatch(tokens, matchGraph, syntaxes || {});\n\n    if (matchResult.match === null) {\n        return matchResult;\n    }\n\n    var item = matchResult.match;\n    var host = matchResult.match = {\n        syntax: matchGraph.syntax || null,\n        match: []\n    };\n    var hostStack = [host];\n\n    // revert a list and start with 2nd item since 1st is a stub item\n    item = reverseList(item).prev;\n\n    // build a tree\n    while (item !== null) {\n        switch (item.type) {\n            case OPEN_SYNTAX:\n                host.match.push(host = {\n                    syntax: item.syntax,\n                    match: []\n                });\n                hostStack.push(host);\n                break;\n\n            case CLOSE_SYNTAX:\n                hostStack.pop();\n                host = hostStack[hostStack.length - 1];\n                break;\n\n            default:\n                host.match.push({\n                    syntax: item.syntax || null,\n                    token: item.token.value,\n                    node: item.token.node\n                });\n        }\n\n        item = item.prev;\n    }\n\n    return matchResult;\n}\n\nmodule.exports = {\n    matchAsList: matchAsList,\n    matchAsTree: matchAsTree,\n    getTotalIterationCount: function() {\n        return totalIterationCount;\n    }\n};\n","function getTrace(node) {\n    function shouldPutToTrace(syntax) {\n        if (syntax === null) {\n            return false;\n        }\n\n        return (\n            syntax.type === 'Type' ||\n            syntax.type === 'Property' ||\n            syntax.type === 'Keyword'\n        );\n    }\n\n    function hasMatch(matchNode) {\n        if (Array.isArray(matchNode.match)) {\n            // use for-loop for better perfomance\n            for (var i = 0; i < matchNode.match.length; i++) {\n                if (hasMatch(matchNode.match[i])) {\n                    if (shouldPutToTrace(matchNode.syntax)) {\n                        result.unshift(matchNode.syntax);\n                    }\n\n                    return true;\n                }\n            }\n        } else if (matchNode.node === node) {\n            result = shouldPutToTrace(matchNode.syntax)\n                ? [matchNode.syntax]\n                : [];\n\n            return true;\n        }\n\n        return false;\n    }\n\n    var result = null;\n\n    if (this.matched !== null) {\n        hasMatch(this.matched);\n    }\n\n    return result;\n}\n\nfunction testNode(match, node, fn) {\n    var trace = getTrace.call(match, node);\n\n    if (trace === null) {\n        return false;\n    }\n\n    return trace.some(fn);\n}\n\nfunction isType(node, type) {\n    return testNode(this, node, function(matchNode) {\n        return matchNode.type === 'Type' && matchNode.name === type;\n    });\n}\n\nfunction isProperty(node, property) {\n    return testNode(this, node, function(matchNode) {\n        return matchNode.type === 'Property' && matchNode.name === property;\n    });\n}\n\nfunction isKeyword(node) {\n    return testNode(this, node, function(matchNode) {\n        return matchNode.type === 'Keyword';\n    });\n}\n\nmodule.exports = {\n    getTrace: getTrace,\n    isType: isType,\n    isProperty: isProperty,\n    isKeyword: isKeyword\n};\n","var List = require('../common/List');\n\nfunction getFirstMatchNode(matchNode) {\n    if ('node' in matchNode) {\n        return matchNode.node;\n    }\n\n    return getFirstMatchNode(matchNode.match[0]);\n}\n\nfunction getLastMatchNode(matchNode) {\n    if ('node' in matchNode) {\n        return matchNode.node;\n    }\n\n    return getLastMatchNode(matchNode.match[matchNode.match.length - 1]);\n}\n\nfunction matchFragments(lexer, ast, match, type, name) {\n    function findFragments(matchNode) {\n        if (matchNode.syntax !== null &&\n            matchNode.syntax.type === type &&\n            matchNode.syntax.name === name) {\n            var start = getFirstMatchNode(matchNode);\n            var end = getLastMatchNode(matchNode);\n\n            lexer.syntax.walk(ast, function(node, item, list) {\n                if (node === start) {\n                    var nodes = new List();\n\n                    do {\n                        nodes.appendData(item.data);\n\n                        if (item.data === end) {\n                            break;\n                        }\n\n                        item = item.next;\n                    } while (item !== null);\n\n                    fragments.push({\n                        parent: list,\n                        nodes: nodes\n                    });\n                }\n            });\n        }\n\n        if (Array.isArray(matchNode.match)) {\n            matchNode.match.forEach(findFragments);\n        }\n    }\n\n    var fragments = [];\n\n    if (match.matched !== null) {\n        findFragments(match.matched);\n    }\n\n    return fragments;\n}\n\nmodule.exports = {\n    matchFragments: matchFragments\n};\n","var List = require('../common/List');\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction isValidNumber(value) {\n    // Number.isInteger(value) && value >= 0\n    return (\n        typeof value === 'number' &&\n        isFinite(value) &&\n        Math.floor(value) === value &&\n        value >= 0\n    );\n}\n\nfunction isValidLocation(loc) {\n    return (\n        Boolean(loc) &&\n        isValidNumber(loc.offset) &&\n        isValidNumber(loc.line) &&\n        isValidNumber(loc.column)\n    );\n}\n\nfunction createNodeStructureChecker(type, fields) {\n    return function checkNode(node, warn) {\n        if (!node || node.constructor !== Object) {\n            return warn(node, 'Type of node should be an Object');\n        }\n\n        for (var key in node) {\n            var valid = true;\n\n            if (hasOwnProperty.call(node, key) === false) {\n                continue;\n            }\n\n            if (key === 'type') {\n                if (node.type !== type) {\n                    warn(node, 'Wrong node type `' + node.type + '`, expected `' + type + '`');\n                }\n            } else if (key === 'loc') {\n                if (node.loc === null) {\n                    continue;\n                } else if (node.loc && node.loc.constructor === Object) {\n                    if (typeof node.loc.source !== 'string') {\n                        key += '.source';\n                    } else if (!isValidLocation(node.loc.start)) {\n                        key += '.start';\n                    } else if (!isValidLocation(node.loc.end)) {\n                        key += '.end';\n                    } else {\n                        continue;\n                    }\n                }\n\n                valid = false;\n            } else if (fields.hasOwnProperty(key)) {\n                for (var i = 0, valid = false; !valid && i < fields[key].length; i++) {\n                    var fieldType = fields[key][i];\n\n                    switch (fieldType) {\n                        case String:\n                            valid = typeof node[key] === 'string';\n                            break;\n\n                        case Boolean:\n                            valid = typeof node[key] === 'boolean';\n                            break;\n\n                        case null:\n                            valid = node[key] === null;\n                            break;\n\n                        default:\n                            if (typeof fieldType === 'string') {\n                                valid = node[key] && node[key].type === fieldType;\n                            } else if (Array.isArray(fieldType)) {\n                                valid = node[key] instanceof List;\n                            }\n                    }\n                }\n            } else {\n                warn(node, 'Unknown field `' + key + '` for ' + type + ' node type');\n            }\n\n            if (!valid) {\n                warn(node, 'Bad value for `' + type + '.' + key + '`');\n            }\n        }\n\n        for (var key in fields) {\n            if (hasOwnProperty.call(fields, key) &&\n                hasOwnProperty.call(node, key) === false) {\n                warn(node, 'Field `' + type + '.' + key + '` is missed');\n            }\n        }\n    };\n}\n\nfunction processStructure(name, nodeType) {\n    var structure = nodeType.structure;\n    var fields = {\n        type: String,\n        loc: true\n    };\n    var docs = {\n        type: '\"' + name + '\"'\n    };\n\n    for (var key in structure) {\n        if (hasOwnProperty.call(structure, key) === false) {\n            continue;\n        }\n\n        var docsTypes = [];\n        var fieldTypes = fields[key] = Array.isArray(structure[key])\n            ? structure[key].slice()\n            : [structure[key]];\n\n        for (var i = 0; i < fieldTypes.length; i++) {\n            var fieldType = fieldTypes[i];\n            if (fieldType === String || fieldType === Boolean) {\n                docsTypes.push(fieldType.name);\n            } else if (fieldType === null) {\n                docsTypes.push('null');\n            } else if (typeof fieldType === 'string') {\n                docsTypes.push('<' + fieldType + '>');\n            } else if (Array.isArray(fieldType)) {\n                docsTypes.push('List'); // TODO: use type enum\n            } else {\n                throw new Error('Wrong value `' + fieldType + '` in `' + name + '.' + key + '` structure definition');\n            }\n        }\n\n        docs[key] = docsTypes.join(' | ');\n    }\n\n    return {\n        docs: docs,\n        check: createNodeStructureChecker(name, fields)\n    };\n}\n\nmodule.exports = {\n    getStructureFromConfig: function(config) {\n        var structure = {};\n\n        if (config.node) {\n            for (var name in config.node) {\n                if (hasOwnProperty.call(config.node, name)) {\n                    var nodeType = config.node[name];\n\n                    if (nodeType.structure) {\n                        structure[name] = processStructure(name, nodeType);\n                    } else {\n                        throw new Error('Missed `structure` field in `' + name + '` node type definition');\n                    }\n                }\n            }\n        }\n\n        return structure;\n    }\n};\n","var SyntaxReferenceError = require('./error').SyntaxReferenceError;\nvar SyntaxMatchError = require('./error').SyntaxMatchError;\nvar names = require('../utils/names');\nvar generic = require('./generic');\nvar parse = require('../definition-syntax/parse');\nvar generate = require('../definition-syntax/generate');\nvar walk = require('../definition-syntax/walk');\nvar prepareTokens = require('./prepare-tokens');\nvar buildMatchGraph = require('./match-graph').buildMatchGraph;\nvar matchAsTree = require('./match').matchAsTree;\nvar trace = require('./trace');\nvar search = require('./search');\nvar getStructureFromConfig = require('./structure').getStructureFromConfig;\nvar cssWideKeywords = buildMatchGraph('inherit | initial | unset');\nvar cssWideKeywordsWithExpression = buildMatchGraph('inherit | initial | unset | <-ms-legacy-expression>');\n\nfunction dumpMapSyntax(map, compact, syntaxAsAst) {\n    var result = {};\n\n    for (var name in map) {\n        if (map[name].syntax) {\n            result[name] = syntaxAsAst\n                ? map[name].syntax\n                : generate(map[name].syntax, { compact: compact });\n        }\n    }\n\n    return result;\n}\n\nfunction dumpAtruleMapSyntax(map, compact, syntaxAsAst) {\n    const result = {};\n\n    for (const [name, atrule] of Object.entries(map)) {\n        result[name] = {\n            prelude: atrule.prelude && (\n                syntaxAsAst\n                    ? atrule.prelude.syntax\n                    : generate(atrule.prelude.syntax, { compact })\n            ),\n            descriptors: atrule.descriptors && dumpMapSyntax(atrule.descriptors, compact, syntaxAsAst)\n        };\n    }\n\n    return result;\n}\n\nfunction valueHasVar(tokens) {\n    for (var i = 0; i < tokens.length; i++) {\n        if (tokens[i].value.toLowerCase() === 'var(') {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nfunction buildMatchResult(match, error, iterations) {\n    return {\n        matched: match,\n        iterations: iterations,\n        error: error,\n        getTrace: trace.getTrace,\n        isType: trace.isType,\n        isProperty: trace.isProperty,\n        isKeyword: trace.isKeyword\n    };\n}\n\nfunction matchSyntax(lexer, syntax, value, useCommon) {\n    var tokens = prepareTokens(value, lexer.syntax);\n    var result;\n\n    if (valueHasVar(tokens)) {\n        return buildMatchResult(null, new Error('Matching for a tree with var() is not supported'));\n    }\n\n    if (useCommon) {\n        result = matchAsTree(tokens, lexer.valueCommonSyntax, lexer);\n    }\n\n    if (!useCommon || !result.match) {\n        result = matchAsTree(tokens, syntax.match, lexer);\n        if (!result.match) {\n            return buildMatchResult(\n                null,\n                new SyntaxMatchError(result.reason, syntax.syntax, value, result),\n                result.iterations\n            );\n        }\n    }\n\n    return buildMatchResult(result.match, null, result.iterations);\n}\n\nvar Lexer = function(config, syntax, structure) {\n    this.valueCommonSyntax = cssWideKeywords;\n    this.syntax = syntax;\n    this.generic = false;\n    this.atrules = {};\n    this.properties = {};\n    this.types = {};\n    this.structure = structure || getStructureFromConfig(config);\n\n    if (config) {\n        if (config.types) {\n            for (var name in config.types) {\n                this.addType_(name, config.types[name]);\n            }\n        }\n\n        if (config.generic) {\n            this.generic = true;\n            for (var name in generic) {\n                this.addType_(name, generic[name]);\n            }\n        }\n\n        if (config.atrules) {\n            for (var name in config.atrules) {\n                this.addAtrule_(name, config.atrules[name]);\n            }\n        }\n\n        if (config.properties) {\n            for (var name in config.properties) {\n                this.addProperty_(name, config.properties[name]);\n            }\n        }\n    }\n};\n\nLexer.prototype = {\n    structure: {},\n    checkStructure: function(ast) {\n        function collectWarning(node, message) {\n            warns.push({\n                node: node,\n                message: message\n            });\n        }\n\n        var structure = this.structure;\n        var warns = [];\n\n        this.syntax.walk(ast, function(node) {\n            if (structure.hasOwnProperty(node.type)) {\n                structure[node.type].check(node, collectWarning);\n            } else {\n                collectWarning(node, 'Unknown node type `' + node.type + '`');\n            }\n        });\n\n        return warns.length ? warns : false;\n    },\n\n    createDescriptor: function(syntax, type, name, parent = null) {\n        var ref = {\n            type: type,\n            name: name\n        };\n        var descriptor = {\n            type: type,\n            name: name,\n            parent: parent,\n            syntax: null,\n            match: null\n        };\n\n        if (typeof syntax === 'function') {\n            descriptor.match = buildMatchGraph(syntax, ref);\n        } else {\n            if (typeof syntax === 'string') {\n                // lazy parsing on first access\n                Object.defineProperty(descriptor, 'syntax', {\n                    get: function() {\n                        Object.defineProperty(descriptor, 'syntax', {\n                            value: parse(syntax)\n                        });\n\n                        return descriptor.syntax;\n                    }\n                });\n            } else {\n                descriptor.syntax = syntax;\n            }\n\n            // lazy graph build on first access\n            Object.defineProperty(descriptor, 'match', {\n                get: function() {\n                    Object.defineProperty(descriptor, 'match', {\n                        value: buildMatchGraph(descriptor.syntax, ref)\n                    });\n\n                    return descriptor.match;\n                }\n            });\n        }\n\n        return descriptor;\n    },\n    addAtrule_: function(name, syntax) {\n        if (!syntax) {\n            return;\n        }\n\n        this.atrules[name] = {\n            type: 'Atrule',\n            name: name,\n            prelude: syntax.prelude ? this.createDescriptor(syntax.prelude, 'AtrulePrelude', name) : null,\n            descriptors: syntax.descriptors\n                ? Object.keys(syntax.descriptors).reduce((res, descName) => {\n                    res[descName] = this.createDescriptor(syntax.descriptors[descName], 'AtruleDescriptor', descName, name);\n                    return res;\n                }, {})\n                : null\n        };\n    },\n    addProperty_: function(name, syntax) {\n        if (!syntax) {\n            return;\n        }\n\n        this.properties[name] = this.createDescriptor(syntax, 'Property', name);\n    },\n    addType_: function(name, syntax) {\n        if (!syntax) {\n            return;\n        }\n\n        this.types[name] = this.createDescriptor(syntax, 'Type', name);\n\n        if (syntax === generic['-ms-legacy-expression']) {\n            this.valueCommonSyntax = cssWideKeywordsWithExpression;\n        }\n    },\n\n    checkAtruleName: function(atruleName) {\n        if (!this.getAtrule(atruleName)) {\n            return new SyntaxReferenceError('Unknown at-rule', '@' + atruleName);\n        }\n    },\n    checkAtrulePrelude: function(atruleName, prelude) {\n        let error = this.checkAtruleName(atruleName);\n\n        if (error) {\n            return error;\n        }\n\n        var atrule = this.getAtrule(atruleName);\n\n        if (!atrule.prelude && prelude) {\n            return new SyntaxError('At-rule `@' + atruleName + '` should not contain a prelude');\n        }\n\n        if (atrule.prelude && !prelude) {\n            return new SyntaxError('At-rule `@' + atruleName + '` should contain a prelude');\n        }\n    },\n    checkAtruleDescriptorName: function(atruleName, descriptorName) {\n        let error = this.checkAtruleName(atruleName);\n\n        if (error) {\n            return error;\n        }\n\n        var atrule = this.getAtrule(atruleName);\n        var descriptor = names.keyword(descriptorName);\n\n        if (!atrule.descriptors) {\n            return new SyntaxError('At-rule `@' + atruleName + '` has no known descriptors');\n        }\n\n        if (!atrule.descriptors[descriptor.name] &&\n            !atrule.descriptors[descriptor.basename]) {\n            return new SyntaxReferenceError('Unknown at-rule descriptor', descriptorName);\n        }\n    },\n    checkPropertyName: function(propertyName) {\n        var property = names.property(propertyName);\n\n        // don't match syntax for a custom property\n        if (property.custom) {\n            return new Error('Lexer matching doesn\\'t applicable for custom properties');\n        }\n\n        if (!this.getProperty(propertyName)) {\n            return new SyntaxReferenceError('Unknown property', propertyName);\n        }\n    },\n\n    matchAtrulePrelude: function(atruleName, prelude) {\n        var error = this.checkAtrulePrelude(atruleName, prelude);\n\n        if (error) {\n            return buildMatchResult(null, error);\n        }\n\n        if (!prelude) {\n            return buildMatchResult(null, null);\n        }\n\n        return matchSyntax(this, this.getAtrule(atruleName).prelude, prelude, false);\n    },\n    matchAtruleDescriptor: function(atruleName, descriptorName, value) {\n        var error = this.checkAtruleDescriptorName(atruleName, descriptorName);\n\n        if (error) {\n            return buildMatchResult(null, error);\n        }\n\n        var atrule = this.getAtrule(atruleName);\n        var descriptor = names.keyword(descriptorName);\n\n        return matchSyntax(this, atrule.descriptors[descriptor.name] || atrule.descriptors[descriptor.basename], value, false);\n    },\n    matchDeclaration: function(node) {\n        if (node.type !== 'Declaration') {\n            return buildMatchResult(null, new Error('Not a Declaration node'));\n        }\n\n        return this.matchProperty(node.property, node.value);\n    },\n    matchProperty: function(propertyName, value) {\n        var error = this.checkPropertyName(propertyName);\n\n        if (error) {\n            return buildMatchResult(null, error);\n        }\n\n        return matchSyntax(this, this.getProperty(propertyName), value, true);\n    },\n    matchType: function(typeName, value) {\n        var typeSyntax = this.getType(typeName);\n\n        if (!typeSyntax) {\n            return buildMatchResult(null, new SyntaxReferenceError('Unknown type', typeName));\n        }\n\n        return matchSyntax(this, typeSyntax, value, false);\n    },\n    match: function(syntax, value) {\n        if (typeof syntax !== 'string' && (!syntax || !syntax.type)) {\n            return buildMatchResult(null, new SyntaxReferenceError('Bad syntax'));\n        }\n\n        if (typeof syntax === 'string' || !syntax.match) {\n            syntax = this.createDescriptor(syntax, 'Type', 'anonymous');\n        }\n\n        return matchSyntax(this, syntax, value, false);\n    },\n\n    findValueFragments: function(propertyName, value, type, name) {\n        return search.matchFragments(this, value, this.matchProperty(propertyName, value), type, name);\n    },\n    findDeclarationValueFragments: function(declaration, type, name) {\n        return search.matchFragments(this, declaration.value, this.matchDeclaration(declaration), type, name);\n    },\n    findAllFragments: function(ast, type, name) {\n        var result = [];\n\n        this.syntax.walk(ast, {\n            visit: 'Declaration',\n            enter: function(declaration) {\n                result.push.apply(result, this.findDeclarationValueFragments(declaration, type, name));\n            }.bind(this)\n        });\n\n        return result;\n    },\n\n    getAtrule: function(atruleName, fallbackBasename = true) {\n        var atrule = names.keyword(atruleName);\n        var atruleEntry = atrule.vendor && fallbackBasename\n            ? this.atrules[atrule.name] || this.atrules[atrule.basename]\n            : this.atrules[atrule.name];\n\n        return atruleEntry || null;\n    },\n    getAtrulePrelude: function(atruleName, fallbackBasename = true) {\n        const atrule = this.getAtrule(atruleName, fallbackBasename);\n\n        return atrule && atrule.prelude || null;\n    },\n    getAtruleDescriptor: function(atruleName, name) {\n        return this.atrules.hasOwnProperty(atruleName) && this.atrules.declarators\n            ? this.atrules[atruleName].declarators[name] || null\n            : null;\n    },\n    getProperty: function(propertyName, fallbackBasename = true) {\n        var property = names.property(propertyName);\n        var propertyEntry = property.vendor && fallbackBasename\n            ? this.properties[property.name] || this.properties[property.basename]\n            : this.properties[property.name];\n\n        return propertyEntry || null;\n    },\n    getType: function(name) {\n        return this.types.hasOwnProperty(name) ? this.types[name] : null;\n    },\n\n    validate: function() {\n        function validate(syntax, name, broken, descriptor) {\n            if (broken.hasOwnProperty(name)) {\n                return broken[name];\n            }\n\n            broken[name] = false;\n            if (descriptor.syntax !== null) {\n                walk(descriptor.syntax, function(node) {\n                    if (node.type !== 'Type' && node.type !== 'Property') {\n                        return;\n                    }\n\n                    var map = node.type === 'Type' ? syntax.types : syntax.properties;\n                    var brokenMap = node.type === 'Type' ? brokenTypes : brokenProperties;\n\n                    if (!map.hasOwnProperty(node.name) || validate(syntax, node.name, brokenMap, map[node.name])) {\n                        broken[name] = true;\n                    }\n                }, this);\n            }\n        }\n\n        var brokenTypes = {};\n        var brokenProperties = {};\n\n        for (var key in this.types) {\n            validate(this, key, brokenTypes, this.types[key]);\n        }\n\n        for (var key in this.properties) {\n            validate(this, key, brokenProperties, this.properties[key]);\n        }\n\n        brokenTypes = Object.keys(brokenTypes).filter(function(name) {\n            return brokenTypes[name];\n        });\n        brokenProperties = Object.keys(brokenProperties).filter(function(name) {\n            return brokenProperties[name];\n        });\n\n        if (brokenTypes.length || brokenProperties.length) {\n            return {\n                types: brokenTypes,\n                properties: brokenProperties\n            };\n        }\n\n        return null;\n    },\n    dump: function(syntaxAsAst, pretty) {\n        return {\n            generic: this.generic,\n            types: dumpMapSyntax(this.types, !pretty, syntaxAsAst),\n            properties: dumpMapSyntax(this.properties, !pretty, syntaxAsAst),\n            atrules: dumpAtruleMapSyntax(this.atrules, !pretty, syntaxAsAst)\n        };\n    },\n    toString: function() {\n        return JSON.stringify(this.dump());\n    }\n};\n\nmodule.exports = Lexer;\n","module.exports = {\n    SyntaxError: require('./SyntaxError'),\n    parse: require('./parse'),\n    generate: require('./generate'),\n    walk: require('./walk')\n};\n","var adoptBuffer = require('./adopt-buffer');\nvar isBOM = require('../tokenizer').isBOM;\n\nvar N = 10;\nvar F = 12;\nvar R = 13;\n\nfunction computeLinesAndColumns(host, source) {\n    var sourceLength = source.length;\n    var lines = adoptBuffer(host.lines, sourceLength); // +1\n    var line = host.startLine;\n    var columns = adoptBuffer(host.columns, sourceLength);\n    var column = host.startColumn;\n    var startOffset = source.length > 0 ? isBOM(source.charCodeAt(0)) : 0;\n\n    for (var i = startOffset; i < sourceLength; i++) { // -1\n        var code = source.charCodeAt(i);\n\n        lines[i] = line;\n        columns[i] = column++;\n\n        if (code === N || code === R || code === F) {\n            if (code === R && i + 1 < sourceLength && source.charCodeAt(i + 1) === N) {\n                i++;\n                lines[i] = line;\n                columns[i] = column;\n            }\n\n            line++;\n            column = 1;\n        }\n    }\n\n    lines[i] = line;\n    columns[i] = column;\n\n    host.lines = lines;\n    host.columns = columns;\n}\n\nvar OffsetToLocation = function() {\n    this.lines = null;\n    this.columns = null;\n    this.linesAndColumnsComputed = false;\n};\n\nOffsetToLocation.prototype = {\n    setSource: function(source, startOffset, startLine, startColumn) {\n        this.source = source;\n        this.startOffset = typeof startOffset === 'undefined' ? 0 : startOffset;\n        this.startLine = typeof startLine === 'undefined' ? 1 : startLine;\n        this.startColumn = typeof startColumn === 'undefined' ? 1 : startColumn;\n        this.linesAndColumnsComputed = false;\n    },\n\n    ensureLinesAndColumnsComputed: function() {\n        if (!this.linesAndColumnsComputed) {\n            computeLinesAndColumns(this, this.source);\n            this.linesAndColumnsComputed = true;\n        }\n    },\n    getLocation: function(offset, filename) {\n        this.ensureLinesAndColumnsComputed();\n\n        return {\n            source: filename,\n            offset: this.startOffset + offset,\n            line: this.lines[offset],\n            column: this.columns[offset]\n        };\n    },\n    getLocationRange: function(start, end, filename) {\n        this.ensureLinesAndColumnsComputed();\n\n        return {\n            source: filename,\n            start: {\n                offset: this.startOffset + start,\n                line: this.lines[start],\n                column: this.columns[start]\n            },\n            end: {\n                offset: this.startOffset + end,\n                line: this.lines[end],\n                column: this.columns[end]\n            }\n        };\n    }\n};\n\nmodule.exports = OffsetToLocation;\n","var TYPE = require('../tokenizer').TYPE;\nvar WHITESPACE = TYPE.WhiteSpace;\nvar COMMENT = TYPE.Comment;\n\nmodule.exports = function readSequence(recognizer) {\n    var children = this.createList();\n    var child = null;\n    var context = {\n        recognizer: recognizer,\n        space: null,\n        ignoreWS: false,\n        ignoreWSAfter: false\n    };\n\n    this.scanner.skipSC();\n\n    while (!this.scanner.eof) {\n        switch (this.scanner.tokenType) {\n            case COMMENT:\n                this.scanner.next();\n                continue;\n\n            case WHITESPACE:\n                if (context.ignoreWS) {\n                    this.scanner.next();\n                } else {\n                    context.space = this.WhiteSpace();\n                }\n                continue;\n        }\n\n        child = recognizer.getNode.call(this, context);\n\n        if (child === undefined) {\n            break;\n        }\n\n        if (context.space !== null) {\n            children.push(context.space);\n            context.space = null;\n        }\n\n        children.push(child);\n\n        if (context.ignoreWSAfter) {\n            context.ignoreWSAfter = false;\n            context.ignoreWS = true;\n        } else {\n            context.ignoreWS = false;\n        }\n    }\n\n    return children;\n};\n","var OffsetToLocation = require('../common/OffsetToLocation');\nvar SyntaxError = require('../common/SyntaxError');\nvar TokenStream = require('../common/TokenStream');\nvar List = require('../common/List');\nvar tokenize = require('../tokenizer');\nvar constants = require('../tokenizer/const');\nvar { findWhiteSpaceStart, cmpStr } = require('../tokenizer/utils');\nvar sequence = require('./sequence');\nvar noop = function() {};\n\nvar TYPE = constants.TYPE;\nvar NAME = constants.NAME;\nvar WHITESPACE = TYPE.WhiteSpace;\nvar COMMENT = TYPE.Comment;\nvar IDENT = TYPE.Ident;\nvar FUNCTION = TYPE.Function;\nvar URL = TYPE.Url;\nvar HASH = TYPE.Hash;\nvar PERCENTAGE = TYPE.Percentage;\nvar NUMBER = TYPE.Number;\nvar NUMBERSIGN = 0x0023; // U+0023 NUMBER SIGN (#)\nvar NULL = 0;\n\nfunction createParseContext(name) {\n    return function() {\n        return this[name]();\n    };\n}\n\nfunction processConfig(config) {\n    var parserConfig = {\n        context: {},\n        scope: {},\n        atrule: {},\n        pseudo: {}\n    };\n\n    if (config.parseContext) {\n        for (var name in config.parseContext) {\n            switch (typeof config.parseContext[name]) {\n                case 'function':\n                    parserConfig.context[name] = config.parseContext[name];\n                    break;\n\n                case 'string':\n                    parserConfig.context[name] = createParseContext(config.parseContext[name]);\n                    break;\n            }\n        }\n    }\n\n    if (config.scope) {\n        for (var name in config.scope) {\n            parserConfig.scope[name] = config.scope[name];\n        }\n    }\n\n    if (config.atrule) {\n        for (var name in config.atrule) {\n            var atrule = config.atrule[name];\n\n            if (atrule.parse) {\n                parserConfig.atrule[name] = atrule.parse;\n            }\n        }\n    }\n\n    if (config.pseudo) {\n        for (var name in config.pseudo) {\n            var pseudo = config.pseudo[name];\n\n            if (pseudo.parse) {\n                parserConfig.pseudo[name] = pseudo.parse;\n            }\n        }\n    }\n\n    if (config.node) {\n        for (var name in config.node) {\n            parserConfig[name] = config.node[name].parse;\n        }\n    }\n\n    return parserConfig;\n}\n\nmodule.exports = function createParser(config) {\n    var parser = {\n        scanner: new TokenStream(),\n        locationMap: new OffsetToLocation(),\n\n        filename: '<unknown>',\n        needPositions: false,\n        onParseError: noop,\n        onParseErrorThrow: false,\n        parseAtrulePrelude: true,\n        parseRulePrelude: true,\n        parseValue: true,\n        parseCustomProperty: false,\n\n        readSequence: sequence,\n\n        createList: function() {\n            return new List();\n        },\n        createSingleNodeList: function(node) {\n            return new List().appendData(node);\n        },\n        getFirstListNode: function(list) {\n            return list && list.first();\n        },\n        getLastListNode: function(list) {\n            return list.last();\n        },\n\n        parseWithFallback: function(consumer, fallback) {\n            var startToken = this.scanner.tokenIndex;\n\n            try {\n                return consumer.call(this);\n            } catch (e) {\n                if (this.onParseErrorThrow) {\n                    throw e;\n                }\n\n                var fallbackNode = fallback.call(this, startToken);\n\n                this.onParseErrorThrow = true;\n                this.onParseError(e, fallbackNode);\n                this.onParseErrorThrow = false;\n\n                return fallbackNode;\n            }\n        },\n\n        lookupNonWSType: function(offset) {\n            do {\n                var type = this.scanner.lookupType(offset++);\n                if (type !== WHITESPACE) {\n                    return type;\n                }\n            } while (type !== NULL);\n\n            return NULL;\n        },\n\n        eat: function(tokenType) {\n            if (this.scanner.tokenType !== tokenType) {\n                var offset = this.scanner.tokenStart;\n                var message = NAME[tokenType] + ' is expected';\n\n                // tweak message and offset\n                switch (tokenType) {\n                    case IDENT:\n                        // when identifier is expected but there is a function or url\n                        if (this.scanner.tokenType === FUNCTION || this.scanner.tokenType === URL) {\n                            offset = this.scanner.tokenEnd - 1;\n                            message = 'Identifier is expected but function found';\n                        } else {\n                            message = 'Identifier is expected';\n                        }\n                        break;\n\n                    case HASH:\n                        if (this.scanner.isDelim(NUMBERSIGN)) {\n                            this.scanner.next();\n                            offset++;\n                            message = 'Name is expected';\n                        }\n                        break;\n\n                    case PERCENTAGE:\n                        if (this.scanner.tokenType === NUMBER) {\n                            offset = this.scanner.tokenEnd;\n                            message = 'Percent sign is expected';\n                        }\n                        break;\n\n                    default:\n                        // when test type is part of another token show error for current position + 1\n                        // e.g. eat(HYPHENMINUS) will fail on \"-foo\", but pointing on \"-\" is odd\n                        if (this.scanner.source.charCodeAt(this.scanner.tokenStart) === tokenType) {\n                            offset = offset + 1;\n                        }\n                }\n\n                this.error(message, offset);\n            }\n\n            this.scanner.next();\n        },\n\n        consume: function(tokenType) {\n            var value = this.scanner.getTokenValue();\n\n            this.eat(tokenType);\n\n            return value;\n        },\n        consumeFunctionName: function() {\n            var name = this.scanner.source.substring(this.scanner.tokenStart, this.scanner.tokenEnd - 1);\n\n            this.eat(FUNCTION);\n\n            return name;\n        },\n\n        getLocation: function(start, end) {\n            if (this.needPositions) {\n                return this.locationMap.getLocationRange(\n                    start,\n                    end,\n                    this.filename\n                );\n            }\n\n            return null;\n        },\n        getLocationFromList: function(list) {\n            if (this.needPositions) {\n                var head = this.getFirstListNode(list);\n                var tail = this.getLastListNode(list);\n                return this.locationMap.getLocationRange(\n                    head !== null ? head.loc.start.offset - this.locationMap.startOffset : this.scanner.tokenStart,\n                    tail !== null ? tail.loc.end.offset - this.locationMap.startOffset : this.scanner.tokenStart,\n                    this.filename\n                );\n            }\n\n            return null;\n        },\n\n        error: function(message, offset) {\n            var location = typeof offset !== 'undefined' && offset < this.scanner.source.length\n                ? this.locationMap.getLocation(offset)\n                : this.scanner.eof\n                    ? this.locationMap.getLocation(findWhiteSpaceStart(this.scanner.source, this.scanner.source.length - 1))\n                    : this.locationMap.getLocation(this.scanner.tokenStart);\n\n            throw new SyntaxError(\n                message || 'Unexpected input',\n                this.scanner.source,\n                location.offset,\n                location.line,\n                location.column\n            );\n        }\n    };\n\n    config = processConfig(config || {});\n    for (var key in config) {\n        parser[key] = config[key];\n    }\n\n    return function(source, options) {\n        options = options || {};\n\n        var context = options.context || 'default';\n        var onComment = options.onComment;\n        var ast;\n\n        tokenize(source, parser.scanner);\n        parser.locationMap.setSource(\n            source,\n            options.offset,\n            options.line,\n            options.column\n        );\n\n        parser.filename = options.filename || '<unknown>';\n        parser.needPositions = Boolean(options.positions);\n        parser.onParseError = typeof options.onParseError === 'function' ? options.onParseError : noop;\n        parser.onParseErrorThrow = false;\n        parser.parseAtrulePrelude = 'parseAtrulePrelude' in options ? Boolean(options.parseAtrulePrelude) : true;\n        parser.parseRulePrelude = 'parseRulePrelude' in options ? Boolean(options.parseRulePrelude) : true;\n        parser.parseValue = 'parseValue' in options ? Boolean(options.parseValue) : true;\n        parser.parseCustomProperty = 'parseCustomProperty' in options ? Boolean(options.parseCustomProperty) : false;\n\n        if (!parser.context.hasOwnProperty(context)) {\n            throw new Error('Unknown context `' + context + '`');\n        }\n\n        if (typeof onComment === 'function') {\n            parser.scanner.forEachToken((type, start, end) => {\n                if (type === COMMENT) {\n                    const loc = parser.getLocation(start, end);\n                    const value = cmpStr(source, end - 2, end, '*/')\n                        ? source.slice(start + 2, end - 2)\n                        : source.slice(start + 2, end);\n\n                    onComment(value, loc);\n                }\n            });\n        }\n\n        ast = parser.context[context].call(parser, options);\n\n        if (!parser.scanner.eof) {\n            parser.error();\n        }\n\n        return ast;\n    };\n};\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\nvar intToCharMap = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'.split('');\n\n/**\n * Encode an integer in the range of 0 to 63 to a single base 64 digit.\n */\nexports.encode = function (number) {\n  if (0 <= number && number < intToCharMap.length) {\n    return intToCharMap[number];\n  }\n  throw new TypeError(\"Must be between 0 and 63: \" + number);\n};\n\n/**\n * Decode a single base 64 character code digit to an integer. Returns -1 on\n * failure.\n */\nexports.decode = function (charCode) {\n  var bigA = 65;     // 'A'\n  var bigZ = 90;     // 'Z'\n\n  var littleA = 97;  // 'a'\n  var littleZ = 122; // 'z'\n\n  var zero = 48;     // '0'\n  var nine = 57;     // '9'\n\n  var plus = 43;     // '+'\n  var slash = 47;    // '/'\n\n  var littleOffset = 26;\n  var numberOffset = 52;\n\n  // 0 - 25: ABCDEFGHIJKLMNOPQRSTUVWXYZ\n  if (bigA <= charCode && charCode <= bigZ) {\n    return (charCode - bigA);\n  }\n\n  // 26 - 51: abcdefghijklmnopqrstuvwxyz\n  if (littleA <= charCode && charCode <= littleZ) {\n    return (charCode - littleA + littleOffset);\n  }\n\n  // 52 - 61: 0123456789\n  if (zero <= charCode && charCode <= nine) {\n    return (charCode - zero + numberOffset);\n  }\n\n  // 62: +\n  if (charCode == plus) {\n    return 62;\n  }\n\n  // 63: /\n  if (charCode == slash) {\n    return 63;\n  }\n\n  // Invalid base64 digit.\n  return -1;\n};\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n *\n * Based on the Base 64 VLQ implementation in Closure Compiler:\n * https://code.google.com/p/closure-compiler/source/browse/trunk/src/com/google/debugging/sourcemap/Base64VLQ.java\n *\n * Copyright 2011 The Closure Compiler Authors. All rights reserved.\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are\n * met:\n *\n *  * Redistributions of source code must retain the above copyright\n *    notice, this list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above\n *    copyright notice, this list of conditions and the following\n *    disclaimer in the documentation and/or other materials provided\n *    with the distribution.\n *  * Neither the name of Google Inc. nor the names of its\n *    contributors may be used to endorse or promote products derived\n *    from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nvar base64 = require('./base64');\n\n// A single base 64 digit can contain 6 bits of data. For the base 64 variable\n// length quantities we use in the source map spec, the first bit is the sign,\n// the next four bits are the actual value, and the 6th bit is the\n// continuation bit. The continuation bit tells us whether there are more\n// digits in this value following this digit.\n//\n//   Continuation\n//   |    Sign\n//   |    |\n//   V    V\n//   101011\n\nvar VLQ_BASE_SHIFT = 5;\n\n// binary: 100000\nvar VLQ_BASE = 1 << VLQ_BASE_SHIFT;\n\n// binary: 011111\nvar VLQ_BASE_MASK = VLQ_BASE - 1;\n\n// binary: 100000\nvar VLQ_CONTINUATION_BIT = VLQ_BASE;\n\n/**\n * Converts from a two-complement value to a value where the sign bit is\n * placed in the least significant bit.  For example, as decimals:\n *   1 becomes 2 (10 binary), -1 becomes 3 (11 binary)\n *   2 becomes 4 (100 binary), -2 becomes 5 (101 binary)\n */\nfunction toVLQSigned(aValue) {\n  return aValue < 0\n    ? ((-aValue) << 1) + 1\n    : (aValue << 1) + 0;\n}\n\n/**\n * Converts to a two-complement value from a value where the sign bit is\n * placed in the least significant bit.  For example, as decimals:\n *   2 (10 binary) becomes 1, 3 (11 binary) becomes -1\n *   4 (100 binary) becomes 2, 5 (101 binary) becomes -2\n */\nfunction fromVLQSigned(aValue) {\n  var isNegative = (aValue & 1) === 1;\n  var shifted = aValue >> 1;\n  return isNegative\n    ? -shifted\n    : shifted;\n}\n\n/**\n * Returns the base 64 VLQ encoded value.\n */\nexports.encode = function base64VLQ_encode(aValue) {\n  var encoded = \"\";\n  var digit;\n\n  var vlq = toVLQSigned(aValue);\n\n  do {\n    digit = vlq & VLQ_BASE_MASK;\n    vlq >>>= VLQ_BASE_SHIFT;\n    if (vlq > 0) {\n      // There are still more digits in this value, so we must make sure the\n      // continuation bit is marked.\n      digit |= VLQ_CONTINUATION_BIT;\n    }\n    encoded += base64.encode(digit);\n  } while (vlq > 0);\n\n  return encoded;\n};\n\n/**\n * Decodes the next base 64 VLQ value from the given string and returns the\n * value and the rest of the string via the out parameter.\n */\nexports.decode = function base64VLQ_decode(aStr, aIndex, aOutParam) {\n  var strLen = aStr.length;\n  var result = 0;\n  var shift = 0;\n  var continuation, digit;\n\n  do {\n    if (aIndex >= strLen) {\n      throw new Error(\"Expected more digits in base 64 VLQ value.\");\n    }\n\n    digit = base64.decode(aStr.charCodeAt(aIndex++));\n    if (digit === -1) {\n      throw new Error(\"Invalid base64 digit: \" + aStr.charAt(aIndex - 1));\n    }\n\n    continuation = !!(digit & VLQ_CONTINUATION_BIT);\n    digit &= VLQ_BASE_MASK;\n    result = result + (digit << shift);\n    shift += VLQ_BASE_SHIFT;\n  } while (continuation);\n\n  aOutParam.value = fromVLQSigned(result);\n  aOutParam.rest = aIndex;\n};\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\n/**\n * This is a helper function for getting values from parameter/options\n * objects.\n *\n * @param args The object we are extracting values from\n * @param name The name of the property we are getting.\n * @param defaultValue An optional value to return if the property is missing\n * from the object. If this is not specified and the property is missing, an\n * error will be thrown.\n */\nfunction getArg(aArgs, aName, aDefaultValue) {\n  if (aName in aArgs) {\n    return aArgs[aName];\n  } else if (arguments.length === 3) {\n    return aDefaultValue;\n  } else {\n    throw new Error('\"' + aName + '\" is a required argument.');\n  }\n}\nexports.getArg = getArg;\n\nvar urlRegexp = /^(?:([\\w+\\-.]+):)?\\/\\/(?:(\\w+:\\w+)@)?([\\w.-]*)(?::(\\d+))?(.*)$/;\nvar dataUrlRegexp = /^data:.+\\,.+$/;\n\nfunction urlParse(aUrl) {\n  var match = aUrl.match(urlRegexp);\n  if (!match) {\n    return null;\n  }\n  return {\n    scheme: match[1],\n    auth: match[2],\n    host: match[3],\n    port: match[4],\n    path: match[5]\n  };\n}\nexports.urlParse = urlParse;\n\nfunction urlGenerate(aParsedUrl) {\n  var url = '';\n  if (aParsedUrl.scheme) {\n    url += aParsedUrl.scheme + ':';\n  }\n  url += '//';\n  if (aParsedUrl.auth) {\n    url += aParsedUrl.auth + '@';\n  }\n  if (aParsedUrl.host) {\n    url += aParsedUrl.host;\n  }\n  if (aParsedUrl.port) {\n    url += \":\" + aParsedUrl.port\n  }\n  if (aParsedUrl.path) {\n    url += aParsedUrl.path;\n  }\n  return url;\n}\nexports.urlGenerate = urlGenerate;\n\n/**\n * Normalizes a path, or the path portion of a URL:\n *\n * - Replaces consecutive slashes with one slash.\n * - Removes unnecessary '.' parts.\n * - Removes unnecessary '<dir>/..' parts.\n *\n * Based on code in the Node.js 'path' core module.\n *\n * @param aPath The path or url to normalize.\n */\nfunction normalize(aPath) {\n  var path = aPath;\n  var url = urlParse(aPath);\n  if (url) {\n    if (!url.path) {\n      return aPath;\n    }\n    path = url.path;\n  }\n  var isAbsolute = exports.isAbsolute(path);\n\n  var parts = path.split(/\\/+/);\n  for (var part, up = 0, i = parts.length - 1; i >= 0; i--) {\n    part = parts[i];\n    if (part === '.') {\n      parts.splice(i, 1);\n    } else if (part === '..') {\n      up++;\n    } else if (up > 0) {\n      if (part === '') {\n        // The first part is blank if the path is absolute. Trying to go\n        // above the root is a no-op. Therefore we can remove all '..' parts\n        // directly after the root.\n        parts.splice(i + 1, up);\n        up = 0;\n      } else {\n        parts.splice(i, 2);\n        up--;\n      }\n    }\n  }\n  path = parts.join('/');\n\n  if (path === '') {\n    path = isAbsolute ? '/' : '.';\n  }\n\n  if (url) {\n    url.path = path;\n    return urlGenerate(url);\n  }\n  return path;\n}\nexports.normalize = normalize;\n\n/**\n * Joins two paths/URLs.\n *\n * @param aRoot The root path or URL.\n * @param aPath The path or URL to be joined with the root.\n *\n * - If aPath is a URL or a data URI, aPath is returned, unless aPath is a\n *   scheme-relative URL: Then the scheme of aRoot, if any, is prepended\n *   first.\n * - Otherwise aPath is a path. If aRoot is a URL, then its path portion\n *   is updated with the result and aRoot is returned. Otherwise the result\n *   is returned.\n *   - If aPath is absolute, the result is aPath.\n *   - Otherwise the two paths are joined with a slash.\n * - Joining for example 'http://' and 'www.example.com' is also supported.\n */\nfunction join(aRoot, aPath) {\n  if (aRoot === \"\") {\n    aRoot = \".\";\n  }\n  if (aPath === \"\") {\n    aPath = \".\";\n  }\n  var aPathUrl = urlParse(aPath);\n  var aRootUrl = urlParse(aRoot);\n  if (aRootUrl) {\n    aRoot = aRootUrl.path || '/';\n  }\n\n  // `join(foo, '//www.example.org')`\n  if (aPathUrl && !aPathUrl.scheme) {\n    if (aRootUrl) {\n      aPathUrl.scheme = aRootUrl.scheme;\n    }\n    return urlGenerate(aPathUrl);\n  }\n\n  if (aPathUrl || aPath.match(dataUrlRegexp)) {\n    return aPath;\n  }\n\n  // `join('http://', 'www.example.com')`\n  if (aRootUrl && !aRootUrl.host && !aRootUrl.path) {\n    aRootUrl.host = aPath;\n    return urlGenerate(aRootUrl);\n  }\n\n  var joined = aPath.charAt(0) === '/'\n    ? aPath\n    : normalize(aRoot.replace(/\\/+$/, '') + '/' + aPath);\n\n  if (aRootUrl) {\n    aRootUrl.path = joined;\n    return urlGenerate(aRootUrl);\n  }\n  return joined;\n}\nexports.join = join;\n\nexports.isAbsolute = function (aPath) {\n  return aPath.charAt(0) === '/' || urlRegexp.test(aPath);\n};\n\n/**\n * Make a path relative to a URL or another path.\n *\n * @param aRoot The root path or URL.\n * @param aPath The path or URL to be made relative to aRoot.\n */\nfunction relative(aRoot, aPath) {\n  if (aRoot === \"\") {\n    aRoot = \".\";\n  }\n\n  aRoot = aRoot.replace(/\\/$/, '');\n\n  // It is possible for the path to be above the root. In this case, simply\n  // checking whether the root is a prefix of the path won't work. Instead, we\n  // need to remove components from the root one by one, until either we find\n  // a prefix that fits, or we run out of components to remove.\n  var level = 0;\n  while (aPath.indexOf(aRoot + '/') !== 0) {\n    var index = aRoot.lastIndexOf(\"/\");\n    if (index < 0) {\n      return aPath;\n    }\n\n    // If the only part of the root that is left is the scheme (i.e. http://,\n    // file:///, etc.), one or more slashes (/), or simply nothing at all, we\n    // have exhausted all components, so the path is not relative to the root.\n    aRoot = aRoot.slice(0, index);\n    if (aRoot.match(/^([^\\/]+:\\/)?\\/*$/)) {\n      return aPath;\n    }\n\n    ++level;\n  }\n\n  // Make sure we add a \"../\" for each component we removed from the root.\n  return Array(level + 1).join(\"../\") + aPath.substr(aRoot.length + 1);\n}\nexports.relative = relative;\n\nvar supportsNullProto = (function () {\n  var obj = Object.create(null);\n  return !('__proto__' in obj);\n}());\n\nfunction identity (s) {\n  return s;\n}\n\n/**\n * Because behavior goes wacky when you set `__proto__` on objects, we\n * have to prefix all the strings in our set with an arbitrary character.\n *\n * See https://github.com/mozilla/source-map/pull/31 and\n * https://github.com/mozilla/source-map/issues/30\n *\n * @param String aStr\n */\nfunction toSetString(aStr) {\n  if (isProtoString(aStr)) {\n    return '$' + aStr;\n  }\n\n  return aStr;\n}\nexports.toSetString = supportsNullProto ? identity : toSetString;\n\nfunction fromSetString(aStr) {\n  if (isProtoString(aStr)) {\n    return aStr.slice(1);\n  }\n\n  return aStr;\n}\nexports.fromSetString = supportsNullProto ? identity : fromSetString;\n\nfunction isProtoString(s) {\n  if (!s) {\n    return false;\n  }\n\n  var length = s.length;\n\n  if (length < 9 /* \"__proto__\".length */) {\n    return false;\n  }\n\n  if (s.charCodeAt(length - 1) !== 95  /* '_' */ ||\n      s.charCodeAt(length - 2) !== 95  /* '_' */ ||\n      s.charCodeAt(length - 3) !== 111 /* 'o' */ ||\n      s.charCodeAt(length - 4) !== 116 /* 't' */ ||\n      s.charCodeAt(length - 5) !== 111 /* 'o' */ ||\n      s.charCodeAt(length - 6) !== 114 /* 'r' */ ||\n      s.charCodeAt(length - 7) !== 112 /* 'p' */ ||\n      s.charCodeAt(length - 8) !== 95  /* '_' */ ||\n      s.charCodeAt(length - 9) !== 95  /* '_' */) {\n    return false;\n  }\n\n  for (var i = length - 10; i >= 0; i--) {\n    if (s.charCodeAt(i) !== 36 /* '$' */) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Comparator between two mappings where the original positions are compared.\n *\n * Optionally pass in `true` as `onlyCompareGenerated` to consider two\n * mappings with the same original source/line/column, but different generated\n * line and column the same. Useful when searching for a mapping with a\n * stubbed out mapping.\n */\nfunction compareByOriginalPositions(mappingA, mappingB, onlyCompareOriginal) {\n  var cmp = strcmp(mappingA.source, mappingB.source);\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalLine - mappingB.originalLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalColumn - mappingB.originalColumn;\n  if (cmp !== 0 || onlyCompareOriginal) {\n    return cmp;\n  }\n\n  cmp = mappingA.generatedColumn - mappingB.generatedColumn;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.generatedLine - mappingB.generatedLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  return strcmp(mappingA.name, mappingB.name);\n}\nexports.compareByOriginalPositions = compareByOriginalPositions;\n\n/**\n * Comparator between two mappings with deflated source and name indices where\n * the generated positions are compared.\n *\n * Optionally pass in `true` as `onlyCompareGenerated` to consider two\n * mappings with the same generated line and column, but different\n * source/name/original line and column the same. Useful when searching for a\n * mapping with a stubbed out mapping.\n */\nfunction compareByGeneratedPositionsDeflated(mappingA, mappingB, onlyCompareGenerated) {\n  var cmp = mappingA.generatedLine - mappingB.generatedLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.generatedColumn - mappingB.generatedColumn;\n  if (cmp !== 0 || onlyCompareGenerated) {\n    return cmp;\n  }\n\n  cmp = strcmp(mappingA.source, mappingB.source);\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalLine - mappingB.originalLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalColumn - mappingB.originalColumn;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  return strcmp(mappingA.name, mappingB.name);\n}\nexports.compareByGeneratedPositionsDeflated = compareByGeneratedPositionsDeflated;\n\nfunction strcmp(aStr1, aStr2) {\n  if (aStr1 === aStr2) {\n    return 0;\n  }\n\n  if (aStr1 === null) {\n    return 1; // aStr2 !== null\n  }\n\n  if (aStr2 === null) {\n    return -1; // aStr1 !== null\n  }\n\n  if (aStr1 > aStr2) {\n    return 1;\n  }\n\n  return -1;\n}\n\n/**\n * Comparator between two mappings with inflated source and name strings where\n * the generated positions are compared.\n */\nfunction compareByGeneratedPositionsInflated(mappingA, mappingB) {\n  var cmp = mappingA.generatedLine - mappingB.generatedLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.generatedColumn - mappingB.generatedColumn;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = strcmp(mappingA.source, mappingB.source);\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalLine - mappingB.originalLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalColumn - mappingB.originalColumn;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  return strcmp(mappingA.name, mappingB.name);\n}\nexports.compareByGeneratedPositionsInflated = compareByGeneratedPositionsInflated;\n\n/**\n * Strip any JSON XSSI avoidance prefix from the string (as documented\n * in the source maps specification), and then parse the string as\n * JSON.\n */\nfunction parseSourceMapInput(str) {\n  return JSON.parse(str.replace(/^\\)]}'[^\\n]*\\n/, ''));\n}\nexports.parseSourceMapInput = parseSourceMapInput;\n\n/**\n * Compute the URL of a source given the the source root, the source's\n * URL, and the source map's URL.\n */\nfunction computeSourceURL(sourceRoot, sourceURL, sourceMapURL) {\n  sourceURL = sourceURL || '';\n\n  if (sourceRoot) {\n    // This follows what Chrome does.\n    if (sourceRoot[sourceRoot.length - 1] !== '/' && sourceURL[0] !== '/') {\n      sourceRoot += '/';\n    }\n    // The spec says:\n    //   Line 4: An optional source root, useful for relocating source\n    //   files on a server or removing repeated values in the\n    //   “sources” entry.  This value is prepended to the individual\n    //   entries in the “source” field.\n    sourceURL = sourceRoot + sourceURL;\n  }\n\n  // Historically, SourceMapConsumer did not take the sourceMapURL as\n  // a parameter.  This mode is still somewhat supported, which is why\n  // this code block is conditional.  However, it's preferable to pass\n  // the source map URL to SourceMapConsumer, so that this function\n  // can implement the source URL resolution algorithm as outlined in\n  // the spec.  This block is basically the equivalent of:\n  //    new URL(sourceURL, sourceMapURL).toString()\n  // ... except it avoids using URL, which wasn't available in the\n  // older releases of node still supported by this library.\n  //\n  // The spec says:\n  //   If the sources are not absolute URLs after prepending of the\n  //   “sourceRoot”, the sources are resolved relative to the\n  //   SourceMap (like resolving script src in a html document).\n  if (sourceMapURL) {\n    var parsed = urlParse(sourceMapURL);\n    if (!parsed) {\n      throw new Error(\"sourceMapURL could not be parsed\");\n    }\n    if (parsed.path) {\n      // Strip the last path component, but keep the \"/\".\n      var index = parsed.path.lastIndexOf('/');\n      if (index >= 0) {\n        parsed.path = parsed.path.substring(0, index + 1);\n      }\n    }\n    sourceURL = join(urlGenerate(parsed), sourceURL);\n  }\n\n  return normalize(sourceURL);\n}\nexports.computeSourceURL = computeSourceURL;\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\nvar util = require('./util');\nvar has = Object.prototype.hasOwnProperty;\nvar hasNativeMap = typeof Map !== \"undefined\";\n\n/**\n * A data structure which is a combination of an array and a set. Adding a new\n * member is O(1), testing for membership is O(1), and finding the index of an\n * element is O(1). Removing elements from the set is not supported. Only\n * strings are supported for membership.\n */\nfunction ArraySet() {\n  this._array = [];\n  this._set = hasNativeMap ? new Map() : Object.create(null);\n}\n\n/**\n * Static method for creating ArraySet instances from an existing array.\n */\nArraySet.fromArray = function ArraySet_fromArray(aArray, aAllowDuplicates) {\n  var set = new ArraySet();\n  for (var i = 0, len = aArray.length; i < len; i++) {\n    set.add(aArray[i], aAllowDuplicates);\n  }\n  return set;\n};\n\n/**\n * Return how many unique items are in this ArraySet. If duplicates have been\n * added, than those do not count towards the size.\n *\n * @returns Number\n */\nArraySet.prototype.size = function ArraySet_size() {\n  return hasNativeMap ? this._set.size : Object.getOwnPropertyNames(this._set).length;\n};\n\n/**\n * Add the given string to this set.\n *\n * @param String aStr\n */\nArraySet.prototype.add = function ArraySet_add(aStr, aAllowDuplicates) {\n  var sStr = hasNativeMap ? aStr : util.toSetString(aStr);\n  var isDuplicate = hasNativeMap ? this.has(aStr) : has.call(this._set, sStr);\n  var idx = this._array.length;\n  if (!isDuplicate || aAllowDuplicates) {\n    this._array.push(aStr);\n  }\n  if (!isDuplicate) {\n    if (hasNativeMap) {\n      this._set.set(aStr, idx);\n    } else {\n      this._set[sStr] = idx;\n    }\n  }\n};\n\n/**\n * Is the given string a member of this set?\n *\n * @param String aStr\n */\nArraySet.prototype.has = function ArraySet_has(aStr) {\n  if (hasNativeMap) {\n    return this._set.has(aStr);\n  } else {\n    var sStr = util.toSetString(aStr);\n    return has.call(this._set, sStr);\n  }\n};\n\n/**\n * What is the index of the given string in the array?\n *\n * @param String aStr\n */\nArraySet.prototype.indexOf = function ArraySet_indexOf(aStr) {\n  if (hasNativeMap) {\n    var idx = this._set.get(aStr);\n    if (idx >= 0) {\n        return idx;\n    }\n  } else {\n    var sStr = util.toSetString(aStr);\n    if (has.call(this._set, sStr)) {\n      return this._set[sStr];\n    }\n  }\n\n  throw new Error('\"' + aStr + '\" is not in the set.');\n};\n\n/**\n * What is the element at the given index?\n *\n * @param Number aIdx\n */\nArraySet.prototype.at = function ArraySet_at(aIdx) {\n  if (aIdx >= 0 && aIdx < this._array.length) {\n    return this._array[aIdx];\n  }\n  throw new Error('No element indexed by ' + aIdx);\n};\n\n/**\n * Returns the array representation of this set (which has the proper indices\n * indicated by indexOf). Note that this is a copy of the internal array used\n * for storing the members so that no one can mess with internal state.\n */\nArraySet.prototype.toArray = function ArraySet_toArray() {\n  return this._array.slice();\n};\n\nexports.ArraySet = ArraySet;\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2014 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\nvar util = require('./util');\n\n/**\n * Determine whether mappingB is after mappingA with respect to generated\n * position.\n */\nfunction generatedPositionAfter(mappingA, mappingB) {\n  // Optimized for most common case\n  var lineA = mappingA.generatedLine;\n  var lineB = mappingB.generatedLine;\n  var columnA = mappingA.generatedColumn;\n  var columnB = mappingB.generatedColumn;\n  return lineB > lineA || lineB == lineA && columnB >= columnA ||\n         util.compareByGeneratedPositionsInflated(mappingA, mappingB) <= 0;\n}\n\n/**\n * A data structure to provide a sorted view of accumulated mappings in a\n * performance conscious manner. It trades a neglibable overhead in general\n * case for a large speedup in case of mappings being added in order.\n */\nfunction MappingList() {\n  this._array = [];\n  this._sorted = true;\n  // Serves as infimum\n  this._last = {generatedLine: -1, generatedColumn: 0};\n}\n\n/**\n * Iterate through internal items. This method takes the same arguments that\n * `Array.prototype.forEach` takes.\n *\n * NOTE: The order of the mappings is NOT guaranteed.\n */\nMappingList.prototype.unsortedForEach =\n  function MappingList_forEach(aCallback, aThisArg) {\n    this._array.forEach(aCallback, aThisArg);\n  };\n\n/**\n * Add the given source mapping.\n *\n * @param Object aMapping\n */\nMappingList.prototype.add = function MappingList_add(aMapping) {\n  if (generatedPositionAfter(this._last, aMapping)) {\n    this._last = aMapping;\n    this._array.push(aMapping);\n  } else {\n    this._sorted = false;\n    this._array.push(aMapping);\n  }\n};\n\n/**\n * Returns the flat, sorted array of mappings. The mappings are sorted by\n * generated position.\n *\n * WARNING: This method returns internal data without copying, for\n * performance. The return value must NOT be mutated, and should be treated as\n * an immutable borrow. If you want to take ownership, you must make your own\n * copy.\n */\nMappingList.prototype.toArray = function MappingList_toArray() {\n  if (!this._sorted) {\n    this._array.sort(util.compareByGeneratedPositionsInflated);\n    this._sorted = true;\n  }\n  return this._array;\n};\n\nexports.MappingList = MappingList;\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\nvar base64VLQ = require('./base64-vlq');\nvar util = require('./util');\nvar ArraySet = require('./array-set').ArraySet;\nvar MappingList = require('./mapping-list').MappingList;\n\n/**\n * An instance of the SourceMapGenerator represents a source map which is\n * being built incrementally. You may pass an object with the following\n * properties:\n *\n *   - file: The filename of the generated source.\n *   - sourceRoot: A root for all relative URLs in this source map.\n */\nfunction SourceMapGenerator(aArgs) {\n  if (!aArgs) {\n    aArgs = {};\n  }\n  this._file = util.getArg(aArgs, 'file', null);\n  this._sourceRoot = util.getArg(aArgs, 'sourceRoot', null);\n  this._skipValidation = util.getArg(aArgs, 'skipValidation', false);\n  this._sources = new ArraySet();\n  this._names = new ArraySet();\n  this._mappings = new MappingList();\n  this._sourcesContents = null;\n}\n\nSourceMapGenerator.prototype._version = 3;\n\n/**\n * Creates a new SourceMapGenerator based on a SourceMapConsumer\n *\n * @param aSourceMapConsumer The SourceMap.\n */\nSourceMapGenerator.fromSourceMap =\n  function SourceMapGenerator_fromSourceMap(aSourceMapConsumer) {\n    var sourceRoot = aSourceMapConsumer.sourceRoot;\n    var generator = new SourceMapGenerator({\n      file: aSourceMapConsumer.file,\n      sourceRoot: sourceRoot\n    });\n    aSourceMapConsumer.eachMapping(function (mapping) {\n      var newMapping = {\n        generated: {\n          line: mapping.generatedLine,\n          column: mapping.generatedColumn\n        }\n      };\n\n      if (mapping.source != null) {\n        newMapping.source = mapping.source;\n        if (sourceRoot != null) {\n          newMapping.source = util.relative(sourceRoot, newMapping.source);\n        }\n\n        newMapping.original = {\n          line: mapping.originalLine,\n          column: mapping.originalColumn\n        };\n\n        if (mapping.name != null) {\n          newMapping.name = mapping.name;\n        }\n      }\n\n      generator.addMapping(newMapping);\n    });\n    aSourceMapConsumer.sources.forEach(function (sourceFile) {\n      var sourceRelative = sourceFile;\n      if (sourceRoot !== null) {\n        sourceRelative = util.relative(sourceRoot, sourceFile);\n      }\n\n      if (!generator._sources.has(sourceRelative)) {\n        generator._sources.add(sourceRelative);\n      }\n\n      var content = aSourceMapConsumer.sourceContentFor(sourceFile);\n      if (content != null) {\n        generator.setSourceContent(sourceFile, content);\n      }\n    });\n    return generator;\n  };\n\n/**\n * Add a single mapping from original source line and column to the generated\n * source's line and column for this source map being created. The mapping\n * object should have the following properties:\n *\n *   - generated: An object with the generated line and column positions.\n *   - original: An object with the original line and column positions.\n *   - source: The original source file (relative to the sourceRoot).\n *   - name: An optional original token name for this mapping.\n */\nSourceMapGenerator.prototype.addMapping =\n  function SourceMapGenerator_addMapping(aArgs) {\n    var generated = util.getArg(aArgs, 'generated');\n    var original = util.getArg(aArgs, 'original', null);\n    var source = util.getArg(aArgs, 'source', null);\n    var name = util.getArg(aArgs, 'name', null);\n\n    if (!this._skipValidation) {\n      this._validateMapping(generated, original, source, name);\n    }\n\n    if (source != null) {\n      source = String(source);\n      if (!this._sources.has(source)) {\n        this._sources.add(source);\n      }\n    }\n\n    if (name != null) {\n      name = String(name);\n      if (!this._names.has(name)) {\n        this._names.add(name);\n      }\n    }\n\n    this._mappings.add({\n      generatedLine: generated.line,\n      generatedColumn: generated.column,\n      originalLine: original != null && original.line,\n      originalColumn: original != null && original.column,\n      source: source,\n      name: name\n    });\n  };\n\n/**\n * Set the source content for a source file.\n */\nSourceMapGenerator.prototype.setSourceContent =\n  function SourceMapGenerator_setSourceContent(aSourceFile, aSourceContent) {\n    var source = aSourceFile;\n    if (this._sourceRoot != null) {\n      source = util.relative(this._sourceRoot, source);\n    }\n\n    if (aSourceContent != null) {\n      // Add the source content to the _sourcesContents map.\n      // Create a new _sourcesContents map if the property is null.\n      if (!this._sourcesContents) {\n        this._sourcesContents = Object.create(null);\n      }\n      this._sourcesContents[util.toSetString(source)] = aSourceContent;\n    } else if (this._sourcesContents) {\n      // Remove the source file from the _sourcesContents map.\n      // If the _sourcesContents map is empty, set the property to null.\n      delete this._sourcesContents[util.toSetString(source)];\n      if (Object.keys(this._sourcesContents).length === 0) {\n        this._sourcesContents = null;\n      }\n    }\n  };\n\n/**\n * Applies the mappings of a sub-source-map for a specific source file to the\n * source map being generated. Each mapping to the supplied source file is\n * rewritten using the supplied source map. Note: The resolution for the\n * resulting mappings is the minimium of this map and the supplied map.\n *\n * @param aSourceMapConsumer The source map to be applied.\n * @param aSourceFile Optional. The filename of the source file.\n *        If omitted, SourceMapConsumer's file property will be used.\n * @param aSourceMapPath Optional. The dirname of the path to the source map\n *        to be applied. If relative, it is relative to the SourceMapConsumer.\n *        This parameter is needed when the two source maps aren't in the same\n *        directory, and the source map to be applied contains relative source\n *        paths. If so, those relative source paths need to be rewritten\n *        relative to the SourceMapGenerator.\n */\nSourceMapGenerator.prototype.applySourceMap =\n  function SourceMapGenerator_applySourceMap(aSourceMapConsumer, aSourceFile, aSourceMapPath) {\n    var sourceFile = aSourceFile;\n    // If aSourceFile is omitted, we will use the file property of the SourceMap\n    if (aSourceFile == null) {\n      if (aSourceMapConsumer.file == null) {\n        throw new Error(\n          'SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, ' +\n          'or the source map\\'s \"file\" property. Both were omitted.'\n        );\n      }\n      sourceFile = aSourceMapConsumer.file;\n    }\n    var sourceRoot = this._sourceRoot;\n    // Make \"sourceFile\" relative if an absolute Url is passed.\n    if (sourceRoot != null) {\n      sourceFile = util.relative(sourceRoot, sourceFile);\n    }\n    // Applying the SourceMap can add and remove items from the sources and\n    // the names array.\n    var newSources = new ArraySet();\n    var newNames = new ArraySet();\n\n    // Find mappings for the \"sourceFile\"\n    this._mappings.unsortedForEach(function (mapping) {\n      if (mapping.source === sourceFile && mapping.originalLine != null) {\n        // Check if it can be mapped by the source map, then update the mapping.\n        var original = aSourceMapConsumer.originalPositionFor({\n          line: mapping.originalLine,\n          column: mapping.originalColumn\n        });\n        if (original.source != null) {\n          // Copy mapping\n          mapping.source = original.source;\n          if (aSourceMapPath != null) {\n            mapping.source = util.join(aSourceMapPath, mapping.source)\n          }\n          if (sourceRoot != null) {\n            mapping.source = util.relative(sourceRoot, mapping.source);\n          }\n          mapping.originalLine = original.line;\n          mapping.originalColumn = original.column;\n          if (original.name != null) {\n            mapping.name = original.name;\n          }\n        }\n      }\n\n      var source = mapping.source;\n      if (source != null && !newSources.has(source)) {\n        newSources.add(source);\n      }\n\n      var name = mapping.name;\n      if (name != null && !newNames.has(name)) {\n        newNames.add(name);\n      }\n\n    }, this);\n    this._sources = newSources;\n    this._names = newNames;\n\n    // Copy sourcesContents of applied map.\n    aSourceMapConsumer.sources.forEach(function (sourceFile) {\n      var content = aSourceMapConsumer.sourceContentFor(sourceFile);\n      if (content != null) {\n        if (aSourceMapPath != null) {\n          sourceFile = util.join(aSourceMapPath, sourceFile);\n        }\n        if (sourceRoot != null) {\n          sourceFile = util.relative(sourceRoot, sourceFile);\n        }\n        this.setSourceContent(sourceFile, content);\n      }\n    }, this);\n  };\n\n/**\n * A mapping can have one of the three levels of data:\n *\n *   1. Just the generated position.\n *   2. The Generated position, original position, and original source.\n *   3. Generated and original position, original source, as well as a name\n *      token.\n *\n * To maintain consistency, we validate that any new mapping being added falls\n * in to one of these categories.\n */\nSourceMapGenerator.prototype._validateMapping =\n  function SourceMapGenerator_validateMapping(aGenerated, aOriginal, aSource,\n                                              aName) {\n    // When aOriginal is truthy but has empty values for .line and .column,\n    // it is most likely a programmer error. In this case we throw a very\n    // specific error message to try to guide them the right way.\n    // For example: https://github.com/Polymer/polymer-bundler/pull/519\n    if (aOriginal && typeof aOriginal.line !== 'number' && typeof aOriginal.column !== 'number') {\n        throw new Error(\n            'original.line and original.column are not numbers -- you probably meant to omit ' +\n            'the original mapping entirely and only map the generated position. If so, pass ' +\n            'null for the original mapping instead of an object with empty or null values.'\n        );\n    }\n\n    if (aGenerated && 'line' in aGenerated && 'column' in aGenerated\n        && aGenerated.line > 0 && aGenerated.column >= 0\n        && !aOriginal && !aSource && !aName) {\n      // Case 1.\n      return;\n    }\n    else if (aGenerated && 'line' in aGenerated && 'column' in aGenerated\n             && aOriginal && 'line' in aOriginal && 'column' in aOriginal\n             && aGenerated.line > 0 && aGenerated.column >= 0\n             && aOriginal.line > 0 && aOriginal.column >= 0\n             && aSource) {\n      // Cases 2 and 3.\n      return;\n    }\n    else {\n      throw new Error('Invalid mapping: ' + JSON.stringify({\n        generated: aGenerated,\n        source: aSource,\n        original: aOriginal,\n        name: aName\n      }));\n    }\n  };\n\n/**\n * Serialize the accumulated mappings in to the stream of base 64 VLQs\n * specified by the source map format.\n */\nSourceMapGenerator.prototype._serializeMappings =\n  function SourceMapGenerator_serializeMappings() {\n    var previousGeneratedColumn = 0;\n    var previousGeneratedLine = 1;\n    var previousOriginalColumn = 0;\n    var previousOriginalLine = 0;\n    var previousName = 0;\n    var previousSource = 0;\n    var result = '';\n    var next;\n    var mapping;\n    var nameIdx;\n    var sourceIdx;\n\n    var mappings = this._mappings.toArray();\n    for (var i = 0, len = mappings.length; i < len; i++) {\n      mapping = mappings[i];\n      next = ''\n\n      if (mapping.generatedLine !== previousGeneratedLine) {\n        previousGeneratedColumn = 0;\n        while (mapping.generatedLine !== previousGeneratedLine) {\n          next += ';';\n          previousGeneratedLine++;\n        }\n      }\n      else {\n        if (i > 0) {\n          if (!util.compareByGeneratedPositionsInflated(mapping, mappings[i - 1])) {\n            continue;\n          }\n          next += ',';\n        }\n      }\n\n      next += base64VLQ.encode(mapping.generatedColumn\n                                 - previousGeneratedColumn);\n      previousGeneratedColumn = mapping.generatedColumn;\n\n      if (mapping.source != null) {\n        sourceIdx = this._sources.indexOf(mapping.source);\n        next += base64VLQ.encode(sourceIdx - previousSource);\n        previousSource = sourceIdx;\n\n        // lines are stored 0-based in SourceMap spec version 3\n        next += base64VLQ.encode(mapping.originalLine - 1\n                                   - previousOriginalLine);\n        previousOriginalLine = mapping.originalLine - 1;\n\n        next += base64VLQ.encode(mapping.originalColumn\n                                   - previousOriginalColumn);\n        previousOriginalColumn = mapping.originalColumn;\n\n        if (mapping.name != null) {\n          nameIdx = this._names.indexOf(mapping.name);\n          next += base64VLQ.encode(nameIdx - previousName);\n          previousName = nameIdx;\n        }\n      }\n\n      result += next;\n    }\n\n    return result;\n  };\n\nSourceMapGenerator.prototype._generateSourcesContent =\n  function SourceMapGenerator_generateSourcesContent(aSources, aSourceRoot) {\n    return aSources.map(function (source) {\n      if (!this._sourcesContents) {\n        return null;\n      }\n      if (aSourceRoot != null) {\n        source = util.relative(aSourceRoot, source);\n      }\n      var key = util.toSetString(source);\n      return Object.prototype.hasOwnProperty.call(this._sourcesContents, key)\n        ? this._sourcesContents[key]\n        : null;\n    }, this);\n  };\n\n/**\n * Externalize the source map.\n */\nSourceMapGenerator.prototype.toJSON =\n  function SourceMapGenerator_toJSON() {\n    var map = {\n      version: this._version,\n      sources: this._sources.toArray(),\n      names: this._names.toArray(),\n      mappings: this._serializeMappings()\n    };\n    if (this._file != null) {\n      map.file = this._file;\n    }\n    if (this._sourceRoot != null) {\n      map.sourceRoot = this._sourceRoot;\n    }\n    if (this._sourcesContents) {\n      map.sourcesContent = this._generateSourcesContent(map.sources, map.sourceRoot);\n    }\n\n    return map;\n  };\n\n/**\n * Render the source map being generated to a string.\n */\nSourceMapGenerator.prototype.toString =\n  function SourceMapGenerator_toString() {\n    return JSON.stringify(this.toJSON());\n  };\n\nexports.SourceMapGenerator = SourceMapGenerator;\n","var SourceMapGenerator = require('source-map/lib/source-map-generator').SourceMapGenerator;\nvar trackNodes = {\n    Atrule: true,\n    Selector: true,\n    Declaration: true\n};\n\nmodule.exports = function generateSourceMap(handlers) {\n    var map = new SourceMapGenerator();\n    var line = 1;\n    var column = 0;\n    var generated = {\n        line: 1,\n        column: 0\n    };\n    var original = {\n        line: 0, // should be zero to add first mapping\n        column: 0\n    };\n    var sourceMappingActive = false;\n    var activatedGenerated = {\n        line: 1,\n        column: 0\n    };\n    var activatedMapping = {\n        generated: activatedGenerated\n    };\n\n    var handlersNode = handlers.node;\n    handlers.node = function(node) {\n        if (node.loc && node.loc.start && trackNodes.hasOwnProperty(node.type)) {\n            var nodeLine = node.loc.start.line;\n            var nodeColumn = node.loc.start.column - 1;\n\n            if (original.line !== nodeLine ||\n                original.column !== nodeColumn) {\n                original.line = nodeLine;\n                original.column = nodeColumn;\n\n                generated.line = line;\n                generated.column = column;\n\n                if (sourceMappingActive) {\n                    sourceMappingActive = false;\n                    if (generated.line !== activatedGenerated.line ||\n                        generated.column !== activatedGenerated.column) {\n                        map.addMapping(activatedMapping);\n                    }\n                }\n\n                sourceMappingActive = true;\n                map.addMapping({\n                    source: node.loc.source,\n                    original: original,\n                    generated: generated\n                });\n            }\n        }\n\n        handlersNode.call(this, node);\n\n        if (sourceMappingActive && trackNodes.hasOwnProperty(node.type)) {\n            activatedGenerated.line = line;\n            activatedGenerated.column = column;\n        }\n    };\n\n    var handlersChunk = handlers.chunk;\n    handlers.chunk = function(chunk) {\n        for (var i = 0; i < chunk.length; i++) {\n            if (chunk.charCodeAt(i) === 10) { // \\n\n                line++;\n                column = 0;\n            } else {\n                column++;\n            }\n        }\n\n        handlersChunk(chunk);\n    };\n\n    var handlersResult = handlers.result;\n    handlers.result = function() {\n        if (sourceMappingActive) {\n            map.addMapping(activatedMapping);\n        }\n\n        return {\n            css: handlersResult(),\n            map: map\n        };\n    };\n\n    return handlers;\n};\n","var sourceMap = require('./sourceMap');\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction processChildren(node, delimeter) {\n    var list = node.children;\n    var prev = null;\n\n    if (typeof delimeter !== 'function') {\n        list.forEach(this.node, this);\n    } else {\n        list.forEach(function(node) {\n            if (prev !== null) {\n                delimeter.call(this, prev);\n            }\n\n            this.node(node);\n            prev = node;\n        }, this);\n    }\n}\n\nmodule.exports = function createGenerator(config) {\n    function processNode(node) {\n        if (hasOwnProperty.call(types, node.type)) {\n            types[node.type].call(this, node);\n        } else {\n            throw new Error('Unknown node type: ' + node.type);\n        }\n    }\n\n    var types = {};\n\n    if (config.node) {\n        for (var name in config.node) {\n            types[name] = config.node[name].generate;\n        }\n    }\n\n    return function(node, options) {\n        var buffer = '';\n        var handlers = {\n            children: processChildren,\n            node: processNode,\n            chunk: function(chunk) {\n                buffer += chunk;\n            },\n            result: function() {\n                return buffer;\n            }\n        };\n\n        if (options) {\n            if (typeof options.decorator === 'function') {\n                handlers = options.decorator(handlers);\n            }\n\n            if (options.sourceMap) {\n                handlers = sourceMap(handlers);\n            }\n        }\n\n        handlers.node(node);\n\n        return handlers.result();\n    };\n};\n","var List = require('../common/List');\n\nmodule.exports = function createConvertors(walk) {\n    return {\n        fromPlainObject: function(ast) {\n            walk(ast, {\n                enter: function(node) {\n                    if (node.children && node.children instanceof List === false) {\n                        node.children = new List().fromArray(node.children);\n                    }\n                }\n            });\n\n            return ast;\n        },\n        toPlainObject: function(ast) {\n            walk(ast, {\n                leave: function(node) {\n                    if (node.children && node.children instanceof List) {\n                        node.children = node.children.toArray();\n                    }\n                }\n            });\n\n            return ast;\n        }\n    };\n};\n","var hasOwnProperty = Object.prototype.hasOwnProperty;\nvar noop = function() {};\n\nfunction ensureFunction(value) {\n    return typeof value === 'function' ? value : noop;\n}\n\nfunction invokeForType(fn, type) {\n    return function(node, item, list) {\n        if (node.type === type) {\n            fn.call(this, node, item, list);\n        }\n    };\n}\n\nfunction getWalkersFromStructure(name, nodeType) {\n    var structure = nodeType.structure;\n    var walkers = [];\n\n    for (var key in structure) {\n        if (hasOwnProperty.call(structure, key) === false) {\n            continue;\n        }\n\n        var fieldTypes = structure[key];\n        var walker = {\n            name: key,\n            type: false,\n            nullable: false\n        };\n\n        if (!Array.isArray(structure[key])) {\n            fieldTypes = [structure[key]];\n        }\n\n        for (var i = 0; i < fieldTypes.length; i++) {\n            var fieldType = fieldTypes[i];\n            if (fieldType === null) {\n                walker.nullable = true;\n            } else if (typeof fieldType === 'string') {\n                walker.type = 'node';\n            } else if (Array.isArray(fieldType)) {\n                walker.type = 'list';\n            }\n        }\n\n        if (walker.type) {\n            walkers.push(walker);\n        }\n    }\n\n    if (walkers.length) {\n        return {\n            context: nodeType.walkContext,\n            fields: walkers\n        };\n    }\n\n    return null;\n}\n\nfunction getTypesFromConfig(config) {\n    var types = {};\n\n    for (var name in config.node) {\n        if (hasOwnProperty.call(config.node, name)) {\n            var nodeType = config.node[name];\n\n            if (!nodeType.structure) {\n                throw new Error('Missed `structure` field in `' + name + '` node type definition');\n            }\n\n            types[name] = getWalkersFromStructure(name, nodeType);\n        }\n    }\n\n    return types;\n}\n\nfunction createTypeIterator(config, reverse) {\n    var fields = config.fields.slice();\n    var contextName = config.context;\n    var useContext = typeof contextName === 'string';\n\n    if (reverse) {\n        fields.reverse();\n    }\n\n    return function(node, context, walk, walkReducer) {\n        var prevContextValue;\n\n        if (useContext) {\n            prevContextValue = context[contextName];\n            context[contextName] = node;\n        }\n\n        for (var i = 0; i < fields.length; i++) {\n            var field = fields[i];\n            var ref = node[field.name];\n\n            if (!field.nullable || ref) {\n                if (field.type === 'list') {\n                    var breakWalk = reverse\n                        ? ref.reduceRight(walkReducer, false)\n                        : ref.reduce(walkReducer, false);\n\n                    if (breakWalk) {\n                        return true;\n                    }\n                } else if (walk(ref)) {\n                    return true;\n                }\n            }\n        }\n\n        if (useContext) {\n            context[contextName] = prevContextValue;\n        }\n    };\n}\n\nfunction createFastTraveralMap(iterators) {\n    return {\n        Atrule: {\n            StyleSheet: iterators.StyleSheet,\n            Atrule: iterators.Atrule,\n            Rule: iterators.Rule,\n            Block: iterators.Block\n        },\n        Rule: {\n            StyleSheet: iterators.StyleSheet,\n            Atrule: iterators.Atrule,\n            Rule: iterators.Rule,\n            Block: iterators.Block\n        },\n        Declaration: {\n            StyleSheet: iterators.StyleSheet,\n            Atrule: iterators.Atrule,\n            Rule: iterators.Rule,\n            Block: iterators.Block,\n            DeclarationList: iterators.DeclarationList\n        }\n    };\n}\n\nmodule.exports = function createWalker(config) {\n    var types = getTypesFromConfig(config);\n    var iteratorsNatural = {};\n    var iteratorsReverse = {};\n    var breakWalk = Symbol('break-walk');\n    var skipNode = Symbol('skip-node');\n\n    for (var name in types) {\n        if (hasOwnProperty.call(types, name) && types[name] !== null) {\n            iteratorsNatural[name] = createTypeIterator(types[name], false);\n            iteratorsReverse[name] = createTypeIterator(types[name], true);\n        }\n    }\n\n    var fastTraversalIteratorsNatural = createFastTraveralMap(iteratorsNatural);\n    var fastTraversalIteratorsReverse = createFastTraveralMap(iteratorsReverse);\n\n    var walk = function(root, options) {\n        function walkNode(node, item, list) {\n            var enterRet = enter.call(context, node, item, list);\n\n            if (enterRet === breakWalk) {\n                debugger;\n                return true;\n            }\n\n            if (enterRet === skipNode) {\n                return false;\n            }\n\n            if (iterators.hasOwnProperty(node.type)) {\n                if (iterators[node.type](node, context, walkNode, walkReducer)) {\n                    return true;\n                }\n            }\n\n            if (leave.call(context, node, item, list) === breakWalk) {\n                return true;\n            }\n\n            return false;\n        }\n\n        var walkReducer = (ret, data, item, list) => ret || walkNode(data, item, list);\n        var enter = noop;\n        var leave = noop;\n        var iterators = iteratorsNatural;\n        var context = {\n            break: breakWalk,\n            skip: skipNode,\n\n            root: root,\n            stylesheet: null,\n            atrule: null,\n            atrulePrelude: null,\n            rule: null,\n            selector: null,\n            block: null,\n            declaration: null,\n            function: null\n        };\n\n        if (typeof options === 'function') {\n            enter = options;\n        } else if (options) {\n            enter = ensureFunction(options.enter);\n            leave = ensureFunction(options.leave);\n\n            if (options.reverse) {\n                iterators = iteratorsReverse;\n            }\n\n            if (options.visit) {\n                if (fastTraversalIteratorsNatural.hasOwnProperty(options.visit)) {\n                    iterators = options.reverse\n                        ? fastTraversalIteratorsReverse[options.visit]\n                        : fastTraversalIteratorsNatural[options.visit];\n                } else if (!types.hasOwnProperty(options.visit)) {\n                    throw new Error('Bad value `' + options.visit + '` for `visit` option (should be: ' + Object.keys(types).join(', ') + ')');\n                }\n\n                enter = invokeForType(enter, options.visit);\n                leave = invokeForType(leave, options.visit);\n            }\n        }\n\n        if (enter === noop && leave === noop) {\n            throw new Error('Neither `enter` nor `leave` walker handler is set or both aren\\'t a function');\n        }\n\n        walkNode(root);\n    };\n\n    walk.break = breakWalk;\n    walk.skip = skipNode;\n\n    walk.find = function(ast, fn) {\n        var found = null;\n\n        walk(ast, function(node, item, list) {\n            if (fn.call(this, node, item, list)) {\n                found = node;\n                return breakWalk;\n            }\n        });\n\n        return found;\n    };\n\n    walk.findLast = function(ast, fn) {\n        var found = null;\n\n        walk(ast, {\n            reverse: true,\n            enter: function(node, item, list) {\n                if (fn.call(this, node, item, list)) {\n                    found = node;\n                    return breakWalk;\n                }\n            }\n        });\n\n        return found;\n    };\n\n    walk.findAll = function(ast, fn) {\n        var found = [];\n\n        walk(ast, function(node, item, list) {\n            if (fn.call(this, node, item, list)) {\n                found.push(node);\n            }\n        });\n\n        return found;\n    };\n\n    return walk;\n};\n","var List = require('../common/List');\n\nmodule.exports = function clone(node) {\n    var result = {};\n\n    for (var key in node) {\n        var value = node[key];\n\n        if (value) {\n            if (Array.isArray(value) || value instanceof List) {\n                value = value.map(clone);\n            } else if (value.constructor === Object) {\n                value = clone(value);\n            }\n        }\n\n        result[key] = value;\n    }\n\n    return result;\n};\n","const hasOwnProperty = Object.prototype.hasOwnProperty;\nconst shape = {\n    generic: true,\n    types: appendOrAssign,\n    atrules: {\n        prelude: appendOrAssignOrNull,\n        descriptors: appendOrAssignOrNull\n    },\n    properties: appendOrAssign,\n    parseContext: assign,\n    scope: deepAssign,\n    atrule: ['parse'],\n    pseudo: ['parse'],\n    node: ['name', 'structure', 'parse', 'generate', 'walkContext']\n};\n\nfunction isObject(value) {\n    return value && value.constructor === Object;\n}\n\nfunction copy(value) {\n    return isObject(value)\n        ? Object.assign({}, value)\n        : value;\n}\n\nfunction assign(dest, src) {\n    return Object.assign(dest, src);\n}\n\nfunction deepAssign(dest, src) {\n    for (const key in src) {\n        if (hasOwnProperty.call(src, key)) {\n            if (isObject(dest[key])) {\n                deepAssign(dest[key], copy(src[key]));\n            } else {\n                dest[key] = copy(src[key]);\n            }\n        }\n    }\n\n    return dest;\n}\n\nfunction append(a, b) {\n    if (typeof b === 'string' && /^\\s*\\|/.test(b)) {\n        return typeof a === 'string'\n            ? a + b\n            : b.replace(/^\\s*\\|\\s*/, '');\n    }\n\n    return b || null;\n}\n\nfunction appendOrAssign(a, b) {\n    if (typeof b === 'string') {\n        return append(a, b);\n    }\n\n    const result = Object.assign({}, a);\n    for (let key in b) {\n        if (hasOwnProperty.call(b, key)) {\n            result[key] = append(hasOwnProperty.call(a, key) ? a[key] : undefined, b[key]);\n        }\n    }\n\n    return result;\n}\n\nfunction appendOrAssignOrNull(a, b) {\n    const result = appendOrAssign(a, b);\n\n    return !isObject(result) || Object.keys(result).length\n        ? result\n        : null;\n}\n\nfunction mix(dest, src, shape) {\n    for (const key in shape) {\n        if (hasOwnProperty.call(shape, key) === false) {\n            continue;\n        }\n\n        if (shape[key] === true) {\n            if (key in src) {\n                if (hasOwnProperty.call(src, key)) {\n                    dest[key] = copy(src[key]);\n                }\n            }\n        } else if (shape[key]) {\n            if (typeof shape[key] === 'function') {\n                const fn = shape[key];\n                dest[key] = fn({}, dest[key]);\n                dest[key] = fn(dest[key] || {}, src[key]);\n            } else if (isObject(shape[key])) {\n                const result = {};\n\n                for (let name in dest[key]) {\n                    result[name] = mix({}, dest[key][name], shape[key]);\n                }\n\n                for (let name in src[key]) {\n                    result[name] = mix(result[name] || {}, src[key][name], shape[key]);\n                }\n\n                dest[key] = result;\n            } else if (Array.isArray(shape[key])) {\n                const res = {};\n                const innerShape = shape[key].reduce(function(s, k) {\n                    s[k] = true;\n                    return s;\n                }, {});\n\n                for (const [name, value] of Object.entries(dest[key] || {})) {\n                    res[name] = {};\n                    if (value) {\n                        mix(res[name], value, innerShape);\n                    }\n                }\n\n                for (const name in src[key]) {\n                    if (hasOwnProperty.call(src[key], name)) {\n                        if (!res[name]) {\n                            res[name] = {};\n                        }\n\n                        if (src[key] && src[key][name]) {\n                            mix(res[name], src[key][name], innerShape);\n                        }\n                    }\n                }\n\n                dest[key] = res;\n            }\n        }\n    }\n    return dest;\n}\n\nmodule.exports = (dest, src) => mix(dest, src, shape);\n","var List = require('../common/List');\nvar SyntaxError = require('../common/SyntaxError');\nvar TokenStream = require('../common/TokenStream');\nvar Lexer = require('../lexer/Lexer');\nvar definitionSyntax = require('../definition-syntax');\nvar tokenize = require('../tokenizer');\nvar createParser = require('../parser/create');\nvar createGenerator = require('../generator/create');\nvar createConvertor = require('../convertor/create');\nvar createWalker = require('../walker/create');\nvar clone = require('../utils/clone');\nvar names = require('../utils/names');\nvar mix = require('./config/mix');\n\nfunction createSyntax(config) {\n    var parse = createParser(config);\n    var walk = createWalker(config);\n    var generate = createGenerator(config);\n    var convert = createConvertor(walk);\n\n    var syntax = {\n        List: List,\n        SyntaxError: SyntaxError,\n        TokenStream: TokenStream,\n        Lexer: Lexer,\n\n        vendorPrefix: names.vendorPrefix,\n        keyword: names.keyword,\n        property: names.property,\n        isCustomProperty: names.isCustomProperty,\n\n        definitionSyntax: definitionSyntax,\n        lexer: null,\n        createLexer: function(config) {\n            return new Lexer(config, syntax, syntax.lexer.structure);\n        },\n\n        tokenize: tokenize,\n        parse: parse,\n        walk: walk,\n        generate: generate,\n\n        find: walk.find,\n        findLast: walk.findLast,\n        findAll: walk.findAll,\n\n        clone: clone,\n        fromPlainObject: convert.fromPlainObject,\n        toPlainObject: convert.toPlainObject,\n\n        createSyntax: function(config) {\n            return createSyntax(mix({}, config));\n        },\n        fork: function(extension) {\n            var base = mix({}, config); // copy of config\n            return createSyntax(\n                typeof extension === 'function'\n                    ? extension(base, Object.assign)\n                    : mix(base, extension)\n            );\n        }\n    };\n\n    syntax.lexer = new Lexer({\n        generic: true,\n        types: config.types,\n        atrules: config.atrules,\n        properties: config.properties,\n        node: config.node\n    }, syntax);\n\n    return syntax;\n};\n\nexports.create = function(config) {\n    return createSyntax(mix({}, config));\n};\n","const mdnAtrules = require('mdn-data/css/at-rules.json');\nconst mdnProperties = require('mdn-data/css/properties.json');\nconst mdnSyntaxes = require('mdn-data/css/syntaxes.json');\nconst patch = require('./patch.json');\nconst extendSyntax = /^\\s*\\|\\s*/;\n\nfunction preprocessAtrules(dict) {\n    const result = Object.create(null);\n\n    for (const atruleName in dict) {\n        const atrule = dict[atruleName];\n        let descriptors = null;\n\n        if (atrule.descriptors) {\n            descriptors = Object.create(null);\n\n            for (const descriptor in atrule.descriptors) {\n                descriptors[descriptor] = atrule.descriptors[descriptor].syntax;\n            }\n        }\n\n        result[atruleName.substr(1)] = {\n            prelude: atrule.syntax.trim().match(/^@\\S+\\s+([^;\\{]*)/)[1].trim() || null,\n            descriptors\n        };\n    }\n\n    return result;\n}\n\nfunction patchDictionary(dict, patchDict) {\n    const result = {};\n\n    // copy all syntaxes for an original dict\n    for (const key in dict) {\n        result[key] = dict[key].syntax || dict[key];\n    }\n\n    // apply a patch\n    for (const key in patchDict) {\n        if (key in dict) {\n            if (patchDict[key].syntax) {\n                result[key] = extendSyntax.test(patchDict[key].syntax)\n                    ? result[key] + ' ' + patchDict[key].syntax.trim()\n                    : patchDict[key].syntax;\n            } else {\n                delete result[key];\n            }\n        } else {\n            if (patchDict[key].syntax) {\n                result[key] = patchDict[key].syntax.replace(extendSyntax, '');\n            }\n        }\n    }\n\n    return result;\n}\n\nfunction unpackSyntaxes(dict) {\n    const result = {};\n\n    for (const key in dict) {\n        result[key] = dict[key].syntax;\n    }\n\n    return result;\n}\n\nfunction patchAtrules(dict, patchDict) {\n    const result = {};\n\n    // copy all syntaxes for an original dict\n    for (const key in dict) {\n        const patchDescriptors = (patchDict[key] && patchDict[key].descriptors) || null;\n\n        result[key] = {\n            prelude: key in patchDict && 'prelude' in patchDict[key]\n                ? patchDict[key].prelude\n                : dict[key].prelude || null,\n            descriptors: dict[key].descriptors\n                ? patchDictionary(dict[key].descriptors, patchDescriptors || {})\n                : patchDescriptors && unpackSyntaxes(patchDescriptors)\n        };\n    }\n\n    // apply a patch\n    for (const key in patchDict) {\n        if (!hasOwnProperty.call(dict, key)) {\n            result[key] = {\n                prelude: patchDict[key].prelude || null,\n                descriptors: patchDict[key].descriptors && unpackSyntaxes(patchDict[key].descriptors)\n            };\n        }\n    }\n\n    return result;\n}\n\nmodule.exports = {\n    types: patchDictionary(mdnSyntaxes, patch.syntaxes),\n    atrules: patchAtrules(preprocessAtrules(mdnAtrules), patch.atrules),\n    properties: patchDictionary(mdnProperties, patch.properties)\n};\n","var cmpChar = require('../../tokenizer').cmpChar;\nvar isDigit = require('../../tokenizer').isDigit;\nvar TYPE = require('../../tokenizer').TYPE;\n\nvar WHITESPACE = TYPE.WhiteSpace;\nvar COMMENT = TYPE.Comment;\nvar IDENT = TYPE.Ident;\nvar NUMBER = TYPE.Number;\nvar DIMENSION = TYPE.Dimension;\nvar PLUSSIGN = 0x002B;    // U+002B PLUS SIGN (+)\nvar HYPHENMINUS = 0x002D; // U+002D HYPHEN-MINUS (-)\nvar N = 0x006E;           // U+006E LATIN SMALL LETTER N (n)\nvar DISALLOW_SIGN = true;\nvar ALLOW_SIGN = false;\n\nfunction checkInteger(offset, disallowSign) {\n    var pos = this.scanner.tokenStart + offset;\n    var code = this.scanner.source.charCodeAt(pos);\n\n    if (code === PLUSSIGN || code === HYPHENMINUS) {\n        if (disallowSign) {\n            this.error('Number sign is not allowed');\n        }\n        pos++;\n    }\n\n    for (; pos < this.scanner.tokenEnd; pos++) {\n        if (!isDigit(this.scanner.source.charCodeAt(pos))) {\n            this.error('Integer is expected', pos);\n        }\n    }\n}\n\nfunction checkTokenIsInteger(disallowSign) {\n    return checkInteger.call(this, 0, disallowSign);\n}\n\nfunction expectCharCode(offset, code) {\n    if (!cmpChar(this.scanner.source, this.scanner.tokenStart + offset, code)) {\n        var msg = '';\n\n        switch (code) {\n            case N:\n                msg = 'N is expected';\n                break;\n            case HYPHENMINUS:\n                msg = 'HyphenMinus is expected';\n                break;\n        }\n\n        this.error(msg, this.scanner.tokenStart + offset);\n    }\n}\n\n// ... <signed-integer>\n// ... ['+' | '-'] <signless-integer>\nfunction consumeB() {\n    var offset = 0;\n    var sign = 0;\n    var type = this.scanner.tokenType;\n\n    while (type === WHITESPACE || type === COMMENT) {\n        type = this.scanner.lookupType(++offset);\n    }\n\n    if (type !== NUMBER) {\n        if (this.scanner.isDelim(PLUSSIGN, offset) ||\n            this.scanner.isDelim(HYPHENMINUS, offset)) {\n            sign = this.scanner.isDelim(PLUSSIGN, offset) ? PLUSSIGN : HYPHENMINUS;\n\n            do {\n                type = this.scanner.lookupType(++offset);\n            } while (type === WHITESPACE || type === COMMENT);\n\n            if (type !== NUMBER) {\n                this.scanner.skip(offset);\n                checkTokenIsInteger.call(this, DISALLOW_SIGN);\n            }\n        } else {\n            return null;\n        }\n    }\n\n    if (offset > 0) {\n        this.scanner.skip(offset);\n    }\n\n    if (sign === 0) {\n        type = this.scanner.source.charCodeAt(this.scanner.tokenStart);\n        if (type !== PLUSSIGN && type !== HYPHENMINUS) {\n            this.error('Number sign is expected');\n        }\n    }\n\n    checkTokenIsInteger.call(this, sign !== 0);\n    return sign === HYPHENMINUS ? '-' + this.consume(NUMBER) : this.consume(NUMBER);\n}\n\n// An+B microsyntax https://www.w3.org/TR/css-syntax-3/#anb\nmodule.exports = {\n    name: 'AnPlusB',\n    structure: {\n        a: [String, null],\n        b: [String, null]\n    },\n    parse: function() {\n        /* eslint-disable brace-style*/\n        var start = this.scanner.tokenStart;\n        var a = null;\n        var b = null;\n\n        // <integer>\n        if (this.scanner.tokenType === NUMBER) {\n            checkTokenIsInteger.call(this, ALLOW_SIGN);\n            b = this.consume(NUMBER);\n        }\n\n        // -n\n        // -n <signed-integer>\n        // -n ['+' | '-'] <signless-integer>\n        // -n- <signless-integer>\n        // <dashndashdigit-ident>\n        else if (this.scanner.tokenType === IDENT && cmpChar(this.scanner.source, this.scanner.tokenStart, HYPHENMINUS)) {\n            a = '-1';\n\n            expectCharCode.call(this, 1, N);\n\n            switch (this.scanner.getTokenLength()) {\n                // -n\n                // -n <signed-integer>\n                // -n ['+' | '-'] <signless-integer>\n                case 2:\n                    this.scanner.next();\n                    b = consumeB.call(this);\n                    break;\n\n                // -n- <signless-integer>\n                case 3:\n                    expectCharCode.call(this, 2, HYPHENMINUS);\n\n                    this.scanner.next();\n                    this.scanner.skipSC();\n\n                    checkTokenIsInteger.call(this, DISALLOW_SIGN);\n\n                    b = '-' + this.consume(NUMBER);\n                    break;\n\n                // <dashndashdigit-ident>\n                default:\n                    expectCharCode.call(this, 2, HYPHENMINUS);\n                    checkInteger.call(this, 3, DISALLOW_SIGN);\n                    this.scanner.next();\n\n                    b = this.scanner.substrToCursor(start + 2);\n            }\n        }\n\n        // '+'? n\n        // '+'? n <signed-integer>\n        // '+'? n ['+' | '-'] <signless-integer>\n        // '+'? n- <signless-integer>\n        // '+'? <ndashdigit-ident>\n        else if (this.scanner.tokenType === IDENT || (this.scanner.isDelim(PLUSSIGN) && this.scanner.lookupType(1) === IDENT)) {\n            var sign = 0;\n            a = '1';\n\n            // just ignore a plus\n            if (this.scanner.isDelim(PLUSSIGN)) {\n                sign = 1;\n                this.scanner.next();\n            }\n\n            expectCharCode.call(this, 0, N);\n\n            switch (this.scanner.getTokenLength()) {\n                // '+'? n\n                // '+'? n <signed-integer>\n                // '+'? n ['+' | '-'] <signless-integer>\n                case 1:\n                    this.scanner.next();\n                    b = consumeB.call(this);\n                    break;\n\n                // '+'? n- <signless-integer>\n                case 2:\n                    expectCharCode.call(this, 1, HYPHENMINUS);\n\n                    this.scanner.next();\n                    this.scanner.skipSC();\n\n                    checkTokenIsInteger.call(this, DISALLOW_SIGN);\n\n                    b = '-' + this.consume(NUMBER);\n                    break;\n\n                // '+'? <ndashdigit-ident>\n                default:\n                    expectCharCode.call(this, 1, HYPHENMINUS);\n                    checkInteger.call(this, 2, DISALLOW_SIGN);\n                    this.scanner.next();\n\n                    b = this.scanner.substrToCursor(start + sign + 1);\n            }\n        }\n\n        // <ndashdigit-dimension>\n        // <ndash-dimension> <signless-integer>\n        // <n-dimension>\n        // <n-dimension> <signed-integer>\n        // <n-dimension> ['+' | '-'] <signless-integer>\n        else if (this.scanner.tokenType === DIMENSION) {\n            var code = this.scanner.source.charCodeAt(this.scanner.tokenStart);\n            var sign = code === PLUSSIGN || code === HYPHENMINUS;\n\n            for (var i = this.scanner.tokenStart + sign; i < this.scanner.tokenEnd; i++) {\n                if (!isDigit(this.scanner.source.charCodeAt(i))) {\n                    break;\n                }\n            }\n\n            if (i === this.scanner.tokenStart + sign) {\n                this.error('Integer is expected', this.scanner.tokenStart + sign);\n            }\n\n            expectCharCode.call(this, i - this.scanner.tokenStart, N);\n            a = this.scanner.source.substring(start, i);\n\n            // <n-dimension>\n            // <n-dimension> <signed-integer>\n            // <n-dimension> ['+' | '-'] <signless-integer>\n            if (i + 1 === this.scanner.tokenEnd) {\n                this.scanner.next();\n                b = consumeB.call(this);\n            } else {\n                expectCharCode.call(this, i - this.scanner.tokenStart + 1, HYPHENMINUS);\n\n                // <ndash-dimension> <signless-integer>\n                if (i + 2 === this.scanner.tokenEnd) {\n                    this.scanner.next();\n                    this.scanner.skipSC();\n                    checkTokenIsInteger.call(this, DISALLOW_SIGN);\n                    b = '-' + this.consume(NUMBER);\n                }\n                // <ndashdigit-dimension>\n                else {\n                    checkInteger.call(this, i - this.scanner.tokenStart + 2, DISALLOW_SIGN);\n                    this.scanner.next();\n                    b = this.scanner.substrToCursor(i + 1);\n                }\n            }\n        } else {\n            this.error();\n        }\n\n        if (a !== null && a.charCodeAt(0) === PLUSSIGN) {\n            a = a.substr(1);\n        }\n\n        if (b !== null && b.charCodeAt(0) === PLUSSIGN) {\n            b = b.substr(1);\n        }\n\n        return {\n            type: 'AnPlusB',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            a: a,\n            b: b\n        };\n    },\n    generate: function(node) {\n        var a = node.a !== null && node.a !== undefined;\n        var b = node.b !== null && node.b !== undefined;\n\n        if (a) {\n            this.chunk(\n                node.a === '+1' ? '+n' : // eslint-disable-line operator-linebreak, indent\n                node.a ===  '1' ?  'n' : // eslint-disable-line operator-linebreak, indent\n                node.a === '-1' ? '-n' : // eslint-disable-line operator-linebreak, indent\n                node.a + 'n'             // eslint-disable-line operator-linebreak, indent\n            );\n\n            if (b) {\n                b = String(node.b);\n                if (b.charAt(0) === '-' || b.charAt(0) === '+') {\n                    this.chunk(b.charAt(0));\n                    this.chunk(b.substr(1));\n                } else {\n                    this.chunk('+');\n                    this.chunk(b);\n                }\n            }\n        } else {\n            this.chunk(String(node.b));\n        }\n    }\n};\n","var tokenizer = require('../../tokenizer');\nvar TYPE = tokenizer.TYPE;\n\nvar WhiteSpace = TYPE.WhiteSpace;\nvar Semicolon = TYPE.Semicolon;\nvar LeftCurlyBracket = TYPE.LeftCurlyBracket;\nvar Delim = TYPE.Delim;\nvar EXCLAMATIONMARK = 0x0021; // U+0021 EXCLAMATION MARK (!)\n\nfunction getOffsetExcludeWS() {\n    if (this.scanner.tokenIndex > 0) {\n        if (this.scanner.lookupType(-1) === WhiteSpace) {\n            return this.scanner.tokenIndex > 1\n                ? this.scanner.getTokenStart(this.scanner.tokenIndex - 1)\n                : this.scanner.firstCharOffset;\n        }\n    }\n\n    return this.scanner.tokenStart;\n}\n\n// 0, 0, false\nfunction balanceEnd() {\n    return 0;\n}\n\n// LEFTCURLYBRACKET, 0, false\nfunction leftCurlyBracket(tokenType) {\n    return tokenType === LeftCurlyBracket ? 1 : 0;\n}\n\n// LEFTCURLYBRACKET, SEMICOLON, false\nfunction leftCurlyBracketOrSemicolon(tokenType) {\n    return tokenType === LeftCurlyBracket || tokenType === Semicolon ? 1 : 0;\n}\n\n// EXCLAMATIONMARK, SEMICOLON, false\nfunction exclamationMarkOrSemicolon(tokenType, source, offset) {\n    if (tokenType === Delim && source.charCodeAt(offset) === EXCLAMATIONMARK) {\n        return 1;\n    }\n\n    return tokenType === Semicolon ? 1 : 0;\n}\n\n// 0, SEMICOLON, true\nfunction semicolonIncluded(tokenType) {\n    return tokenType === Semicolon ? 2 : 0;\n}\n\nmodule.exports = {\n    name: 'Raw',\n    structure: {\n        value: String\n    },\n    parse: function(startToken, mode, excludeWhiteSpace) {\n        var startOffset = this.scanner.getTokenStart(startToken);\n        var endOffset;\n\n        this.scanner.skip(\n            this.scanner.getRawLength(startToken, mode || balanceEnd)\n        );\n\n        if (excludeWhiteSpace && this.scanner.tokenStart > startOffset) {\n            endOffset = getOffsetExcludeWS.call(this);\n        } else {\n            endOffset = this.scanner.tokenStart;\n        }\n\n        return {\n            type: 'Raw',\n            loc: this.getLocation(startOffset, endOffset),\n            value: this.scanner.source.substring(startOffset, endOffset)\n        };\n    },\n    generate: function(node) {\n        this.chunk(node.value);\n    },\n\n    mode: {\n        default: balanceEnd,\n        leftCurlyBracket: leftCurlyBracket,\n        leftCurlyBracketOrSemicolon: leftCurlyBracketOrSemicolon,\n        exclamationMarkOrSemicolon: exclamationMarkOrSemicolon,\n        semicolonIncluded: semicolonIncluded\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\nvar rawMode = require('./Raw').mode;\n\nvar ATKEYWORD = TYPE.AtKeyword;\nvar SEMICOLON = TYPE.Semicolon;\nvar LEFTCURLYBRACKET = TYPE.LeftCurlyBracket;\nvar RIGHTCURLYBRACKET = TYPE.RightCurlyBracket;\n\nfunction consumeRaw(startToken) {\n    return this.Raw(startToken, rawMode.leftCurlyBracketOrSemicolon, true);\n}\n\nfunction isDeclarationBlockAtrule() {\n    for (var offset = 1, type; type = this.scanner.lookupType(offset); offset++) {\n        if (type === RIGHTCURLYBRACKET) {\n            return true;\n        }\n\n        if (type === LEFTCURLYBRACKET ||\n            type === ATKEYWORD) {\n            return false;\n        }\n    }\n\n    return false;\n}\n\nmodule.exports = {\n    name: 'Atrule',\n    structure: {\n        name: String,\n        prelude: ['AtrulePrelude', 'Raw', null],\n        block: ['Block', null]\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var name;\n        var nameLowerCase;\n        var prelude = null;\n        var block = null;\n\n        this.eat(ATKEYWORD);\n\n        name = this.scanner.substrToCursor(start + 1);\n        nameLowerCase = name.toLowerCase();\n        this.scanner.skipSC();\n\n        // parse prelude\n        if (this.scanner.eof === false &&\n            this.scanner.tokenType !== LEFTCURLYBRACKET &&\n            this.scanner.tokenType !== SEMICOLON) {\n            if (this.parseAtrulePrelude) {\n                prelude = this.parseWithFallback(this.AtrulePrelude.bind(this, name), consumeRaw);\n\n                // turn empty AtrulePrelude into null\n                if (prelude.type === 'AtrulePrelude' && prelude.children.head === null) {\n                    prelude = null;\n                }\n            } else {\n                prelude = consumeRaw.call(this, this.scanner.tokenIndex);\n            }\n\n            this.scanner.skipSC();\n        }\n\n        switch (this.scanner.tokenType) {\n            case SEMICOLON:\n                this.scanner.next();\n                break;\n\n            case LEFTCURLYBRACKET:\n                if (this.atrule.hasOwnProperty(nameLowerCase) &&\n                    typeof this.atrule[nameLowerCase].block === 'function') {\n                    block = this.atrule[nameLowerCase].block.call(this);\n                } else {\n                    // TODO: should consume block content as Raw?\n                    block = this.Block(isDeclarationBlockAtrule.call(this));\n                }\n\n                break;\n        }\n\n        return {\n            type: 'Atrule',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            name: name,\n            prelude: prelude,\n            block: block\n        };\n    },\n    generate: function(node) {\n        this.chunk('@');\n        this.chunk(node.name);\n\n        if (node.prelude !== null) {\n            this.chunk(' ');\n            this.node(node.prelude);\n        }\n\n        if (node.block) {\n            this.node(node.block);\n        } else {\n            this.chunk(';');\n        }\n    },\n    walkContext: 'atrule'\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar SEMICOLON = TYPE.Semicolon;\nvar LEFTCURLYBRACKET = TYPE.LeftCurlyBracket;\n\nmodule.exports = {\n    name: 'AtrulePrelude',\n    structure: {\n        children: [[]]\n    },\n    parse: function(name) {\n        var children = null;\n\n        if (name !== null) {\n            name = name.toLowerCase();\n        }\n\n        this.scanner.skipSC();\n\n        if (this.atrule.hasOwnProperty(name) &&\n            typeof this.atrule[name].prelude === 'function') {\n            // custom consumer\n            children = this.atrule[name].prelude.call(this);\n        } else {\n            // default consumer\n            children = this.readSequence(this.scope.AtrulePrelude);\n        }\n\n        this.scanner.skipSC();\n\n        if (this.scanner.eof !== true &&\n            this.scanner.tokenType !== LEFTCURLYBRACKET &&\n            this.scanner.tokenType !== SEMICOLON) {\n            this.error('Semicolon or block is expected');\n        }\n\n        if (children === null) {\n            children = this.createList();\n        }\n\n        return {\n            type: 'AtrulePrelude',\n            loc: this.getLocationFromList(children),\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.children(node);\n    },\n    walkContext: 'atrulePrelude'\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar IDENT = TYPE.Ident;\nvar STRING = TYPE.String;\nvar COLON = TYPE.Colon;\nvar LEFTSQUAREBRACKET = TYPE.LeftSquareBracket;\nvar RIGHTSQUAREBRACKET = TYPE.RightSquareBracket;\nvar DOLLARSIGN = 0x0024;       // U+0024 DOLLAR SIGN ($)\nvar ASTERISK = 0x002A;         // U+002A ASTERISK (*)\nvar EQUALSSIGN = 0x003D;       // U+003D EQUALS SIGN (=)\nvar CIRCUMFLEXACCENT = 0x005E; // U+005E (^)\nvar VERTICALLINE = 0x007C;     // U+007C VERTICAL LINE (|)\nvar TILDE = 0x007E;            // U+007E TILDE (~)\n\nfunction getAttributeName() {\n    if (this.scanner.eof) {\n        this.error('Unexpected end of input');\n    }\n\n    var start = this.scanner.tokenStart;\n    var expectIdent = false;\n    var checkColon = true;\n\n    if (this.scanner.isDelim(ASTERISK)) {\n        expectIdent = true;\n        checkColon = false;\n        this.scanner.next();\n    } else if (!this.scanner.isDelim(VERTICALLINE)) {\n        this.eat(IDENT);\n    }\n\n    if (this.scanner.isDelim(VERTICALLINE)) {\n        if (this.scanner.source.charCodeAt(this.scanner.tokenStart + 1) !== EQUALSSIGN) {\n            this.scanner.next();\n            this.eat(IDENT);\n        } else if (expectIdent) {\n            this.error('Identifier is expected', this.scanner.tokenEnd);\n        }\n    } else if (expectIdent) {\n        this.error('Vertical line is expected');\n    }\n\n    if (checkColon && this.scanner.tokenType === COLON) {\n        this.scanner.next();\n        this.eat(IDENT);\n    }\n\n    return {\n        type: 'Identifier',\n        loc: this.getLocation(start, this.scanner.tokenStart),\n        name: this.scanner.substrToCursor(start)\n    };\n}\n\nfunction getOperator() {\n    var start = this.scanner.tokenStart;\n    var code = this.scanner.source.charCodeAt(start);\n\n    if (code !== EQUALSSIGN &&        // =\n        code !== TILDE &&             // ~=\n        code !== CIRCUMFLEXACCENT &&  // ^=\n        code !== DOLLARSIGN &&        // $=\n        code !== ASTERISK &&          // *=\n        code !== VERTICALLINE         // |=\n    ) {\n        this.error('Attribute selector (=, ~=, ^=, $=, *=, |=) is expected');\n    }\n\n    this.scanner.next();\n\n    if (code !== EQUALSSIGN) {\n        if (!this.scanner.isDelim(EQUALSSIGN)) {\n            this.error('Equal sign is expected');\n        }\n\n        this.scanner.next();\n    }\n\n    return this.scanner.substrToCursor(start);\n}\n\n// '[' <wq-name> ']'\n// '[' <wq-name> <attr-matcher> [ <string-token> | <ident-token> ] <attr-modifier>? ']'\nmodule.exports = {\n    name: 'AttributeSelector',\n    structure: {\n        name: 'Identifier',\n        matcher: [String, null],\n        value: ['String', 'Identifier', null],\n        flags: [String, null]\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var name;\n        var matcher = null;\n        var value = null;\n        var flags = null;\n\n        this.eat(LEFTSQUAREBRACKET);\n        this.scanner.skipSC();\n\n        name = getAttributeName.call(this);\n        this.scanner.skipSC();\n\n        if (this.scanner.tokenType !== RIGHTSQUAREBRACKET) {\n            // avoid case `[name i]`\n            if (this.scanner.tokenType !== IDENT) {\n                matcher = getOperator.call(this);\n\n                this.scanner.skipSC();\n\n                value = this.scanner.tokenType === STRING\n                    ? this.String()\n                    : this.Identifier();\n\n                this.scanner.skipSC();\n            }\n\n            // attribute flags\n            if (this.scanner.tokenType === IDENT) {\n                flags = this.scanner.getTokenValue();\n                this.scanner.next();\n\n                this.scanner.skipSC();\n            }\n        }\n\n        this.eat(RIGHTSQUAREBRACKET);\n\n        return {\n            type: 'AttributeSelector',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            name: name,\n            matcher: matcher,\n            value: value,\n            flags: flags\n        };\n    },\n    generate: function(node) {\n        var flagsPrefix = ' ';\n\n        this.chunk('[');\n        this.node(node.name);\n\n        if (node.matcher !== null) {\n            this.chunk(node.matcher);\n\n            if (node.value !== null) {\n                this.node(node.value);\n\n                // space between string and flags is not required\n                if (node.value.type === 'String') {\n                    flagsPrefix = '';\n                }\n            }\n        }\n\n        if (node.flags !== null) {\n            this.chunk(flagsPrefix);\n            this.chunk(node.flags);\n        }\n\n        this.chunk(']');\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\nvar rawMode = require('./Raw').mode;\n\nvar WHITESPACE = TYPE.WhiteSpace;\nvar COMMENT = TYPE.Comment;\nvar SEMICOLON = TYPE.Semicolon;\nvar ATKEYWORD = TYPE.AtKeyword;\nvar LEFTCURLYBRACKET = TYPE.LeftCurlyBracket;\nvar RIGHTCURLYBRACKET = TYPE.RightCurlyBracket;\n\nfunction consumeRaw(startToken) {\n    return this.Raw(startToken, null, true);\n}\nfunction consumeRule() {\n    return this.parseWithFallback(this.Rule, consumeRaw);\n}\nfunction consumeRawDeclaration(startToken) {\n    return this.Raw(startToken, rawMode.semicolonIncluded, true);\n}\nfunction consumeDeclaration() {\n    if (this.scanner.tokenType === SEMICOLON) {\n        return consumeRawDeclaration.call(this, this.scanner.tokenIndex);\n    }\n\n    var node = this.parseWithFallback(this.Declaration, consumeRawDeclaration);\n\n    if (this.scanner.tokenType === SEMICOLON) {\n        this.scanner.next();\n    }\n\n    return node;\n}\n\nmodule.exports = {\n    name: 'Block',\n    structure: {\n        children: [[\n            'Atrule',\n            'Rule',\n            'Declaration'\n        ]]\n    },\n    parse: function(isDeclaration) {\n        var consumer = isDeclaration ? consumeDeclaration : consumeRule;\n\n        var start = this.scanner.tokenStart;\n        var children = this.createList();\n\n        this.eat(LEFTCURLYBRACKET);\n\n        scan:\n        while (!this.scanner.eof) {\n            switch (this.scanner.tokenType) {\n                case RIGHTCURLYBRACKET:\n                    break scan;\n\n                case WHITESPACE:\n                case COMMENT:\n                    this.scanner.next();\n                    break;\n\n                case ATKEYWORD:\n                    children.push(this.parseWithFallback(this.Atrule, consumeRaw));\n                    break;\n\n                default:\n                    children.push(consumer.call(this));\n            }\n        }\n\n        if (!this.scanner.eof) {\n            this.eat(RIGHTCURLYBRACKET);\n        }\n\n        return {\n            type: 'Block',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.chunk('{');\n        this.children(node, function(prev) {\n            if (prev.type === 'Declaration') {\n                this.chunk(';');\n            }\n        });\n        this.chunk('}');\n    },\n    walkContext: 'block'\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar LEFTSQUAREBRACKET = TYPE.LeftSquareBracket;\nvar RIGHTSQUAREBRACKET = TYPE.RightSquareBracket;\n\nmodule.exports = {\n    name: 'Brackets',\n    structure: {\n        children: [[]]\n    },\n    parse: function(readSequence, recognizer) {\n        var start = this.scanner.tokenStart;\n        var children = null;\n\n        this.eat(LEFTSQUAREBRACKET);\n\n        children = readSequence.call(this, recognizer);\n\n        if (!this.scanner.eof) {\n            this.eat(RIGHTSQUAREBRACKET);\n        }\n\n        return {\n            type: 'Brackets',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.chunk('[');\n        this.children(node);\n        this.chunk(']');\n    }\n};\n","var CDC = require('../../tokenizer').TYPE.CDC;\n\nmodule.exports = {\n    name: 'CDC',\n    structure: [],\n    parse: function() {\n        var start = this.scanner.tokenStart;\n\n        this.eat(CDC); // -->\n\n        return {\n            type: 'CDC',\n            loc: this.getLocation(start, this.scanner.tokenStart)\n        };\n    },\n    generate: function() {\n        this.chunk('-->');\n    }\n};\n","var CDO = require('../../tokenizer').TYPE.CDO;\n\nmodule.exports = {\n    name: 'CDO',\n    structure: [],\n    parse: function() {\n        var start = this.scanner.tokenStart;\n\n        this.eat(CDO); // <!--\n\n        return {\n            type: 'CDO',\n            loc: this.getLocation(start, this.scanner.tokenStart)\n        };\n    },\n    generate: function() {\n        this.chunk('<!--');\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar IDENT = TYPE.Ident;\nvar FULLSTOP = 0x002E; // U+002E FULL STOP (.)\n\n// '.' ident\nmodule.exports = {\n    name: 'ClassSelector',\n    structure: {\n        name: String\n    },\n    parse: function() {\n        if (!this.scanner.isDelim(FULLSTOP)) {\n            this.error('Full stop is expected');\n        }\n\n        this.scanner.next();\n\n        return {\n            type: 'ClassSelector',\n            loc: this.getLocation(this.scanner.tokenStart - 1, this.scanner.tokenEnd),\n            name: this.consume(IDENT)\n        };\n    },\n    generate: function(node) {\n        this.chunk('.');\n        this.chunk(node.name);\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar IDENT = TYPE.Ident;\nvar PLUSSIGN = 0x002B;        // U+002B PLUS SIGN (+)\nvar SOLIDUS = 0x002F;         // U+002F SOLIDUS (/)\nvar GREATERTHANSIGN = 0x003E; // U+003E GREATER-THAN SIGN (>)\nvar TILDE = 0x007E;           // U+007E TILDE (~)\n\n// + | > | ~ | /deep/\nmodule.exports = {\n    name: 'Combinator',\n    structure: {\n        name: String\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var code = this.scanner.source.charCodeAt(this.scanner.tokenStart);\n\n        switch (code) {\n            case GREATERTHANSIGN:\n            case PLUSSIGN:\n            case TILDE:\n                this.scanner.next();\n                break;\n\n            case SOLIDUS:\n                this.scanner.next();\n\n                if (this.scanner.tokenType !== IDENT || this.scanner.lookupValue(0, 'deep') === false) {\n                    this.error('Identifier `deep` is expected');\n                }\n\n                this.scanner.next();\n\n                if (!this.scanner.isDelim(SOLIDUS)) {\n                    this.error('Solidus is expected');\n                }\n\n                this.scanner.next();\n                break;\n\n            default:\n                this.error('Combinator is expected');\n        }\n\n        return {\n            type: 'Combinator',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            name: this.scanner.substrToCursor(start)\n        };\n    },\n    generate: function(node) {\n        this.chunk(node.name);\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar COMMENT = TYPE.Comment;\nvar ASTERISK = 0x002A;        // U+002A ASTERISK (*)\nvar SOLIDUS = 0x002F;         // U+002F SOLIDUS (/)\n\n// '/*' .* '*/'\nmodule.exports = {\n    name: 'Comment',\n    structure: {\n        value: String\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var end = this.scanner.tokenEnd;\n\n        this.eat(COMMENT);\n\n        if ((end - start + 2) >= 2 &&\n            this.scanner.source.charCodeAt(end - 2) === ASTERISK &&\n            this.scanner.source.charCodeAt(end - 1) === SOLIDUS) {\n            end -= 2;\n        }\n\n        return {\n            type: 'Comment',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            value: this.scanner.source.substring(start + 2, end)\n        };\n    },\n    generate: function(node) {\n        this.chunk('/*');\n        this.chunk(node.value);\n        this.chunk('*/');\n    }\n};\n","var isCustomProperty = require('../../utils/names').isCustomProperty;\nvar TYPE = require('../../tokenizer').TYPE;\nvar rawMode = require('./Raw').mode;\n\nvar IDENT = TYPE.Ident;\nvar HASH = TYPE.Hash;\nvar COLON = TYPE.Colon;\nvar SEMICOLON = TYPE.Semicolon;\nvar DELIM = TYPE.Delim;\nvar WHITESPACE = TYPE.WhiteSpace;\nvar EXCLAMATIONMARK = 0x0021; // U+0021 EXCLAMATION MARK (!)\nvar NUMBERSIGN = 0x0023;      // U+0023 NUMBER SIGN (#)\nvar DOLLARSIGN = 0x0024;      // U+0024 DOLLAR SIGN ($)\nvar AMPERSAND = 0x0026;       // U+0026 ANPERSAND (&)\nvar ASTERISK = 0x002A;        // U+002A ASTERISK (*)\nvar PLUSSIGN = 0x002B;        // U+002B PLUS SIGN (+)\nvar SOLIDUS = 0x002F;         // U+002F SOLIDUS (/)\n\nfunction consumeValueRaw(startToken) {\n    return this.Raw(startToken, rawMode.exclamationMarkOrSemicolon, true);\n}\n\nfunction consumeCustomPropertyRaw(startToken) {\n    return this.Raw(startToken, rawMode.exclamationMarkOrSemicolon, false);\n}\n\nfunction consumeValue() {\n    var startValueToken = this.scanner.tokenIndex;\n    var value = this.Value();\n\n    if (value.type !== 'Raw' &&\n        this.scanner.eof === false &&\n        this.scanner.tokenType !== SEMICOLON &&\n        this.scanner.isDelim(EXCLAMATIONMARK) === false &&\n        this.scanner.isBalanceEdge(startValueToken) === false) {\n        this.error();\n    }\n\n    return value;\n}\n\nmodule.exports = {\n    name: 'Declaration',\n    structure: {\n        important: [Boolean, String],\n        property: String,\n        value: ['Value', 'Raw']\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var startToken = this.scanner.tokenIndex;\n        var property = readProperty.call(this);\n        var customProperty = isCustomProperty(property);\n        var parseValue = customProperty ? this.parseCustomProperty : this.parseValue;\n        var consumeRaw = customProperty ? consumeCustomPropertyRaw : consumeValueRaw;\n        var important = false;\n        var value;\n\n        this.scanner.skipSC();\n        this.eat(COLON);\n\n        const valueStart = this.scanner.tokenIndex;\n\n        if (!customProperty) {\n            this.scanner.skipSC();\n        }\n\n        if (parseValue) {\n            value = this.parseWithFallback(consumeValue, consumeRaw);\n        } else {\n            value = consumeRaw.call(this, this.scanner.tokenIndex);\n        }\n\n        if (customProperty && value.type === 'Value' && value.children.isEmpty()) {\n            for (let offset = valueStart - this.scanner.tokenIndex; offset <= 0; offset++) {\n                if (this.scanner.lookupType(offset) === WHITESPACE) {\n                    value.children.appendData({\n                        type: 'WhiteSpace',\n                        loc: null,\n                        value: ' '\n                    });\n                    break;\n                }\n            }\n        }\n\n        if (this.scanner.isDelim(EXCLAMATIONMARK)) {\n            important = getImportant.call(this);\n            this.scanner.skipSC();\n        }\n\n        // Do not include semicolon to range per spec\n        // https://drafts.csswg.org/css-syntax/#declaration-diagram\n\n        if (this.scanner.eof === false &&\n            this.scanner.tokenType !== SEMICOLON &&\n            this.scanner.isBalanceEdge(startToken) === false) {\n            this.error();\n        }\n\n        return {\n            type: 'Declaration',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            important: important,\n            property: property,\n            value: value\n        };\n    },\n    generate: function(node) {\n        this.chunk(node.property);\n        this.chunk(':');\n        this.node(node.value);\n\n        if (node.important) {\n            this.chunk(node.important === true ? '!important' : '!' + node.important);\n        }\n    },\n    walkContext: 'declaration'\n};\n\nfunction readProperty() {\n    var start = this.scanner.tokenStart;\n    var prefix = 0;\n\n    // hacks\n    if (this.scanner.tokenType === DELIM) {\n        switch (this.scanner.source.charCodeAt(this.scanner.tokenStart)) {\n            case ASTERISK:\n            case DOLLARSIGN:\n            case PLUSSIGN:\n            case NUMBERSIGN:\n            case AMPERSAND:\n                this.scanner.next();\n                break;\n\n            // TODO: not sure we should support this hack\n            case SOLIDUS:\n                this.scanner.next();\n                if (this.scanner.isDelim(SOLIDUS)) {\n                    this.scanner.next();\n                }\n                break;\n        }\n    }\n\n    if (prefix) {\n        this.scanner.skip(prefix);\n    }\n\n    if (this.scanner.tokenType === HASH) {\n        this.eat(HASH);\n    } else {\n        this.eat(IDENT);\n    }\n\n    return this.scanner.substrToCursor(start);\n}\n\n// ! ws* important\nfunction getImportant() {\n    this.eat(DELIM);\n    this.scanner.skipSC();\n\n    var important = this.consume(IDENT);\n\n    // store original value in case it differ from `important`\n    // for better original source restoring and hacks like `!ie` support\n    return important === 'important' ? true : important;\n}\n","var TYPE = require('../../tokenizer').TYPE;\nvar rawMode = require('./Raw').mode;\n\nvar WHITESPACE = TYPE.WhiteSpace;\nvar COMMENT = TYPE.Comment;\nvar SEMICOLON = TYPE.Semicolon;\n\nfunction consumeRaw(startToken) {\n    return this.Raw(startToken, rawMode.semicolonIncluded, true);\n}\n\nmodule.exports = {\n    name: 'DeclarationList',\n    structure: {\n        children: [[\n            'Declaration'\n        ]]\n    },\n    parse: function() {\n        var children = this.createList();\n\n        scan:\n        while (!this.scanner.eof) {\n            switch (this.scanner.tokenType) {\n                case WHITESPACE:\n                case COMMENT:\n                case SEMICOLON:\n                    this.scanner.next();\n                    break;\n\n                default:\n                    children.push(this.parseWithFallback(this.Declaration, consumeRaw));\n            }\n        }\n\n        return {\n            type: 'DeclarationList',\n            loc: this.getLocationFromList(children),\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.children(node, function(prev) {\n            if (prev.type === 'Declaration') {\n                this.chunk(';');\n            }\n        });\n    }\n};\n","var consumeNumber = require('../../tokenizer/utils').consumeNumber;\nvar TYPE = require('../../tokenizer').TYPE;\n\nvar DIMENSION = TYPE.Dimension;\n\nmodule.exports = {\n    name: 'Dimension',\n    structure: {\n        value: String,\n        unit: String\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var numberEnd = consumeNumber(this.scanner.source, start);\n\n        this.eat(DIMENSION);\n\n        return {\n            type: 'Dimension',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            value: this.scanner.source.substring(start, numberEnd),\n            unit: this.scanner.source.substring(numberEnd, this.scanner.tokenStart)\n        };\n    },\n    generate: function(node) {\n        this.chunk(node.value);\n        this.chunk(node.unit);\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar RIGHTPARENTHESIS = TYPE.RightParenthesis;\n\n// <function-token> <sequence> )\nmodule.exports = {\n    name: 'Function',\n    structure: {\n        name: String,\n        children: [[]]\n    },\n    parse: function(readSequence, recognizer) {\n        var start = this.scanner.tokenStart;\n        var name = this.consumeFunctionName();\n        var nameLowerCase = name.toLowerCase();\n        var children;\n\n        children = recognizer.hasOwnProperty(nameLowerCase)\n            ? recognizer[nameLowerCase].call(this, recognizer)\n            : readSequence.call(this, recognizer);\n\n        if (!this.scanner.eof) {\n            this.eat(RIGHTPARENTHESIS);\n        }\n\n        return {\n            type: 'Function',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            name: name,\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.chunk(node.name);\n        this.chunk('(');\n        this.children(node);\n        this.chunk(')');\n    },\n    walkContext: 'function'\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar HASH = TYPE.Hash;\n\n// '#' ident\nmodule.exports = {\n    name: 'Hash',\n    structure: {\n        value: String\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n\n        this.eat(HASH);\n\n        return {\n            type: 'Hash',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            value: this.scanner.substrToCursor(start + 1)\n        };\n    },\n    generate: function(node) {\n        this.chunk('#');\n        this.chunk(node.value);\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar IDENT = TYPE.Ident;\n\nmodule.exports = {\n    name: 'Identifier',\n    structure: {\n        name: String\n    },\n    parse: function() {\n        return {\n            type: 'Identifier',\n            loc: this.getLocation(this.scanner.tokenStart, this.scanner.tokenEnd),\n            name: this.consume(IDENT)\n        };\n    },\n    generate: function(node) {\n        this.chunk(node.name);\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar HASH = TYPE.Hash;\n\n// <hash-token>\nmodule.exports = {\n    name: 'IdSelector',\n    structure: {\n        name: String\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n\n        // TODO: check value is an ident\n        this.eat(HASH);\n\n        return {\n            type: 'IdSelector',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            name: this.scanner.substrToCursor(start + 1)\n        };\n    },\n    generate: function(node) {\n        this.chunk('#');\n        this.chunk(node.name);\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar IDENT = TYPE.Ident;\nvar NUMBER = TYPE.Number;\nvar DIMENSION = TYPE.Dimension;\nvar LEFTPARENTHESIS = TYPE.LeftParenthesis;\nvar RIGHTPARENTHESIS = TYPE.RightParenthesis;\nvar COLON = TYPE.Colon;\nvar DELIM = TYPE.Delim;\n\nmodule.exports = {\n    name: 'MediaFeature',\n    structure: {\n        name: String,\n        value: ['Identifier', 'Number', 'Dimension', 'Ratio', null]\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var name;\n        var value = null;\n\n        this.eat(LEFTPARENTHESIS);\n        this.scanner.skipSC();\n\n        name = this.consume(IDENT);\n        this.scanner.skipSC();\n\n        if (this.scanner.tokenType !== RIGHTPARENTHESIS) {\n            this.eat(COLON);\n            this.scanner.skipSC();\n\n            switch (this.scanner.tokenType) {\n                case NUMBER:\n                    if (this.lookupNonWSType(1) === DELIM) {\n                        value = this.Ratio();\n                    } else {\n                        value = this.Number();\n                    }\n\n                    break;\n\n                case DIMENSION:\n                    value = this.Dimension();\n                    break;\n\n                case IDENT:\n                    value = this.Identifier();\n\n                    break;\n\n                default:\n                    this.error('Number, dimension, ratio or identifier is expected');\n            }\n\n            this.scanner.skipSC();\n        }\n\n        this.eat(RIGHTPARENTHESIS);\n\n        return {\n            type: 'MediaFeature',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            name: name,\n            value: value\n        };\n    },\n    generate: function(node) {\n        this.chunk('(');\n        this.chunk(node.name);\n        if (node.value !== null) {\n            this.chunk(':');\n            this.node(node.value);\n        }\n        this.chunk(')');\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar WHITESPACE = TYPE.WhiteSpace;\nvar COMMENT = TYPE.Comment;\nvar IDENT = TYPE.Ident;\nvar LEFTPARENTHESIS = TYPE.LeftParenthesis;\n\nmodule.exports = {\n    name: 'MediaQuery',\n    structure: {\n        children: [[\n            'Identifier',\n            'MediaFeature',\n            'WhiteSpace'\n        ]]\n    },\n    parse: function() {\n        this.scanner.skipSC();\n\n        var children = this.createList();\n        var child = null;\n        var space = null;\n\n        scan:\n        while (!this.scanner.eof) {\n            switch (this.scanner.tokenType) {\n                case COMMENT:\n                    this.scanner.next();\n                    continue;\n\n                case WHITESPACE:\n                    space = this.WhiteSpace();\n                    continue;\n\n                case IDENT:\n                    child = this.Identifier();\n                    break;\n\n                case LEFTPARENTHESIS:\n                    child = this.MediaFeature();\n                    break;\n\n                default:\n                    break scan;\n            }\n\n            if (space !== null) {\n                children.push(space);\n                space = null;\n            }\n\n            children.push(child);\n        }\n\n        if (child === null) {\n            this.error('Identifier or parenthesis is expected');\n        }\n\n        return {\n            type: 'MediaQuery',\n            loc: this.getLocationFromList(children),\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.children(node);\n    }\n};\n","var COMMA = require('../../tokenizer').TYPE.Comma;\n\nmodule.exports = {\n    name: 'MediaQueryList',\n    structure: {\n        children: [[\n            'MediaQuery'\n        ]]\n    },\n    parse: function(relative) {\n        var children = this.createList();\n\n        this.scanner.skipSC();\n\n        while (!this.scanner.eof) {\n            children.push(this.MediaQuery(relative));\n\n            if (this.scanner.tokenType !== COMMA) {\n                break;\n            }\n\n            this.scanner.next();\n        }\n\n        return {\n            type: 'MediaQueryList',\n            loc: this.getLocationFromList(children),\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.children(node, function() {\n            this.chunk(',');\n        });\n    }\n};\n","module.exports = {\n    name: 'Nth',\n    structure: {\n        nth: ['AnPlusB', 'Identifier'],\n        selector: ['SelectorList', null]\n    },\n    parse: function(allowOfClause) {\n        this.scanner.skipSC();\n\n        var start = this.scanner.tokenStart;\n        var end = start;\n        var selector = null;\n        var query;\n\n        if (this.scanner.lookupValue(0, 'odd') || this.scanner.lookupValue(0, 'even')) {\n            query = this.Identifier();\n        } else {\n            query = this.AnPlusB();\n        }\n\n        this.scanner.skipSC();\n\n        if (allowOfClause && this.scanner.lookupValue(0, 'of')) {\n            this.scanner.next();\n\n            selector = this.SelectorList();\n\n            if (this.needPositions) {\n                end = this.getLastListNode(selector.children).loc.end.offset;\n            }\n        } else {\n            if (this.needPositions) {\n                end = query.loc.end.offset;\n            }\n        }\n\n        return {\n            type: 'Nth',\n            loc: this.getLocation(start, end),\n            nth: query,\n            selector: selector\n        };\n    },\n    generate: function(node) {\n        this.node(node.nth);\n        if (node.selector !== null) {\n            this.chunk(' of ');\n            this.node(node.selector);\n        }\n    }\n};\n","var NUMBER = require('../../tokenizer').TYPE.Number;\n\nmodule.exports = {\n    name: 'Number',\n    structure: {\n        value: String\n    },\n    parse: function() {\n        return {\n            type: 'Number',\n            loc: this.getLocation(this.scanner.tokenStart, this.scanner.tokenEnd),\n            value: this.consume(NUMBER)\n        };\n    },\n    generate: function(node) {\n        this.chunk(node.value);\n    }\n};\n","// '/' | '*' | ',' | ':' | '+' | '-'\nmodule.exports = {\n    name: 'Operator',\n    structure: {\n        value: String\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n\n        this.scanner.next();\n\n        return {\n            type: 'Operator',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            value: this.scanner.substrToCursor(start)\n        };\n    },\n    generate: function(node) {\n        this.chunk(node.value);\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar LEFTPARENTHESIS = TYPE.LeftParenthesis;\nvar RIGHTPARENTHESIS = TYPE.RightParenthesis;\n\nmodule.exports = {\n    name: 'Parentheses',\n    structure: {\n        children: [[]]\n    },\n    parse: function(readSequence, recognizer) {\n        var start = this.scanner.tokenStart;\n        var children = null;\n\n        this.eat(LEFTPARENTHESIS);\n\n        children = readSequence.call(this, recognizer);\n\n        if (!this.scanner.eof) {\n            this.eat(RIGHTPARENTHESIS);\n        }\n\n        return {\n            type: 'Parentheses',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.chunk('(');\n        this.children(node);\n        this.chunk(')');\n    }\n};\n","var consumeNumber = require('../../tokenizer/utils').consumeNumber;\nvar TYPE = require('../../tokenizer').TYPE;\n\nvar PERCENTAGE = TYPE.Percentage;\n\nmodule.exports = {\n    name: 'Percentage',\n    structure: {\n        value: String\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var numberEnd = consumeNumber(this.scanner.source, start);\n\n        this.eat(PERCENTAGE);\n\n        return {\n            type: 'Percentage',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            value: this.scanner.source.substring(start, numberEnd)\n        };\n    },\n    generate: function(node) {\n        this.chunk(node.value);\n        this.chunk('%');\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar IDENT = TYPE.Ident;\nvar FUNCTION = TYPE.Function;\nvar COLON = TYPE.Colon;\nvar RIGHTPARENTHESIS = TYPE.RightParenthesis;\n\n// : [ <ident> | <function-token> <any-value>? ) ]\nmodule.exports = {\n    name: 'PseudoClassSelector',\n    structure: {\n        name: String,\n        children: [['Raw'], null]\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var children = null;\n        var name;\n        var nameLowerCase;\n\n        this.eat(COLON);\n\n        if (this.scanner.tokenType === FUNCTION) {\n            name = this.consumeFunctionName();\n            nameLowerCase = name.toLowerCase();\n\n            if (this.pseudo.hasOwnProperty(nameLowerCase)) {\n                this.scanner.skipSC();\n                children = this.pseudo[nameLowerCase].call(this);\n                this.scanner.skipSC();\n            } else {\n                children = this.createList();\n                children.push(\n                    this.Raw(this.scanner.tokenIndex, null, false)\n                );\n            }\n\n            this.eat(RIGHTPARENTHESIS);\n        } else {\n            name = this.consume(IDENT);\n        }\n\n        return {\n            type: 'PseudoClassSelector',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            name: name,\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.chunk(':');\n        this.chunk(node.name);\n\n        if (node.children !== null) {\n            this.chunk('(');\n            this.children(node);\n            this.chunk(')');\n        }\n    },\n    walkContext: 'function'\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar IDENT = TYPE.Ident;\nvar FUNCTION = TYPE.Function;\nvar COLON = TYPE.Colon;\nvar RIGHTPARENTHESIS = TYPE.RightParenthesis;\n\n// :: [ <ident> | <function-token> <any-value>? ) ]\nmodule.exports = {\n    name: 'PseudoElementSelector',\n    structure: {\n        name: String,\n        children: [['Raw'], null]\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var children = null;\n        var name;\n        var nameLowerCase;\n\n        this.eat(COLON);\n        this.eat(COLON);\n\n        if (this.scanner.tokenType === FUNCTION) {\n            name = this.consumeFunctionName();\n            nameLowerCase = name.toLowerCase();\n\n            if (this.pseudo.hasOwnProperty(nameLowerCase)) {\n                this.scanner.skipSC();\n                children = this.pseudo[nameLowerCase].call(this);\n                this.scanner.skipSC();\n            } else {\n                children = this.createList();\n                children.push(\n                    this.Raw(this.scanner.tokenIndex, null, false)\n                );\n            }\n\n            this.eat(RIGHTPARENTHESIS);\n        } else {\n            name = this.consume(IDENT);\n        }\n\n        return {\n            type: 'PseudoElementSelector',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            name: name,\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.chunk('::');\n        this.chunk(node.name);\n\n        if (node.children !== null) {\n            this.chunk('(');\n            this.children(node);\n            this.chunk(')');\n        }\n    },\n    walkContext: 'function'\n};\n","var isDigit = require('../../tokenizer').isDigit;\nvar TYPE = require('../../tokenizer').TYPE;\n\nvar NUMBER = TYPE.Number;\nvar DELIM = TYPE.Delim;\nvar SOLIDUS = 0x002F;  // U+002F SOLIDUS (/)\nvar FULLSTOP = 0x002E; // U+002E FULL STOP (.)\n\n// Terms of <ratio> should be a positive numbers (not zero or negative)\n// (see https://drafts.csswg.org/mediaqueries-3/#values)\n// However, -o-min-device-pixel-ratio takes fractional values as a ratio's term\n// and this is using by various sites. Therefore we relax checking on parse\n// to test a term is unsigned number without an exponent part.\n// Additional checking may be applied on lexer validation.\nfunction consumeNumber() {\n    this.scanner.skipWS();\n\n    var value = this.consume(NUMBER);\n\n    for (var i = 0; i < value.length; i++) {\n        var code = value.charCodeAt(i);\n        if (!isDigit(code) && code !== FULLSTOP) {\n            this.error('Unsigned number is expected', this.scanner.tokenStart - value.length + i);\n        }\n    }\n\n    if (Number(value) === 0) {\n        this.error('Zero number is not allowed', this.scanner.tokenStart - value.length);\n    }\n\n    return value;\n}\n\n// <positive-integer> S* '/' S* <positive-integer>\nmodule.exports = {\n    name: 'Ratio',\n    structure: {\n        left: String,\n        right: String\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var left = consumeNumber.call(this);\n        var right;\n\n        this.scanner.skipWS();\n\n        if (!this.scanner.isDelim(SOLIDUS)) {\n            this.error('Solidus is expected');\n        }\n        this.eat(DELIM);\n        right = consumeNumber.call(this);\n\n        return {\n            type: 'Ratio',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            left: left,\n            right: right\n        };\n    },\n    generate: function(node) {\n        this.chunk(node.left);\n        this.chunk('/');\n        this.chunk(node.right);\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\nvar rawMode = require('./Raw').mode;\n\nvar LEFTCURLYBRACKET = TYPE.LeftCurlyBracket;\n\nfunction consumeRaw(startToken) {\n    return this.Raw(startToken, rawMode.leftCurlyBracket, true);\n}\n\nfunction consumePrelude() {\n    var prelude = this.SelectorList();\n\n    if (prelude.type !== 'Raw' &&\n        this.scanner.eof === false &&\n        this.scanner.tokenType !== LEFTCURLYBRACKET) {\n        this.error();\n    }\n\n    return prelude;\n}\n\nmodule.exports = {\n    name: 'Rule',\n    structure: {\n        prelude: ['SelectorList', 'Raw'],\n        block: ['Block']\n    },\n    parse: function() {\n        var startToken = this.scanner.tokenIndex;\n        var startOffset = this.scanner.tokenStart;\n        var prelude;\n        var block;\n\n        if (this.parseRulePrelude) {\n            prelude = this.parseWithFallback(consumePrelude, consumeRaw);\n        } else {\n            prelude = consumeRaw.call(this, startToken);\n        }\n\n        block = this.Block(true);\n\n        return {\n            type: 'Rule',\n            loc: this.getLocation(startOffset, this.scanner.tokenStart),\n            prelude: prelude,\n            block: block\n        };\n    },\n    generate: function(node) {\n        this.node(node.prelude);\n        this.node(node.block);\n    },\n    walkContext: 'rule'\n};\n","module.exports = {\n    name: 'Selector',\n    structure: {\n        children: [[\n            'TypeSelector',\n            'IdSelector',\n            'ClassSelector',\n            'AttributeSelector',\n            'PseudoClassSelector',\n            'PseudoElementSelector',\n            'Combinator',\n            'WhiteSpace'\n        ]]\n    },\n    parse: function() {\n        var children = this.readSequence(this.scope.Selector);\n\n        // nothing were consumed\n        if (this.getFirstListNode(children) === null) {\n            this.error('Selector is expected');\n        }\n\n        return {\n            type: 'Selector',\n            loc: this.getLocationFromList(children),\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.children(node);\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar COMMA = TYPE.Comma;\n\nmodule.exports = {\n    name: 'SelectorList',\n    structure: {\n        children: [[\n            'Selector',\n            'Raw'\n        ]]\n    },\n    parse: function() {\n        var children = this.createList();\n\n        while (!this.scanner.eof) {\n            children.push(this.Selector());\n\n            if (this.scanner.tokenType === COMMA) {\n                this.scanner.next();\n                continue;\n            }\n\n            break;\n        }\n\n        return {\n            type: 'SelectorList',\n            loc: this.getLocationFromList(children),\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.children(node, function() {\n            this.chunk(',');\n        });\n    },\n    walkContext: 'selector'\n};\n","var STRING = require('../../tokenizer').TYPE.String;\n\nmodule.exports = {\n    name: 'String',\n    structure: {\n        value: String\n    },\n    parse: function() {\n        return {\n            type: 'String',\n            loc: this.getLocation(this.scanner.tokenStart, this.scanner.tokenEnd),\n            value: this.consume(STRING)\n        };\n    },\n    generate: function(node) {\n        this.chunk(node.value);\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar WHITESPACE = TYPE.WhiteSpace;\nvar COMMENT = TYPE.Comment;\nvar ATKEYWORD = TYPE.AtKeyword;\nvar CDO = TYPE.CDO;\nvar CDC = TYPE.CDC;\nvar EXCLAMATIONMARK = 0x0021; // U+0021 EXCLAMATION MARK (!)\n\nfunction consumeRaw(startToken) {\n    return this.Raw(startToken, null, false);\n}\n\nmodule.exports = {\n    name: 'StyleSheet',\n    structure: {\n        children: [[\n            'Comment',\n            'CDO',\n            'CDC',\n            'Atrule',\n            'Rule',\n            'Raw'\n        ]]\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var children = this.createList();\n        var child;\n\n        scan:\n        while (!this.scanner.eof) {\n            switch (this.scanner.tokenType) {\n                case WHITESPACE:\n                    this.scanner.next();\n                    continue;\n\n                case COMMENT:\n                    // ignore comments except exclamation comments (i.e. /*! .. */) on top level\n                    if (this.scanner.source.charCodeAt(this.scanner.tokenStart + 2) !== EXCLAMATIONMARK) {\n                        this.scanner.next();\n                        continue;\n                    }\n\n                    child = this.Comment();\n                    break;\n\n                case CDO: // <!--\n                    child = this.CDO();\n                    break;\n\n                case CDC: // -->\n                    child = this.CDC();\n                    break;\n\n                // CSS Syntax Module Level 3\n                // §2.2 Error handling\n                // At the \"top level\" of a stylesheet, an <at-keyword-token> starts an at-rule.\n                case ATKEYWORD:\n                    child = this.parseWithFallback(this.Atrule, consumeRaw);\n                    break;\n\n                // Anything else starts a qualified rule ...\n                default:\n                    child = this.parseWithFallback(this.Rule, consumeRaw);\n            }\n\n            children.push(child);\n        }\n\n        return {\n            type: 'StyleSheet',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.children(node);\n    },\n    walkContext: 'stylesheet'\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar IDENT = TYPE.Ident;\nvar ASTERISK = 0x002A;     // U+002A ASTERISK (*)\nvar VERTICALLINE = 0x007C; // U+007C VERTICAL LINE (|)\n\nfunction eatIdentifierOrAsterisk() {\n    if (this.scanner.tokenType !== IDENT &&\n        this.scanner.isDelim(ASTERISK) === false) {\n        this.error('Identifier or asterisk is expected');\n    }\n\n    this.scanner.next();\n}\n\n// ident\n// ident|ident\n// ident|*\n// *\n// *|ident\n// *|*\n// |ident\n// |*\nmodule.exports = {\n    name: 'TypeSelector',\n    structure: {\n        name: String\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n\n        if (this.scanner.isDelim(VERTICALLINE)) {\n            this.scanner.next();\n            eatIdentifierOrAsterisk.call(this);\n        } else {\n            eatIdentifierOrAsterisk.call(this);\n\n            if (this.scanner.isDelim(VERTICALLINE)) {\n                this.scanner.next();\n                eatIdentifierOrAsterisk.call(this);\n            }\n        }\n\n        return {\n            type: 'TypeSelector',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            name: this.scanner.substrToCursor(start)\n        };\n    },\n    generate: function(node) {\n        this.chunk(node.name);\n    }\n};\n","var isHexDigit = require('../../tokenizer').isHexDigit;\nvar cmpChar = require('../../tokenizer').cmpChar;\nvar TYPE = require('../../tokenizer').TYPE;\nvar NAME = require('../../tokenizer').NAME;\n\nvar IDENT = TYPE.Ident;\nvar NUMBER = TYPE.Number;\nvar DIMENSION = TYPE.Dimension;\nvar PLUSSIGN = 0x002B;     // U+002B PLUS SIGN (+)\nvar HYPHENMINUS = 0x002D;  // U+002D HYPHEN-MINUS (-)\nvar QUESTIONMARK = 0x003F; // U+003F QUESTION MARK (?)\nvar U = 0x0075;            // U+0075 LATIN SMALL LETTER U (u)\n\nfunction eatHexSequence(offset, allowDash) {\n    for (var pos = this.scanner.tokenStart + offset, len = 0; pos < this.scanner.tokenEnd; pos++) {\n        var code = this.scanner.source.charCodeAt(pos);\n\n        if (code === HYPHENMINUS && allowDash && len !== 0) {\n            if (eatHexSequence.call(this, offset + len + 1, false) === 0) {\n                this.error();\n            }\n\n            return -1;\n        }\n\n        if (!isHexDigit(code)) {\n            this.error(\n                allowDash && len !== 0\n                    ? 'HyphenMinus' + (len < 6 ? ' or hex digit' : '') + ' is expected'\n                    : (len < 6 ? 'Hex digit is expected' : 'Unexpected input'),\n                pos\n            );\n        }\n\n        if (++len > 6) {\n            this.error('Too many hex digits', pos);\n        };\n    }\n\n    this.scanner.next();\n    return len;\n}\n\nfunction eatQuestionMarkSequence(max) {\n    var count = 0;\n\n    while (this.scanner.isDelim(QUESTIONMARK)) {\n        if (++count > max) {\n            this.error('Too many question marks');\n        }\n\n        this.scanner.next();\n    }\n}\n\nfunction startsWith(code) {\n    if (this.scanner.source.charCodeAt(this.scanner.tokenStart) !== code) {\n        this.error(NAME[code] + ' is expected');\n    }\n}\n\n// https://drafts.csswg.org/css-syntax/#urange\n// Informally, the <urange> production has three forms:\n// U+0001\n//      Defines a range consisting of a single code point, in this case the code point \"1\".\n// U+0001-00ff\n//      Defines a range of codepoints between the first and the second value, in this case\n//      the range between \"1\" and \"ff\" (255 in decimal) inclusive.\n// U+00??\n//      Defines a range of codepoints where the \"?\" characters range over all hex digits,\n//      in this case defining the same as the value U+0000-00ff.\n// In each form, a maximum of 6 digits is allowed for each hexadecimal number (if you treat \"?\" as a hexadecimal digit).\n//\n// <urange> =\n//   u '+' <ident-token> '?'* |\n//   u <dimension-token> '?'* |\n//   u <number-token> '?'* |\n//   u <number-token> <dimension-token> |\n//   u <number-token> <number-token> |\n//   u '+' '?'+\nfunction scanUnicodeRange() {\n    var hexLength = 0;\n\n    // u '+' <ident-token> '?'*\n    // u '+' '?'+\n    if (this.scanner.isDelim(PLUSSIGN)) {\n        this.scanner.next();\n\n        if (this.scanner.tokenType === IDENT) {\n            hexLength = eatHexSequence.call(this, 0, true);\n            if (hexLength > 0) {\n                eatQuestionMarkSequence.call(this, 6 - hexLength);\n            }\n            return;\n        }\n\n        if (this.scanner.isDelim(QUESTIONMARK)) {\n            this.scanner.next();\n            eatQuestionMarkSequence.call(this, 5);\n            return;\n        }\n\n        this.error('Hex digit or question mark is expected');\n        return;\n    }\n\n    // u <number-token> '?'*\n    // u <number-token> <dimension-token>\n    // u <number-token> <number-token>\n    if (this.scanner.tokenType === NUMBER) {\n        startsWith.call(this, PLUSSIGN);\n        hexLength = eatHexSequence.call(this, 1, true);\n\n        if (this.scanner.isDelim(QUESTIONMARK)) {\n            eatQuestionMarkSequence.call(this, 6 - hexLength);\n            return;\n        }\n\n        if (this.scanner.tokenType === DIMENSION ||\n            this.scanner.tokenType === NUMBER) {\n            startsWith.call(this, HYPHENMINUS);\n            eatHexSequence.call(this, 1, false);\n            return;\n        }\n\n        return;\n    }\n\n    // u <dimension-token> '?'*\n    if (this.scanner.tokenType === DIMENSION) {\n        startsWith.call(this, PLUSSIGN);\n        hexLength = eatHexSequence.call(this, 1, true);\n\n        if (hexLength > 0) {\n            eatQuestionMarkSequence.call(this, 6 - hexLength);\n        }\n\n        return;\n    }\n\n    this.error();\n}\n\nmodule.exports = {\n    name: 'UnicodeRange',\n    structure: {\n        value: String\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n\n        // U or u\n        if (!cmpChar(this.scanner.source, start, U)) {\n            this.error('U is expected');\n        }\n\n        if (!cmpChar(this.scanner.source, start + 1, PLUSSIGN)) {\n            this.error('Plus sign is expected');\n        }\n\n        this.scanner.next();\n        scanUnicodeRange.call(this);\n\n        return {\n            type: 'UnicodeRange',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            value: this.scanner.substrToCursor(start)\n        };\n    },\n    generate: function(node) {\n        this.chunk(node.value);\n    }\n};\n","var isWhiteSpace = require('../../tokenizer').isWhiteSpace;\nvar cmpStr = require('../../tokenizer').cmpStr;\nvar TYPE = require('../../tokenizer').TYPE;\n\nvar FUNCTION = TYPE.Function;\nvar URL = TYPE.Url;\nvar RIGHTPARENTHESIS = TYPE.RightParenthesis;\n\n// <url-token> | <function-token> <string> )\nmodule.exports = {\n    name: 'Url',\n    structure: {\n        value: ['String', 'Raw']\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var value;\n\n        switch (this.scanner.tokenType) {\n            case URL:\n                var rawStart = start + 4;\n                var rawEnd = this.scanner.tokenEnd - 1;\n\n                while (rawStart < rawEnd && isWhiteSpace(this.scanner.source.charCodeAt(rawStart))) {\n                    rawStart++;\n                }\n\n                while (rawStart < rawEnd && isWhiteSpace(this.scanner.source.charCodeAt(rawEnd - 1))) {\n                    rawEnd--;\n                }\n\n                value = {\n                    type: 'Raw',\n                    loc: this.getLocation(rawStart, rawEnd),\n                    value: this.scanner.source.substring(rawStart, rawEnd)\n                };\n\n                this.eat(URL);\n                break;\n\n            case FUNCTION:\n                if (!cmpStr(this.scanner.source, this.scanner.tokenStart, this.scanner.tokenEnd, 'url(')) {\n                    this.error('Function name must be `url`');\n                }\n\n                this.eat(FUNCTION);\n                this.scanner.skipSC();\n                value = this.String();\n                this.scanner.skipSC();\n                this.eat(RIGHTPARENTHESIS);\n                break;\n\n            default:\n                this.error('Url or Function is expected');\n        }\n\n        return {\n            type: 'Url',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            value: value\n        };\n    },\n    generate: function(node) {\n        this.chunk('url');\n        this.chunk('(');\n        this.node(node.value);\n        this.chunk(')');\n    }\n};\n","module.exports = {\n    name: 'Value',\n    structure: {\n        children: [[]]\n    },\n    parse: function() {\n        var start = this.scanner.tokenStart;\n        var children = this.readSequence(this.scope.Value);\n\n        return {\n            type: 'Value',\n            loc: this.getLocation(start, this.scanner.tokenStart),\n            children: children\n        };\n    },\n    generate: function(node) {\n        this.children(node);\n    }\n};\n","var WHITESPACE = require('../../tokenizer').TYPE.WhiteSpace;\nvar SPACE = Object.freeze({\n    type: 'WhiteSpace',\n    loc: null,\n    value: ' '\n});\n\nmodule.exports = {\n    name: 'WhiteSpace',\n    structure: {\n        value: String\n    },\n    parse: function() {\n        this.eat(WHITESPACE);\n        return SPACE;\n\n        // return {\n        //     type: 'WhiteSpace',\n        //     loc: this.getLocation(this.scanner.tokenStart, this.scanner.tokenEnd),\n        //     value: this.consume(WHITESPACE)\n        // };\n    },\n    generate: function(node) {\n        this.chunk(node.value);\n    }\n};\n","module.exports = {\n    AnPlusB: require('./AnPlusB'),\n    Atrule: require('./Atrule'),\n    AtrulePrelude: require('./AtrulePrelude'),\n    AttributeSelector: require('./AttributeSelector'),\n    Block: require('./Block'),\n    Brackets: require('./Brackets'),\n    CDC: require('./CDC'),\n    CDO: require('./CDO'),\n    ClassSelector: require('./ClassSelector'),\n    Combinator: require('./Combinator'),\n    Comment: require('./Comment'),\n    Declaration: require('./Declaration'),\n    DeclarationList: require('./DeclarationList'),\n    Dimension: require('./Dimension'),\n    Function: require('./Function'),\n    Hash: require('./Hash'),\n    Identifier: require('./Identifier'),\n    IdSelector: require('./IdSelector'),\n    MediaFeature: require('./MediaFeature'),\n    MediaQuery: require('./MediaQuery'),\n    MediaQueryList: require('./MediaQueryList'),\n    Nth: require('./Nth'),\n    Number: require('./Number'),\n    Operator: require('./Operator'),\n    Parentheses: require('./Parentheses'),\n    Percentage: require('./Percentage'),\n    PseudoClassSelector: require('./PseudoClassSelector'),\n    PseudoElementSelector: require('./PseudoElementSelector'),\n    Ratio: require('./Ratio'),\n    Raw: require('./Raw'),\n    Rule: require('./Rule'),\n    Selector: require('./Selector'),\n    SelectorList: require('./SelectorList'),\n    String: require('./String'),\n    StyleSheet: require('./StyleSheet'),\n    TypeSelector: require('./TypeSelector'),\n    UnicodeRange: require('./UnicodeRange'),\n    Url: require('./Url'),\n    Value: require('./Value'),\n    WhiteSpace: require('./WhiteSpace')\n};\n","var data = require('../../../data');\n\nmodule.exports = {\n    generic: true,\n    types: data.types,\n    atrules: data.atrules,\n    properties: data.properties,\n    node: require('../node')\n};\n","var cmpChar = require('../../tokenizer').cmpChar;\nvar cmpStr = require('../../tokenizer').cmpStr;\nvar TYPE = require('../../tokenizer').TYPE;\n\nvar IDENT = TYPE.Ident;\nvar STRING = TYPE.String;\nvar NUMBER = TYPE.Number;\nvar FUNCTION = TYPE.Function;\nvar URL = TYPE.Url;\nvar HASH = TYPE.Hash;\nvar DIMENSION = TYPE.Dimension;\nvar PERCENTAGE = TYPE.Percentage;\nvar LEFTPARENTHESIS = TYPE.LeftParenthesis;\nvar LEFTSQUAREBRACKET = TYPE.LeftSquareBracket;\nvar COMMA = TYPE.Comma;\nvar DELIM = TYPE.Delim;\nvar NUMBERSIGN = 0x0023;  // U+0023 NUMBER SIGN (#)\nvar ASTERISK = 0x002A;    // U+002A ASTERISK (*)\nvar PLUSSIGN = 0x002B;    // U+002B PLUS SIGN (+)\nvar HYPHENMINUS = 0x002D; // U+002D HYPHEN-MINUS (-)\nvar SOLIDUS = 0x002F;     // U+002F SOLIDUS (/)\nvar U = 0x0075;           // U+0075 LATIN SMALL LETTER U (u)\n\nmodule.exports = function defaultRecognizer(context) {\n    switch (this.scanner.tokenType) {\n        case HASH:\n            return this.Hash();\n\n        case COMMA:\n            context.space = null;\n            context.ignoreWSAfter = true;\n            return this.Operator();\n\n        case LEFTPARENTHESIS:\n            return this.Parentheses(this.readSequence, context.recognizer);\n\n        case LEFTSQUAREBRACKET:\n            return this.Brackets(this.readSequence, context.recognizer);\n\n        case STRING:\n            return this.String();\n\n        case DIMENSION:\n            return this.Dimension();\n\n        case PERCENTAGE:\n            return this.Percentage();\n\n        case NUMBER:\n            return this.Number();\n\n        case FUNCTION:\n            return cmpStr(this.scanner.source, this.scanner.tokenStart, this.scanner.tokenEnd, 'url(')\n                ? this.Url()\n                : this.Function(this.readSequence, context.recognizer);\n\n        case URL:\n            return this.Url();\n\n        case IDENT:\n            // check for unicode range, it should start with u+ or U+\n            if (cmpChar(this.scanner.source, this.scanner.tokenStart, U) &&\n                cmpChar(this.scanner.source, this.scanner.tokenStart + 1, PLUSSIGN)) {\n                return this.UnicodeRange();\n            } else {\n                return this.Identifier();\n            }\n\n        case DELIM:\n            var code = this.scanner.source.charCodeAt(this.scanner.tokenStart);\n\n            if (code === SOLIDUS ||\n                code === ASTERISK ||\n                code === PLUSSIGN ||\n                code === HYPHENMINUS) {\n                return this.Operator(); // TODO: replace with Delim\n            }\n\n            // TODO: produce a node with Delim node type\n\n            if (code === NUMBERSIGN) {\n                this.error('Hex or identifier is expected', this.scanner.tokenStart + 1);\n            }\n\n            break;\n    }\n};\n","module.exports = {\n    getNode: require('./default')\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar DELIM = TYPE.Delim;\nvar IDENT = TYPE.Ident;\nvar DIMENSION = TYPE.Dimension;\nvar PERCENTAGE = TYPE.Percentage;\nvar NUMBER = TYPE.Number;\nvar HASH = TYPE.Hash;\nvar COLON = TYPE.Colon;\nvar LEFTSQUAREBRACKET = TYPE.LeftSquareBracket;\nvar NUMBERSIGN = 0x0023;      // U+0023 NUMBER SIGN (#)\nvar ASTERISK = 0x002A;        // U+002A ASTERISK (*)\nvar PLUSSIGN = 0x002B;        // U+002B PLUS SIGN (+)\nvar SOLIDUS = 0x002F;         // U+002F SOLIDUS (/)\nvar FULLSTOP = 0x002E;        // U+002E FULL STOP (.)\nvar GREATERTHANSIGN = 0x003E; // U+003E GREATER-THAN SIGN (>)\nvar VERTICALLINE = 0x007C;    // U+007C VERTICAL LINE (|)\nvar TILDE = 0x007E;           // U+007E TILDE (~)\n\nfunction getNode(context) {\n    switch (this.scanner.tokenType) {\n        case LEFTSQUAREBRACKET:\n            return this.AttributeSelector();\n\n        case HASH:\n            return this.IdSelector();\n\n        case COLON:\n            if (this.scanner.lookupType(1) === COLON) {\n                return this.PseudoElementSelector();\n            } else {\n                return this.PseudoClassSelector();\n            }\n\n        case IDENT:\n            return this.TypeSelector();\n\n        case NUMBER:\n        case PERCENTAGE:\n            return this.Percentage();\n\n        case DIMENSION:\n            // throws when .123ident\n            if (this.scanner.source.charCodeAt(this.scanner.tokenStart) === FULLSTOP) {\n                this.error('Identifier is expected', this.scanner.tokenStart + 1);\n            }\n            break;\n\n        case DELIM:\n            var code = this.scanner.source.charCodeAt(this.scanner.tokenStart);\n\n            switch (code) {\n                case PLUSSIGN:\n                case GREATERTHANSIGN:\n                case TILDE:\n                    context.space = null;\n                    context.ignoreWSAfter = true;\n                    return this.Combinator();\n\n                case SOLIDUS:  // /deep/\n                    return this.Combinator();\n\n                case FULLSTOP:\n                    return this.ClassSelector();\n\n                case ASTERISK:\n                case VERTICALLINE:\n                    return this.TypeSelector();\n\n                case NUMBERSIGN:\n                    return this.IdSelector();\n            }\n\n            break;\n    }\n};\n\nmodule.exports = {\n    getNode: getNode\n};\n","// legacy IE function\n// expression( <any-value> )\nmodule.exports = function() {\n    return this.createSingleNodeList(\n        this.Raw(this.scanner.tokenIndex, null, false)\n    );\n};\n","var TYPE = require('../../tokenizer').TYPE;\nvar rawMode = require('../node/Raw').mode;\n\nvar COMMA = TYPE.Comma;\nvar WHITESPACE = TYPE.WhiteSpace;\n\n// var( <ident> , <value>? )\nmodule.exports = function() {\n    var children = this.createList();\n\n    this.scanner.skipSC();\n\n    // NOTE: Don't check more than a first argument is an ident, rest checks are for lexer\n    children.push(this.Identifier());\n\n    this.scanner.skipSC();\n\n    if (this.scanner.tokenType === COMMA) {\n        children.push(this.Operator());\n\n        const startIndex = this.scanner.tokenIndex;\n        const value = this.parseCustomProperty\n            ? this.Value(null)\n            : this.Raw(this.scanner.tokenIndex, rawMode.exclamationMarkOrSemicolon, false);\n\n        if (value.type === 'Value' && value.children.isEmpty()) {\n            for (let offset = startIndex - this.scanner.tokenIndex; offset <= 0; offset++) {\n                if (this.scanner.lookupType(offset) === WHITESPACE) {\n                    value.children.appendData({\n                        type: 'WhiteSpace',\n                        loc: null,\n                        value: ' '\n                    });\n                    break;\n                }\n            }\n        }\n\n        children.push(value);\n    }\n\n    return children;\n};\n","module.exports = {\n    getNode: require('./default'),\n    'expression': require('../function/expression'),\n    'var': require('../function/var')\n};\n","module.exports = {\n    AtrulePrelude: require('./atrulePrelude'),\n    Selector: require('./selector'),\n    Value: require('./value')\n};\n","module.exports = {\n    parse: {\n        prelude: null,\n        block: function() {\n            return this.Block(true);\n        }\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar STRING = TYPE.String;\nvar IDENT = TYPE.Ident;\nvar URL = TYPE.Url;\nvar FUNCTION = TYPE.Function;\nvar LEFTPARENTHESIS = TYPE.LeftParenthesis;\n\nmodule.exports = {\n    parse: {\n        prelude: function() {\n            var children = this.createList();\n\n            this.scanner.skipSC();\n\n            switch (this.scanner.tokenType) {\n                case STRING:\n                    children.push(this.String());\n                    break;\n\n                case URL:\n                case FUNCTION:\n                    children.push(this.Url());\n                    break;\n\n                default:\n                    this.error('String or url() is expected');\n            }\n\n            if (this.lookupNonWSType(0) === IDENT ||\n                this.lookupNonWSType(0) === LEFTPARENTHESIS) {\n                children.push(this.WhiteSpace());\n                children.push(this.MediaQueryList());\n            }\n\n            return children;\n        },\n        block: null\n    }\n};\n","module.exports = {\n    parse: {\n        prelude: function() {\n            return this.createSingleNodeList(\n                this.MediaQueryList()\n            );\n        },\n        block: function() {\n            return this.Block(false);\n        }\n    }\n};\n","module.exports = {\n    parse: {\n        prelude: function() {\n            return this.createSingleNodeList(\n                this.SelectorList()\n            );\n        },\n        block: function() {\n            return this.Block(true);\n        }\n    }\n};\n","var TYPE = require('../../tokenizer').TYPE;\n\nvar WHITESPACE = TYPE.WhiteSpace;\nvar COMMENT = TYPE.Comment;\nvar IDENT = TYPE.Ident;\nvar FUNCTION = TYPE.Function;\nvar COLON = TYPE.Colon;\nvar LEFTPARENTHESIS = TYPE.LeftParenthesis;\n\nfunction consumeRaw() {\n    return this.createSingleNodeList(\n        this.Raw(this.scanner.tokenIndex, null, false)\n    );\n}\n\nfunction parentheses() {\n    this.scanner.skipSC();\n\n    if (this.scanner.tokenType === IDENT &&\n        this.lookupNonWSType(1) === COLON) {\n        return this.createSingleNodeList(\n            this.Declaration()\n        );\n    }\n\n    return readSequence.call(this);\n}\n\nfunction readSequence() {\n    var children = this.createList();\n    var space = null;\n    var child;\n\n    this.scanner.skipSC();\n\n    scan:\n    while (!this.scanner.eof) {\n        switch (this.scanner.tokenType) {\n            case WHITESPACE:\n                space = this.WhiteSpace();\n                continue;\n\n            case COMMENT:\n                this.scanner.next();\n                continue;\n\n            case FUNCTION:\n                child = this.Function(consumeRaw, this.scope.AtrulePrelude);\n                break;\n\n            case IDENT:\n                child = this.Identifier();\n                break;\n\n            case LEFTPARENTHESIS:\n                child = this.Parentheses(parentheses, this.scope.AtrulePrelude);\n                break;\n\n            default:\n                break scan;\n        }\n\n        if (space !== null) {\n            children.push(space);\n            space = null;\n        }\n\n        children.push(child);\n    }\n\n    return children;\n}\n\nmodule.exports = {\n    parse: {\n        prelude: function() {\n            var children = readSequence.call(this);\n\n            if (this.getFirstListNode(children) === null) {\n                this.error('Condition is expected');\n            }\n\n            return children;\n        },\n        block: function() {\n            return this.Block(false);\n        }\n    }\n};\n","module.exports = {\n    'font-face': require('./font-face'),\n    'import': require('./import'),\n    'media': require('./media'),\n    'page': require('./page'),\n    'supports': require('./supports')\n};\n","module.exports = {\n    parse: function() {\n        return this.createSingleNodeList(\n            this.Identifier()\n        );\n    }\n};\n","module.exports = {\n    parse: function() {\n        return this.createSingleNodeList(\n            this.SelectorList()\n        );\n    }\n};\n","module.exports = {\n    parse: function() {\n        return this.createSingleNodeList(\n            this.Identifier()\n        );\n    }\n};\n","module.exports = {\n    parse: function selectorList() {\n        return this.createSingleNodeList(\n            this.SelectorList()\n        );\n    }\n};\n","module.exports = require('./common/selectorList');\n","module.exports = require('./common/selectorList');\n","var ALLOW_OF_CLAUSE = true;\n\nmodule.exports = {\n    parse: function nthWithOfClause() {\n        return this.createSingleNodeList(\n            this.Nth(ALLOW_OF_CLAUSE)\n        );\n    }\n};\n","module.exports = require('./common/nthWithOfClause');\n","module.exports = require('./common/nthWithOfClause');\n","var DISALLOW_OF_CLAUSE = false;\n\nmodule.exports = {\n    parse: function nth() {\n        return this.createSingleNodeList(\n            this.Nth(DISALLOW_OF_CLAUSE)\n        );\n    }\n};\n","module.exports = require('./common/nth');\n","module.exports = require('./common/nth');\n","module.exports = {\n    parse: function compoundSelector() {\n        return this.createSingleNodeList(\n            this.Selector()\n        );\n    }\n};\n","module.exports = {\n    'dir': require('./dir'),\n    'has': require('./has'),\n    'lang': require('./lang'),\n    'matches': require('./matches'),\n    'not': require('./not'),\n    'nth-child': require('./nth-child'),\n    'nth-last-child': require('./nth-last-child'),\n    'nth-last-of-type': require('./nth-last-of-type'),\n    'nth-of-type': require('./nth-of-type'),\n    'slotted': require('./slotted')\n};\n","module.exports = {\n    parseContext: {\n        default: 'StyleSheet',\n        stylesheet: 'StyleSheet',\n        atrule: 'Atrule',\n        atrulePrelude: function(options) {\n            return this.AtrulePrelude(options.atrule ? String(options.atrule) : null);\n        },\n        mediaQueryList: 'MediaQueryList',\n        mediaQuery: 'MediaQuery',\n        rule: 'Rule',\n        selectorList: 'SelectorList',\n        selector: 'Selector',\n        block: function() {\n            return this.Block(true);\n        },\n        declarationList: 'DeclarationList',\n        declaration: 'Declaration',\n        value: 'Value'\n    },\n    scope: require('../scope'),\n    atrule: require('../atrule'),\n    pseudo: require('../pseudo'),\n    node: require('../node')\n};\n","module.exports = {\n    node: require('../node')\n};\n","function merge() {\n    var dest = {};\n\n    for (var i = 0; i < arguments.length; i++) {\n        var src = arguments[i];\n        for (var key in src) {\n            dest[key] = src[key];\n        }\n    }\n\n    return dest;\n}\n\nmodule.exports = require('./create').create(\n    merge(\n        require('./config/lexer'),\n        require('./config/parser'),\n        require('./config/walker')\n    )\n);\nmodule.exports.version = require('../../package.json').version;\n","module.exports = require('./syntax');\n","import csstree from \"css-tree\";\nimport { UUID } from \"../utils/utils.js\";\nimport Hook from \"../utils/hook.js\";\n\nclass Sheet {\n\tconstructor(url, hooks) {\n\n\t\tif (hooks) {\n\t\t\tthis.hooks = hooks;\n\t\t} else {\n\t\t\tthis.hooks = {};\n\t\t\tthis.hooks.onUrl = new Hook(this);\n\t\t\tthis.hooks.onAtPage = new Hook(this);\n\t\t\tthis.hooks.onAtMedia = new Hook(this);\n\t\t\tthis.hooks.onRule = new Hook(this);\n\t\t\tthis.hooks.onDeclaration = new Hook(this);\n\t\t\tthis.hooks.onSelector = new Hook(this);\n\t\t\tthis.hooks.onPseudoSelector = new Hook(this);\n\n\t\t\tthis.hooks.onContent = new Hook(this);\n\t\t\tthis.hooks.onImport = new Hook(this);\n\n\t\t\tthis.hooks.beforeTreeParse = new Hook(this);\n\t\t\tthis.hooks.beforeTreeWalk = new Hook(this);\n\t\t\tthis.hooks.afterTreeWalk = new Hook(this);\n\t\t}\n\n\t\ttry {\n\t\t\tthis.url = new URL(url, window.location.href);\n\t\t} catch (e) {\n\t\t\tthis.url = new URL(window.location.href);\n\t\t}\n\t}\n\n\n\n\t// parse\n\tasync parse(text) {\n\t\tthis.text = text;\n\n\t\tawait this.hooks.beforeTreeParse.trigger(this.text, this);\n\n\t\t// send to csstree\n\t\tthis.ast = csstree.parse(this._text);\n\n\t\tawait this.hooks.beforeTreeWalk.trigger(this.ast);\n\n\t\t// Replace urls\n\t\tthis.replaceUrls(this.ast);\n\n\t\t// Scope\n\t\tthis.id = UUID();\n\t\t// this.addScope(this.ast, this.uuid);\n\n\t\t// Replace IDs with data-id\n\t\tthis.replaceIds(this.ast);\n\n\t\tthis.imported = [];\n\n\t\t// Trigger Hooks\n\t\tthis.urls(this.ast);\n\t\tthis.rules(this.ast);\n\t\tthis.atrules(this.ast);\n\n\t\tawait this.hooks.afterTreeWalk.trigger(this.ast, this);\n\n\t\t// return ast\n\t\treturn this.ast;\n\t}\n\n\n\n\tinsertRule(rule) {\n\t\tlet inserted = this.ast.children.appendData(rule);\n\n\t\tthis.declarations(rule);\n\n\t\treturn inserted;\n\t}\n\n\turls(ast) {\n\t\tcsstree.walk(ast, {\n\t\t\tvisit: \"Url\",\n\t\t\tenter: (node, item, list) => {\n\t\t\t\tthis.hooks.onUrl.trigger(node, item, list);\n\t\t\t}\n\t\t});\n\t}\n\n\tatrules(ast) {\n\t\tcsstree.walk(ast, {\n\t\t\tvisit: \"Atrule\",\n\t\t\tenter: (node, item, list) => {\n\t\t\t\tconst basename = csstree.keyword(node.name).basename;\n\n\t\t\t\tif (basename === \"page\") {\n\t\t\t\t\tthis.hooks.onAtPage.trigger(node, item, list);\n\t\t\t\t\tthis.declarations(node, item, list);\n\t\t\t\t}\n\n\t\t\t\tif (basename === \"media\") {\n\t\t\t\t\tthis.hooks.onAtMedia.trigger(node, item, list);\n\t\t\t\t\tthis.declarations(node, item, list);\n\t\t\t\t}\n\n\t\t\t\tif (basename === \"import\") {\n\t\t\t\t\tthis.hooks.onImport.trigger(node, item, list);\n\t\t\t\t\tthis.imports(node, item, list);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\n\trules(ast) {\n\t\tcsstree.walk(ast, {\n\t\t\tvisit: \"Rule\",\n\t\t\tenter: (ruleNode, ruleItem, rulelist) => {\n\n\t\t\t\tthis.hooks.onRule.trigger(ruleNode, ruleItem, rulelist);\n\t\t\t\tthis.declarations(ruleNode, ruleItem, rulelist);\n\t\t\t\tthis.onSelector(ruleNode, ruleItem, rulelist);\n\n\t\t\t}\n\t\t});\n\t}\n\n\tdeclarations(ruleNode, ruleItem, rulelist) {\n\t\tcsstree.walk(ruleNode, {\n\t\t\tvisit: \"Declaration\",\n\t\t\tenter: (declarationNode, dItem, dList) => {\n\n\t\t\t\tthis.hooks.onDeclaration.trigger(declarationNode, dItem, dList, {ruleNode, ruleItem, rulelist});\n\n\t\t\t\tif (declarationNode.property === \"content\") {\n\t\t\t\t\tcsstree.walk(declarationNode, {\n\t\t\t\t\t\tvisit: \"Function\",\n\t\t\t\t\t\tenter: (funcNode, fItem, fList) => {\n\t\t\t\t\t\t\tthis.hooks.onContent.trigger(funcNode, fItem, fList, {declarationNode, dItem, dList}, {ruleNode, ruleItem, rulelist});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t}\n\t\t});\n\t}\n\n\t// add pseudo elements to parser\n\tonSelector(ruleNode, ruleItem, rulelist) {\n\t\tcsstree.walk(ruleNode, {\n\t\t\tvisit: \"Selector\",\n\t\t\tenter: (selectNode, selectItem, selectList) => {\n\t\t\t\tthis.hooks.onSelector.trigger(selectNode, selectItem, selectList, {ruleNode, ruleItem, rulelist});\n\n\t\t\t\tif (selectNode.children.forEach(node => {if (node.type === \"PseudoElementSelector\") {\n\t\t\t\t\tcsstree.walk(node, {\n\t\t\t\t\t\tvisit: \"PseudoElementSelector\",\n\t\t\t\t\t\tenter: (pseudoNode, pItem, pList) => {\n\t\t\t\t\t\t\tthis.hooks.onPseudoSelector.trigger(pseudoNode, pItem, pList, {selectNode, selectItem, selectList}, {ruleNode, ruleItem, rulelist});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}}));\n\t\t\t}\n\t\t});\n\t}\n\n\treplaceUrls(ast) {\n\t\tcsstree.walk(ast, {\n\t\t\tvisit: \"Url\",\n\t\t\tenter: (node, item, list) => {\n\t\t\t\tlet content = node.value.value;\n\t\t\t\tif ((node.value.type === \"Raw\" && content.startsWith(\"data:\")) || (node.value.type === \"String\" && (content.startsWith(\"\\\"data:\") || content.startsWith(\"'data:\")))) {\n\t\t\t\t\t// data-uri should not be parsed using the URL interface.\n\t\t\t\t} else {\n\t\t\t\t\tlet href = content.replace(/[\"']/g, \"\");\n\t\t\t\t\tlet url = new URL(href, this.url);\n\t\t\t\t\tnode.value.value = url.toString();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\taddScope(ast, id) {\n\t\t// Get all selector lists\n\t\t// add an id\n\t\tcsstree.walk(ast, {\n\t\t\tvisit: \"Selector\",\n\t\t\tenter: (node, item, list) => {\n\t\t\t\tlet children = node.children;\n\t\t\t\tchildren.prepend(children.createItem({\n\t\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\t\tvalue: \" \"\n\t\t\t\t}));\n\t\t\t\tchildren.prepend(children.createItem({\n\t\t\t\t\ttype: \"IdSelector\",\n\t\t\t\t\tname: id,\n\t\t\t\t\tloc: null,\n\t\t\t\t\tchildren: null\n\t\t\t\t}));\n\t\t\t}\n\t\t});\n\t}\n\n\tgetNamedPageSelectors(ast) {\n\t\tlet namedPageSelectors = {};\n\t\tcsstree.walk(ast, {\n\t\t\tvisit: \"Rule\",\n\t\t\tenter: (node, item, list) => {\n\t\t\t\tcsstree.walk(node, {\n\t\t\t\t\tvisit: \"Declaration\",\n\t\t\t\t\tenter: (declaration, dItem, dList) => {\n\t\t\t\t\t\tif (declaration.property === \"page\") {\n\t\t\t\t\t\t\tlet value = declaration.value.children.first();\n\t\t\t\t\t\t\tlet name = value.name;\n\t\t\t\t\t\t\tlet selector = csstree.generate(node.prelude);\n\t\t\t\t\t\t\tnamedPageSelectors[name] = {\n\t\t\t\t\t\t\t\tname: name,\n\t\t\t\t\t\t\t\tselector: selector\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t// dList.remove(dItem);\n\n\t\t\t\t\t\t\t// Add in page break\n\t\t\t\t\t\t\tdeclaration.property = \"break-before\";\n\t\t\t\t\t\t\tvalue.type = \"Identifier\";\n\t\t\t\t\t\t\tvalue.name = \"always\";\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\treturn namedPageSelectors;\n\t}\n\n\treplaceIds(ast) {\n\t\tcsstree.walk(ast, {\n\t\t\tvisit: \"Rule\",\n\t\t\tenter: (node, item, list) => {\n\n\t\t\t\tcsstree.walk(node, {\n\t\t\t\t\tvisit: \"IdSelector\",\n\t\t\t\t\tenter: (idNode, idItem, idList) => {\n\t\t\t\t\t\tlet name = idNode.name;\n\t\t\t\t\t\tidNode.flags = null;\n\t\t\t\t\t\tidNode.matcher = \"=\";\n\t\t\t\t\t\tidNode.name = {type: \"Identifier\", loc: null, name: \"data-id\"};\n\t\t\t\t\t\tidNode.type = \"AttributeSelector\";\n\t\t\t\t\t\tidNode.value = {type: \"String\", loc: null, value: `\"${name}\"`};\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\timports(node, item, list) {\n\t\t// console.log(\"import\", node, item, list);\n\t\tlet queries = [];\n\t\tcsstree.walk(node, {\n\t\t\tvisit: \"MediaQuery\",\n\t\t\tenter: (mqNode, mqItem, mqList) => {\n\t\t\t\tcsstree.walk(mqNode, {\n\t\t\t\t\tvisit: \"Identifier\",\n\t\t\t\t\tenter: (identNode, identItem, identList) => {\n\t\t\t\t\t\tqueries.push(identNode.name);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t// Just basic media query support for now\n\t\tlet shouldNotApply = queries.some((query, index) => {\n\t\t\tlet q = query;\n\t\t\tif (q === \"not\") {\n\t\t\t\tq = queries[index + 1];\n\t\t\t\treturn !(q === \"screen\" || q === \"speech\");\n\t\t\t} else {\n\t\t\t\treturn (q === \"screen\" || q === \"speech\");\n\t\t\t}\n\t\t});\n\n\t\tif (shouldNotApply) {\n\t\t\treturn;\n\t\t}\n\n\t\tcsstree.walk(node, {\n\t\t\tvisit: \"String\",\n\t\t\tenter: (urlNode, urlItem, urlList) => {\n\t\t\t\tlet href = urlNode.value.replace(/[\"']/g, \"\");\n\t\t\t\tlet url = new URL(href, this.url);\n\t\t\t\tlet value = url.toString();\n\n\t\t\t\tthis.imported.push(value);\n\n\t\t\t\t// Remove the original\n\t\t\t\tlist.remove(item);\n\t\t\t}\n\t\t});\n\t}\n\n\tset text(t) {\n\t\tthis._text = t;\n\t}\n\n\tget text() {\n\t\treturn this._text;\n\t}\n\n\t// generate string\n\ttoString(ast) {\n\t\treturn csstree.generate(ast || this.ast);\n\t}\n}\n\nexport default Sheet;\n","export default `\n:root {\n\t--pagedjs-width: 8.5in;\n\t--pagedjs-height: 11in;\n\t--pagedjs-width-right: 8.5in;\n\t--pagedjs-height-right: 11in;\n\t--pagedjs-width-left: 8.5in;\n\t--pagedjs-height-left: 11in;\n\t--pagedjs-pagebox-width: 8.5in;\n\t--pagedjs-pagebox-height: 11in;\n\t--pagedjs-footnotes-height: 0mm;\n\t--pagedjs-margin-top: 1in;\n\t--pagedjs-margin-right: 1in;\n\t--pagedjs-margin-bottom: 1in;\n\t--pagedjs-margin-left: 1in;\n\t--pagedjs-padding-top: 0mm;\n\t--pagedjs-padding-right: 0mm;\n\t--pagedjs-padding-bottom: 0mm;\n\t--pagedjs-padding-left: 0mm;\n\t--pagedjs-border-top: 0mm;\n\t--pagedjs-border-right: 0mm;\n\t--pagedjs-border-bottom: 0mm;\n\t--pagedjs-border-left: 0mm;\n\t--pagedjs-bleed-top: 0mm;\n\t--pagedjs-bleed-right: 0mm;\n\t--pagedjs-bleed-bottom: 0mm;\n\t--pagedjs-bleed-left: 0mm;\n\t--pagedjs-bleed-right-top: 0mm;\n\t--pagedjs-bleed-right-right: 0mm;\n\t--pagedjs-bleed-right-bottom: 0mm;\n\t--pagedjs-bleed-right-left: 0mm;\n\t--pagedjs-bleed-left-top: 0mm;\n\t--pagedjs-bleed-left-right: 0mm;\n\t--pagedjs-bleed-left-bottom: 0mm;\n\t--pagedjs-bleed-left-left: 0mm;\n\t--pagedjs-crop-color: black;\n\t--pagedjs-crop-shadow: white;\n\t--pagedjs-crop-offset: 2mm;\n\t--pagedjs-crop-stroke: 1px;\n\t--pagedjs-cross-size: 5mm;\n\t--pagedjs-mark-cross-display: none;\n\t--pagedjs-mark-crop-display: none;\n\t--pagedjs-page-count: 0;\n\t--pagedjs-page-counter-increment: 1;\n\t--pagedjs-footnotes-count: 0;\n\t--pagedjs-column-gap-offset: 1000px;\n}\n\n@page {\n\tsize: letter;\n\tmargin: 0;\n}\n\n.pagedjs_sheet {\n\tbox-sizing: border-box;\n\twidth: var(--pagedjs-width);\n\theight: var(--pagedjs-height);\n\toverflow: hidden;\n\tposition: relative;\n\tdisplay: grid;\n\tgrid-template-columns: [bleed-left] var(--pagedjs-bleed-left) [sheet-center] calc(var(--pagedjs-width) - var(--pagedjs-bleed-left) - var(--pagedjs-bleed-right)) [bleed-right] var(--pagedjs-bleed-right);\n\tgrid-template-rows: [bleed-top] var(--pagedjs-bleed-top) [sheet-middle] calc(var(--pagedjs-height) - var(--pagedjs-bleed-top) - var(--pagedjs-bleed-bottom)) [bleed-bottom] var(--pagedjs-bleed-bottom);\n}\n\n.pagedjs_right_page .pagedjs_sheet {\n\twidth: var(--pagedjs-width-right);\n\theight: var(--pagedjs-height-right);\n\tgrid-template-columns: [bleed-left] var(--pagedjs-bleed-right-left) [sheet-center] calc(var(--pagedjs-width) - var(--pagedjs-bleed-right-left) - var(--pagedjs-bleed-right-right)) [bleed-right] var(--pagedjs-bleed-right-right);\n\tgrid-template-rows: [bleed-top] var(--pagedjs-bleed-right-top) [sheet-middle] calc(var(--pagedjs-height) - var(--pagedjs-bleed-right-top) - var(--pagedjs-bleed-right-bottom)) [bleed-bottom] var(--pagedjs-bleed-right-bottom);\n}\n\n.pagedjs_left_page .pagedjs_sheet {\n\twidth: var(--pagedjs-width-left);\n\theight: var(--pagedjs-height-left);\n\tgrid-template-columns: [bleed-left] var(--pagedjs-bleed-left-left) [sheet-center] calc(var(--pagedjs-width) - var(--pagedjs-bleed-left-left) - var(--pagedjs-bleed-left-right)) [bleed-right] var(--pagedjs-bleed-left-right);\n\tgrid-template-rows: [bleed-top] var(--pagedjs-bleed-left-top) [sheet-middle] calc(var(--pagedjs-height) - var(--pagedjs-bleed-left-top) - var(--pagedjs-bleed-left-bottom)) [bleed-bottom] var(--pagedjs-bleed-left-bottom);\n}\n\n.pagedjs_bleed {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tflex-wrap: nowrap;\n\toverflow: hidden;\n}\n\n.pagedjs_bleed-top {\n\tgrid-column: bleed-left / -1;\n\tgrid-row: bleed-top;\n\tflex-direction: row;\n}\n\n.pagedjs_bleed-bottom {\n\tgrid-column: bleed-left / -1;\n\tgrid-row: bleed-bottom;\n\tflex-direction: row;\n}\n\n.pagedjs_bleed-left {\n\tgrid-column: bleed-left;\n\tgrid-row: bleed-top / -1;\n\tflex-direction: column;\n}\n\n.pagedjs_bleed-right {\n\tgrid-column: bleed-right;\n\tgrid-row: bleed-top / -1;\n\tflex-direction: column;\n}\n\n.pagedjs_marks-crop {\n\tdisplay: var(--pagedjs-mark-crop-display);\n\tflex-grow: 0;\n\tflex-shrink: 0;\n\tz-index: 9999999999;\n}\n\n.pagedjs_bleed-top .pagedjs_marks-crop:nth-child(1),\n.pagedjs_bleed-bottom .pagedjs_marks-crop:nth-child(1) {\n\twidth: calc(var(--pagedjs-bleed-left) - var(--pagedjs-crop-stroke));\n\tborder-right: var(--pagedjs-crop-stroke) solid var(--pagedjs-crop-color);\n\tbox-shadow: 1px 0px 0px 0px var(--pagedjs-crop-shadow);\n}\n\n.pagedjs_right_page .pagedjs_bleed-top .pagedjs_marks-crop:nth-child(1),\n.pagedjs_right_page .pagedjs_bleed-bottom .pagedjs_marks-crop:nth-child(1) {\n\twidth: calc(var(--pagedjs-bleed-right-left) - var(--pagedjs-crop-stroke));\n}\n\n.pagedjs_left_page .pagedjs_bleed-top .pagedjs_marks-crop:nth-child(1),\n.pagedjs_left_page .pagedjs_bleed-bottom .pagedjs_marks-crop:nth-child(1) {\n\twidth: calc(var(--pagedjs-bleed-left-left) - var(--pagedjs-crop-stroke));\n}\n\n.pagedjs_bleed-top .pagedjs_marks-crop:nth-child(3),\n.pagedjs_bleed-bottom .pagedjs_marks-crop:nth-child(3) {\n\twidth: calc(var(--pagedjs-bleed-right) - var(--pagedjs-crop-stroke));\n\tborder-left: var(--pagedjs-crop-stroke) solid var(--pagedjs-crop-color);\n\tbox-shadow: -1px 0px 0px 0px var(--pagedjs-crop-shadow);\n}\n\n.pagedjs_right_page .pagedjs_bleed-top .pagedjs_marks-crop:nth-child(3),\n.pagedjs_right_page .pagedjs_bleed-bottom .pagedjs_marks-crop:nth-child(3) {\n\twidth: calc(var(--pagedjs-bleed-right-right) - var(--pagedjs-crop-stroke));\n}\n\n.pagedjs_left_page .pagedjs_bleed-top .pagedjs_marks-crop:nth-child(3),\n.pagedjs_left_page .pagedjs_bleed-bottom .pagedjs_marks-crop:nth-child(3) {\n\twidth: calc(var(--pagedjs-bleed-left-right) - var(--pagedjs-crop-stroke));\n}\n\n.pagedjs_bleed-top .pagedjs_marks-crop {\n\talign-self: flex-start;\n\theight: calc(var(--pagedjs-bleed-top) - var(--pagedjs-crop-offset));\n}\n\n.pagedjs_right_page .pagedjs_bleed-top .pagedjs_marks-crop {\n\theight: calc(var(--pagedjs-bleed-right-top) - var(--pagedjs-crop-offset));\n}\n\n.pagedjs_left_page .pagedjs_bleed-top .pagedjs_marks-crop {\n\theight: calc(var(--pagedjs-bleed-left-top) - var(--pagedjs-crop-offset));\n}\n\n.pagedjs_bleed-bottom .pagedjs_marks-crop {\n\talign-self: flex-end;\n\theight: calc(var(--pagedjs-bleed-bottom) - var(--pagedjs-crop-offset));\n}\n\n.pagedjs_right_page .pagedjs_bleed-bottom .pagedjs_marks-crop {\n\theight: calc(var(--pagedjs-bleed-right-bottom) - var(--pagedjs-crop-offset));\n}\n\n.pagedjs_left_page .pagedjs_bleed-bottom .pagedjs_marks-crop {\n\theight: calc(var(--pagedjs-bleed-left-bottom) - var(--pagedjs-crop-offset));\n}\n\n.pagedjs_bleed-left .pagedjs_marks-crop:nth-child(1),\n.pagedjs_bleed-right .pagedjs_marks-crop:nth-child(1) {\n\theight: calc(var(--pagedjs-bleed-top) - var(--pagedjs-crop-stroke));\n\tborder-bottom: var(--pagedjs-crop-stroke) solid var(--pagedjs-crop-color);\n\tbox-shadow: 0px 1px 0px 0px var(--pagedjs-crop-shadow);\n}\n\n.pagedjs_right_page .pagedjs_bleed-left .pagedjs_marks-crop:nth-child(1),\n.pagedjs_right_page .pagedjs_bleed-right .pagedjs_marks-crop:nth-child(1) {\n\theight: calc(var(--pagedjs-bleed-right-top) - var(--pagedjs-crop-stroke));\n}\n\n.pagedjs_left_page .pagedjs_bleed-left .pagedjs_marks-crop:nth-child(1),\n.pagedjs_left_page .pagedjs_bleed-right .pagedjs_marks-crop:nth-child(1) {\n\theight: calc(var(--pagedjs-bleed-left-top) - var(--pagedjs-crop-stroke));\n}\n\n.pagedjs_bleed-left .pagedjs_marks-crop:nth-child(3),\n.pagedjs_bleed-right .pagedjs_marks-crop:nth-child(3) {\n\theight: calc(var(--pagedjs-bleed-bottom) - var(--pagedjs-crop-stroke));\n\tborder-top: var(--pagedjs-crop-stroke) solid var(--pagedjs-crop-color);\n\tbox-shadow: 0px -1px 0px 0px var(--pagedjs-crop-shadow);\n}\n\n.pagedjs_right_page .pagedjs_bleed-left .pagedjs_marks-crop:nth-child(3),\n.pagedjs_right_page .pagedjs_bleed-right .pagedjs_marks-crop:nth-child(3) {\n\theight: calc(var(--pagedjs-bleed-right-bottom) - var(--pagedjs-crop-stroke));\n}\n\n.pagedjs_left_page .pagedjs_bleed-left .pagedjs_marks-crop:nth-child(3),\n.pagedjs_left_page .pagedjs_bleed-right .pagedjs_marks-crop:nth-child(3) {\n\theight: calc(var(--pagedjs-bleed-left-bottom) - var(--pagedjs-crop-stroke));\n}\n\n.pagedjs_bleed-left .pagedjs_marks-crop {\n\twidth: calc(var(--pagedjs-bleed-left) - var(--pagedjs-crop-offset));\n\talign-self: flex-start;\n}\n\n.pagedjs_right_page .pagedjs_bleed-left .pagedjs_marks-crop {\n\twidth: calc(var(--pagedjs-bleed-right-left) - var(--pagedjs-crop-offset));\n}\n\n.pagedjs_left_page .pagedjs_bleed-left .pagedjs_marks-crop {\n\twidth: calc(var(--pagedjs-bleed-left-left) - var(--pagedjs-crop-offset));\n}\n\n.pagedjs_bleed-right .pagedjs_marks-crop {\n\twidth: calc(var(--pagedjs-bleed-right) - var(--pagedjs-crop-offset));\n\talign-self: flex-end;\n}\n\n.pagedjs_right_page .pagedjs_bleed-right .pagedjs_marks-crop {\n\twidth: calc(var(--pagedjs-bleed-right-right) - var(--pagedjs-crop-offset));\n}\n\n.pagedjs_left_page .pagedjs_bleed-right .pagedjs_marks-crop {\n\twidth: calc(var(--pagedjs-bleed-left-right) - var(--pagedjs-crop-offset));\n}\n\n.pagedjs_marks-middle {\n\tdisplay: flex;\n\tflex-grow: 1;\n\tflex-shrink: 0;\n\talign-items: center;\n\tjustify-content: center;\n}\n\n.pagedjs_marks-cross {\n\tdisplay: var(--pagedjs-mark-cross-display);\n\tbackground-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSIzMi41MzdweCIgaGVpZ2h0PSIzMi41MzdweCIgdmlld0JveD0iMC4xMDQgMC4xMDQgMzIuNTM3IDMyLjUzNyIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwLjEwNCAwLjEwNCAzMi41MzcgMzIuNTM3IiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNGRkZGRkYiIHN0cm9rZS13aWR0aD0iMy4zODkzIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGQ9Ik0yOS45MzEsMTYuMzczYzAsNy40ODktNi4wNjgsMTMuNTYtMTMuNTU4LDEzLjU2Yy03LjQ4MywwLTEzLjU1Ny02LjA3Mi0xMy41NTctMTMuNTZjMC03LjQ4Niw2LjA3NC0xMy41NTQsMTMuNTU3LTEzLjU1NEMyMy44NjIsMi44MTksMjkuOTMxLDguODg3LDI5LjkzMSwxNi4zNzN6Ii8+PGxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjRkZGRkZGIiBzdHJva2Utd2lkdGg9IjMuMzg5MyIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiB4MT0iMC4xMDQiIHkxPSIxNi4zNzMiIHgyPSIzMi42NDIiIHkyPSIxNi4zNzMiLz48bGluZSBmaWxsPSJub25lIiBzdHJva2U9IiNGRkZGRkYiIHN0cm9rZS13aWR0aD0iMy4zODkzIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHgxPSIxNi4zNzMiIHkxPSIwLjEwNCIgeDI9IjE2LjM3MyIgeTI9IjMyLjY0MiIvPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0ZGRkZGRiIgc3Ryb2tlLXdpZHRoPSIzLjM4OTMiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTI0LjUwOCwxNi4zNzNjMCw0LjQ5Ni0zLjYzOCw4LjEzNS04LjEzNSw4LjEzNWMtNC40OTEsMC04LjEzNS0zLjYzOC04LjEzNS04LjEzNWMwLTQuNDg5LDMuNjQ0LTguMTM1LDguMTM1LTguMTM1QzIwLjg2OSw4LjIzOSwyNC41MDgsMTEuODg0LDI0LjUwOCwxNi4zNzN6Ii8+PHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utd2lkdGg9IjAuNjc3OCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMjkuOTMxLDE2LjM3M2MwLDcuNDg5LTYuMDY4LDEzLjU2LTEzLjU1OCwxMy41NmMtNy40ODMsMC0xMy41NTctNi4wNzItMTMuNTU3LTEzLjU2YzAtNy40ODYsNi4wNzQtMTMuNTU0LDEzLjU1Ny0xMy41NTRDMjMuODYyLDIuODE5LDI5LjkzMSw4Ljg4NywyOS45MzEsMTYuMzczeiIvPjxsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLXdpZHRoPSIwLjY3NzgiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgeDE9IjAuMTA0IiB5MT0iMTYuMzczIiB4Mj0iMzIuNjQyIiB5Mj0iMTYuMzczIi8+PGxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utd2lkdGg9IjAuNjc3OCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiB4MT0iMTYuMzczIiB5MT0iMC4xMDQiIHgyPSIxNi4zNzMiIHkyPSIzMi42NDIiLz48cGF0aCBkPSJNMjQuNTA4LDE2LjM3M2MwLDQuNDk2LTMuNjM4LDguMTM1LTguMTM1LDguMTM1Yy00LjQ5MSwwLTguMTM1LTMuNjM4LTguMTM1LTguMTM1YzAtNC40ODksMy42NDQtOC4xMzUsOC4xMzUtOC4xMzVDMjAuODY5LDguMjM5LDI0LjUwOCwxMS44ODQsMjQuNTA4LDE2LjM3MyIvPjxsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0ZGRkZGRiIgc3Ryb2tlLXdpZHRoPSIwLjY3NzgiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgeDE9IjguMjM5IiB5MT0iMTYuMzczIiB4Mj0iMjQuNTA4IiB5Mj0iMTYuMzczIi8+PGxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjRkZGRkZGIiBzdHJva2Utd2lkdGg9IjAuNjc3OCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiB4MT0iMTYuMzczIiB5MT0iOC4yMzkiIHgyPSIxNi4zNzMiIHkyPSIyNC41MDgiLz48L3N2Zz4=);\n  background-repeat: no-repeat;\n  background-position: 50% 50%;\n  background-size: var(--pagedjs-cross-size);\n\n  z-index: 2147483647;\n\twidth: var(--pagedjs-cross-size);\n\theight: var(--pagedjs-cross-size);\n}\n\n.pagedjs_pagebox {\n\tbox-sizing: border-box;\n\twidth: var(--pagedjs-pagebox-width);\n\theight: var(--pagedjs-pagebox-height);\n\tposition: relative;\n\tdisplay: grid;\n\tgrid-template-columns: [left] var(--pagedjs-margin-left) [center] calc(var(--pagedjs-pagebox-width) - var(--pagedjs-margin-left) - var(--pagedjs-margin-right)) [right] var(--pagedjs-margin-right);\n\tgrid-template-rows: [header] var(--pagedjs-margin-top) [page] calc(var(--pagedjs-pagebox-height) - var(--pagedjs-margin-top) - var(--pagedjs-margin-bottom)) [footer] var(--pagedjs-margin-bottom);\n\tgrid-column: sheet-center;\n\tgrid-row: sheet-middle;\n}\n\n.pagedjs_pagebox * {\n\tbox-sizing: border-box;\n}\n\n.pagedjs_margin-top {\n\twidth: calc(var(--pagedjs-pagebox-width) - var(--pagedjs-margin-left) - var(--pagedjs-margin-right));\n\theight: var(--pagedjs-margin-top);\n\tgrid-column: center;\n\tgrid-row: header;\n\tflex-wrap: nowrap;\n\tdisplay: grid;\n\tgrid-template-columns: repeat(3, 1fr);\n\tgrid-template-rows: 100%;\n}\n\n.pagedjs_margin-top-left-corner-holder {\n\twidth: var(--pagedjs-margin-left);\n\theight: var(--pagedjs-margin-top);\n\tdisplay: flex;\n\tgrid-column: left;\n\tgrid-row: header;\n}\n\n.pagedjs_margin-top-right-corner-holder {\n\twidth: var(--pagedjs-margin-right);\n\theight: var(--pagedjs-margin-top);\n\tdisplay: flex;\n\tgrid-column: right;\n\tgrid-row: header;\n}\n\n.pagedjs_margin-top-left-corner {\n\twidth: var(--pagedjs-margin-left);\n}\n\n.pagedjs_margin-top-right-corner {\n\twidth: var(--pagedjs-margin-right);\n}\n\n.pagedjs_margin-right {\n\theight: calc(var(--pagedjs-pagebox-height) - var(--pagedjs-margin-top) - var(--pagedjs-margin-bottom));\n\twidth: var(--pagedjs-margin-right);\n\tright: 0;\n\tgrid-column: right;\n\tgrid-row: page;\n\tdisplay: grid;\n\tgrid-template-rows: repeat(3, 33.3333%);\n\tgrid-template-columns: 100%;\n}\n\n.pagedjs_margin-bottom {\n\twidth: calc(var(--pagedjs-pagebox-width) - var(--pagedjs-margin-left) - var(--pagedjs-margin-right));\n\theight: var(--pagedjs-margin-bottom);\n\tgrid-column: center;\n\tgrid-row: footer;\n\tdisplay: grid;\n\tgrid-template-columns: repeat(3, 1fr);\n\tgrid-template-rows: 100%;\n}\n\n.pagedjs_margin-bottom-left-corner-holder {\n\twidth: var(--pagedjs-margin-left);\n\theight: var(--pagedjs-margin-bottom);\n\tdisplay: flex;\n\tgrid-column: left;\n\tgrid-row: footer;\n}\n\n.pagedjs_margin-bottom-right-corner-holder {\n\twidth: var(--pagedjs-margin-right);\n\theight: var(--pagedjs-margin-bottom);\n\tdisplay: flex;\n\tgrid-column: right;\n\tgrid-row: footer;\n}\n\n.pagedjs_margin-bottom-left-corner {\n\twidth: var(--pagedjs-margin-left);\n}\n\n.pagedjs_margin-bottom-right-corner {\n\twidth: var(--pagedjs-margin-right);\n}\n\n\n\n.pagedjs_margin-left {\n\theight: calc(var(--pagedjs-pagebox-height) - var(--pagedjs-margin-top) - var(--pagedjs-margin-bottom));\n\twidth: var(--pagedjs-margin-left);\n\tgrid-column: left;\n\tgrid-row: page;\n\tdisplay: grid;\n\tgrid-template-rows: repeat(3, 33.33333%);\n\tgrid-template-columns: 100%;\n}\n\n.pagedjs_pages .pagedjs_pagebox .pagedjs_margin:not(.hasContent) {\n\tvisibility: hidden;\n}\n\n.pagedjs_pagebox > .pagedjs_area {\n\tgrid-column: center;\n\tgrid-row: page;\n\twidth: 100%;\n\theight: 100%;\n\tpadding: var(--pagedjs-padding-top) var(--pagedjs-padding-right) var(--pagedjs-padding-bottom) var(--pagedjs-padding-left);\n\tborder-top: var(--pagedjs-border-top);\n\tborder-right: var(--pagedjs-border-right);\n\tborder-bottom: var(--pagedjs-border-bottom);\n\tborder-left: var(--pagedjs-border-left);\n}\n\n.pagedjs_pagebox > .pagedjs_area > .pagedjs_page_content {\n\twidth: 100%;\n\theight: calc(100% - var(--pagedjs-footnotes-height));\n\tposition: relative;\n\tcolumn-fill: auto;\n}\n\n.pagedjs_pagebox > .pagedjs_area > .pagedjs_page_content > div {\n\theight: inherit;\n}\n\n.pagedjs_pagebox > .pagedjs_area > .pagedjs_footnote_area {\n\tposition: relative;\n\toverflow: hidden;\n\theight: var(--pagedjs-footnotes-height);\n\tdisplay: flex;\n    justify-content: flex-end;\n    flex-flow: column;\n}\n\n.pagedjs_pagebox > .pagedjs_area > .pagedjs_footnote_area > .pagedjs_footnote_content {\n\toverflow: hidden;\n}\n\n.pagedjs_pagebox > .pagedjs_area > .pagedjs_footnote_area > .pagedjs_footnote_inner_content {\n\toverflow: hidden;\n}\n\n.pagedjs_area [data-footnote-call] {\n\tall: unset;\n\tcounter-increment: footnote;\n}\n\n.pagedjs_area [data-split-from] {\n\tcounter-increment: unset;\n\tcounter-reset: unset;\n}\n\n[data-footnote-call]::after {\n\tvertical-align: super;\n\tfont-size: 65%;\n\tline-height: normal;\n\tcontent: counter(footnote);\n}\n\n@supports ( font-variant-position: super ) {\n\t[data-footnote-call]::after {\n\t\tvertical-align: baseline;\n\t\tfont-size: 100%;\n\t\tline-height: inherit;\n\t\tfont-variant-position: super;\n\t}\n}\n\n.pagedjs_footnote_empty {\n\tdisplay: none;\n}\n\n.pagedjs_area [data-split-from] {\n\tcounter-increment: unset;\n\tcounter-reset: unset;\n}\n\n[data-footnote-marker] {\n\ttext-indent: 0;\n\tdisplay: list-item;\n\tlist-style-position: inside;\n}\n\n[data-footnote-marker][data-split-from] {\n\tlist-style: none;\n}\n\n[data-footnote-marker]:not([data-split-from]) {\n\tcounter-increment: footnote-marker;\n}\n\n[data-footnote-marker]::marker {\n\tcontent: counter(footnote-marker) \". \";\n}\n\n[data-footnote-marker][data-split-from]::marker {\n\tcontent: unset;\n}\n\n.pagedjs_area .pagedjs_footnote_inner_content [data-note-display=\"inline\"] {\n \tdisplay: inline;\n}\n\n.pagedjs_page {\n\tcounter-increment: page var(--pagedjs-page-counter-increment);\n\twidth: var(--pagedjs-width);\n\theight: var(--pagedjs-height);\n}\n\n.pagedjs_page.pagedjs_right_page {\n\twidth: var(--pagedjs-width-right);\n\theight: var(--pagedjs-height-right);\n}\n\n.pagedjs_page.pagedjs_left_page {\n\twidth: var(--pagedjs-width-left);\n\theight: var(--pagedjs-height-left);\n}\n\n.pagedjs_pages {\n\tcounter-reset: pages var(--pagedjs-page-count) footnote var(--pagedjs-footnotes-count) footnote-marker var(--pagedjs-footnotes-count);\n}\n\n.pagedjs_pagebox .pagedjs_margin-top-left-corner,\n.pagedjs_pagebox .pagedjs_margin-top-right-corner,\n.pagedjs_pagebox .pagedjs_margin-bottom-left-corner,\n.pagedjs_pagebox .pagedjs_margin-bottom-right-corner,\n.pagedjs_pagebox .pagedjs_margin-top-left,\n.pagedjs_pagebox .pagedjs_margin-top-right,\n.pagedjs_pagebox .pagedjs_margin-bottom-left,\n.pagedjs_pagebox .pagedjs_margin-bottom-right,\n.pagedjs_pagebox .pagedjs_margin-top-center,\n.pagedjs_pagebox .pagedjs_margin-bottom-center,\n.pagedjs_pagebox .pagedjs_margin-top-center,\n.pagedjs_pagebox .pagedjs_margin-bottom-center,\n.pagedjs_margin-right-middle,\n.pagedjs_margin-left-middle  {\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.pagedjs_margin-right-top,\n.pagedjs_margin-left-top  {\n\tdisplay: flex;\n\talign-items: flex-top;\n}\n\n\n.pagedjs_margin-right-bottom,\n.pagedjs_margin-left-bottom  {\n\tdisplay: flex;\n\talign-items: flex-end;\n}\n\n\n\n/*\n.pagedjs_pagebox .pagedjs_margin-top-center,\n.pagedjs_pagebox .pagedjs_margin-bottom-center {\n\theight: 100%;\n\tdisplay: none;\n\talign-items: center;\n\tflex: 1 0 33%;\n\tmargin: 0 auto;\n}\n\n.pagedjs_pagebox .pagedjs_margin-top-left-corner,\n.pagedjs_pagebox .pagedjs_margin-top-right-corner,\n.pagedjs_pagebox .pagedjs_margin-bottom-right-corner,\n.pagedjs_pagebox .pagedjs_margin-bottom-left-corner {\n\tdisplay: none;\n\talign-items: center;\n}\n\n.pagedjs_pagebox .pagedjs_margin-left-top,\n.pagedjs_pagebox .pagedjs_margin-right-top {\n\tdisplay: none;\n\talign-items: flex-start;\n}\n\n.pagedjs_pagebox .pagedjs_margin-right-middle,\n.pagedjs_pagebox .pagedjs_margin-left-middle {\n\tdisplay: none;\n\talign-items: center;\n}\n\n.pagedjs_pagebox .pagedjs_margin-left-bottom,\n.pagedjs_pagebox .pagedjs_margin-right-bottom {\n\tdisplay: none;\n\talign-items: flex-end;\n}\n*/\n\n.pagedjs_pagebox .pagedjs_margin-top-left,\n.pagedjs_pagebox .pagedjs_margin-top-right-corner,\n.pagedjs_pagebox .pagedjs_margin-bottom-left,\n.pagedjs_pagebox .pagedjs_margin-bottom-right-corner { text-align: left; }\n\n.pagedjs_pagebox .pagedjs_margin-top-left-corner,\n.pagedjs_pagebox .pagedjs_margin-top-right,\n.pagedjs_pagebox .pagedjs_margin-bottom-left-corner,\n.pagedjs_pagebox .pagedjs_margin-bottom-right { text-align: right; }\n\n.pagedjs_pagebox .pagedjs_margin-top-center,\n.pagedjs_pagebox .pagedjs_margin-bottom-center,\n.pagedjs_pagebox .pagedjs_margin-left-top,\n.pagedjs_pagebox .pagedjs_margin-left-middle,\n.pagedjs_pagebox .pagedjs_margin-left-bottom,\n.pagedjs_pagebox .pagedjs_margin-right-top,\n.pagedjs_pagebox .pagedjs_margin-right-middle,\n.pagedjs_pagebox .pagedjs_margin-right-bottom { text-align: center; }\n\n.pagedjs_pages .pagedjs_margin .pagedjs_margin-content {\n\twidth: 100%;\n}\n\n.pagedjs_pages .pagedjs_margin-left .pagedjs_margin-content::after,\n.pagedjs_pages .pagedjs_margin-top .pagedjs_margin-content::after,\n.pagedjs_pages .pagedjs_margin-right .pagedjs_margin-content::after,\n.pagedjs_pages .pagedjs_margin-bottom .pagedjs_margin-content::after {\n\tdisplay: block;\n}\n\n.pagedjs_pages > .pagedjs_page > .pagedjs_sheet > .pagedjs_pagebox > .pagedjs_area > div [data-split-to] {\n\tmargin-bottom: unset;\n\tpadding-bottom: unset;\n}\n\n.pagedjs_pages > .pagedjs_page > .pagedjs_sheet > .pagedjs_pagebox > .pagedjs_area > div [data-split-from] {\n\ttext-indent: unset;\n\tmargin-top: unset;\n\tpadding-top: unset;\n\tinitial-letter: unset;\n}\n\n.pagedjs_pages > .pagedjs_page > .pagedjs_sheet > .pagedjs_pagebox > .pagedjs_area > div [data-split-from] > *::first-letter,\n.pagedjs_pages > .pagedjs_page > .pagedjs_sheet > .pagedjs_pagebox > .pagedjs_area > div [data-split-from]::first-letter {\n\tcolor: unset;\n\tfont-size: unset;\n\tfont-weight: unset;\n\tfont-family: unset;\n\tcolor: unset;\n\tline-height: unset;\n\tfloat: unset;\n\tpadding: unset;\n\tmargin: unset;\n}\n\n.pagedjs_pages > .pagedjs_page > .pagedjs_sheet > .pagedjs_pagebox > .pagedjs_area > div [data-split-to]:not([data-footnote-call]):after,\n.pagedjs_pages > .pagedjs_page > .pagedjs_sheet > .pagedjs_pagebox > .pagedjs_area > div [data-split-to]:not([data-footnote-call])::after {\n\tcontent: unset;\n}\n\n.pagedjs_pages > .pagedjs_page > .pagedjs_sheet > .pagedjs_pagebox > .pagedjs_area > div [data-split-from]:not([data-footnote-call]):before,\n.pagedjs_pages > .pagedjs_page > .pagedjs_sheet > .pagedjs_pagebox > .pagedjs_area > div [data-split-from]:not([data-footnote-call])::before {\n\tcontent: unset;\n}\n\n.pagedjs_pages > .pagedjs_page > .pagedjs_sheet > .pagedjs_pagebox > .pagedjs_area > div li[data-split-from]:first-of-type {\n\tlist-style: none;\n}\n\n/*\n[data-page]:not([data-split-from]),\n[data-break-before=\"page\"]:not([data-split-from]),\n[data-break-before=\"always\"]:not([data-split-from]),\n[data-break-before=\"left\"]:not([data-split-from]),\n[data-break-before=\"right\"]:not([data-split-from]),\n[data-break-before=\"recto\"]:not([data-split-from]),\n[data-break-before=\"verso\"]:not([data-split-from])\n{\n\tbreak-before: column;\n}\n\n[data-page]:not([data-split-to]),\n[data-break-after=\"page\"]:not([data-split-to]),\n[data-break-after=\"always\"]:not([data-split-to]),\n[data-break-after=\"left\"]:not([data-split-to]),\n[data-break-after=\"right\"]:not([data-split-to]),\n[data-break-after=\"recto\"]:not([data-split-to]),\n[data-break-after=\"verso\"]:not([data-split-to])\n{\n\tbreak-after: column;\n}\n*/\n\n.pagedjs_clear-after::after {\n\tcontent: none !important;\n}\n\n[data-align-last-split-element='justify'] {\n\ttext-align-last: justify;\n}\n\n\n@media print {\n\thtml {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\t-webkit-print-color-adjust: exact;\n\t\tprint-color-adjust: exact;\n\t}\n\tbody {\n\t\tmargin: 0;\n\t\tpadding: 0;\n\t\twidth: 100% !important;\n\t\theight: 100% !important;\n\t\tmin-width: 100%;\n\t\tmax-width: 100%;\n\t\tmin-height: 100%;\n\t\tmax-height: 100%;\n\t}\n\t.pagedjs_pages {\n\t\twidth: auto;\n\t\tdisplay: block !important;\n\t\ttransform: none !important;\n\t\theight: 100% !important;\n\t\tmin-height: 100%;\n\t\tmax-height: 100%;\n\t\toverflow: visible;\n\t}\n\t.pagedjs_page {\n\t\tmargin: 0;\n\t\tpadding: 0;\n\t\tmax-height: 100%;\n\t\tmin-height: 100%;\n\t\theight: 100% !important;\n\t\tpage-break-after: always;\n\t\tbreak-after: page;\n\t}\n\t.pagedjs_sheet {\n\t\tmargin: 0;\n\t\tpadding: 0;\n\t\tmax-height: 100%;\n\t\tmin-height: 100%;\n\t\theight: 100% !important;\n\t}\n}\n`;\n","export default async function request(url, options={}) {\n\treturn new Promise(function(resolve, reject) {\n\t\tlet request = new XMLHttpRequest();\n\n\t\trequest.open(options.method || \"get\", url, true);\n\n\t\tfor (let i in options.headers) {\n\t\t\trequest.setRequestHeader(i, options.headers[i]);\n\t\t}\n\n\t\trequest.withCredentials = options.credentials === \"include\";\n\n\t\trequest.onload = () => {\n\t\t\t// Chrome returns a status code of 0 for local files\n\t\t\tconst status = request.status === 0 && url.startsWith(\"file://\") ? 200 : request.status;\n\t\t\tresolve(new Response(request.responseText, {status}));\n\t\t};\n\n\t\trequest.onerror = reject;\n\n\t\trequest.send(options.body || null);\n\t});\n}\n","import Sheet from \"./sheet.js\";\nimport baseStyles from \"./base.js\";\nimport Hook from \"../utils/hook.js\";\nimport request from \"../utils/request.js\";\n\nclass Polisher {\n\tconstructor(setup) {\n\t\tthis.sheets = [];\n\t\tthis.inserted = [];\n\n\t\tthis.hooks = {};\n\t\tthis.hooks.onUrl = new Hook(this);\n\t\tthis.hooks.onAtPage = new Hook(this);\n\t\tthis.hooks.onAtMedia = new Hook(this);\n\t\tthis.hooks.onRule = new Hook(this);\n\t\tthis.hooks.onDeclaration = new Hook(this);\n\t\tthis.hooks.onContent = new Hook(this);\n\t\tthis.hooks.onSelector = new Hook(this);\n\t\tthis.hooks.onPseudoSelector = new Hook(this);\n\n\t\tthis.hooks.onImport = new Hook(this);\n\n\t\tthis.hooks.beforeTreeParse = new Hook(this);\n\t\tthis.hooks.beforeTreeWalk = new Hook(this);\n\t\tthis.hooks.afterTreeWalk = new Hook(this);\n\n\t\tif (setup !== false) {\n\t\t\tthis.setup();\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.base = this.insert(baseStyles);\n\t\tthis.styleEl = document.createElement(\"style\");\n\t\tdocument.head.appendChild(this.styleEl);\n\t\tthis.styleSheet = this.styleEl.sheet;\n\t\treturn this.styleSheet;\n\t}\n\n\tasync add() {\n\t\tlet fetched = [];\n\t\tlet urls = [];\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tlet f;\n\n\t\t\tif (typeof arguments[i] === \"object\") {\n\t\t\t\tfor (let url in arguments[i]) {\n\t\t\t\t\tlet obj = arguments[i];\n\t\t\t\t\tf = new Promise(function(resolve, reject) {\n\t\t\t\t\t\turls.push(url);\n\t\t\t\t\t\tresolve(obj[url]);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\turls.push(arguments[i]);\n\t\t\t\tf = request(arguments[i]).then((response) => {\n\t\t\t\t\treturn response.text();\n\t\t\t\t});\n\t\t\t}\n\n\n\t\t\tfetched.push(f);\n\t\t}\n\n\t\treturn await Promise.all(fetched)\n\t\t\t.then(async (originals) => {\n\t\t\t\tlet text = \"\";\n\t\t\t\tfor (let index = 0; index < originals.length; index++) {\n\t\t\t\t\ttext = await this.convertViaSheet(originals[index], urls[index]);\n\t\t\t\t\tthis.insert(text);\n\t\t\t\t}\n\t\t\t\treturn text;\n\t\t\t});\n\t}\n\n\tasync convertViaSheet(cssStr, href) {\n\t\tlet sheet = new Sheet(href, this.hooks);\n\t\tawait sheet.parse(cssStr);\n\n\t\t// Insert the imported sheets first\n\t\tfor (let url of sheet.imported) {\n\t\t\tlet str = await request(url).then((response) => {\n\t\t\t\treturn response.text();\n\t\t\t});\n\t\t\tlet text = await this.convertViaSheet(str, url);\n\t\t\tthis.insert(text);\n\t\t}\n\n\t\tthis.sheets.push(sheet);\n\n\t\tif (typeof sheet.width !== \"undefined\") {\n\t\t\tthis.width = sheet.width;\n\t\t}\n\t\tif (typeof sheet.height !== \"undefined\") {\n\t\t\tthis.height = sheet.height;\n\t\t}\n\t\tif (typeof sheet.orientation !== \"undefined\") {\n\t\t\tthis.orientation = sheet.orientation;\n\t\t}\n\t\treturn sheet.toString();\n\t}\n\n\tinsert(text){\n\t\tlet head = document.querySelector(\"head\");\n\t\tlet style = document.createElement(\"style\");\n\t\tstyle.setAttribute(\"data-pagedjs-inserted-styles\", \"true\");\n\n\t\tstyle.appendChild(document.createTextNode(text));\n\n\t\thead.appendChild(style);\n\n\t\tthis.inserted.push(style);\n\t\treturn style;\n\t}\n\n\tdestroy() {\n\t\tthis.styleEl.remove();\n\t\tthis.inserted.forEach((s) => {\n\t\t\ts.remove();\n\t\t});\n\t\tthis.sheets = [];\n\t}\n}\n\nexport default Polisher;\n","import EventEmitter from \"event-emitter\";\n\nclass Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tlet hooks = Object.assign({}, chunker && chunker.hooks, polisher && polisher.hooks, caller && caller.hooks);\n\t\tthis.chunker = chunker;\n\t\tthis.polisher = polisher;\n\t\tthis.caller = caller;\n\n\t\tfor (let name in hooks) {\n\t\t\tif (name in this) {\n\t\t\t\tlet hook = hooks[name];\n\t\t\t\thook.register(this[name].bind(this));\n\t\t\t}\n\t\t}\n\t}\n}\n\nEventEmitter(Handler.prototype);\n\nexport default Handler;\n","// https://www.w3.org/TR/css3-page/#page-size-prop\n\nexport default {\n\t\"A0\": {\n\t\twidth: {\n\t\t\tvalue: 841,\n\t\t\tunit: \"mm\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 1189,\n\t\t\tunit: \"mm\"\n\t\t}\n\t},\n\t\"A1\": {\n\t\twidth: {\n\t\t\tvalue: 594,\n\t\t\tunit: \"mm\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 841,\n\t\t\tunit: \"mm\"\n\t\t}\n\t},\n\t\"A2\": {\n\t\twidth: {\n\t\t\tvalue: 420,\n\t\t\tunit: \"mm\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 594,\n\t\t\tunit: \"mm\"\n\t\t}\n\t},\n\t\"A3\": {\n\t\twidth: {\n\t\t\tvalue: 297,\n\t\t\tunit: \"mm\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 420,\n\t\t\tunit: \"mm\"\n\t\t}\n\t},\n\t\"A4\": {\n\t\twidth: {\n\t\t\tvalue: 210,\n\t\t\tunit: \"mm\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 297,\n\t\t\tunit: \"mm\"\n\t\t}\n\t},\n\t\"A5\": {\n\t\twidth: {\n\t\t\tvalue: 148,\n\t\t\tunit: \"mm\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 210,\n\t\t\tunit: \"mm\"\n\t\t}\n\t},\n\t\"A6\": {\n\t\twidth: {\n\t\t\tvalue: 105,\n\t\t\tunit: \"mm\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 148,\n\t\t\tunit: \"mm\"\n\t\t}\n\t},\n\t\"A7\": {\n\t\twidth: {\n\t\t\tvalue: 74,\n\t\t\tunit: \"mm\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 105,\n\t\t\tunit: \"mm\"\n\t\t}\n\t},\n\t\"A8\": {\n\t\twidth: {\n\t\t\tvalue: 52,\n\t\t\tunit: \"mm\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 74,\n\t\t\tunit: \"mm\"\n\t\t}\n\t},\n\t\"A9\": {\n\t\twidth: {\n\t\t\tvalue: 37,\n\t\t\tunit: \"mm\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 52,\n\t\t\tunit: \"mm\"\n\t\t}\n\t},\n\t\"A10\": {\n\t\twidth: {\n\t\t\tvalue: 26,\n\t\t\tunit: \"mm\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 37,\n\t\t\tunit: \"mm\"\n\t\t}\n\t},\n\t\"B4\": {\n\t\twidth: {\n\t\t\tvalue: 250,\n\t\t\tunit: \"mm\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 353,\n\t\t\tunit: \"mm\"\n\t\t}\n\t},\n\t\"B5\": {\n\t\twidth: {\n\t\t\tvalue: 176,\n\t\t\tunit: \"mm\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 250,\n\t\t\tunit: \"mm\"\n\t\t}\n\t},\n\t\"letter\": {\n\t\twidth: {\n\t\t\tvalue: 8.5,\n\t\t\tunit: \"in\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 11,\n\t\t\tunit: \"in\"\n\t\t}\n\t},\n\t\"legal\": {\n\t\twidth: {\n\t\t\tvalue: 8.5,\n\t\t\tunit: \"in\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 14,\n\t\t\tunit: \"in\"\n\t\t}\n\t},\n\t\"ledger\": {\n\t\twidth: {\n\t\t\tvalue: 11,\n\t\t\tunit: \"in\"\n\t\t},\n\t\theight: {\n\t\t\tvalue: 17,\n\t\t\tunit: \"in\"\n\t\t}\n\t}\n};\n","import Handler from \"../handler.js\";\nimport csstree from \"css-tree\";\nimport pageSizes from \"../../polisher/sizes.js\";\nimport { rebuildAncestors } from \"../../utils/dom.js\";\nimport { CSSValueToString } from \"../../utils/utils.js\";\n\nclass AtPage extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\n\t\tthis.pages = {};\n\n\t\tthis.width = undefined;\n\t\tthis.height = undefined;\n\t\tthis.orientation = undefined;\n\t\tthis.marginalia = {};\n\t}\n\n\tpageModel(selector) {\n\t\treturn {\n\t\t\tselector: selector,\n\t\t\tname: undefined,\n\t\t\tpsuedo: undefined,\n\t\t\tnth: undefined,\n\t\t\tmarginalia: {},\n\t\t\twidth: undefined,\n\t\t\theight: undefined,\n\t\t\torientation: undefined,\n\t\t\tmargin: {\n\t\t\t\ttop: {},\n\t\t\t\tright: {},\n\t\t\t\tleft: {},\n\t\t\t\tbottom: {}\n\t\t\t},\n\t\t\tpadding: {\n\t\t\t\ttop: {},\n\t\t\t\tright: {},\n\t\t\t\tleft: {},\n\t\t\t\tbottom: {}\n\t\t\t},\n\t\t\tborder: {\n\t\t\t\ttop: {},\n\t\t\t\tright: {},\n\t\t\t\tleft: {},\n\t\t\t\tbottom: {}\n\t\t\t},\n\t\t\tbackgroundOrigin: undefined,\n\t\t\tblock: {},\n\t\t\tmarks: undefined,\n\t\t\tnotes: undefined,\n\t\t\tadded: false\n\t\t};\n\t}\n\n\t// Find and Remove @page rules\n\tonAtPage(node, item, list) {\n\t\tlet page, marginalia;\n\t\tlet selector = \"\";\n\t\tlet named, psuedo, nth;\n\t\tlet needsMerge = false;\n\n\t\tif (node.prelude) {\n\t\t\tnamed = this.getTypeSelector(node);\n\t\t\tpsuedo = this.getPsuedoSelector(node);\n\t\t\tnth = this.getNthSelector(node);\n\t\t\tselector = csstree.generate(node.prelude);\n\t\t} else {\n\t\t\tselector = \"*\";\n\t\t}\n\n\t\tif (selector in this.pages) {\n\t\t\t// this.pages[selector] = Object.assign(this.pages[selector], page);\n\t\t\t// console.log(\"after\", selector, this.pages[selector]);\n\n\t\t\t// this.pages[selector].added = false;\n\t\t\tpage = this.pages[selector];\n\t\t\tmarginalia = this.replaceMarginalia(node);\n\t\t\tneedsMerge = true;\n\t\t\t// Mark page for getting classes added again\n\t\t\tpage.added = false;\n\t\t} else {\n\t\t\tpage = this.pageModel(selector);\n\t\t\tmarginalia = this.replaceMarginalia(node);\n\t\t\tthis.pages[selector] = page;\n\t\t}\n\n\t\tpage.name = named;\n\t\tpage.psuedo = psuedo;\n\t\tpage.nth = nth;\n\n\t\tif (needsMerge) {\n\t\t\tpage.marginalia = Object.assign(page.marginalia, marginalia);\n\t\t} else {\n\t\t\tpage.marginalia = marginalia;\n\t\t}\n\n\t\tlet notes = this.replaceNotes(node);\n\t\tpage.notes = notes;\n\n\t\tlet declarations = this.replaceDeclarations(node);\n\n\t\tif (declarations.size) {\n\t\t\tpage.size = declarations.size;\n\t\t\tpage.width = declarations.size.width;\n\t\t\tpage.height = declarations.size.height;\n\t\t\tpage.orientation = declarations.size.orientation;\n\t\t\tpage.format = declarations.size.format;\n\t\t}\n\n\t\tif (declarations.bleed && declarations.bleed[0] != \"auto\") {\n\t\t\tswitch (declarations.bleed.length) {\n\t\t\t\tcase 4: // top right bottom left\n\t\t\t\t\tpage.bleed = {\n\t\t\t\t\t\ttop: declarations.bleed[0],\n\t\t\t\t\t\tright: declarations.bleed[1],\n\t\t\t\t\t\tbottom: declarations.bleed[2],\n\t\t\t\t\t\tleft: declarations.bleed[3]\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3: // top right bottom right\n\t\t\t\t\tpage.bleed = {\n\t\t\t\t\t\ttop: declarations.bleed[0],\n\t\t\t\t\t\tright: declarations.bleed[1],\n\t\t\t\t\t\tbottom: declarations.bleed[2],\n\t\t\t\t\t\tleft: declarations.bleed[1]\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2: // top right top right\n\t\t\t\t\tpage.bleed = {\n\t\t\t\t\t\ttop: declarations.bleed[0],\n\t\t\t\t\t\tright: declarations.bleed[1],\n\t\t\t\t\t\tbottom: declarations.bleed[0],\n\t\t\t\t\t\tleft: declarations.bleed[1]\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tpage.bleed = {\n\t\t\t\t\t\ttop: declarations.bleed[0],\n\t\t\t\t\t\tright: declarations.bleed[0],\n\t\t\t\t\t\tbottom: declarations.bleed[0],\n\t\t\t\t\t\tleft: declarations.bleed[0]\n\t\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tif (declarations.marks) {\n\t\t\tif (!declarations.bleed || declarations.bleed && declarations.bleed[0] === \"auto\") {\n\t\t\t\t// Spec say 6pt, but needs more space for marks\n\t\t\t\tpage.bleed = {\n\t\t\t\t\ttop: { value: 6, unit: \"mm\" },\n\t\t\t\t\tright: { value: 6, unit: \"mm\" },\n\t\t\t\t\tbottom: { value: 6, unit: \"mm\" },\n\t\t\t\t\tleft: { value: 6, unit: \"mm\" }\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tpage.marks = declarations.marks;\n\t\t}\n\n\t\tif (declarations.margin) {\n\t\t\tpage.margin = declarations.margin;\n\t\t}\n\t\tif (declarations.padding) {\n\t\t\tpage.padding = declarations.padding;\n\t\t}\n\n\t\tif (declarations.border) {\n\t\t\tpage.border = declarations.border;\n\t\t}\n\n\t\tif (declarations.marks) {\n\t\t\tpage.marks = declarations.marks;\n\t\t}\n\n\t\tif (needsMerge) {\n\t\t\tpage.block.children.appendList(node.block.children);\n\t\t} else {\n\t\t\tpage.block = node.block;\n\t\t}\n\n\t\t// Remove the rule\n\t\tlist.remove(item);\n\t}\n\n\t/* Handled in breaks */\n\t/*\n\tafterParsed(parsed) {\n\t\tfor (let b in this.named) {\n\t\t\t// Find elements\n\t\t\tlet elements = parsed.querySelectorAll(b);\n\t\t\t// Add break data\n\t\t\tfor (var i = 0; i < elements.length; i++) {\n\t\t\t\telements[i].setAttribute(\"data-page\", this.named[b]);\n\t\t\t}\n\t\t}\n\t}\n\t*/\n\n\tafterTreeWalk(ast, sheet) {\n\t\tlet dirtyPage = \"*\" in this.pages && this.pages[\"*\"].added === false;\n\n\t\tthis.addPageClasses(this.pages, ast, sheet);\n\n\t\tif (dirtyPage) {\n\t\t\tlet width = this.pages[\"*\"].width;\n\t\t\tlet height = this.pages[\"*\"].height;\n\t\t\tlet format = this.pages[\"*\"].format;\n\t\t\tlet orientation = this.pages[\"*\"].orientation;\n\t\t\tlet bleed = this.pages[\"*\"].bleed;\n\t\t\tlet marks = this.pages[\"*\"].marks;\n\t\t\tlet bleedverso = undefined;\n\t\t\tlet bleedrecto = undefined;\n\n\t\t\tif (\":left\" in this.pages) {\n\t\t\t\tbleedverso = this.pages[\":left\"].bleed;\n\t\t\t}\n\n\t\t\tif (\":right\" in this.pages) {\n\t\t\t\tbleedrecto = this.pages[\":right\"].bleed;\n\t\t\t}\n\n\t\t\tif ((width && height) &&\n\t\t\t\t(this.width !== width || this.height !== height)) {\n\t\t\t\tthis.width = width;\n\t\t\t\tthis.height = height;\n\t\t\t\tthis.format = format;\n\t\t\t\tthis.orientation = orientation;\n\n\t\t\t\tthis.addRootVars(ast, width, height, orientation, bleed, bleedrecto, bleedverso, marks);\n\t\t\t\tthis.addRootPage(ast, this.pages[\"*\"].size, bleed, bleedrecto, bleedverso);\n\n\t\t\t\tthis.emit(\"size\", { width, height, orientation, format, bleed });\n\t\t\t\tthis.emit(\"atpages\", this.pages);\n\t\t\t}\n\n\t\t}\n\t}\n\n\tgetTypeSelector(ast) {\n\t\t// Find page name\n\t\tlet name;\n\n\t\tcsstree.walk(ast, {\n\t\t\tvisit: \"TypeSelector\",\n\t\t\tenter: (node, item, list) => {\n\t\t\t\tname = node.name;\n\t\t\t}\n\t\t});\n\n\t\treturn name;\n\t}\n\n\tgetPsuedoSelector(ast) {\n\t\t// Find if it has :left & :right & :black & :first\n\t\tlet name;\n\t\tcsstree.walk(ast, {\n\t\t\tvisit: \"PseudoClassSelector\",\n\t\t\tenter: (node, item, list) => {\n\t\t\t\tif (node.name !== \"nth\") {\n\t\t\t\t\tname = node.name;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn name;\n\t}\n\n\tgetNthSelector(ast) {\n\t\t// Find if it has :nth\n\t\tlet nth;\n\t\tcsstree.walk(ast, {\n\t\t\tvisit: \"PseudoClassSelector\",\n\t\t\tenter: (node, item, list) => {\n\t\t\t\tif (node.name === \"nth\" && node.children) {\n\t\t\t\t\tlet raw = node.children.first();\n\t\t\t\t\tnth = raw.value;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn nth;\n\t}\n\n\treplaceMarginalia(ast) {\n\t\tlet parsed = {};\n\t\tconst MARGINS = [\n\t\t\t\"top-left-corner\", \"top-left\", \"top\", \"top-center\", \"top-right\", \"top-right-corner\",\n\t\t\t\"bottom-left-corner\", \"bottom-left\", \"bottom\", \"bottom-center\", \"bottom-right\", \"bottom-right-corner\",\n\t\t\t\"left-top\", \"left-middle\", \"left\", \"left-bottom\", \"top-right-corner\",\n\t\t\t\"right-top\", \"right-middle\", \"right\", \"right-bottom\", \"right-right-corner\"\n\t\t];\n\t\tcsstree.walk(ast.block, {\n\t\t\tvisit: \"Atrule\",\n\t\t\tenter: (node, item, list) => {\n\t\t\t\tlet name = node.name;\n\t\t\t\tif (MARGINS.includes(name)) {\n\t\t\t\t\tif (name === \"top\") {\n\t\t\t\t\t\tname = \"top-center\";\n\t\t\t\t\t}\n\t\t\t\t\tif (name === \"right\") {\n\t\t\t\t\t\tname = \"right-middle\";\n\t\t\t\t\t}\n\t\t\t\t\tif (name === \"left\") {\n\t\t\t\t\t\tname = \"left-middle\";\n\t\t\t\t\t}\n\t\t\t\t\tif (name === \"bottom\") {\n\t\t\t\t\t\tname = \"bottom-center\";\n\t\t\t\t\t}\n\t\t\t\t\tparsed[name] = node.block;\n\t\t\t\t\tlist.remove(item);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn parsed;\n\t}\n\n\treplaceNotes(ast) {\n\t\tlet parsed = {};\n\n\t\tcsstree.walk(ast.block, {\n\t\t\tvisit: \"Atrule\",\n\t\t\tenter: (node, item, list) => {\n\t\t\t\tlet name = node.name;\n\t\t\t\tif (name === \"footnote\") {\n\t\t\t\t\tparsed[name] = node.block;\n\t\t\t\t\tlist.remove(item);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn parsed;\n\t}\n\n\treplaceDeclarations(ast) {\n\t\tlet parsed = {};\n\n\t\tcsstree.walk(ast.block, {\n\t\t\tvisit: \"Declaration\",\n\t\t\tenter: (declaration, dItem, dList) => {\n\t\t\t\tlet prop = csstree.property(declaration.property).name;\n\t\t\t\t// let value = declaration.value;\n\n\t\t\t\tif (prop === \"marks\") {\n\t\t\t\t\tparsed.marks = [];\n\t\t\t\t\tcsstree.walk(declaration, {\n\t\t\t\t\t\tvisit: \"Identifier\",\n\t\t\t\t\t\tenter: (ident) => {\n\t\t\t\t\t\t\tparsed.marks.push(ident.name);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tdList.remove(dItem);\n\t\t\t\t} else if (prop === \"margin\") {\n\t\t\t\t\tparsed.margin = this.getMargins(declaration);\n\t\t\t\t\tdList.remove(dItem);\n\n\t\t\t\t} else if (prop.indexOf(\"margin-\") === 0) {\n\t\t\t\t\tlet m = prop.substring(\"margin-\".length);\n\t\t\t\t\tif (!parsed.margin) {\n\t\t\t\t\t\tparsed.margin = {\n\t\t\t\t\t\t\ttop: {},\n\t\t\t\t\t\t\tright: {},\n\t\t\t\t\t\t\tleft: {},\n\t\t\t\t\t\t\tbottom: {}\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tparsed.margin[m] = declaration.value.children.first();\n\t\t\t\t\tdList.remove(dItem);\n\n\t\t\t\t} else if (prop === \"padding\") {\n\t\t\t\t\tparsed.padding = this.getPaddings(declaration.value);\n\t\t\t\t\tdList.remove(dItem);\n\n\t\t\t\t} else if (prop.indexOf(\"padding-\") === 0) {\n\t\t\t\t\tlet p = prop.substring(\"padding-\".length);\n\t\t\t\t\tif (!parsed.padding) {\n\t\t\t\t\t\tparsed.padding = {\n\t\t\t\t\t\t\ttop: {},\n\t\t\t\t\t\t\tright: {},\n\t\t\t\t\t\t\tleft: {},\n\t\t\t\t\t\t\tbottom: {}\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tparsed.padding[p] = declaration.value.children.first();\n\t\t\t\t\tdList.remove(dItem);\n\t\t\t\t}\n\n\t\t\t\telse if (prop === \"border\") {\n\t\t\t\t\tif (!parsed.border) {\n\t\t\t\t\t\tparsed.border = {\n\t\t\t\t\t\t\ttop: {},\n\t\t\t\t\t\t\tright: {},\n\t\t\t\t\t\t\tleft: {},\n\t\t\t\t\t\t\tbottom: {}\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tparsed.border.top = csstree.generate(declaration.value);\n\t\t\t\t\tparsed.border.right = csstree.generate(declaration.value);\n\t\t\t\t\tparsed.border.left = csstree.generate(declaration.value);\n\t\t\t\t\tparsed.border.bottom = csstree.generate(declaration.value);\n\n\t\t\t\t\tdList.remove(dItem);\n\n\t\t\t\t}\n\n\t\t\t\telse if (prop.indexOf(\"border-\") === 0) {\n\t\t\t\t\tif (!parsed.border) {\n\t\t\t\t\t\tparsed.border = {\n\t\t\t\t\t\t\ttop: {},\n\t\t\t\t\t\t\tright: {},\n\t\t\t\t\t\t\tleft: {},\n\t\t\t\t\t\t\tbottom: {}\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tlet p = prop.substring(\"border-\".length);\n\n\t\t\t\t\tparsed.border[p] = csstree.generate(declaration.value);\n\t\t\t\t\tdList.remove(dItem);\n\n\t\t\t\t}\n\n\t\t\t\telse if (prop === \"size\") {\n\t\t\t\t\tparsed.size = this.getSize(declaration);\n\t\t\t\t\tdList.remove(dItem);\n\t\t\t\t} else if (prop === \"bleed\") {\n\t\t\t\t\tparsed.bleed = [];\n\n\t\t\t\t\tcsstree.walk(declaration, {\n\t\t\t\t\t\tenter: (subNode) => {\n\t\t\t\t\t\t\tswitch (subNode.type) {\n\t\t\t\t\t\t\t\tcase \"String\": // bleed: \"auto\"\n\t\t\t\t\t\t\t\t\tif (subNode.value.indexOf(\"auto\") > -1) {\n\t\t\t\t\t\t\t\t\t\tparsed.bleed.push(\"auto\");\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase \"Dimension\": // bleed: 1in 2in, bleed: 20px ect.\n\t\t\t\t\t\t\t\t\tparsed.bleed.push({\n\t\t\t\t\t\t\t\t\t\tvalue: subNode.value,\n\t\t\t\t\t\t\t\t\t\tunit: subNode.unit\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase \"Number\":\n\t\t\t\t\t\t\t\t\tparsed.bleed.push({\n\t\t\t\t\t\t\t\t\t\tvalue: subNode.value,\n\t\t\t\t\t\t\t\t\t\tunit: \"px\"\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t// ignore\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tdList.remove(dItem);\n\t\t\t\t}\n\n\t\t\t}\n\t\t});\n\n\t\treturn parsed;\n\n\t}\n\tgetSize(declaration) {\n\t\tlet width, height, orientation, format;\n\n\t\t// Get size: Xmm Ymm\n\t\tcsstree.walk(declaration, {\n\t\t\tvisit: \"Dimension\",\n\t\t\tenter: (node, item, list) => {\n\t\t\t\tlet { value, unit } = node;\n\t\t\t\tif (typeof width === \"undefined\") {\n\t\t\t\t\twidth = { value, unit };\n\t\t\t\t} else if (typeof height === \"undefined\") {\n\t\t\t\t\theight = { value, unit };\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Get size: \"A4\"\n\t\tcsstree.walk(declaration, {\n\t\t\tvisit: \"String\",\n\t\t\tenter: (node, item, list) => {\n\t\t\t\tlet name = node.value.replace(/[\"|']/g, \"\");\n\t\t\t\tlet s = pageSizes[name];\n\t\t\t\tif (s) {\n\t\t\t\t\twidth = s.width;\n\t\t\t\t\theight = s.height;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Get Format or Landscape or Portrait\n\t\tcsstree.walk(declaration, {\n\t\t\tvisit: \"Identifier\",\n\t\t\tenter: (node, item, list) => {\n\t\t\t\tlet name = node.name;\n\t\t\t\tif (name === \"landscape\" || name === \"portrait\") {\n\t\t\t\t\torientation = node.name;\n\t\t\t\t} else if (name !== \"auto\") {\n\t\t\t\t\tlet s = pageSizes[name];\n\t\t\t\t\tif (s) {\n\t\t\t\t\t\twidth = s.width;\n\t\t\t\t\t\theight = s.height;\n\t\t\t\t\t}\n\t\t\t\t\tformat = name;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn {\n\t\t\twidth,\n\t\t\theight,\n\t\t\torientation,\n\t\t\tformat\n\t\t};\n\t}\n\n\tgetMargins(declaration) {\n\t\tlet margins = [];\n\t\tlet margin = {\n\t\t\ttop: {},\n\t\t\tright: {},\n\t\t\tleft: {},\n\t\t\tbottom: {}\n\t\t};\n\n\t\tcsstree.walk(declaration, {\n\t\t\tenter: (node) => {\n\t\t\t\tswitch (node.type) {\n\t\t\t\t\tcase \"Dimension\": // margin: 1in 2in, margin: 20px, etc...\n\t\t\t\t\t\tmargins.push(node);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Number\": // margin: 0\n\t\t\t\t\t\tmargins.push({value: node.value, unit: \"px\"});\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t// ignore\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (margins.length === 1) {\n\t\t\tfor (let m in margin) {\n\t\t\t\tmargin[m] = margins[0];\n\t\t\t}\n\t\t} else if (margins.length === 2) {\n\t\t\tmargin.top = margins[0];\n\t\t\tmargin.right = margins[1];\n\t\t\tmargin.bottom = margins[0];\n\t\t\tmargin.left = margins[1];\n\t\t} else if (margins.length === 3) {\n\t\t\tmargin.top = margins[0];\n\t\t\tmargin.right = margins[1];\n\t\t\tmargin.bottom = margins[2];\n\t\t\tmargin.left = margins[1];\n\t\t} else if (margins.length === 4) {\n\t\t\tmargin.top = margins[0];\n\t\t\tmargin.right = margins[1];\n\t\t\tmargin.bottom = margins[2];\n\t\t\tmargin.left = margins[3];\n\t\t}\n\n\t\treturn margin;\n\t}\n\n\tgetPaddings(declaration) {\n\t\tlet paddings = [];\n\t\tlet padding = {\n\t\t\ttop: {},\n\t\t\tright: {},\n\t\t\tleft: {},\n\t\t\tbottom: {}\n\t\t};\n\n\t\tcsstree.walk(declaration, {\n\t\t\tenter: (node) => {\n\t\t\t\tswitch (node.type) {\n\t\t\t\t\tcase \"Dimension\": // padding: 1in 2in, padding: 20px, etc...\n\t\t\t\t\t\tpaddings.push(node);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Number\": // padding: 0\n\t\t\t\t\t\tpaddings.push({value: node.value, unit: \"px\"});\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t// ignore\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tif (paddings.length === 1) {\n\t\t\tfor (let p in padding) {\n\t\t\t\tpadding[p] = paddings[0];\n\t\t\t}\n\t\t} else if (paddings.length === 2) {\n\n\t\t\tpadding.top = paddings[0];\n\t\t\tpadding.right = paddings[1];\n\t\t\tpadding.bottom = paddings[0];\n\t\t\tpadding.left = paddings[1];\n\t\t} else if (paddings.length === 3) {\n\n\t\t\tpadding.top = paddings[0];\n\t\t\tpadding.right = paddings[1];\n\t\t\tpadding.bottom = paddings[2];\n\t\t\tpadding.left = paddings[1];\n\t\t} else if (paddings.length === 4) {\n\n\t\t\tpadding.top = paddings[0];\n\t\t\tpadding.right = paddings[1];\n\t\t\tpadding.bottom = paddings[2];\n\t\t\tpadding.left = paddings[3];\n\t\t}\n\t\treturn padding;\n\t}\n\n\t// get values for the border on the @page to pass them to the element with the .pagedjs_area class\n\tgetBorders(declaration) {\n\t\tlet border = {\n\t\t\ttop: {},\n\t\t\tright: {},\n\t\t\tleft: {},\n\t\t\tbottom: {}\n\t\t};\n\n\t\tif (declaration.prop == \"border\") {\n\t\t\tborder.top = csstree.generate(declaration.value);\n\t\t\tborder.right = csstree.generate(declaration.value);\n\t\t\tborder.bottom = csstree.generate(declaration.value);\n\t\t\tborder.left = csstree.generate(declaration.value);\n\n\t\t}\n\t\telse if (declaration.prop == \"border-top\") {\n\t\t\tborder.top = csstree.generate(declaration.value);\n\t\t}\n\t\telse if (declaration.prop == \"border-right\") {\n\t\t\tborder.right = csstree.generate(declaration.value);\n\n\t\t}\n\t\telse if (declaration.prop == \"border-bottom\") {\n\t\t\tborder.bottom = csstree.generate(declaration.value);\n\n\t\t}\n\t\telse if (declaration.prop == \"border-left\") {\n\t\t\tborder.left = csstree.generate(declaration.value);\n\t\t}\n\n\t\treturn border;\n\t}\n\n\n\taddPageClasses(pages, ast, sheet) {\n\t\t// First add * page\n\t\tif (\"*\" in pages && pages[\"*\"].added === false) {\n\t\t\tlet p = this.createPage(pages[\"*\"], ast.children, sheet);\n\t\t\tsheet.insertRule(p);\n\t\t\tpages[\"*\"].added = true;\n\t\t}\n\t\t// Add :left & :right\n\t\tif (\":left\" in pages && pages[\":left\"].added === false) {\n\t\t\tlet left = this.createPage(pages[\":left\"], ast.children, sheet);\n\t\t\tsheet.insertRule(left);\n\t\t\tpages[\":left\"].added = true;\n\t\t}\n\t\tif (\":right\" in pages && pages[\":right\"].added === false) {\n\t\t\tlet right = this.createPage(pages[\":right\"], ast.children, sheet);\n\t\t\tsheet.insertRule(right);\n\t\t\tpages[\":right\"].added = true;\n\t\t}\n\t\t// Add :first & :blank\n\t\tif (\":first\" in pages && pages[\":first\"].added === false) {\n\t\t\tlet first = this.createPage(pages[\":first\"], ast.children, sheet);\n\t\t\tsheet.insertRule(first);\n\t\t\tpages[\":first\"].added = true;\n\t\t}\n\t\tif (\":blank\" in pages && pages[\":blank\"].added === false) {\n\t\t\tlet blank = this.createPage(pages[\":blank\"], ast.children, sheet);\n\t\t\tsheet.insertRule(blank);\n\t\t\tpages[\":blank\"].added = true;\n\t\t}\n\t\t// Add nth pages\n\t\tfor (let pg in pages) {\n\t\t\tif (pages[pg].nth && pages[pg].added === false) {\n\t\t\t\tlet nth = this.createPage(pages[pg], ast.children, sheet);\n\t\t\t\tsheet.insertRule(nth);\n\t\t\t\tpages[pg].added = true;\n\t\t\t}\n\t\t}\n\n\t\t// Add named pages\n\t\tfor (let pg in pages) {\n\t\t\tif (pages[pg].name && pages[pg].added === false) {\n\t\t\t\tlet named = this.createPage(pages[pg], ast.children, sheet);\n\t\t\t\tsheet.insertRule(named);\n\t\t\t\tpages[pg].added = true;\n\t\t\t}\n\t\t}\n\n\t}\n\n\tcreatePage(page, ruleList, sheet) {\n\n\t\tlet selectors = this.selectorsForPage(page);\n\t\tlet children = page.block.children.copy();\n\t\tlet block = {\n\t\t\ttype: \"Block\",\n\t\t\tloc: 0,\n\t\t\tchildren: children\n\t\t};\n\n\n\t\tlet rule = this.createRule(selectors, block);\n\n\t\tthis.addMarginVars(page.margin, children, children.first());\n\t\tthis.addPaddingVars(page.padding, children, children.first());\n\t\tthis.addBorderVars(page.border, children, children.first());\n\n\n\t\tif (page.width) {\n\t\t\tthis.addDimensions(page.width, page.height, page.orientation, children, children.first());\n\t\t}\n\n\t\tif (page.marginalia) {\n\t\t\tthis.addMarginaliaStyles(page, ruleList, rule, sheet);\n\t\t\tthis.addMarginaliaContent(page, ruleList, rule, sheet);\n\t\t}\n\n\t\tif(page.notes) {\n\t\t\tthis.addNotesStyles(page.notes, page, ruleList, rule, sheet);\n\t\t}\n\n\t\treturn rule;\n\t}\n\n\taddMarginVars(margin, list, item) {\n\t\t// variables for margins\n\t\tfor (let m in margin) {\n\t\t\tif (typeof margin[m].value !== \"undefined\") {\n\t\t\t\tlet value = margin[m].value + (margin[m].unit || \"\");\n\t\t\t\tlet mVar = list.createItem({\n\t\t\t\t\ttype: \"Declaration\",\n\t\t\t\t\tproperty: \"--pagedjs-margin-\" + m,\n\t\t\t\t\tvalue: {\n\t\t\t\t\t\ttype: \"Raw\",\n\t\t\t\t\t\tvalue: value\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tlist.append(mVar, item);\n\n\t\t\t}\n\t\t}\n\t}\n\n\taddPaddingVars(padding, list, item) {\n\t\t// variables for padding\n\t\tfor (let p in padding) {\n\n\t\t\tif (typeof padding[p].value !== \"undefined\") {\n\t\t\t\tlet value = padding[p].value + (padding[p].unit || \"\");\n\t\t\t\tlet pVar = list.createItem({\n\t\t\t\t\ttype: \"Declaration\",\n\t\t\t\t\tproperty: \"--pagedjs-padding-\" + p,\n\t\t\t\t\tvalue: {\n\t\t\t\t\t\ttype: \"Raw\",\n\t\t\t\t\t\tvalue: value\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tlist.append(pVar, item);\n\t\t\t}\n\n\t\t}\n\t}\n\n\taddBorderVars(border, list, item) {\n\t\t// variables for borders\n\t\tfor (const name of Object.keys(border)) {\n\t\t\tconst value = border[name];\n\t\t\t// value is an empty object when undefined\n\t\t\tif (typeof value === \"string\") {\n\t\t\t\tconst borderItem = list.createItem({\n\t\t\t\t\ttype: \"Declaration\",\n\t\t\t\t\tproperty: \"--pagedjs-border-\" + name,\n\t\t\t\t\tvalue: {\n\t\t\t\t\t\ttype: \"Raw\",\n\t\t\t\t\t\tvalue: value\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tlist.append(borderItem, item);\n\t\t\t}\n\t\t}\n\t}\n\n\taddDimensions(width, height, orientation, list, item) {\n\t\tlet widthString, heightString;\n\n\t\twidthString = CSSValueToString(width);\n\t\theightString = CSSValueToString(height);\n\n\t\tif (orientation && orientation !== \"portrait\") {\n\t\t\t// reverse for orientation\n\t\t\t[widthString, heightString] = [heightString, widthString];\n\t\t}\n\n\t\t// width variable\n\t\tlet wVar = this.createVariable(\"--pagedjs-pagebox-width\", widthString);\n\t\tlist.appendData(wVar);\n\n\t\t// height variable\n\t\tlet hVar = this.createVariable(\"--pagedjs-pagebox-height\", heightString);\n\t\tlist.appendData(hVar);\n\n\t\t// let w = this.createDimension(\"width\", width);\n\t\t// let h = this.createDimension(\"height\", height);\n\t\t// list.appendData(w);\n\t\t// list.appendData(h);\n\t}\n\n\taddMarginaliaStyles(page, list, item, sheet) {\n\t\tfor (let loc in page.marginalia) {\n\t\t\tlet block = csstree.clone(page.marginalia[loc]);\n\t\t\tlet hasContent = false;\n\n\t\t\tif (block.children.isEmpty()) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tcsstree.walk(block, {\n\t\t\t\tvisit: \"Declaration\",\n\t\t\t\tenter: (node, item, list) => {\n\t\t\t\t\tif (node.property === \"content\") {\n\t\t\t\t\t\tif (node.value.children && node.value.children.first().name === \"none\") {\n\t\t\t\t\t\t\thasContent = false;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\thasContent = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlist.remove(item);\n\t\t\t\t\t}\n\t\t\t\t\tif (node.property === \"vertical-align\") {\n\t\t\t\t\t\tcsstree.walk(node, {\n\t\t\t\t\t\t\tvisit: \"Identifier\",\n\t\t\t\t\t\t\tenter: (identNode, identItem, identlist) => {\n\t\t\t\t\t\t\t\tlet name = identNode.name;\n\t\t\t\t\t\t\t\tif (name === \"top\") {\n\t\t\t\t\t\t\t\t\tidentNode.name = \"flex-start\";\n\t\t\t\t\t\t\t\t} else if (name === \"middle\") {\n\t\t\t\t\t\t\t\t\tidentNode.name = \"center\";\n\t\t\t\t\t\t\t\t} else if (name === \"bottom\") {\n\t\t\t\t\t\t\t\t\tidentNode.name = \"flex-end\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnode.property = \"align-items\";\n\t\t\t\t\t}\n\n\t\t\t\t\tif (node.property === \"width\" &&\n\t\t\t\t\t\t(loc === \"top-left\" ||\n\t\t\t\t\t\t\tloc === \"top-center\" ||\n\t\t\t\t\t\t\tloc === \"top-right\" ||\n\t\t\t\t\t\t\tloc === \"bottom-left\" ||\n\t\t\t\t\t\t\tloc === \"bottom-center\" ||\n\t\t\t\t\t\t\tloc === \"bottom-right\")) {\n\t\t\t\t\t\tlet c = csstree.clone(node);\n\t\t\t\t\t\tc.property = \"max-width\";\n\t\t\t\t\t\tlist.appendData(c);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (node.property === \"height\" &&\n\t\t\t\t\t\t(loc === \"left-top\" ||\n\t\t\t\t\t\t\tloc === \"left-middle\" ||\n\t\t\t\t\t\t\tloc === \"left-bottom\" ||\n\t\t\t\t\t\t\tloc === \"right-top\" ||\n\t\t\t\t\t\t\tloc === \"right-middle\" ||\n\t\t\t\t\t\t\tloc === \"right-bottom\")) {\n\t\t\t\t\t\tlet c = csstree.clone(node);\n\t\t\t\t\t\tc.property = \"max-height\";\n\t\t\t\t\t\tlist.appendData(c);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlet marginSelectors = this.selectorsForPageMargin(page, loc);\n\t\t\tlet marginRule = this.createRule(marginSelectors, block);\n\n\t\t\tlist.appendData(marginRule);\n\n\t\t\tlet sel = csstree.generate({\n\t\t\t\ttype: \"Selector\",\n\t\t\t\tchildren: marginSelectors\n\t\t\t});\n\n\t\t\tthis.marginalia[sel] = {\n\t\t\t\tpage: page,\n\t\t\t\tselector: sel,\n\t\t\t\tblock: page.marginalia[loc],\n\t\t\t\thasContent: hasContent\n\t\t\t};\n\n\t\t}\n\t}\n\n\taddMarginaliaContent(page, list, item, sheet) {\n\t\tlet displayNone;\n\t\t// Just content\n\t\tfor (let loc in page.marginalia) {\n\t\t\tlet content = csstree.clone(page.marginalia[loc]);\n\t\t\tcsstree.walk(content, {\n\t\t\t\tvisit: \"Declaration\",\n\t\t\t\tenter: (node, item, list) => {\n\t\t\t\t\tif (node.property !== \"content\") {\n\t\t\t\t\t\tlist.remove(item);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (node.value.children && node.value.children.first().name === \"none\") {\n\t\t\t\t\t\tdisplayNone = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (content.children.isEmpty()) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet displaySelectors = this.selectorsForPageMargin(page, loc);\n\t\t\tlet displayDeclaration;\n\n\t\t\tdisplaySelectors.insertData({\n\t\t\t\ttype: \"Combinator\",\n\t\t\t\tname: \">\"\n\t\t\t});\n\n\t\t\tdisplaySelectors.insertData({\n\t\t\t\ttype: \"ClassSelector\",\n\t\t\t\tname: \"pagedjs_margin-content\"\n\t\t\t});\n\n\t\t\tdisplaySelectors.insertData({\n\t\t\t\ttype: \"Combinator\",\n\t\t\t\tname: \">\"\n\t\t\t});\n\n\t\t\tdisplaySelectors.insertData({\n\t\t\t\ttype: \"TypeSelector\",\n\t\t\t\tname: \"*\"\n\t\t\t});\n\n\t\t\tif (displayNone) {\n\t\t\t\tdisplayDeclaration = this.createDeclaration(\"display\", \"none\");\n\t\t\t} else {\n\t\t\t\tdisplayDeclaration = this.createDeclaration(\"display\", \"block\");\n\t\t\t}\n\n\t\t\tlet displayRule = this.createRule(displaySelectors, [displayDeclaration]);\n\t\t\tsheet.insertRule(displayRule);\n\n\t\t\t// insert content rule\n\t\t\tlet contentSelectors = this.selectorsForPageMargin(page, loc);\n\n\t\t\tcontentSelectors.insertData({\n\t\t\t\ttype: \"Combinator\",\n\t\t\t\tname: \">\"\n\t\t\t});\n\n\t\t\tcontentSelectors.insertData({\n\t\t\t\ttype: \"ClassSelector\",\n\t\t\t\tname: \"pagedjs_margin-content\"\n\t\t\t});\n\n\t\t\tcontentSelectors.insertData({\n\t\t\t\ttype: \"PseudoElementSelector\",\n\t\t\t\tname: \"after\",\n\t\t\t\tchildren: null\n\t\t\t});\n\n\t\t\tlet contentRule = this.createRule(contentSelectors, content);\n\t\t\tsheet.insertRule(contentRule);\n\t\t}\n\t}\n\n\taddRootVars(ast, width, height, orientation, bleed, bleedrecto, bleedverso, marks) {\n\t\tlet rules = [];\n\t\tlet selectors = new csstree.List();\n\t\tselectors.insertData({\n\t\t\ttype: \"PseudoClassSelector\",\n\t\t\tname: \"root\",\n\t\t\tchildren: null\n\t\t});\n\n\t\tlet widthString, heightString;\n\t\tlet widthStringRight, heightStringRight;\n\t\tlet widthStringLeft, heightStringLeft;\n\n\t\tif (!bleed) {\n\t\t\twidthString = CSSValueToString(width);\n\t\t\theightString = CSSValueToString(height);\n\t\t\twidthStringRight = CSSValueToString(width);\n\t\t\theightStringRight = CSSValueToString(height);\n\t\t\twidthStringLeft = CSSValueToString(width);\n\t\t\theightStringLeft = CSSValueToString(height);\n\t\t} else {\n\t\t\twidthString = `calc( ${CSSValueToString(width)} + ${CSSValueToString(bleed.left)} + ${CSSValueToString(bleed.right)} )`;\n\t\t\theightString = `calc( ${CSSValueToString(height)} + ${CSSValueToString(bleed.top)} + ${CSSValueToString(bleed.bottom)} )`;\n\n\t\t\twidthStringRight = `calc( ${CSSValueToString(width)} + ${CSSValueToString(bleed.left)} + ${CSSValueToString(bleed.right)} )`;\n\t\t\theightStringRight = `calc( ${CSSValueToString(height)} + ${CSSValueToString(bleed.top)} + ${CSSValueToString(bleed.bottom)} )`;\n\n\t\t\twidthStringLeft = `calc( ${CSSValueToString(width)} + ${CSSValueToString(bleed.left)} + ${CSSValueToString(bleed.right)} )`;\n\t\t\theightStringLeft = `calc( ${CSSValueToString(height)} + ${CSSValueToString(bleed.top)} + ${CSSValueToString(bleed.bottom)} )`;\n\n\t\t\tlet bleedTop = this.createVariable(\"--pagedjs-bleed-top\", CSSValueToString(bleed.top));\n\t\t\tlet bleedRight = this.createVariable(\"--pagedjs-bleed-right\", CSSValueToString(bleed.right));\n\t\t\tlet bleedBottom = this.createVariable(\"--pagedjs-bleed-bottom\", CSSValueToString(bleed.bottom));\n\t\t\tlet bleedLeft = this.createVariable(\"--pagedjs-bleed-left\", CSSValueToString(bleed.left));\n\n\t\t\tlet bleedTopRecto = this.createVariable(\"--pagedjs-bleed-right-top\", CSSValueToString(bleed.top));\n\t\t\tlet bleedRightRecto = this.createVariable(\"--pagedjs-bleed-right-right\", CSSValueToString(bleed.right));\n\t\t\tlet bleedBottomRecto = this.createVariable(\"--pagedjs-bleed-right-bottom\", CSSValueToString(bleed.bottom));\n\t\t\tlet bleedLeftRecto = this.createVariable(\"--pagedjs-bleed-right-left\", CSSValueToString(bleed.left));\n\n\t\t\tlet bleedTopVerso = this.createVariable(\"--pagedjs-bleed-left-top\", CSSValueToString(bleed.top));\n\t\t\tlet bleedRightVerso = this.createVariable(\"--pagedjs-bleed-left-right\", CSSValueToString(bleed.right));\n\t\t\tlet bleedBottomVerso = this.createVariable(\"--pagedjs-bleed-left-bottom\", CSSValueToString(bleed.bottom));\n\t\t\tlet bleedLeftVerso = this.createVariable(\"--pagedjs-bleed-left-left\", CSSValueToString(bleed.left));\n\n\t\t\tif (bleedrecto) {\n\t\t\t\tbleedTopRecto = this.createVariable(\"--pagedjs-bleed-right-top\", CSSValueToString(bleedrecto.top));\n\t\t\t\tbleedRightRecto = this.createVariable(\"--pagedjs-bleed-right-right\", CSSValueToString(bleedrecto.right));\n\t\t\t\tbleedBottomRecto = this.createVariable(\"--pagedjs-bleed-right-bottom\", CSSValueToString(bleedrecto.bottom));\n\t\t\t\tbleedLeftRecto = this.createVariable(\"--pagedjs-bleed-right-left\", CSSValueToString(bleedrecto.left));\n\n\t\t\t\twidthStringRight = `calc( ${CSSValueToString(width)} + ${CSSValueToString(bleedrecto.left)} + ${CSSValueToString(bleedrecto.right)} )`;\n\t\t\t\theightStringRight = `calc( ${CSSValueToString(height)} + ${CSSValueToString(bleedrecto.top)} + ${CSSValueToString(bleedrecto.bottom)} )`;\n\t\t\t}\n\t\t\tif (bleedverso) {\n\t\t\t\tbleedTopVerso = this.createVariable(\"--pagedjs-bleed-left-top\", CSSValueToString(bleedverso.top));\n\t\t\t\tbleedRightVerso = this.createVariable(\"--pagedjs-bleed-left-right\", CSSValueToString(bleedverso.right));\n\t\t\t\tbleedBottomVerso = this.createVariable(\"--pagedjs-bleed-left-bottom\", CSSValueToString(bleedverso.bottom));\n\t\t\t\tbleedLeftVerso = this.createVariable(\"--pagedjs-bleed-left-left\", CSSValueToString(bleedverso.left));\n\n\t\t\t\twidthStringLeft = `calc( ${CSSValueToString(width)} + ${CSSValueToString(bleedverso.left)} + ${CSSValueToString(bleedverso.right)} )`;\n\t\t\t\theightStringLeft = `calc( ${CSSValueToString(height)} + ${CSSValueToString(bleedverso.top)} + ${CSSValueToString(bleedverso.bottom)} )`;\n\t\t\t}\n\n\t\t\tlet pageWidthVar = this.createVariable(\"--pagedjs-width\", CSSValueToString(width));\n\t\t\tlet pageHeightVar = this.createVariable(\"--pagedjs-height\", CSSValueToString(height));\n\n\t\t\trules.push(\n\t\t\t\tbleedTop,\n\t\t\t\tbleedRight,\n\t\t\t\tbleedBottom,\n\t\t\t\tbleedLeft,\n\t\t\t\tbleedTopRecto,\n\t\t\t\tbleedRightRecto,\n\t\t\t\tbleedBottomRecto,\n\t\t\t\tbleedLeftRecto,\n\t\t\t\tbleedTopVerso,\n\t\t\t\tbleedRightVerso,\n\t\t\t\tbleedBottomVerso,\n\t\t\t\tbleedLeftVerso,\n\t\t\t\tpageWidthVar,\n\t\t\t\tpageHeightVar\n\t\t\t);\n\t\t}\n\n\t\tif (marks) {\n\t\t\tmarks.forEach((mark) => {\n\t\t\t\tlet markDisplay = this.createVariable(\"--pagedjs-mark-\" + mark + \"-display\", \"block\");\n\t\t\t\trules.push(markDisplay);\n\t\t\t});\n\t\t}\n\n\t\t// orientation variable\n\t\tif (orientation) {\n\t\t\tlet oVar = this.createVariable(\"--pagedjs-orientation\", orientation);\n\t\t\trules.push(oVar);\n\n\t\t\tif (orientation !== \"portrait\") {\n\t\t\t\t// reverse for orientation\n\t\t\t\t[widthString, heightString] = [heightString, widthString];\n\t\t\t\t[widthStringRight, heightStringRight] = [heightStringRight, widthStringRight];\n\t\t\t\t[widthStringLeft, heightStringLeft] = [heightStringLeft, widthStringLeft];\n\t\t\t}\n\t\t}\n\n\t\tlet wVar = this.createVariable(\"--pagedjs-width\", widthString);\n\t\tlet hVar = this.createVariable(\"--pagedjs-height\", heightString);\n\n\t\tlet wVarR = this.createVariable(\"--pagedjs-width-right\", widthStringRight);\n\t\tlet hVarR = this.createVariable(\"--pagedjs-height-right\", heightStringRight);\n\n\t\tlet wVarL = this.createVariable(\"--pagedjs-width-left\", widthStringLeft);\n\t\tlet hVarL = this.createVariable(\"--pagedjs-height-left\", heightStringLeft);\n\n\t\trules.push(wVar, hVar, wVarR, hVarR, wVarL, hVarL);\n\n\t\tlet rule = this.createRule(selectors, rules);\n\n\t\tast.children.appendData(rule);\n\t}\n\n\n\taddNotesStyles(notes, page, list, item, sheet) {\n\n\t\tfor (const note in notes) {\n\t\t\tlet selectors = this.selectorsForPage(page);\n\n\t\t\tselectors.insertData({\n\t\t\t\ttype: \"Combinator\",\n\t\t\t\tname: \" \"\n\t\t\t});\n\n\t\t\tselectors.insertData({\n\t\t\t\ttype: \"ClassSelector\",\n\t\t\t\tname: \"pagedjs_\" + note + \"_content\"\n\t\t\t});\n\n\t\t\tlet notesRule = this.createRule(selectors, notes[note]);\n\n\t\t\tlist.appendData(notesRule);\n\t\t}\n\n\t}\n\n\t/*\n\t@page {\n\t\tsize: var(--pagedjs-width) var(--pagedjs-height);\n\t\tmargin: 0;\n\t\tpadding: 0;\n\t}\n\t*/\n\taddRootPage(ast, size, bleed, bleedrecto, bleedverso) {\n\t\tlet { width, height, orientation, format } = size;\n\t\tlet children = new csstree.List();\n\t\tlet childrenLeft = new csstree.List();\n\t\tlet childrenRight = new csstree.List();\n\t\tlet dimensions = new csstree.List();\n\t\tlet dimensionsLeft = new csstree.List();\n\t\tlet dimensionsRight = new csstree.List();\n\n\t\tif (bleed) {\n\t\t\tlet widthCalculations = new csstree.List();\n\t\t\tlet heightCalculations = new csstree.List();\n\n\t\t\t// width\n\t\t\twidthCalculations.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: width.unit,\n\t\t\t\tvalue: width.value\n\t\t\t});\n\n\t\t\twidthCalculations.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\twidthCalculations.appendData({\n\t\t\t\ttype: \"Operator\",\n\t\t\t\tvalue: \"+\"\n\t\t\t});\n\n\t\t\twidthCalculations.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\twidthCalculations.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: bleed.left.unit,\n\t\t\t\tvalue: bleed.left.value\n\t\t\t});\n\n\t\t\twidthCalculations.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\twidthCalculations.appendData({\n\t\t\t\ttype: \"Operator\",\n\t\t\t\tvalue: \"+\"\n\t\t\t});\n\n\t\t\twidthCalculations.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\twidthCalculations.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: bleed.right.unit,\n\t\t\t\tvalue: bleed.right.value\n\t\t\t});\n\n\t\t\t// height\n\t\t\theightCalculations.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: height.unit,\n\t\t\t\tvalue: height.value\n\t\t\t});\n\n\t\t\theightCalculations.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\theightCalculations.appendData({\n\t\t\t\ttype: \"Operator\",\n\t\t\t\tvalue: \"+\"\n\t\t\t});\n\n\t\t\theightCalculations.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\theightCalculations.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: bleed.top.unit,\n\t\t\t\tvalue: bleed.top.value\n\t\t\t});\n\n\t\t\theightCalculations.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\theightCalculations.appendData({\n\t\t\t\ttype: \"Operator\",\n\t\t\t\tvalue: \"+\"\n\t\t\t});\n\n\t\t\theightCalculations.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\theightCalculations.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: bleed.bottom.unit,\n\t\t\t\tvalue: bleed.bottom.value\n\t\t\t});\n\n\t\t\tdimensions.appendData({\n\t\t\t\ttype: \"Function\",\n\t\t\t\tname: \"calc\",\n\t\t\t\tchildren: widthCalculations\n\t\t\t});\n\n\t\t\tdimensions.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\tdimensions.appendData({\n\t\t\t\ttype: \"Function\",\n\t\t\t\tname: \"calc\",\n\t\t\t\tchildren: heightCalculations\n\t\t\t});\n\n\t\t} else if (format) {\n\t\t\tdimensions.appendData({\n\t\t\t\ttype: \"Identifier\",\n\t\t\t\tname: format\n\t\t\t});\n\n\t\t\tif (orientation) {\n\t\t\t\tdimensions.appendData({\n\t\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\t\tvalue: \" \"\n\t\t\t\t});\n\n\t\t\t\tdimensions.appendData({\n\t\t\t\t\ttype: \"Identifier\",\n\t\t\t\t\tname: orientation\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tdimensions.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: width.unit,\n\t\t\t\tvalue: width.value\n\t\t\t});\n\n\t\t\tdimensions.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\tdimensions.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: height.unit,\n\t\t\t\tvalue: height.value\n\t\t\t});\n\t\t}\n\n\t\tchildren.appendData({\n\t\t\ttype: \"Declaration\",\n\t\t\tproperty: \"size\",\n\t\t\tloc: null,\n\t\t\tvalue: {\n\t\t\t\ttype: \"Value\",\n\t\t\t\tchildren: dimensions\n\t\t\t}\n\t\t});\n\n\t\tchildren.appendData({\n\t\t\ttype: \"Declaration\",\n\t\t\tproperty: \"margin\",\n\t\t\tloc: null,\n\t\t\tvalue: {\n\t\t\t\ttype: \"Value\",\n\t\t\t\tchildren: [{\n\t\t\t\t\ttype: \"Dimension\",\n\t\t\t\t\tunit: \"px\",\n\t\t\t\t\tvalue: 0\n\t\t\t\t}]\n\t\t\t}\n\t\t});\n\n\t\tchildren.appendData({\n\t\t\ttype: \"Declaration\",\n\t\t\tproperty: \"padding\",\n\t\t\tloc: null,\n\t\t\tvalue: {\n\t\t\t\ttype: \"Value\",\n\t\t\t\tchildren: [{\n\t\t\t\t\ttype: \"Dimension\",\n\t\t\t\t\tunit: \"px\",\n\t\t\t\t\tvalue: 0\n\t\t\t\t}]\n\t\t\t}\n\t\t});\n\n\t\tchildren.appendData({\n\t\t\ttype: \"Declaration\",\n\t\t\tproperty: \"padding\",\n\t\t\tloc: null,\n\t\t\tvalue: {\n\t\t\t\ttype: \"Value\",\n\t\t\t\tchildren: [{\n\t\t\t\t\ttype: \"Dimension\",\n\t\t\t\t\tunit: \"px\",\n\t\t\t\t\tvalue: 0\n\t\t\t\t}]\n\t\t\t}\n\t\t});\n\n\t\tlet rule = ast.children.createItem({\n\t\t\ttype: \"Atrule\",\n\t\t\tprelude: null,\n\t\t\tname: \"page\",\n\t\t\tblock: {\n\t\t\t\ttype: \"Block\",\n\t\t\t\tloc: null,\n\t\t\t\tchildren: children\n\t\t\t}\n\t\t});\n\n\t\tast.children.append(rule);\n\n\t\tif (bleedverso) {\n\t\t\tlet widthCalculationsLeft = new csstree.List();\n\t\t\tlet heightCalculationsLeft = new csstree.List();\n\n\t\t\t// width\n\t\t\twidthCalculationsLeft.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: width.unit,\n\t\t\t\tvalue: width.value\n\t\t\t});\n\n\t\t\twidthCalculationsLeft.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\twidthCalculationsLeft.appendData({\n\t\t\t\ttype: \"Operator\",\n\t\t\t\tvalue: \"+\"\n\t\t\t});\n\n\t\t\twidthCalculationsLeft.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\twidthCalculationsLeft.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: bleedverso.left.unit,\n\t\t\t\tvalue: bleedverso.left.value\n\t\t\t});\n\n\t\t\twidthCalculationsLeft.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\twidthCalculationsLeft.appendData({\n\t\t\t\ttype: \"Operator\",\n\t\t\t\tvalue: \"+\"\n\t\t\t});\n\n\t\t\twidthCalculationsLeft.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\twidthCalculationsLeft.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: bleedverso.right.unit,\n\t\t\t\tvalue: bleedverso.right.value\n\t\t\t});\n\n\t\t\t// height\n\t\t\theightCalculationsLeft.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: height.unit,\n\t\t\t\tvalue: height.value\n\t\t\t});\n\n\t\t\theightCalculationsLeft.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\theightCalculationsLeft.appendData({\n\t\t\t\ttype: \"Operator\",\n\t\t\t\tvalue: \"+\"\n\t\t\t});\n\n\t\t\theightCalculationsLeft.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\theightCalculationsLeft.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: bleedverso.top.unit,\n\t\t\t\tvalue: bleedverso.top.value\n\t\t\t});\n\n\t\t\theightCalculationsLeft.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\theightCalculationsLeft.appendData({\n\t\t\t\ttype: \"Operator\",\n\t\t\t\tvalue: \"+\"\n\t\t\t});\n\n\t\t\theightCalculationsLeft.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\theightCalculationsLeft.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: bleedverso.bottom.unit,\n\t\t\t\tvalue: bleedverso.bottom.value\n\t\t\t});\n\n\t\t\tdimensionsLeft.appendData({\n\t\t\t\ttype: \"Function\",\n\t\t\t\tname: \"calc\",\n\t\t\t\tchildren: widthCalculationsLeft\n\t\t\t});\n\n\t\t\tdimensionsLeft.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\tdimensionsLeft.appendData({\n\t\t\t\ttype: \"Function\",\n\t\t\t\tname: \"calc\",\n\t\t\t\tchildren: heightCalculationsLeft\n\t\t\t});\n\n\t\t\tchildrenLeft.appendData({\n\t\t\t\ttype: \"Declaration\",\n\t\t\t\tproperty: \"size\",\n\t\t\t\tloc: null,\n\t\t\t\tvalue: {\n\t\t\t\t\ttype: \"Value\",\n\t\t\t\t\tchildren: dimensionsLeft\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlet ruleLeft = ast.children.createItem({\n\t\t\t\ttype: \"Atrule\",\n\t\t\t\tprelude: null,\n\t\t\t\tname: \"page :left\",\n\t\t\t\tblock: {\n\t\t\t\t\ttype: \"Block\",\n\t\t\t\t\tloc: null,\n\t\t\t\t\tchildren: childrenLeft\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tast.children.append(ruleLeft);\n\n\t\t}\n\n\t\tif (bleedrecto) {\n\t\t\tlet widthCalculationsRight = new csstree.List();\n\t\t\tlet heightCalculationsRight = new csstree.List();\n\n\t\t\t// width\n\t\t\twidthCalculationsRight.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: width.unit,\n\t\t\t\tvalue: width.value\n\t\t\t});\n\n\t\t\twidthCalculationsRight.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\twidthCalculationsRight.appendData({\n\t\t\t\ttype: \"Operator\",\n\t\t\t\tvalue: \"+\"\n\t\t\t});\n\n\t\t\twidthCalculationsRight.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\twidthCalculationsRight.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: bleedrecto.left.unit,\n\t\t\t\tvalue: bleedrecto.left.value\n\t\t\t});\n\n\t\t\twidthCalculationsRight.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\twidthCalculationsRight.appendData({\n\t\t\t\ttype: \"Operator\",\n\t\t\t\tvalue: \"+\"\n\t\t\t});\n\n\t\t\twidthCalculationsRight.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\twidthCalculationsRight.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: bleedrecto.right.unit,\n\t\t\t\tvalue: bleedrecto.right.value\n\t\t\t});\n\n\t\t\t// height\n\t\t\theightCalculationsRight.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: height.unit,\n\t\t\t\tvalue: height.value\n\t\t\t});\n\n\t\t\theightCalculationsRight.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\theightCalculationsRight.appendData({\n\t\t\t\ttype: \"Operator\",\n\t\t\t\tvalue: \"+\"\n\t\t\t});\n\n\t\t\theightCalculationsRight.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\theightCalculationsRight.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: bleedrecto.top.unit,\n\t\t\t\tvalue: bleedrecto.top.value\n\t\t\t});\n\n\t\t\theightCalculationsRight.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\theightCalculationsRight.appendData({\n\t\t\t\ttype: \"Operator\",\n\t\t\t\tvalue: \"+\"\n\t\t\t});\n\n\t\t\theightCalculationsRight.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\theightCalculationsRight.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: bleedrecto.bottom.unit,\n\t\t\t\tvalue: bleedrecto.bottom.value\n\t\t\t});\n\n\t\t\tdimensionsRight.appendData({\n\t\t\t\ttype: \"Function\",\n\t\t\t\tname: \"calc\",\n\t\t\t\tchildren: widthCalculationsRight\n\t\t\t});\n\n\t\t\tdimensionsRight.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\tdimensionsRight.appendData({\n\t\t\t\ttype: \"Function\",\n\t\t\t\tname: \"calc\",\n\t\t\t\tchildren: heightCalculationsRight\n\t\t\t});\n\n\t\t\tchildrenRight.appendData({\n\t\t\t\ttype: \"Declaration\",\n\t\t\t\tproperty: \"size\",\n\t\t\t\tloc: null,\n\t\t\t\tvalue: {\n\t\t\t\t\ttype: \"Value\",\n\t\t\t\t\tchildren: dimensionsRight\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlet ruleRight = ast.children.createItem({\n\t\t\t\ttype: \"Atrule\",\n\t\t\t\tprelude: null,\n\t\t\t\tname: \"page :right\",\n\t\t\t\tblock: {\n\t\t\t\t\ttype: \"Block\",\n\t\t\t\t\tloc: null,\n\t\t\t\t\tchildren: childrenRight\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tast.children.append(ruleRight);\n\n\t\t}\n\t}\n\n\tgetNth(nth) {\n\t\tlet n = nth.indexOf(\"n\");\n\t\tlet plus = nth.indexOf(\"+\");\n\t\tlet splitN = nth.split(\"n\");\n\t\tlet splitP = nth.split(\"+\");\n\t\tlet a = null;\n\t\tlet b = null;\n\t\tif (n > -1) {\n\t\t\ta = splitN[0];\n\t\t\tif (plus > -1) {\n\t\t\t\tb = splitP[1];\n\t\t\t}\n\t\t} else {\n\t\t\tb = nth;\n\t\t}\n\n\t\treturn {\n\t\t\ttype: \"Nth\",\n\t\t\tloc: null,\n\t\t\tselector: null,\n\t\t\tnth: {\n\t\t\t\ttype: \"AnPlusB\",\n\t\t\t\tloc: null,\n\t\t\t\ta: a,\n\t\t\t\tb: b\n\t\t\t}\n\t\t};\n\t}\n\n\taddPageAttributes(page, start, pages) {\n\t\tlet namedPages = [start.dataset.page];\n\n\t\tif (namedPages && namedPages.length) {\n\t\t\tfor (const named of namedPages) {\n\t\t\t\tif (!named) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tpage.name = named;\n\t\t\t\tpage.element.classList.add(\"pagedjs_named_page\");\n\t\t\t\tpage.element.classList.add(\"pagedjs_\" + named + \"_page\");\n\n\t\t\t\tif (!start.dataset.splitFrom) {\n\t\t\t\t\tpage.element.classList.add(\"pagedjs_\" + named + \"_first_page\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetStartElement(content, breakToken) {\n\t\tlet node = breakToken && breakToken.node;\n\n\t\tif (!content && !breakToken) {\n\t\t\treturn;\n\t\t}\n\n\t\t// No break\n\t\tif (!node) {\n\t\t\treturn content.children[0];\n\t\t}\n\n\t\t// Top level element\n\t\tif (node.nodeType === 1 && node.parentNode.nodeType === 11) {\n\t\t\treturn node;\n\t\t}\n\n\t\t// Named page\n\t\tif (node.nodeType === 1 && node.dataset.page) {\n\t\t\treturn node;\n\t\t}\n\n\t\t// Get top level Named parent\n\t\tlet fragment = rebuildAncestors(node);\n\t\tlet pages = fragment.querySelectorAll(\"[data-page]\");\n\n\t\tif (pages.length) {\n\t\t\treturn pages[pages.length - 1];\n\t\t} else {\n\t\t\treturn fragment.children[0];\n\t\t}\n\t}\n\n\tbeforePageLayout(page, contents, breakToken, chunker) {\n\t\tlet start = this.getStartElement(contents, breakToken);\n\t\tif (start) {\n\t\t\tthis.addPageAttributes(page, start, chunker.pages);\n\t\t}\n\t\t// page.element.querySelector('.paged_area').style.color = red;\n\t}\n\n\tfinalizePage(fragment, page, breakToken, chunker) {\n\t\tfor (let m in this.marginalia) {\n\t\t\tlet margin = this.marginalia[m];\n\t\t\tlet sels = m.split(\" \");\n\n\t\t\tlet content;\n\t\t\tif (page.element.matches(sels[0]) && margin.hasContent) {\n\t\t\t\tcontent = page.element.querySelector(sels[1]);\n\t\t\t\tcontent.classList.add(\"hasContent\");\n\t\t\t}\n\t\t}\n\n\t\t// check center\n\t\t[\"top\", \"bottom\"].forEach((loc) => {\n\t\t\tlet marginGroup = page.element.querySelector(\".pagedjs_margin-\" + loc);\n\t\t\tlet center = page.element.querySelector(\".pagedjs_margin-\" + loc + \"-center\");\n\t\t\tlet left = page.element.querySelector(\".pagedjs_margin-\" + loc + \"-left\");\n\t\t\tlet right = page.element.querySelector(\".pagedjs_margin-\" + loc + \"-right\");\n\n\t\t\tlet centerContent = center.classList.contains(\"hasContent\");\n\t\t\tlet leftContent = left.classList.contains(\"hasContent\");\n\t\t\tlet rightContent = right.classList.contains(\"hasContent\");\n\t\t\tlet centerWidth, leftWidth, rightWidth;\n\n\t\t\tif (leftContent) {\n\t\t\t\tleftWidth = window.getComputedStyle(left)[\"max-width\"];\n\t\t\t}\n\n\t\t\tif (rightContent) {\n\t\t\t\trightWidth = window.getComputedStyle(right)[\"max-width\"];\n\t\t\t}\n\n\n\t\t\tif (centerContent) {\n\t\t\t\tcenterWidth = window.getComputedStyle(center)[\"max-width\"];\n\n\t\t\t\tif (centerWidth === \"none\" || centerWidth === \"auto\") {\n\t\t\t\t\tif (!leftContent && !rightContent) {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"0 1fr 0\";\n\t\t\t\t\t} else if (leftContent) {\n\t\t\t\t\t\tif (!rightContent) {\n\t\t\t\t\t\t\tif (leftWidth !== \"none\" && leftWidth !== \"auto\") {\n\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = leftWidth + \" 1fr \" + leftWidth;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"auto auto 1fr\";\n\t\t\t\t\t\t\t\tleft.style[\"white-space\"] = \"nowrap\";\n\t\t\t\t\t\t\t\tcenter.style[\"white-space\"] = \"nowrap\";\n\t\t\t\t\t\t\t\tlet leftOuterWidth = left.offsetWidth;\n\t\t\t\t\t\t\t\tlet centerOuterWidth = center.offsetWidth;\n\t\t\t\t\t\t\t\tlet outerwidths = leftOuterWidth + centerOuterWidth;\n\t\t\t\t\t\t\t\tlet newcenterWidth = centerOuterWidth * 100 / outerwidths;\n\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"minmax(16.66%, 1fr) minmax(33%, \" + newcenterWidth + \"%) minmax(16.66%, 1fr)\";\n\t\t\t\t\t\t\t\tleft.style[\"white-space\"] = \"normal\";\n\t\t\t\t\t\t\t\tcenter.style[\"white-space\"] = \"normal\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (leftWidth !== \"none\" && leftWidth !== \"auto\") {\n\t\t\t\t\t\t\t\tif (rightWidth !== \"none\" && rightWidth !== \"auto\") {\n\t\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = leftWidth + \" 1fr \" + rightWidth;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = leftWidth + \" 1fr \" + leftWidth;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (rightWidth !== \"none\" && rightWidth !== \"auto\") {\n\t\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = rightWidth + \" 1fr \" + rightWidth;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"auto auto 1fr\";\n\t\t\t\t\t\t\t\t\tleft.style[\"white-space\"] = \"nowrap\";\n\t\t\t\t\t\t\t\t\tcenter.style[\"white-space\"] = \"nowrap\";\n\t\t\t\t\t\t\t\t\tright.style[\"white-space\"] = \"nowrap\";\n\t\t\t\t\t\t\t\t\tlet leftOuterWidth = left.offsetWidth;\n\t\t\t\t\t\t\t\t\tlet centerOuterWidth = center.offsetWidth;\n\t\t\t\t\t\t\t\t\tlet rightOuterWidth = right.offsetWidth;\n\t\t\t\t\t\t\t\t\tlet outerwidths = leftOuterWidth + centerOuterWidth + rightOuterWidth;\n\t\t\t\t\t\t\t\t\tlet newcenterWidth = centerOuterWidth * 100 / outerwidths;\n\t\t\t\t\t\t\t\t\tif (newcenterWidth > 40) {\n\t\t\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"minmax(16.66%, 1fr) minmax(33%, \" + newcenterWidth + \"%) minmax(16.66%, 1fr)\";\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"repeat(3, 1fr)\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tleft.style[\"white-space\"] = \"normal\";\n\t\t\t\t\t\t\t\t\tcenter.style[\"white-space\"] = \"normal\";\n\t\t\t\t\t\t\t\t\tright.style[\"white-space\"] = \"normal\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (rightWidth !== \"none\" && rightWidth !== \"auto\") {\n\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = rightWidth + \" 1fr \" + rightWidth;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"auto auto 1fr\";\n\t\t\t\t\t\t\tright.style[\"white-space\"] = \"nowrap\";\n\t\t\t\t\t\t\tcenter.style[\"white-space\"] = \"nowrap\";\n\t\t\t\t\t\t\tlet rightOuterWidth = right.offsetWidth;\n\t\t\t\t\t\t\tlet centerOuterWidth = center.offsetWidth;\n\t\t\t\t\t\t\tlet outerwidths = rightOuterWidth + centerOuterWidth;\n\t\t\t\t\t\t\tlet newcenterWidth = centerOuterWidth * 100 / outerwidths;\n\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"minmax(16.66%, 1fr) minmax(33%, \" + newcenterWidth + \"%) minmax(16.66%, 1fr)\";\n\t\t\t\t\t\t\tright.style[\"white-space\"] = \"normal\";\n\t\t\t\t\t\t\tcenter.style[\"white-space\"] = \"normal\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (centerWidth !== \"none\" && centerWidth !== \"auto\") {\n\t\t\t\t\tif (leftContent && leftWidth !== \"none\" && leftWidth !== \"auto\") {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = leftWidth + \" \" + centerWidth + \" 1fr\";\n\t\t\t\t\t} else if (rightContent && rightWidth !== \"none\" && rightWidth !== \"auto\") {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"1fr \" + centerWidth + \" \" + rightWidth;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"1fr \" + centerWidth + \" 1fr\";\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tif (leftContent) {\n\t\t\t\t\tif (!rightContent) {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"1fr 0 0\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (leftWidth !== \"none\" && leftWidth !== \"auto\") {\n\t\t\t\t\t\t\tif (rightWidth !== \"none\" && rightWidth !== \"auto\") {\n\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = leftWidth + \" 1fr \" + rightWidth;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = leftWidth + \" 0 1fr\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (rightWidth !== \"none\" && rightWidth !== \"auto\") {\n\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"1fr 0 \" + rightWidth;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"auto 1fr auto\";\n\t\t\t\t\t\t\t\tleft.style[\"white-space\"] = \"nowrap\";\n\t\t\t\t\t\t\t\tright.style[\"white-space\"] = \"nowrap\";\n\t\t\t\t\t\t\t\tlet leftOuterWidth = left.offsetWidth;\n\t\t\t\t\t\t\t\tlet rightOuterWidth = right.offsetWidth;\n\t\t\t\t\t\t\t\tlet outerwidths = leftOuterWidth + rightOuterWidth;\n\t\t\t\t\t\t\t\tlet newLeftWidth = leftOuterWidth * 100 / outerwidths;\n\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"minmax(16.66%, \" + newLeftWidth + \"%) 0 1fr\";\n\t\t\t\t\t\t\t\tleft.style[\"white-space\"] = \"normal\";\n\t\t\t\t\t\t\t\tright.style[\"white-space\"] = \"normal\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (rightWidth !== \"none\" && rightWidth !== \"auto\") {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"1fr 0 \" + rightWidth;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-columns\"] = \"0 0 1fr\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// check middle\n\t\t[\"left\", \"right\"].forEach((loc) => {\n\t\t\tlet middle = page.element.querySelector(\".pagedjs_margin-\" + loc + \"-middle.hasContent\");\n\t\t\tlet marginGroup = page.element.querySelector(\".pagedjs_margin-\" + loc);\n\t\t\tlet top = page.element.querySelector(\".pagedjs_margin-\" + loc + \"-top\");\n\t\t\tlet bottom = page.element.querySelector(\".pagedjs_margin-\" + loc + \"-bottom\");\n\t\t\tlet topContent = top.classList.contains(\"hasContent\");\n\t\t\tlet bottomContent = bottom.classList.contains(\"hasContent\");\n\t\t\tlet middleHeight, topHeight, bottomHeight;\n\n\t\t\tif (topContent) {\n\t\t\t\ttopHeight = window.getComputedStyle(top)[\"max-height\"];\n\t\t\t}\n\n\t\t\tif (bottomContent) {\n\t\t\t\tbottomHeight = window.getComputedStyle(bottom)[\"max-height\"];\n\t\t\t}\n\n\t\t\tif (middle) {\n\t\t\t\tmiddleHeight = window.getComputedStyle(middle)[\"max-height\"];\n\n\t\t\t\tif (middleHeight === \"none\" || middleHeight === \"auto\") {\n\t\t\t\t\tif (!topContent && !bottomContent) {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = \"0 1fr 0\";\n\t\t\t\t\t} else if (topContent) {\n\t\t\t\t\t\tif (!bottomContent) {\n\t\t\t\t\t\t\tif (topHeight !== \"none\" && topHeight !== \"auto\") {\n\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = topHeight + \" calc(100% - \" + topHeight + \"*2) \" + topHeight;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (topHeight !== \"none\" && topHeight !== \"auto\") {\n\t\t\t\t\t\t\t\tif (bottomHeight !== \"none\" && bottomHeight !== \"auto\") {\n\t\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = topHeight + \" calc(100% - \" + topHeight + \" - \" + bottomHeight + \") \" + bottomHeight;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = topHeight + \" calc(100% - \" + topHeight + \"*2) \" + topHeight;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (bottomHeight !== \"none\" && bottomHeight !== \"auto\") {\n\t\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = bottomHeight + \" calc(100% - \" + bottomHeight + \"*2) \" + bottomHeight;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (bottomHeight !== \"none\" && bottomHeight !== \"auto\") {\n\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = bottomHeight + \" calc(100% - \" + bottomHeight + \"*2) \" + bottomHeight;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (topContent && topHeight !== \"none\" && topHeight !== \"auto\") {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = topHeight + \" \" + middleHeight + \" calc(100% - (\" + topHeight + \" + \" + middleHeight + \"))\";\n\t\t\t\t\t} else if (bottomContent && bottomHeight !== \"none\" && bottomHeight !== \"auto\") {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = \"1fr \" + middleHeight + \" \" + bottomHeight;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = \"calc((100% - \" + middleHeight + \")/2) \" + middleHeight + \" calc((100% - \" + middleHeight + \")/2)\";\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tif (topContent) {\n\t\t\t\t\tif (!bottomContent) {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = \"1fr 0 0\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (topHeight !== \"none\" && topHeight !== \"auto\") {\n\t\t\t\t\t\t\tif (bottomHeight !== \"none\" && bottomHeight !== \"auto\") {\n\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = topHeight + \" 1fr \" + bottomHeight;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = topHeight + \" 0 1fr\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (bottomHeight !== \"none\" && bottomHeight !== \"auto\") {\n\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = \"1fr 0 \" + bottomHeight;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = \"1fr 0 1fr\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (bottomHeight !== \"none\" && bottomHeight !== \"auto\") {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = \"1fr 0 \" + bottomHeight;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmarginGroup.style[\"grid-template-rows\"] = \"0 0 1fr\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\n\n\t\t});\n\n\t}\n\n\t// CSS Tree Helpers\n\n\tselectorsForPage(page) {\n\t\tlet nthlist;\n\t\tlet nth;\n\n\t\tlet selectors = new csstree.List();\n\n\t\tselectors.insertData({\n\t\t\ttype: \"ClassSelector\",\n\t\t\tname: \"pagedjs_page\"\n\t\t});\n\n\t\t// Named page\n\t\tif (page.name) {\n\t\t\tselectors.insertData({\n\t\t\t\ttype: \"ClassSelector\",\n\t\t\t\tname: \"pagedjs_named_page\"\n\t\t\t});\n\n\t\t\tselectors.insertData({\n\t\t\t\ttype: \"ClassSelector\",\n\t\t\t\tname: \"pagedjs_\" + page.name + \"_page\"\n\t\t\t});\n\t\t}\n\n\t\t// PsuedoSelector\n\t\tif (page.psuedo && !(page.name && page.psuedo === \"first\")) {\n\t\t\tselectors.insertData({\n\t\t\t\ttype: \"ClassSelector\",\n\t\t\t\tname: \"pagedjs_\" + page.psuedo + \"_page\"\n\t\t\t});\n\t\t}\n\n\t\tif (page.name && page.psuedo === \"first\") {\n\t\t\tselectors.insertData({\n\t\t\t\ttype: \"ClassSelector\",\n\t\t\t\tname: \"pagedjs_\" + page.name + \"_\" + page.psuedo + \"_page\"\n\t\t\t});\n\t\t}\n\n\t\t// Nth\n\t\tif (page.nth) {\n\t\t\tnthlist = new csstree.List();\n\t\t\tnth = this.getNth(page.nth);\n\n\t\t\tnthlist.insertData(nth);\n\n\t\t\tselectors.insertData({\n\t\t\t\ttype: \"PseudoClassSelector\",\n\t\t\t\tname: \"nth-of-type\",\n\t\t\t\tchildren: nthlist\n\t\t\t});\n\t\t}\n\n\t\treturn selectors;\n\t}\n\n\tselectorsForPageMargin(page, margin) {\n\t\tlet selectors = this.selectorsForPage(page);\n\n\t\tselectors.insertData({\n\t\t\ttype: \"Combinator\",\n\t\t\tname: \" \"\n\t\t});\n\n\t\tselectors.insertData({\n\t\t\ttype: \"ClassSelector\",\n\t\t\tname: \"pagedjs_margin-\" + margin\n\t\t});\n\n\t\treturn selectors;\n\t}\n\n\tcreateDeclaration(property, value, important) {\n\t\tlet children = new csstree.List();\n\n\t\tchildren.insertData({\n\t\t\ttype: \"Identifier\",\n\t\t\tloc: null,\n\t\t\tname: value\n\t\t});\n\n\t\treturn {\n\t\t\ttype: \"Declaration\",\n\t\t\tloc: null,\n\t\t\timportant: important,\n\t\t\tproperty: property,\n\t\t\tvalue: {\n\t\t\t\ttype: \"Value\",\n\t\t\t\tloc: null,\n\t\t\t\tchildren: children\n\t\t\t}\n\t\t};\n\t}\n\n\tcreateVariable(property, value) {\n\t\treturn {\n\t\t\ttype: \"Declaration\",\n\t\t\tloc: null,\n\t\t\tproperty: property,\n\t\t\tvalue: {\n\t\t\t\ttype: \"Raw\",\n\t\t\t\tvalue: value\n\t\t\t}\n\t\t};\n\t}\n\n\tcreateCalculatedDimension(property, items, important, operator = \"+\") {\n\t\tlet children = new csstree.List();\n\t\tlet calculations = new csstree.List();\n\n\t\titems.forEach((item, index) => {\n\t\t\tcalculations.appendData({\n\t\t\t\ttype: \"Dimension\",\n\t\t\t\tunit: item.unit,\n\t\t\t\tvalue: item.value\n\t\t\t});\n\n\t\t\tcalculations.appendData({\n\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\tvalue: \" \"\n\t\t\t});\n\n\t\t\tif (index + 1 < items.length) {\n\t\t\t\tcalculations.appendData({\n\t\t\t\t\ttype: \"Operator\",\n\t\t\t\t\tvalue: operator\n\t\t\t\t});\n\n\t\t\t\tcalculations.appendData({\n\t\t\t\t\ttype: \"WhiteSpace\",\n\t\t\t\t\tvalue: \" \"\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tchildren.insertData({\n\t\t\ttype: \"Function\",\n\t\t\tloc: null,\n\t\t\tname: \"calc\",\n\t\t\tchildren: calculations\n\t\t});\n\n\t\treturn {\n\t\t\ttype: \"Declaration\",\n\t\t\tloc: null,\n\t\t\timportant: important,\n\t\t\tproperty: property,\n\t\t\tvalue: {\n\t\t\t\ttype: \"Value\",\n\t\t\t\tloc: null,\n\t\t\t\tchildren: children\n\t\t\t}\n\t\t};\n\t}\n\n\tcreateDimension(property, cssValue, important) {\n\t\tlet children = new csstree.List();\n\n\t\tchildren.insertData({\n\t\t\ttype: \"Dimension\",\n\t\t\tloc: null,\n\t\t\tvalue: cssValue.value,\n\t\t\tunit: cssValue.unit\n\t\t});\n\n\t\treturn {\n\t\t\ttype: \"Declaration\",\n\t\t\tloc: null,\n\t\t\timportant: important,\n\t\t\tproperty: property,\n\t\t\tvalue: {\n\t\t\t\ttype: \"Value\",\n\t\t\t\tloc: null,\n\t\t\t\tchildren: children\n\t\t\t}\n\t\t};\n\t}\n\n\tcreateBlock(declarations) {\n\t\tlet block = new csstree.List();\n\n\t\tdeclarations.forEach((declaration) => {\n\t\t\tblock.insertData(declaration);\n\t\t});\n\n\t\treturn {\n\t\t\ttype: \"Block\",\n\t\t\tloc: null,\n\t\t\tchildren: block\n\t\t};\n\t}\n\n\tcreateRule(selectors, block) {\n\t\tlet selectorList = new csstree.List();\n\t\tselectorList.insertData({\n\t\t\ttype: \"Selector\",\n\t\t\tchildren: selectors\n\t\t});\n\n\t\tif (Array.isArray(block)) {\n\t\t\tblock = this.createBlock(block);\n\t\t}\n\n\t\treturn {\n\t\t\ttype: \"Rule\",\n\t\t\tprelude: {\n\t\t\t\ttype: \"SelectorList\",\n\t\t\t\tchildren: selectorList\n\t\t\t},\n\t\t\tblock: block\n\t\t};\n\t}\n\n}\n\nexport default AtPage;\n","import Handler from \"../handler.js\";\nimport csstree from \"css-tree\";\nimport { displayedElementAfter, displayedElementBefore, needsPageBreak } from \"../../utils/dom.js\";\n\nclass Breaks extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\n\t\tthis.breaks = {};\n\t}\n\n\tonDeclaration(declaration, dItem, dList, rule) {\n\t\tlet property = declaration.property;\n\n\t\tif (property === \"page\") {\n\t\t\tlet children = declaration.value.children.first();\n\t\t\tlet value = children.name;\n\t\t\tlet selector = csstree.generate(rule.ruleNode.prelude);\n\t\t\tlet name = value;\n\n\t\t\tlet breaker = {\n\t\t\t\tproperty: property,\n\t\t\t\tvalue: value,\n\t\t\t\tselector: selector,\n\t\t\t\tname: name\n\t\t\t};\n\n\t\t\tselector.split(\",\").forEach((s) => {\n\t\t\t\tif (!this.breaks[s]) {\n\t\t\t\t\tthis.breaks[s] = [breaker];\n\t\t\t\t} else {\n\t\t\t\t\tthis.breaks[s].push(breaker);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tdList.remove(dItem);\n\t\t}\n\n\t\tif (property === \"break-before\" ||\n\t\t\t\tproperty === \"break-after\" ||\n\t\t\t\tproperty === \"page-break-before\" ||\n\t\t\t\tproperty === \"page-break-after\"\n\t\t) {\n\t\t\tlet child = declaration.value.children.first();\n\t\t\tlet value = child.name;\n\t\t\tlet selector = csstree.generate(rule.ruleNode.prelude);\n\n\t\t\tif (property === \"page-break-before\") {\n\t\t\t\tproperty = \"break-before\";\n\t\t\t} else if (property === \"page-break-after\") {\n\t\t\t\tproperty = \"break-after\";\n\t\t\t}\n\n\t\t\tlet breaker = {\n\t\t\t\tproperty: property,\n\t\t\t\tvalue: value,\n\t\t\t\tselector: selector\n\t\t\t};\n\n\t\t\tselector.split(\",\").forEach((s) => {\n\t\t\t\tif (!this.breaks[s]) {\n\t\t\t\t\tthis.breaks[s] = [breaker];\n\t\t\t\t} else {\n\t\t\t\t\tthis.breaks[s].push(breaker);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Remove from CSS -- handle right / left in module\n\t\t\tdList.remove(dItem);\n\t\t}\n\t}\n\n\tafterParsed(parsed) {\n\t\tthis.processBreaks(parsed, this.breaks);\n\t}\n\n\tprocessBreaks(parsed, breaks) {\n\t\tfor (let b in breaks) {\n\t\t\t// Find elements\n\t\t\tlet elements = parsed.querySelectorAll(b);\n\t\t\t// Add break data\n\t\t\tfor (var i = 0; i < elements.length; i++) {\n\t\t\t\tfor (let prop of breaks[b]) {\n\n\t\t\t\t\tif (prop.property === \"break-after\") {\n\t\t\t\t\t\tlet nodeAfter = displayedElementAfter(elements[i], parsed);\n\n\t\t\t\t\t\telements[i].setAttribute(\"data-break-after\", prop.value);\n\n\t\t\t\t\t\tif (nodeAfter) {\n\t\t\t\t\t\t\tnodeAfter.setAttribute(\"data-previous-break-after\", prop.value);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (prop.property === \"break-before\") {\n\t\t\t\t\t\tlet nodeBefore = displayedElementBefore(elements[i], parsed);\n\n\t\t\t\t\t\t// Breaks are only allowed between siblings, not between a box and its container.\n\t\t\t\t\t\t// If we cannot find a node before we should not break!\n\t\t\t\t\t\t// https://drafts.csswg.org/css-break-3/#break-propagation\n\t\t\t\t\t\tif (nodeBefore) {\n\t\t\t\t\t\t\tif (prop.value === \"page\" && needsPageBreak(elements[i], nodeBefore)) {\n\t\t\t\t\t\t\t\t// we ignore this explicit page break because an implicit page break is already needed\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telements[i].setAttribute(\"data-break-before\", prop.value);\n\t\t\t\t\t\t\tnodeBefore.setAttribute(\"data-next-break-before\", prop.value);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (prop.property === \"page\") {\n\t\t\t\t\t\telements[i].setAttribute(\"data-page\", prop.value);\n\n\t\t\t\t\t\tlet nodeAfter = displayedElementAfter(elements[i], parsed);\n\n\t\t\t\t\t\tif (nodeAfter) {\n\t\t\t\t\t\t\tnodeAfter.setAttribute(\"data-after-page\", prop.value);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\telements[i].setAttribute(\"data-\" + prop.property, prop.value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tmergeBreaks(pageBreaks, newBreaks) {\n\t\tfor (let b in newBreaks) {\n\t\t\tif (b in pageBreaks) {\n\t\t\t\tpageBreaks[b] = pageBreaks[b].concat(newBreaks[b]);\n\t\t\t} else {\n\t\t\t\tpageBreaks[b] = newBreaks[b];\n\t\t\t}\n\t\t}\n\t\treturn pageBreaks;\n\t}\n\n\taddBreakAttributes(pageElement, page) {\n\t\tlet before = pageElement.querySelector(\"[data-break-before]\");\n\t\tlet after = pageElement.querySelector(\"[data-break-after]\");\n\t\tlet previousBreakAfter = pageElement.querySelector(\"[data-previous-break-after]\");\n\n\t\tif (before) {\n\t\t\tif (before.dataset.splitFrom) {\n\t\t\t\tpage.splitFrom = before.dataset.splitFrom;\n\t\t\t\tpageElement.setAttribute(\"data-split-from\", before.dataset.splitFrom);\n\t\t\t} else if (before.dataset.breakBefore && before.dataset.breakBefore !== \"avoid\") {\n\t\t\t\tpage.breakBefore = before.dataset.breakBefore;\n\t\t\t\tpageElement.setAttribute(\"data-break-before\", before.dataset.breakBefore);\n\t\t\t}\n\t\t}\n\n\t\tif (after && after.dataset) {\n\t\t\tif (after.dataset.splitTo) {\n\t\t\t\tpage.splitTo = after.dataset.splitTo;\n\t\t\t\tpageElement.setAttribute(\"data-split-to\", after.dataset.splitTo);\n\t\t\t} else if (after.dataset.breakAfter && after.dataset.breakAfter !== \"avoid\") {\n\t\t\t\tpage.breakAfter = after.dataset.breakAfter;\n\t\t\t\tpageElement.setAttribute(\"data-break-after\", after.dataset.breakAfter);\n\t\t\t}\n\t\t}\n\n\t\tif (previousBreakAfter && previousBreakAfter.dataset) {\n\t\t\tif (previousBreakAfter.dataset.previousBreakAfter && previousBreakAfter.dataset.previousBreakAfter !== \"avoid\") {\n\t\t\t\tpage.previousBreakAfter = previousBreakAfter.dataset.previousBreakAfter;\n\t\t\t}\n\t\t}\n\t}\n\n\tafterPageLayout(pageElement, page) {\n\t\tthis.addBreakAttributes(pageElement, page);\n\t}\n}\n\nexport default Breaks;\n","import Handler from \"../handler.js\";\nimport csstree from \"css-tree\";\n\nclass PrintMedia extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\t}\n\n\tonAtMedia(node, item, list) {\n\t\tlet media = this.getMediaName(node);\n\t\tlet rules;\n\t\tif (media.includes(\"print\")) {\n\t\t\trules = node.block.children;\n\n\t\t\t// Append rules to the end of main rules list\n\t\t\t// TODO: this isn't working right, needs to check what is in the prelude\n\t\t\t/*\n\t\t\trules.forEach((selectList) => {\n\t\t\t\tif (selectList.prelude) {\n\t\t\t\t\tselectList.prelude.children.forEach((rule) => {\n\n\t\t\t\t\t\trule.children.prependData({\n\t\t\t\t\t\t\ttype: \"Combinator\",\n\t\t\t\t\t\t\tname: \" \"\n\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\trule.children.prependData({\n\t\t\t\t\t\t\ttype: \"ClassSelector\",\n\t\t\t\t\t\t\tname: \"pagedjs_page\"\n\t\t\t\t\t\t});\n\t\t\t\t\t});\t\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlist.insertList(rules, item);\n\t\t\t*/\n\n\t\t\t// Append rules to the end of main rules list\n\t\t\tlist.appendList(rules);\n\n\t\t\t// Remove rules from the @media block\n\t\t\tlist.remove(item);\n\t\t} else if (!media.includes(\"all\") && !media.includes(\"pagedjs-ignore\")) {\n\t\t\tlist.remove(item);\n\t\t}\n\n\t}\n\n\tgetMediaName(node) {\n\t\tlet media = [];\n\n\t\tif (typeof node.prelude === \"undefined\" ||\n\t\t\t\tnode.prelude.type !== \"AtrulePrelude\" ) {\n\t\t\treturn;\n\t\t}\n\n\t\tcsstree.walk(node.prelude, {\n\t\t\tvisit: \"Identifier\",\n\t\t\tenter: (identNode, iItem, iList) => {\n\t\t\t\tmedia.push(identNode.name);\n\t\t\t}\n\t\t});\n\t\treturn media;\n\t}\n\n\n}\n\nexport default PrintMedia;\n","import Handler from \"../handler.js\";\n\nclass Splits extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\t}\n\n\tafterPageLayout(pageElement, page, breakToken, chunker) {\n\t\tlet splits = Array.from(pageElement.querySelectorAll(\"[data-split-from]\"));\n\t\tlet pages = pageElement.parentNode;\n\t\tlet index = Array.prototype.indexOf.call(pages.children, pageElement);\n\t\tlet prevPage;\n\n\t\tif (index === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tprevPage = pages.children[index - 1];\n\n\t\tlet from; // Capture the last from element\n\t\tsplits.forEach((split) => {\n\t\t\tlet ref = split.dataset.ref;\n\t\t\tfrom = prevPage.querySelector(\"[data-ref='\"+ ref +\"']:not([data-split-to])\");\n\n\t\t\tif (from) {\n\t\t\t\tfrom.dataset.splitTo = ref;\n\n\t\t\t\tif (!from.dataset.splitFrom) {\n\t\t\t\t\tfrom.dataset.splitOriginal = true;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Fix alignment on the deepest split element\n\t\tif (from) {\n\t\t\tthis.handleAlignment(from);\n\t\t}\n\t}\n\n\thandleAlignment(node) {\n\t\tlet styles = window.getComputedStyle(node);\n\t\tlet align = styles[\"text-align\"];\n\t\tlet alignLast = styles[\"text-align-last\"];\n\t\tnode.dataset.lastSplitElement = \"true\";\n\t\tif (align === \"justify\" && alignLast === \"auto\") {\n\t\t\tnode.dataset.alignLastSplitElement = \"justify\";\n\t\t} else {\n\t\t\tnode.dataset.alignLastSplitElement = alignLast;\n\t\t}\n\t}\n\n}\n\nexport default Splits;\n","import Handler from \"../handler.js\";\nimport csstree from \"css-tree\";\n\nclass Counters extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\n\t\tthis.styleSheet = polisher.styleSheet;\n\t\tthis.counters = {};\n\t\tthis.resetCountersMap = new Map();\n\t}\n\n\tonDeclaration(declaration, dItem, dList, rule) {\n\t\tlet property = declaration.property;\n\n\t\tif (property === \"counter-increment\") {\n\t\t\tthis.handleIncrement(declaration, rule);\n\t\t\t// clean up empty declaration\n\t\t\tlet hasProperities = false;\n\t\t\tdeclaration.value.children.forEach((data) => {\n\t\t\t\tif (data.type && data.type !== \"WhiteSpace\") {\n\t\t\t\t\thasProperities = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (!hasProperities) {\n\t\t\t\tdList.remove(dItem);\n\t\t\t}\n\t\t} else if (property === \"counter-reset\") {\n\t\t\tthis.handleReset(declaration, rule);\n\t\t\t// clean up empty declaration\n\t\t\tlet hasProperities = false;\n\t\t\tdeclaration.value.children.forEach((data) => {\n\t\t\t\tif (data.type && data.type !== \"WhiteSpace\") {\n\t\t\t\t\thasProperities = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (!hasProperities) {\n\t\t\t\tdList.remove(dItem);\n\t\t\t}\n\t\t}\n\t}\n\n\tafterParsed(parsed) {\n\t\tthis.processCounters(parsed, this.counters);\n\t\tthis.scopeCounters(this.counters);\n\t}\n\n\taddCounter(name) {\n\t\tif (name in this.counters) {\n\t\t\treturn this.counters[name];\n\t\t}\n\n\t\tthis.counters[name] = {\n\t\t\tname: name,\n\t\t\tincrements: {},\n\t\t\tresets: {}\n\t\t};\n\n\t\treturn this.counters[name];\n\t}\n\n\thandleIncrement(declaration, rule) {\n\t\tlet increments = [];\n\t\tlet children = declaration.value.children;\n\n\t\tchildren.forEach((data, item) => {\n\t\t\tif (data.type && data.type === \"Identifier\") {\n\t\t\t\tlet name = data.name;\n\n\t\t\t\tif (name === \"page\" || name.indexOf(\"target-counter-\") === 0) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet whitespace, number, value;\n\t\t\t\tif (item.next && item.next.data.type === \"WhiteSpace\") {\n\t\t\t\t\twhitespace = item.next;\n\t\t\t\t}\n\t\t\t\tif (whitespace && whitespace.next && whitespace.next.data.type === \"Number\") {\n\t\t\t\t\tnumber = whitespace.next;\n\t\t\t\t\tvalue = parseInt(number.data.value);\n\t\t\t\t}\n\n\t\t\t\tlet selector = csstree.generate(rule.ruleNode.prelude);\n\n\t\t\t\tlet counter;\n\t\t\t\tif (!(name in this.counters)) {\n\t\t\t\t\tcounter = this.addCounter(name);\n\t\t\t\t} else {\n\t\t\t\t\tcounter = this.counters[name];\n\t\t\t\t}\n\t\t\t\tlet increment = {\n\t\t\t\t\tselector: selector,\n\t\t\t\t\tnumber: value || 1\n\t\t\t\t};\n\t\t\t\tcounter.increments[selector] = increment;\n\t\t\t\tincrements.push(increment);\n\n\t\t\t\t// Remove the parsed resets\n\t\t\t\tchildren.remove(item);\n\t\t\t\tif (whitespace) {\n\t\t\t\t\tchildren.remove(whitespace);\n\t\t\t\t}\n\t\t\t\tif (number) {\n\t\t\t\t\tchildren.remove(number);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn increments;\n\t}\n\n\thandleReset(declaration, rule) {\n\t\tlet children = declaration.value.children;\n\n\t\tchildren.forEach((data, item) => {\n\t\t\tif (data.type && data.type === \"Identifier\") {\n\t\t\t\tlet name = data.name;\n\t\t\t\tlet whitespace, number, value;\n\t\t\t\tif (item.next && item.next.data.type === \"WhiteSpace\") {\n\t\t\t\t\twhitespace = item.next;\n\t\t\t\t}\n\t\t\t\tif (whitespace && whitespace.next) {\n\t\t\t\t\tif (whitespace.next.data.type === \"Number\") {\n\t\t\t\t\t\t// The counter reset value is specified using a number. E.g. counter-reset: c2 5;\n\t\t\t\t\t\tnumber = whitespace.next;\n\t\t\t\t\t\tvalue = parseInt(number.data.value);\n\t\t\t\t\t} else if (whitespace.next.data.type === \"Function\" && whitespace.next.data.name === \"var\") {\n\t\t\t\t\t\t// The counter reset value is specified using a CSS variable (custom property).\n\t\t\t\t\t\t// E.g. counter-reset: c2 var(--my-variable);\n\t\t\t\t\t\t// See https://developer.mozilla.org/en-US/docs/Web/CSS/var\n\t\t\t\t\t\tnumber = whitespace.next;\n\t\t\t\t\t\t// Use the variable name (e.g. '--my-variable') as value for now. The actual value is resolved later by the\n\t\t\t\t\t\t// processCounterResets function.\n\t\t\t\t\t\tvalue = whitespace.next.data.children.head.data.name;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet counter;\n\t\t\t\tlet selector;\n\t\t\t\tlet prelude = rule.ruleNode.prelude;\n\n\t\t\t\tif (rule.ruleNode.type === \"Atrule\" && rule.ruleNode.name === \"page\") {\n\t\t\t\t\tselector = \".pagedjs_page\";\n\t\t\t\t} else {\n\t\t\t\t\tselector = csstree.generate(prelude || rule.ruleNode);\n\t\t\t\t}\n\n\t\t\t\tif (name === \"footnote\") {\n\t\t\t\t\tthis.addFootnoteMarkerCounter(declaration.value.children);\n\t\t\t\t}\n\n\t\t\t\tif (!(name in this.counters)) {\n\t\t\t\t\tcounter = this.addCounter(name);\n\t\t\t\t} else {\n\t\t\t\t\tcounter = this.counters[name];\n\t\t\t\t}\n\n\t\t\t\tlet reset = {\n\t\t\t\t\tselector: selector,\n\t\t\t\t\tnumber: value || 0\n\t\t\t\t};\n\n\t\t\t\tcounter.resets[selector] = reset;\n\n\t\t\t\tif (selector !== \".pagedjs_page\") {\n\t\t\t\t\t// Remove the parsed resets\n\t\t\t\t\tchildren.remove(item);\n\t\t\t\t\tif (whitespace) {\n\t\t\t\t\t\tchildren.remove(whitespace);\n\t\t\t\t\t}\n\t\t\t\t\tif (number) {\n\t\t\t\t\t\tchildren.remove(number);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprocessCounters(parsed, counters) {\n\t\tlet counter;\n\t\tfor (let c in counters) {\n\t\t\tcounter = this.counters[c];\n\t\t\tthis.processCounterIncrements(parsed, counter);\n\t\t\tthis.processCounterResets(parsed, counter);\n\t\t\tif (c !== \"page\") {\n\t\t\t\tthis.addCounterValues(parsed, counter);\n\t\t\t}\n\t\t}\n\t}\n\n\tscopeCounters(counters) {\n\t\tlet countersArray = [];\n\t\tfor (let c in counters) {\n\t\t\tif(c !== \"page\") {\n\t\t\t\tcountersArray.push(`${counters[c].name} 0`);\n\t\t\t}\n\t\t}\n\t\t// Add to pages to allow cross page scope\n\t\tthis.insertRule(`.pagedjs_pages { counter-reset: ${countersArray.join(\" \")} page 0 pages var(--pagedjs-page-count) footnote var(--pagedjs-footnotes-count) footnote-marker var(--pagedjs-footnotes-count)}`);\n\t}\n\n\tinsertRule(rule) {\n\t\tthis.styleSheet.insertRule(rule, this.styleSheet.cssRules.length);\n\t}\n\n\tprocessCounterIncrements(parsed, counter) {\n\t\tlet increment;\n\t\tfor (let inc in counter.increments) {\n\t\t\tincrement = counter.increments[inc];\n\t\t\t// Find elements for increments\n\t\t\tlet incrementElements = parsed.querySelectorAll(increment.selector);\n\t\t\t// Add counter data\n\t\t\tfor (let i = 0; i < incrementElements.length; i++) {\n\t\t\t\tincrementElements[i].setAttribute(\"data-counter-\"+ counter.name +\"-increment\", increment.number);\n\t\t\t\tif (incrementElements[i].getAttribute(\"data-counter-increment\")) {\n\t\t\t\t\tincrementElements[i].setAttribute(\"data-counter-increment\", incrementElements[i].getAttribute(\"data-counter-increment\") + \" \" + counter.name);\n\t\t\t\t} else {\n\t\t\t\t\tincrementElements[i].setAttribute(\"data-counter-increment\", counter.name);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessCounterResets(parsed, counter) {\n\t\tlet reset;\n\t\tfor (let r in counter.resets) {\n\t\t\treset = counter.resets[r];\n\t\t\t// Find elements for resets\n\t\t\tlet resetElements = parsed.querySelectorAll(reset.selector);\n\t\t\t// Add counter data\n\t\t\tfor (var i = 0; i < resetElements.length; i++) {\n\t\t\t\tlet value = reset.number;\n\t\t\t\tif (typeof value === \"string\" && value.startsWith(\"--\")) {\n\t\t\t\t\t// The value is specified using a CSS variable (custom property).\n\t\t\t\t\t// FIXME: We get the variable value only from the inline style of the element because at this point the\n\t\t\t\t\t// element is detached and thus using:\n\t\t\t\t\t//\n\t\t\t\t\t//\t\tgetComputedStyle(resetElements[i]).getPropertyValue(value)\n\t\t\t\t\t//\n\t\t\t\t\t// always returns an empty string. We could try to temporarily attach the element to get its computed style,\n\t\t\t\t\t// but for now using the inline style is enough for us.\n\t\t\t\t\tvalue = resetElements[i].style.getPropertyValue(value) || 0;\n\t\t\t\t}\n\t\t\t\tresetElements[i].setAttribute(\"data-counter-\"+ counter.name +\"-reset\", value);\n\t\t\t\tif (resetElements[i].getAttribute(\"data-counter-reset\")) {\n\t\t\t\t\tresetElements[i].setAttribute(\"data-counter-reset\", resetElements[i].getAttribute(\"data-counter-reset\") + \" \" + counter.name);\n\t\t\t\t} else {\n\t\t\t\t\tresetElements[i].setAttribute(\"data-counter-reset\", counter.name);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\taddCounterValues(parsed, counter) {\n\t\tlet counterName = counter.name;\n\n\t\tif (counterName === \"page\" || counterName === \"footnote\") {\n\t\t\treturn;\n\t\t}\n\n\t\tlet elements = parsed.querySelectorAll(\"[data-counter-\"+ counterName +\"-reset], [data-counter-\"+ counterName +\"-increment]\");\n\n\t\tlet count = 0;\n\t\tlet element;\n\t\tlet increment, reset;\n\t\tlet resetValue, incrementValue, resetDelta;\n\t\tlet incrementArray;\n\n\t\tfor (let i = 0; i < elements.length; i++) {\n\t\t\telement = elements[i];\n\t\t\tresetDelta = 0;\n\t\t\tincrementArray = [];\n\n\t\t\tif (element.hasAttribute(\"data-counter-\"+ counterName +\"-reset\")) {\n\t\t\t\treset = element.getAttribute(\"data-counter-\"+ counterName +\"-reset\");\n\t\t\t\tresetValue = parseInt(reset);\n\n\t\t\t\t// Use negative increment value inplace of reset\n\t\t\t\tresetDelta = resetValue - count;\n\t\t\t\tincrementArray.push(`${counterName} ${resetDelta}`);\n\n\t\t\t\tcount = resetValue;\n\t\t\t}\n\n\t\t\tif (element.hasAttribute(\"data-counter-\"+ counterName +\"-increment\")) {\n\n\t\t\t\tincrement = element.getAttribute(\"data-counter-\"+ counterName +\"-increment\");\n\t\t\t\tincrementValue = parseInt(increment);\n\n\t\t\t\tcount += incrementValue;\n\n\t\t\t\telement.setAttribute(\"data-counter-\"+counterName+\"-value\", count);\n\n\t\t\t\tincrementArray.push(`${counterName} ${incrementValue}`);\n\t\t\t}\n\n\t\t\tif (incrementArray.length > 0) {\n\t\t\t\tthis.incrementCounterForElement(element, incrementArray);\n\t\t\t}\n\n\t\t}\n\t}\n\n\taddFootnoteMarkerCounter(list) {\n\t\tlet markers = [];\n\t\tcsstree.walk(list, {\n\t\t\tvisit: \"Identifier\",\n\t\t\tenter: (identNode, iItem, iList) => {\n\t\t\t\tmarkers.push(identNode.name);\n\t\t\t}\n\t\t});\n\n\t\t// Already added\n\t\tif (markers.includes(\"footnote-maker\")) {\n\t\t\treturn;\n\t\t}\n\n\t\tlist.insertData({\n\t\t\ttype: \"WhiteSpace\",\n\t\t\tvalue: \" \"\n\t\t});\n\n\t\tlist.insertData({\n\t\t\ttype: \"Identifier\",\n\t\t\tname: \"footnote-marker\"\n\t\t});\n\n\t\tlist.insertData({\n\t\t\ttype: \"WhiteSpace\",\n\t\t\tvalue: \" \"\n\t\t});\n\n\t\tlist.insertData({\n\t\t\ttype: \"Number\",\n\t\t\tvalue: 0\n\t\t});\n\t}\n\n\tincrementCounterForElement(element, incrementArray) {\n\t\tif (!element || !incrementArray || incrementArray.length === 0) return;\n\n\t\tconst ref = element.dataset.ref;\n\t\tconst increments = Array.from(this.styleSheet.cssRules).filter((rule) => {\n\t\t\treturn rule.selectorText === `[data-ref=\"${element.dataset.ref}\"]:not([data-split-from])`\n\t\t\t\t\t\t && rule.style[0] === \"counter-increment\";\n\t\t}).map(rule => rule.style.counterIncrement);\n\n\t\t// Merge the current increments by summing the values because we generate both a decrement and an increment when the\n\t\t// element resets and increments the counter at the same time. E.g. ['c1 -7', 'c1 1'] should lead to 'c1 -6'.\n\t\tincrements.push(this.mergeIncrements(incrementArray,\n\t\t\t(prev, next) => (parseInt(prev) || 0) + (parseInt(next) || 0)));\n\n\t\t// Keep the last value for each counter when merging with the previous increments. E.g. ['c1 -7 c2 3', 'c1 1']\n\t\t// should lead to 'c1 1 c2 3'.\n\t\tconst counterIncrement = this.mergeIncrements(increments, (prev, next) => next);\n\t\tthis.insertRule(`[data-ref=\"${ref}\"]:not([data-split-from]) { counter-increment: ${counterIncrement} }`);\n\t}\n\n\t/**\n\t * Merge multiple values of a counter-increment CSS rule, using the specified operator.\n\t *\n\t * @param {Array} incrementArray the values to merge, e.g. ['c1 1', 'c1 -7 c2 1']\n\t * @param {Function} operator the function used to merge counter values (e.g. keep the last value of a counter or sum\n\t *\t\t\t\t\tthe counter values)\n\t * @return {string} the merged value of the counter-increment CSS rule\n\t */\n\tmergeIncrements(incrementArray, operator) {\n\t\tconst increments = {};\n\t\tincrementArray.forEach(increment => {\n\t\t\tlet values = increment.split(\" \");\n\t\t\tfor (let i = 0; i < values.length; i+=2) {\n\t\t\t\tincrements[values[i]] = operator(increments[values[i]], values[i + 1]);\n\t\t\t}\n\t\t});\n\n\t\treturn Object.entries(increments).map(([key, value]) => `${key} ${value}`).join(\" \");\n\t}\n\n\tafterPageLayout(pageElement, page) {\n\t\tlet resets = [];\n\n\t\tlet pgreset = pageElement.querySelectorAll(\"[data-counter-page-reset]:not([data-split-from])\");\n\t\tpgreset.forEach((reset) => {\n\t\t\tconst ref = reset.dataset && reset.dataset.ref;\n\t\t\tif (ref && this.resetCountersMap.has(ref)) {\n\t\t\t\t// ignoring, the counter-reset directive has already been taken into account.\n\t\t\t} else {\n\t\t\t\tif (ref) {\n\t\t\t\t\tthis.resetCountersMap.set(ref, \"\");\n\t\t\t\t}\n\t\t\t\tlet value = reset.dataset.counterPageReset;\n\t\t\t\tresets.push(`page ${value}`);\n\t\t\t}\n\t\t});\n\n\t\tlet notereset = pageElement.querySelectorAll(\"[data-counter-footnote-reset]:not([data-split-from])\");\n\t\tnotereset.forEach((reset) => {\n\t\t\tlet value = reset.dataset.counterFootnoteReset;\n\t\t\tresets.push(`footnote ${value}`);\n\t\t\tresets.push(`footnote-marker ${value}`);\n\t\t});\n\n\t\tif (resets.length) {\n\t\t\tthis.styleSheet.insertRule(`[data-page-number=\"${pageElement.dataset.pageNumber}\"] { counter-increment: none; counter-reset: ${resets.join(\" \")} }`, this.styleSheet.cssRules.length);\n\t\t}\n\t}\n\n}\n\nexport default Counters;\n","import Handler from \"../handler.js\";\n\nclass Lists extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\t}\n\tafterParsed(content) {\n\t\tconst orderedLists = content.querySelectorAll(\"ol\");\n\n\t\tfor (var list of orderedLists) {\n\t\t\tthis.addDataNumbers(list);\n\t\t}\n\t}\n\n\tafterPageLayout(pageElement, page, breakToken, chunker) {\n\t\tvar orderedLists = pageElement.getElementsByTagName(\"ol\");\n\t\tfor (var list of orderedLists) {\n\t\t\tif (list.firstElementChild) {\n\t\t\t\tlist.start = list.firstElementChild.dataset.itemNum;\n\t\t\t}\n\t\t}\n\t}\n\n\taddDataNumbers(list) {\n\t\tlet start = 1;\n\t\tif (list.hasAttribute(\"start\")) {\n\t\t\tstart = parseInt(list.getAttribute(\"start\"), 10);\n\t\t\tif (isNaN(start)) {\n\t\t\t\tstart = 1;\n\t\t\t}\n\t\t}\n\t\tlet items = list.children;\n\t\tfor (var i = 0; i < items.length; i++) {\n\t\t\titems[i].setAttribute(\"data-item-num\", i + start);\n\t\t}\n\t}\n\n}\n\nexport default Lists;\n","import Handler from \"../handler.js\";\nimport csstree from \"css-tree\";\n\nclass PositionFixed extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\t\tthis.styleSheet = polisher.styleSheet;\n\t\tthis.fixedElementsSelector = [];\n\t\tthis.fixedElements = [];\n\t}\n\n\tonDeclaration(declaration, dItem, dList, rule) {\n\t\tif (declaration.property === \"position\" && declaration.value.children.first().name === \"fixed\") {\n\t\t\tlet selector = csstree.generate(rule.ruleNode.prelude);\n\t\t\tthis.fixedElementsSelector.push(selector);\n\t\t\tdList.remove(dItem);\n\t\t}\n\t}\n\n\tafterParsed(fragment) {\n\t\tthis.fixedElementsSelector.forEach(fixedEl => {\n\t\t\tfragment.querySelectorAll(`${fixedEl}`).forEach(el => {\n\t\t\t\tel.style.setProperty(\"position\", \"absolute\");\n\t\t\t\tthis.fixedElements.push(el);\n\t\t\t\tel.remove();\n\t\t\t});\n\t\t});\n\t}\n\n\tafterPageLayout(pageElement, page, breakToken) {\n\t\tthis.fixedElements.forEach(el => {\n\t\t\tconst clone = el.cloneNode(true);\n\t\t\tpageElement.querySelector(\".pagedjs_pagebox\").insertAdjacentElement(\"afterbegin\", clone);\n\t\t});\n\t}\n}\n\n\n\n\n\nexport default PositionFixed;\n\n","import Handler from \"../handler.js\";\nimport csstree from \"css-tree\";\n\nclass PageCounterIncrement extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\n\t\tthis.styleSheet = polisher.styleSheet;\n\t\tthis.pageCounter = {\n\t\t\tname: \"page\",\n\t\t\tincrements: {},\n\t\t\tresets: {}\n\t\t};\n\t}\n\n\tonDeclaration(declaration, dItem, dList, rule) {\n\t\tconst property = declaration.property;\n\n\t\tif (property === \"counter-increment\") {\n\t\t\tlet inc = this.handleIncrement(declaration, rule);\n\t\t\tif (inc) {\n\t\t\t\tdList.remove(dItem);\n\t\t\t}\n\t\t}\n\t}\n\n\tafterParsed(_) {\n\t\tfor (const inc in this.pageCounter.increments) {\n\t\t\tconst increment = this.pageCounter.increments[inc];\n\t\t\tthis.insertRule(`${increment.selector} { --pagedjs-page-counter-increment: ${increment.number} }`);\n\t\t}\n\t}\n\n\thandleIncrement(declaration, rule) {\n\t\tconst identifier = declaration.value.children.first();\n\t\tconst number = declaration.value.children.getSize() > 1 ? declaration.value.children.last().value : 1;\n\t\tconst name = identifier && identifier.name;\n\n\t\tif (name && name.indexOf(\"target-counter-\") === 0) {\n\t\t\treturn;\n\t\t}\n\t\t// A counter named page is automatically created and incremented by 1 on every page of the document,\n\t\t// unless the counter-increment property in the page context explicitly specifies a different increment for the page counter.\n\t\t// https://www.w3.org/TR/css-page-3/#page-based-counters\n\t\tif (name !== \"page\") {\n\t\t\treturn;\n\t\t}\n\t\t// the counter-increment property is not defined on the page context (i.e. @page rule), ignoring...\n\t\tif (rule.ruleNode.name === \"page\" && rule.ruleNode.type === \"Atrule\") {\n\t\t\treturn;\n\t\t}\n\t\tconst selector = csstree.generate(rule.ruleNode.prelude);\n\t\treturn this.pageCounter.increments[selector] = {\n\t\t\tselector: selector,\n\t\t\tnumber\n\t\t};\n\t}\n\n\tinsertRule(rule) {\n\t\tthis.styleSheet.insertRule(rule, this.styleSheet.cssRules.length);\n\t}\n}\n\nexport default PageCounterIncrement;\n","import Handler from \"../handler.js\";\nimport csstree from \"css-tree\";\nimport {UUID} from \"../../utils/utils.js\";\n\nclass NthOfType extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\n\t\tthis.styleSheet = polisher.styleSheet;\n\t\tthis.selectors = {};\n\t}\n\n\tonRule(ruleNode, ruleItem, rulelist) {\n\t\tlet selector = csstree.generate(ruleNode.prelude);\n\t\tif (selector.match(/:(first|last|nth)-of-type/)) {\n\t\t\t\n\t\t\tlet declarations = csstree.generate(ruleNode.block);\n\t\t\tdeclarations = declarations.replace(/[{}]/g,\"\");\n\n\t\t\tlet uuid = \"nth-of-type-\" + UUID();\n\n\t\t\tselector.split(\",\").forEach((s) => {\n\t\t\t\tif (!this.selectors[s]) {\n\t\t\t\t\tthis.selectors[s] = [uuid, declarations];\n\t\t\t\t} else {\n\t\t\t\t\tthis.selectors[s][1] = `${this.selectors[s][1]};${declarations}` ;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\trulelist.remove(ruleItem);\n\t\t}\n\t}\n\n\tafterParsed(parsed) {\n\t\tthis.processSelectors(parsed, this.selectors);\n\t}\n\n\tprocessSelectors(parsed, selectors) {\n\t\t// add the new attributes to matching elements\n\t\tfor (let s in selectors) {\n\t\t\tlet elements = parsed.querySelectorAll(s);\n\n\t\t\tfor (var i = 0; i < elements.length; i++) {\n\t\t\t\tlet dataNthOfType = elements[i].getAttribute(\"data-nth-of-type\");\n\n\t\t\t\tif (dataNthOfType && dataNthOfType != \"\") {\n\t\t\t\t\tdataNthOfType = `${dataNthOfType},${selectors[s][0]}`;\n\t\t\t\t\telements[i].setAttribute(\"data-nth-of-type\", dataNthOfType);\n\t\t\t\t} else {\n\t\t\t\t\telements[i].setAttribute(\"data-nth-of-type\", selectors[s][0]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet rule = `*[data-nth-of-type*='${selectors[s][0]}'] { ${selectors[s][1]}; }`;\n\t\t\tthis.styleSheet.insertRule(rule, this.styleSheet.cssRules.length);\n\t\t}\n\t}\n}\n\n\n\n\nexport default NthOfType;\n\n","import Handler from \"../handler.js\";\nimport csstree from \"css-tree\";\nimport {UUID} from \"../../utils/utils.js\";\n\nclass Following extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\n\t\tthis.styleSheet = polisher.styleSheet;\n\t\tthis.selectors = {};\n\t}\n\n\tonRule(ruleNode, ruleItem, rulelist) {\n\t\tlet selector = csstree.generate(ruleNode.prelude);\n\t\tif (selector.match(/\\+/)) {\n\t\t\t\n\t\t\tlet declarations = csstree.generate(ruleNode.block);\n\t\t\tdeclarations = declarations.replace(/[{}]/g,\"\");\n\n\t\t\tlet uuid = \"following-\" + UUID();\n\n\t\t\tselector.split(\",\").forEach((s) => {\n\t\t\t\tif (!this.selectors[s]) {\n\t\t\t\t\tthis.selectors[s] = [uuid, declarations];\n\t\t\t\t} else {\n\t\t\t\t\tthis.selectors[s][1] = `${this.selectors[s][1]};${declarations}` ;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\trulelist.remove(ruleItem);\n\t\t}\n\t}\n\n\tafterParsed(parsed) {\n\t\tthis.processSelectors(parsed, this.selectors);\n\t}\n\n\tprocessSelectors(parsed, selectors) {\n\t\t// add the new attributes to matching elements\n\t\tfor (let s in selectors) {\n\t\t\tlet elements = parsed.querySelectorAll(s);\n\n\t\t\tfor (var i = 0; i < elements.length; i++) {\n\t\t\t\tlet dataFollowing = elements[i].getAttribute(\"data-following\");\n\n\t\t\t\tif (dataFollowing && dataFollowing != \"\") {\n\t\t\t\t\tdataFollowing = `${dataFollowing},${selectors[s][0]}`;\n\t\t\t\t\telements[i].setAttribute(\"data-following\", dataFollowing);\n\t\t\t\t} else {\n\t\t\t\t\telements[i].setAttribute(\"data-following\", selectors[s][0]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet rule = `*[data-following*='${selectors[s][0]}'] { ${selectors[s][1]}; }`;\n\t\t\tthis.styleSheet.insertRule(rule, this.styleSheet.cssRules.length);\n\t\t}\n\t}\n}\n\n\n\n\nexport default Following;\n\n","import Handler from \"../handler.js\";\nimport { isContainer, isElement } from \"../../utils/dom.js\";\nimport Layout from \"../../chunker/layout.js\";\nimport csstree from \"css-tree\";\n\nclass Footnotes extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\n\t\tthis.footnotes = {};\n\t\tthis.needsLayout = [];\n\t}\n\n\tonDeclaration(declaration, dItem, dList, rule) {\n\t\tlet property = declaration.property;\n\t\tif (property === \"float\") {\n\t\t\tlet identifier = declaration.value.children && declaration.value.children.first();\n\t\t\tlet location = identifier && identifier.name;\n\t\t\tif (location === \"footnote\") {\n\t\t\t\tlet selector = csstree.generate(rule.ruleNode.prelude);\n\t\t\t\tthis.footnotes[selector] = {\n\t\t\t\t\tselector: selector,\n\t\t\t\t\tpolicy: \"auto\",\n\t\t\t\t\tdisplay: \"block\"\n\t\t\t\t};\n\t\t\t\tdList.remove(dItem);\n\t\t\t}\n\t\t}\n\t\tif (property === \"footnote-policy\") {\n\t\t\tlet identifier = declaration.value.children && declaration.value.children.first();\n\t\t\tlet policy = identifier && identifier.name;\n\t\t\tif (policy) {\n\t\t\t\tlet selector = csstree.generate(rule.ruleNode.prelude);\n\t\t\t\tlet note = this.footnotes[selector];\n\t\t\t\tif (note) {\n\t\t\t\t\tnote.policy = policy;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (property === \"footnote-display\") {\n\t\t\tlet identifier = declaration.value.children && declaration.value.children.first();\n\t\t\tlet display = identifier && identifier.name;\n\t\t\tlet selector = csstree.generate(rule.ruleNode.prelude);\n\t\t\tif (display && this.footnotes[selector]) {\n\t\t\t\tlet note = this.footnotes[selector];\n\t\t\t\tif (note) {\n\t\t\t\t\tnote.display = display;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonPseudoSelector(pseudoNode, pItem, pList, selector, rule) {\n\t\tlet name = pseudoNode.name;\n\t\tif (name === \"footnote-marker\") {\n\t\t\t// switch ::footnote-marker to [data-footnote-marker]::before\n\t\t\tlet prelude = rule.ruleNode.prelude;\n\t\t\tlet newPrelude = new csstree.List();\n\n\t\t\t// Can't get remove to work, so just copying everything else\n\t\t\tprelude.children.first().children.each((node) => {\n\t\t\t\tif (node.type !== \"PseudoElementSelector\") {\n\t\t\t\t\tnewPrelude.appendData(node);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Add our data call\n\t\t\tnewPrelude.appendData({\n\t\t\t\ttype: \"AttributeSelector\",\n\t\t\t\tname: {\n\t\t\t\t\ttype: \"Identifier\",\n\t\t\t\t\tname: \"data-footnote-marker\",\n\t\t\t\t},\n\t\t\t\tflags: null,\n\t\t\t\tloc: null,\n\t\t\t\tmatcher: null,\n\t\t\t\tvalue: null\n\t\t\t});\n\n\t\t\t// Add new pseudo element\n\t\t\tnewPrelude.appendData({\n\t\t\t\ttype: \"PseudoElementSelector\",\n\t\t\t\tname: \"marker\",\n\t\t\t\tloc: null,\n\t\t\t\tchildren: null\n\t\t\t});\n\n\t\t\tprelude.children.first().children = newPrelude;\n\t\t}\n\n\t\tif (name === \"footnote-call\") {\n\t\t\t// switch ::footnote-call to [data-footnote-call]::after\n\n\t\t\tlet prelude = rule.ruleNode.prelude;\n\t\t\tlet newPrelude = new csstree.List();\n\n\t\t\t// Can't get remove to work, so just copying everything else\n\t\t\tprelude.children.first().children.each((node) => {\n\t\t\t\tif (node.type !== \"PseudoElementSelector\") {\n\t\t\t\t\tnewPrelude.appendData(node);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Add our data call\n\t\t\tnewPrelude.appendData({\n\t\t\t\ttype: \"AttributeSelector\",\n\t\t\t\tname: {\n\t\t\t\t\ttype: \"Identifier\",\n\t\t\t\t\tname: \"data-footnote-call\",\n\t\t\t\t},\n\t\t\t\tflags: null,\n\t\t\t\tloc: null,\n\t\t\t\tmatcher: null,\n\t\t\t\tvalue: null\n\t\t\t});\n\n\t\t\t// Add new pseudo element\n\t\t\tnewPrelude.appendData({\n\t\t\t\ttype: \"PseudoElementSelector\",\n\t\t\t\tname: \"after\",\n\t\t\t\tloc: null,\n\t\t\t\tchildren: null\n\t\t\t});\n\n\t\t\tprelude.children.first().children = newPrelude;\n\t\t}\n\t}\n\n\tafterParsed(parsed) {\n\t\tthis.processFootnotes(parsed, this.footnotes);\n\t}\n\n\tprocessFootnotes(parsed, notes) {\n\t\tfor (let n in notes) {\n\t\t\t// Find elements\n\t\t\tlet elements = parsed.querySelectorAll(n);\n\t\t\tlet element;\n\t\t\tlet note = notes[n];\n\t\t\tfor (var i = 0; i < elements.length; i++) {\n\t\t\t\telement = elements[i];\n\t\t\t\t// Add note type\n\t\t\t\telement.setAttribute(\"data-note\", \"footnote\");\n\t\t\t\telement.setAttribute(\"data-break-before\", \"avoid\");\n\t\t\t\telement.setAttribute(\"data-note-policy\", note.policy || \"auto\");\n\t\t\t\telement.setAttribute(\"data-note-display\", note.display || \"block\");\n\t\t\t\t// Mark all parents\n\t\t\t\tthis.processFootnoteContainer(element);\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessFootnoteContainer(node) {\n\t\t// Find the container\n\t\tlet element = node.parentElement;\n\t\tlet prevElement = element;\n\t\t// Walk up the dom until we find a container element\n\t\twhile (element) {\n\t\t\tif (isContainer(element)) {\n\t\t\t\t// Add flag to the previous non-container element that will render with children\n\t\t\t\tprevElement.setAttribute(\"data-has-notes\", \"true\");\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tprevElement = element;\n\t\t\telement = element.parentElement;\n\n\t\t\t// If no containers were found and there are no further parents flag the last element\n\t\t\tif (!element) {\n\t\t\t\tprevElement.setAttribute(\"data-has-notes\", \"true\");\n\t\t\t}\n\t\t}\n\t}\n\n\trenderNode(node) {\n\t\tif (node.nodeType == 1) {\n\t\t\t// Get all notes\n\t\t\tlet notes;\n\n\t\t\t// Ingnore html element nodes, like mathml\n\t\t\tif (!node.dataset) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (node.dataset.note === \"footnote\") {\n\t\t\t\tnotes = [node];\n\t\t\t} else if (node.dataset.hasNotes || node.querySelectorAll(\"[data-note='footnote']\")) {\n\t\t\t\tnotes = node.querySelectorAll(\"[data-note='footnote']\");\n\t\t\t}\n\n\t\t\tif (notes && notes.length) {\n\t\t\t\tthis.findVisibleFootnotes(notes, node);\n\t\t\t}\n\t\t}\n\t}\n\n\tfindVisibleFootnotes(notes, node) {\n\t\tlet area, size, right;\n\t\tarea = node.closest(\".pagedjs_page_content\");\n\t\tsize = area.getBoundingClientRect();\n\t\tright = size.left + size.width;\n\n\t\tfor (let i = 0; i < notes.length; ++i) {\n\t\t\tlet currentNote = notes[i];\n\t\t\tlet bounds = currentNote.getBoundingClientRect();\n\t\t\tlet left = bounds.left;\n\n\t\t\tif (left < right) {\n\t\t\t\t// Add call for the note\n\t\t\t\tthis.moveFootnote(currentNote, node.closest(\".pagedjs_area\"), true);\n\t\t\t}\n\t\t}\n\t}\n\n\tmoveFootnote(node, pageArea, needsNoteCall) {\n\t\t// let pageArea = node.closest(\".pagedjs_area\");\n\t\tlet noteArea = pageArea.querySelector(\".pagedjs_footnote_area\");\n\t\tlet noteContent = noteArea.querySelector(\".pagedjs_footnote_content\");\n\t\tlet noteInnerContent = noteContent.querySelector(\".pagedjs_footnote_inner_content\");\n\n\t\tif (!isElement(node)) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Add call for the note\n\t\tlet noteCall;\n\t\tif (needsNoteCall) {\n\t\t\tnoteCall = this.createFootnoteCall(node);\n\t\t}\n\n\t\t// Remove the break before attribute for future layout\n\t\tnode.removeAttribute(\"data-break-before\");\n\n\t\t// Check if note already exists for overflow\n\t\tlet existing = noteInnerContent.querySelector(`[data-ref=\"${node.dataset.ref}\"]`);\n\t\tif (existing) {\n\t\t\t// Remove the note from the flow but no need to render it again\n\t\t\tnode.remove();\n\t\t\treturn;\n\t\t}\n\n\t\t// Add the note node\n\t\tnoteInnerContent.appendChild(node);\n\n\t\t// Remove empty class\n\t\tif (noteContent.classList.contains(\"pagedjs_footnote_empty\")) {\n\t\t\tnoteContent.classList.remove(\"pagedjs_footnote_empty\");\n\t\t}\n\n\t\t// Add marker\n\t\tnode.dataset.footnoteMarker = node.dataset.ref;\n\n\t\t// Add Id\n\t\tnode.id = `note-${node.dataset.ref}`;\n\n\t\t// Get note content size\n\t\tlet height = noteContent.scrollHeight;\n\n\t\t// Check the noteCall is still on screen\n\t\tlet area = pageArea.querySelector(\".pagedjs_page_content\");\n\t\tlet size = area.getBoundingClientRect();\n\t\tlet right = size.left + size.width;\n\n\t\t// TODO: add a max height in CSS\n\n\t\t// Check element sizes\n\t\tlet noteCallBounds = noteCall && noteCall.getBoundingClientRect();\n\t\tlet noteAreaBounds = noteArea.getBoundingClientRect();\n\n\t\t// Get the @footnote margins\n\t\tlet noteContentMargins = this.marginsHeight(noteContent);\n\t\tlet noteContentPadding = this.paddingHeight(noteContent);\n\t\tlet noteContentBorders = this.borderHeight(noteContent);\n\t\tlet total = noteContentMargins + noteContentPadding + noteContentBorders;\n\n\t\t// Get the top of the @footnote area\n\t\tlet notAreaTop = Math.floor(noteAreaBounds.top);\n\t\t// If the height isn't set yet, remove the margins from the top\n\t\tif (noteAreaBounds.height === 0) {\n\t\t\tnotAreaTop -= this.marginsHeight(noteContent, false);\n\t\t\tnotAreaTop -= this.paddingHeight(noteContent, false);\n\t\t\tnotAreaTop -= this.borderHeight(noteContent, false);\n\t\t}\n\t\t// Determine the note call position and offset per policy\n\t\tlet notePolicy = node.dataset.notePolicy;\n\t\tlet noteCallPosition = 0;\n\t\tlet noteCallOffset = 0;\n\t\tif (noteCall) {\n\t\t\t// Get the correct line bottom for super or sub styled callouts\n\t\t\tlet prevSibling = noteCall.previousSibling;\n\t\t\tlet range = new Range();\n\t\t\tif (prevSibling) {\n\t\t\t\trange.setStartBefore(prevSibling);\n\t\t\t} else {\n\t\t\t\trange.setStartBefore(noteCall);\n\t\t\t}\n\t\t\trange.setEndAfter(noteCall);\n\t\t\tlet rangeBounds = range.getBoundingClientRect();\n\t\t\tnoteCallPosition = rangeBounds.bottom;\n\t\t\tif (!notePolicy || notePolicy === \"auto\") {\n\t\t\t\tnoteCallOffset = Math.ceil(rangeBounds.bottom);\n\t\t\t} else if (notePolicy === \"line\") {\n\t\t\t\tnoteCallOffset = Math.ceil(rangeBounds.top);\n\t\t\t} else if (notePolicy === \"block\") {\n\t\t\t\t// Check that there is a previous element on the page\n\t\t\t\tlet parentParagraph = noteCall.closest(\"p\").previousElementSibling;\n\t\t\t\tif (parentParagraph) {\n\t\t\t\t\tnoteCallOffset = Math.ceil(\n\t\t\t\t\t\tparentParagraph.getBoundingClientRect().bottom\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tnoteCallOffset = Math.ceil(rangeBounds.bottom);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet contentDelta = height + total - noteAreaBounds.height;\n\t\t// Space between the top of the footnotes area and the bottom of the footnote call\n\t\tlet noteDelta = noteCallPosition ? notAreaTop - noteCallPosition : 0;\n\t\t// Space needed for the force a break for the policy of the footnote\n\t\tlet notePolicyDelta = noteCallPosition ? Math.floor(noteAreaBounds.top) - noteCallOffset : 0;\n\t\tlet hasNotes = noteArea.querySelector(\"[data-note='footnote']\");\n\t\tif (needsNoteCall && noteCallBounds.left > right) {\n\t\t\t// Note is offscreen and will be chunked to the next page on overflow\n\t\t\tnode.remove();\n\t\t} else if (!hasNotes && needsNoteCall && total > noteDelta) {\n\t\t\t// No space to add even the footnote area\n\t\t\tpageArea.style.setProperty(\"--pagedjs-footnotes-height\", \"0px\");\n\t\t\t// Add a wrapper as this div is removed later\n\t\t\tlet wrapperDiv = document.createElement(\"div\");\n\t\t\twrapperDiv.appendChild(node);\n\t\t\t// Push to the layout queue for the next page\n\t\t\tthis.needsLayout.push(wrapperDiv);\n\t\t} else if (!needsNoteCall) {\n\t\t\t// Call was previously added, force adding footnote\n\t\t\tpageArea.style.setProperty(\n\t\t\t\t\"--pagedjs-footnotes-height\",\n\t\t\t\t`${height + total}px`\n\t\t\t);\n\t\t} else if (noteCallPosition < noteAreaBounds.top - contentDelta) {\n\t\t\t// the current note content will fit without pushing the call to the next page\n\t\t\tpageArea.style.setProperty(\n\t\t\t\t\"--pagedjs-footnotes-height\",\n\t\t\t\t`${height + noteContentMargins + noteContentBorders}px`\n\t\t\t);\n\t\t} else {\n\t\t\t// set height to just before note call\n\t\t\tpageArea.style.setProperty(\n\t\t\t\t\"--pagedjs-footnotes-height\",\n\t\t\t\t`${noteAreaBounds.height + notePolicyDelta}px`\n\t\t\t);\n\t\t\tnoteInnerContent.style.height =\n\t\t\t\tnoteAreaBounds.height + notePolicyDelta - total + \"px\";\n\t\t}\n\t}\n\n\tcreateFootnoteCall(node) {\n\t\tlet parentElement = node.parentElement;\n\t\tlet footnoteCall = document.createElement(\"a\");\n\t\tfor (const className of node.classList) {\n\t\t\tfootnoteCall.classList.add(`${className}`);\n\t\t}\n\n\t\tfootnoteCall.dataset.footnoteCall = node.dataset.ref;\n\t\tfootnoteCall.dataset.ref = node.dataset.ref;\n\n\t\t// Increment for counters\n\t\tfootnoteCall.dataset.dataCounterFootnoteIncrement = 1;\n\n\t\t// Add link\n\t\tfootnoteCall.href = `#note-${node.dataset.ref}`;\n\n\t\tparentElement.insertBefore(footnoteCall, node);\n\n\t\treturn footnoteCall;\n\t}\n\n\tafterPageLayout(pageElement, page, breakToken, chunker) {\n\t\tlet pageArea = pageElement.querySelector(\".pagedjs_area\");\n\t\tlet noteArea = page.footnotesArea;\n\t\tlet noteContent = noteArea.querySelector(\".pagedjs_footnote_content\");\n\t\tlet noteInnerContent = noteArea.querySelector(\".pagedjs_footnote_inner_content\");\n\n\t\tlet noteContentBounds = noteContent.getBoundingClientRect();\n\t\tlet { width } = noteContentBounds;\n\n\t\tnoteInnerContent.style.columnWidth = Math.round(width) + \"px\";\n\t\tnoteInnerContent.style.columnGap = \"calc(var(--pagedjs-margin-right) + var(--pagedjs-margin-left))\";\n\n\t\t// Get overflow\n\t\tlet layout = new Layout(noteArea, undefined, chunker.settings);\n\t\tlet overflow = layout.findOverflow(noteInnerContent, noteContentBounds);\n\n\t\tif (overflow) {\n\t\t\tlet { startContainer, startOffset } = overflow;\n\t\t\tlet startIsNode;\n\t\t\tif (isElement(startContainer)) {\n\t\t\t\tlet start = startContainer.childNodes[startOffset];\n\t\t\t\tstartIsNode = isElement(start) && start.hasAttribute(\"data-footnote-marker\");\n\t\t\t}\n\n\t\t\tlet extracted = overflow.extractContents();\n\n\t\t\tif (!startIsNode) {\n\t\t\t\tlet splitChild = extracted.firstElementChild;\n\t\t\t\tsplitChild.dataset.splitFrom = splitChild.dataset.ref;\n\n\t\t\t\tthis.handleAlignment(noteInnerContent.lastElementChild);\n\t\t\t}\n\n\t\t\tthis.needsLayout.push(extracted);\n\n\t\t\tnoteContent.style.removeProperty(\"height\");\n\t\t\tnoteInnerContent.style.removeProperty(\"height\");\n\n\t\t\tlet noteInnerContentBounds = noteInnerContent.getBoundingClientRect();\n\t\t\tlet { height } = noteInnerContentBounds;\n\n\t\t\t// Get the @footnote margins\n\t\t\tlet noteContentMargins = this.marginsHeight(noteContent);\n\t\t\tlet noteContentPadding = this.paddingHeight(noteContent);\n\t\t\tlet noteContentBorders = this.borderHeight(noteContent);\n\t\t\tpageArea.style.setProperty(\n\t\t\t\t\"--pagedjs-footnotes-height\",\n\t\t\t\t`${height + noteContentMargins + noteContentBorders + noteContentPadding}px`\n\t\t\t);\n\n\t\t\t// Hide footnote content if empty\n\t\t\tif (noteInnerContent.childNodes.length === 0) {\n\t\t\t\tnoteContent.classList.add(\"pagedjs_footnote_empty\");\n\t\t\t}\n\n\t\t\tif (!breakToken) {\n\t\t\t\tchunker.clonePage(page);\n\t\t\t} else {\n\t\t\t\tlet breakBefore, previousBreakAfter;\n\t\t\t\tif (\n\t\t\t\t\tbreakToken.node &&\n\t\t\t\t\ttypeof breakToken.node.dataset !== \"undefined\" &&\n\t\t\t\t\ttypeof breakToken.node.dataset.previousBreakAfter !== \"undefined\"\n\t\t\t\t) {\n\t\t\t\t\tpreviousBreakAfter = breakToken.node.dataset.previousBreakAfter;\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\tbreakToken.node &&\n\t\t\t\t\ttypeof breakToken.node.dataset !== \"undefined\" &&\n\t\t\t\t\ttypeof breakToken.node.dataset.breakBefore !== \"undefined\"\n\t\t\t\t) {\n\t\t\t\t\tbreakBefore = breakToken.node.dataset.breakBefore;\n\t\t\t\t}\n\n\t\t\t\tif (breakBefore || previousBreakAfter) {\n\t\t\t\t\tchunker.clonePage(page);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tnoteInnerContent.style.height = \"auto\";\n\t}\n\n\thandleAlignment(node) {\n\t\tlet styles = window.getComputedStyle(node);\n\t\tlet alignLast = styles[\"text-align-last\"];\n\t\tnode.dataset.lastSplitElement = \"true\";\n\t\tif (alignLast === \"auto\") {\n\t\t\tnode.dataset.alignLastSplitElement = \"justify\";\n\t\t} else {\n\t\t\tnode.dataset.alignLastSplitElement = alignLast;\n\t\t}\n\t}\n\n\tbeforePageLayout(page) {\n\t\twhile (this.needsLayout.length) {\n\t\t\tlet fragment = this.needsLayout.shift();\n\n\t\t\tArray.from(fragment.childNodes).forEach((node) => {\n\t\t\t\tthis.moveFootnote(\n\t\t\t\t\tnode,\n\t\t\t\t\tpage.element.querySelector(\".pagedjs_area\"),\n\t\t\t\t\tfalse\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\t}\n\n\tafterOverflowRemoved(removed, rendered) {\n\t\t// Find the page area\n\t\tlet area = rendered.closest(\".pagedjs_area\");\n\t\t// Get any rendered footnotes\n\t\tlet notes = area.querySelectorAll(\".pagedjs_footnote_area [data-note='footnote']\");\n\t\tfor (let n = 0; n < notes.length; n++) {\n\t\t\tconst note = notes[n];\n\t\t\t// Check if the call for that footnote has been removed with the overflow\n\t\t\tlet call = removed.querySelector(`[data-footnote-call=\"${note.dataset.ref}\"]`);\n\t\t\tif (call) {\n\t\t\t\tnote.remove();\n\t\t\t}\n\t\t}\n\t\t// Hide footnote content if empty\n\t\tlet noteInnerContent = area.querySelector(\".pagedjs_footnote_inner_content\");\n\t\tif (noteInnerContent && noteInnerContent.childNodes.length === 0) {\n\t\t\tnoteInnerContent.parentElement.classList.add(\"pagedjs_footnote_empty\");\n\t\t}\n\t}\n\n\tmarginsHeight(element, total=true) {\n\t\tlet styles = window.getComputedStyle(element);\n\t\tlet marginTop = parseInt(styles.marginTop);\n\t\tlet marginBottom = parseInt(styles.marginBottom);\n\t\tlet margin = 0;\n\t\tif (marginTop) {\n\t\t\tmargin += marginTop;\n\t\t}\n\t\tif (marginBottom && total) {\n\t\t\tmargin += marginBottom;\n\t\t}\n\t\treturn margin;\n\t}\n\n\tpaddingHeight(element, total=true) {\n\t\tlet styles = window.getComputedStyle(element);\n\t\tlet paddingTop = parseInt(styles.paddingTop);\n\t\tlet paddingBottom = parseInt(styles.paddingBottom);\n\t\tlet padding = 0;\n\t\tif (paddingTop) {\n\t\t\tpadding += paddingTop;\n\t\t}\n\t\tif (paddingBottom && total) {\n\t\t\tpadding += paddingBottom;\n\t\t}\n\t\treturn padding;\n\t}\n\n\tborderHeight(element, total=true) {\n\t\tlet styles = window.getComputedStyle(element);\n\t\tlet borderTop = parseInt(styles.borderTop);\n\t\tlet borderBottom = parseInt(styles.borderBottom);\n\t\tlet borders = 0;\n\t\tif (borderTop) {\n\t\t\tborders += borderTop;\n\t\t}\n\t\tif (borderBottom && total) {\n\t\t\tborders += borderBottom;\n\t\t}\n\t\treturn borders;\n\t}\n}\n\nexport default Footnotes;\n","import AtPage from \"./atpage.js\";\nimport Breaks from \"./breaks.js\";\nimport PrintMedia from \"./print-media.js\";\nimport Splits from \"./splits.js\";\nimport Counters from \"./counters.js\";\nimport Lists from \"./lists.js\";\nimport PositionFixed from \"./position-fixed.js\";\nimport PageCounterIncrement from \"./page-counter-increment.js\";\nimport NthOfType from \"./nth-of-type.js\";\nimport Following from \"./following.js\";\nimport Footnotes from \"./footnotes.js\";\n\nexport default [\n\tPrintMedia,\n\tAtPage,\n\tBreaks,\n\tSplits,\n\tCounters,\n\tLists,\n\tPositionFixed,\n\tPageCounterIncrement,\n\tNthOfType,\n\tFollowing,\n\tFootnotes\n];\n","import Handler from \"../handler.js\";\nimport csstree from \"css-tree\";\n\nclass RunningHeaders extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\n\t\tthis.runningSelectors = {};\n\t\tthis.elements = {};\n\t}\n\n\tonDeclaration(declaration, dItem, dList, rule) {\n\t\tif (declaration.property === \"position\") {\n\t\t\tlet selector = csstree.generate(rule.ruleNode.prelude);\n\t\t\tlet identifier = declaration.value.children.first().name;\n\n\t\t\tif (identifier === \"running\") {\n\t\t\t\tlet value;\n\t\t\t\tcsstree.walk(declaration, {\n\t\t\t\t\tvisit: \"Function\",\n\t\t\t\t\tenter: (node, item, list) => {\n\t\t\t\t\t\tvalue = node.children.first().name;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.runningSelectors[value] = {\n\t\t\t\t\tidentifier: identifier,\n\t\t\t\t\tvalue: value,\n\t\t\t\t\tselector: selector\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tif (declaration.property === \"content\") {\n\n\t\t\tcsstree.walk(declaration, {\n\t\t\t\tvisit: \"Function\",\n\t\t\t\tenter: (funcNode, fItem, fList) => {\n\n\t\t\t\t\tif (funcNode.name.indexOf(\"element\") > -1) {\n\n\t\t\t\t\t\tlet selector = csstree.generate(rule.ruleNode.prelude);\n\n\t\t\t\t\t\tlet func = funcNode.name;\n\n\t\t\t\t\t\tlet value = funcNode.children.first().name;\n\n\t\t\t\t\t\tlet args = [value];\n\n\t\t\t\t\t\t// we only handle first for now\n\t\t\t\t\t\tlet style = \"first\";\n\n\t\t\t\t\t\tselector.split(\",\").forEach((s) => {\n\t\t\t\t\t\t\t// remove before / after\n\t\t\t\t\t\t\ts = s.replace(/::after|::before/, \"\");\n\n\t\t\t\t\t\t\tthis.elements[s] = {\n\t\t\t\t\t\t\t\tfunc: func,\n\t\t\t\t\t\t\t\targs: args,\n\t\t\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\t\t\tstyle: style || \"first\",\n\t\t\t\t\t\t\t\tselector: s,\n\t\t\t\t\t\t\t\tfullSelector: selector\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tafterParsed(fragment) {\n\t\tfor (let name of Object.keys(this.runningSelectors)) {\n\t\t\tlet set = this.runningSelectors[name];\n\t\t\tlet selected = Array.from(fragment.querySelectorAll(set.selector));\n\n\t\t\tif (set.identifier === \"running\") {\n\t\t\t\tfor (let header of selected) {\n\t\t\t\t\theader.style.display = \"none\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t}\n\n\tafterPageLayout(fragment) {\n\t\tfor (let name of Object.keys(this.runningSelectors)) {\n\t\t\tlet set = this.runningSelectors[name];\n\t\t\tlet selected = fragment.querySelector(set.selector);\n\t\t\tif (selected) {\n\t\t\t\t// let cssVar;\n\t\t\t\tif (set.identifier === \"running\") {\n\t\t\t\t\t// cssVar = selected.textContent.replace(/\\\\([\\s\\S])|([\"|'])/g,\"\\\\$1$2\");\n\t\t\t\t\t// this.styleSheet.insertRule(`:root { --string-${name}: \"${cssVar}\"; }`, this.styleSheet.cssRules.length);\n\t\t\t\t\t// fragment.style.setProperty(`--string-${name}`, `\"${cssVar}\"`);\n\t\t\t\t\tset.first = selected;\n\t\t\t\t} else {\n\t\t\t\t\tconsole.warn(set.value + \"needs css replacement\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// move elements\n\t\tif (!this.orderedSelectors) {\n\t\t\tthis.orderedSelectors = this.orderSelectors(this.elements);\n\t\t}\n\n\t\tfor (let selector of this.orderedSelectors) {\n\t\t\tif (selector) {\n\n\t\t\t\tlet el = this.elements[selector];\n\t\t\t\tlet selected = fragment.querySelector(selector);\n\t\t\t\tif (selected) {\n\t\t\t\t\tlet running = this.runningSelectors[el.args[0]];\n\t\t\t\t\tif (running && running.first) {\n\t\t\t\t\t\tselected.innerHTML = \"\"; // Clear node\n\t\t\t\t\t\t// selected.classList.add(\"pagedjs_clear-after\"); // Clear ::after\n\t\t\t\t\t\tlet clone = running.first.cloneNode(true);\n\t\t\t\t\t\tclone.style.display = null;\n\t\t\t\t\t\tselected.appendChild(clone);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t* Assign a weight to @page selector classes\n\t* 1) page\n\t* 2) left & right\n\t* 3) blank\n\t* 4) first & nth\n\t* 5) named page\n\t* 6) named left & right\n\t* 7) named first & nth\n\t* @param {string} [s] selector string\n\t* @return {int} weight\n\t*/\n\tpageWeight(s) {\n\t\tlet weight = 1;\n\t\tlet selector = s.split(\" \");\n\t\tlet parts = selector.length && selector[0].split(\".\");\n\n\t\tparts.shift(); // remove empty first part\n\n\t\tswitch (parts.length) {\n\t\t\tcase 4:\n\t\t\t\tif (/^pagedjs_[\\w-]+_first_page$/.test(parts[3])) {\n\t\t\t\t\tweight = 7;\n\t\t\t\t} else if (parts[3] === \"pagedjs_left_page\" || parts[3] === \"pagedjs_right_page\") {\n\t\t\t\t\tweight = 6;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tif (parts[1] === \"pagedjs_named_page\") {\n\t\t\t\t\tif (parts[2].indexOf(\":nth-of-type\") > -1) {\n\t\t\t\t\t\tweight = 7;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tweight = 5;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tif (parts[1] === \"pagedjs_first_page\") {\n\t\t\t\t\tweight = 4;\n\t\t\t\t} else if (parts[1] === \"pagedjs_blank_page\") {\n\t\t\t\t\tweight = 3;\n\t\t\t\t} else if (parts[1] === \"pagedjs_left_page\" || parts[1] === \"pagedjs_right_page\") {\n\t\t\t\t\tweight = 2;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tif (parts[0].indexOf(\":nth-of-type\") > -1) {\n\t\t\t\t\tweight = 4;\n\t\t\t\t} else {\n\t\t\t\t\tweight = 1;\n\t\t\t\t}\n\t\t}\n\n\t\treturn weight;\n\t}\n\n\t/**\n\t* Orders the selectors based on weight\n\t*\n\t* Does not try to deduplicate base on specifity of the selector\n\t* Previous matched selector will just be overwritten\n\t* @param {obj} [obj] selectors object\n\t* @return {Array} orderedSelectors\n\t*/\n\torderSelectors(obj) {\n\t\tlet selectors = Object.keys(obj);\n\t\tlet weighted = {\n\t\t\t1: [],\n\t\t\t2: [],\n\t\t\t3: [],\n\t\t\t4: [],\n\t\t\t5: [],\n\t\t\t6: [],\n\t\t\t7: []\n\t\t};\n\n\t\tlet orderedSelectors = [];\n\n\t\tfor (let s of selectors) {\n\t\t\tlet w = this.pageWeight(s);\n\t\t\tweighted[w].unshift(s);\n\t\t}\n\n\t\tfor (var i = 1; i <= 7; i++) {\n\t\t\torderedSelectors = orderedSelectors.concat(weighted[i]);\n\t\t}\n\n\t\treturn orderedSelectors;\n\t}\n\n\tbeforeTreeParse(text, sheet) {\n\t\t// element(x) is parsed as image element selector, so update element to element-ident\n\t\tsheet.text = text.replace(/element[\\s]*\\(([^|^#)]*)\\)/g, \"element-ident($1)\");\n\t}\n}\n\nexport default RunningHeaders;\n","export function cleanPseudoContent(el, trim = \"\\\"' \") {\n\tif(el == null) return;\n\treturn el\n\t\t.replace(new RegExp(`^[${trim}]+`), \"\")\n\t\t.replace(new RegExp(`[${trim}]+$`), \"\")\n\t\t.replace(/[\"']/g, match => {\n\t\t\treturn \"\\\\\" + match;\n\t\t})\n\t\t.replace(/[\\n]/g, match => {\n\t\t\treturn \"\\\\00000A\";\n\t\t});\n}\n\nexport function cleanSelector(el) {\n\tif(el == null) return;\n\treturn el\n\t\t.replace(new RegExp(\"::footnote-call\", \"g\"), \"\")\n\t\t.replace(new RegExp(\"::footnote-marker\", \"g\"), \"\");\n}\n","import Handler from \"../handler.js\";\nimport csstree from \"css-tree\";\nimport { cleanPseudoContent } from \"../../utils/css.js\";\n\nclass StringSets extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\n\t\tthis.stringSetSelectors = {};\n\t\tthis.type;\n\t\t// pageLastString = last string variable defined on the page\n\t\tthis.pageLastString;\n\n\t}\n\t\n\tonDeclaration(declaration, dItem, dList, rule) {\n\t\tif (declaration.property === \"string-set\") {\n\t\t\tlet selector = csstree.generate(rule.ruleNode.prelude);\n\n\t\t\tlet identifiers = [];\n\t\t\tlet functions = [];\n\t\t\tlet values = [];\n\n\t\t\tdeclaration.value.children.forEach((child) => {\n\t\t\t\tif (child.type === \"Identifier\") {\n\t\t\t\t\tidentifiers.push(child.name);\n\t\t\t\t}\n\t\t\t\tif (child.type === \"Function\") {\n\t\t\t\t\tfunctions.push(child.name);\n\t\t\t\t\tchild.children.forEach((subchild) => {\n\t\t\t\t\t\tif (subchild.type === \"Identifier\") {\n\t\t\t\t\t\t\tvalues.push(subchild.name);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tidentifiers.forEach((identifier, index) => {\n\t\t\t\tlet func = functions[index];\n\t\t\t\tlet value = values[index];\n\t\t\t\tthis.stringSetSelectors[identifier] = {\n\t\t\t\t\tidentifier,\n\t\t\t\t\tfunc,\n\t\t\t\t\tvalue,\n\t\t\t\t\tselector\n\t\t\t\t};\n\t\t\t});\n\n\t\t}\n\t}\n\n\tonContent(funcNode, fItem, fList, declaration, rule) {\n\n\t\tif (funcNode.name === \"string\") {\n\t\t\tlet identifier = funcNode.children && funcNode.children.first().name;\n\t\t\tthis.type = funcNode.children.last().name;\n\t\t\tfuncNode.name = \"var\";\n\t\t\tfuncNode.children = new csstree.List();\n\n \n\t\t\tif(this.type === \"first\" || this.type === \"last\" || this.type === \"start\" || this.type === \"first-except\"){\n\t\t\t\tfuncNode.children.append(\n\t\t\t\t\tfuncNode.children.createItem({\n\t\t\t\t\t\ttype: \"Identifier\",\n\t\t\t\t\t\tloc: null,\n\t\t\t\t\t\tname: \"--pagedjs-string-\" + this.type + \"-\" + identifier\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}else{\n\t\t\t\tfuncNode.children.append(\n\t\t\t\t\tfuncNode.children.createItem({\n\t\t\t\t\t\ttype: \"Identifier\",\n\t\t\t\t\t\tloc: null,\n\t\t\t\t\t\tname: \"--pagedjs-string-first-\" + identifier\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tafterPageLayout(fragment) {\n\n\t\n\t\tif ( this.pageLastString === undefined )\n\t\t{\n\t\t\tthis.pageLastString = {};\n\t\t}\n\n\t\t\n\t\tfor (let name of Object.keys(this.stringSetSelectors)) {\n\t\n\t\t\tlet set = this.stringSetSelectors[name];\n\t\t\tlet value = set.value;\n\t\t\tlet func = set.func;\n\t\t\tlet selected = fragment.querySelectorAll(set.selector);\n\n\t\t\t// Get the last found string for the current identifier\n\t\t\tlet stringPrevPage = ( name in this.pageLastString ) ? this.pageLastString[name] : \"\";\n\n\t\t\tlet varFirst, varLast, varStart, varFirstExcept;\n\n\t\t\tif(selected.length == 0){\n\t\t\t\t// if there is no sel. on the page\n\t\t\t\tvarFirst = stringPrevPage;\n\t\t\t\tvarLast = stringPrevPage;\n\t\t\t\tvarStart = stringPrevPage;\n\t\t\t\tvarFirstExcept = stringPrevPage;\n\t\t\t}else{\n\n\t\t\t\tselected.forEach((sel) => {\n\t\t\t\t\t// push each content into the array to define in the variable the first and the last element of the page.\n\t\t\t\t\tif (func === \"content\") {\n\t\t\t\t\t\tthis.pageLastString[name] = selected[selected.length - 1].textContent;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (func === \"attr\") {\n\t\t\t\t\t\tthis.pageLastString[name] = selected[selected.length - 1].getAttribute(value) || \"\";\n\t\t\t\t\t}\n\n\t\t\t\t});\t\n\n\t\t\t\t/* FIRST */\n\t\n\t\t\t\tif (func === \"content\") {\n\t\t\t\t\tvarFirst = selected[0].textContent;\n\t\t\t\t}\n\n\t\t\t\tif (func === \"attr\") {\n\t\t\t\t\tvarFirst = selected[0].getAttribute(value) || \"\";\n\t\t\t\t}\n\n\n\t\t\t\t/* LAST */\n\n\t\t\t\tif (func === \"content\") {\n\t\t\t\t\tvarLast = selected[selected.length - 1].textContent;\n\t\t\t\t}\n\n\t\t\t\tif (func === \"attr\") {\n\t\t\t\t\tvarLast = selected[selected.length - 1].getAttribute(value) || \"\";\n\t\t\t\t}\n\n\n\t\t\t\t/* START */\n\n\t\t\t\t// Hack to find if the sel. is the first elem of the page / find a better way \n\t\t\t\tlet selTop = selected[0].getBoundingClientRect().top;\n\t\t\t\tlet pageContent = selected[0].closest(\".pagedjs_page_content\");\n\t\t\t\tlet pageContentTop = pageContent.getBoundingClientRect().top;\n\n\t\t\t\tif(selTop == pageContentTop){\n\t\t\t\t\tvarStart = varFirst;\n\t\t\t\t}else{\n\t\t\t\t\tvarStart = stringPrevPage;\n\t\t\t\t}\n\n\t\t\t\t/* FIRST EXCEPT */\n\n\t\t\t\tvarFirstExcept = \"\";\n\t\t\t\t\n\t\t\t}\n\n\t\t\tfragment.style.setProperty(`--pagedjs-string-first-${name}`, `\"${cleanPseudoContent(varFirst)}`);\n\t\t\tfragment.style.setProperty(`--pagedjs-string-last-${name}`, `\"${cleanPseudoContent(varLast)}`);\n\t\t\tfragment.style.setProperty(`--pagedjs-string-start-${name}`, `\"${cleanPseudoContent(varStart)}`);\n\t\t\tfragment.style.setProperty(`--pagedjs-string-first-except-${name}`, `\"${cleanPseudoContent(varFirstExcept)}`);\n\t\t\t\n\t\n\t\t}\n\t}\n\t\n\n}\n\n\n\nexport default StringSets;\n","import Handler from \"../handler.js\";\nimport {attr, querySelectorEscape, UUID} from \"../../utils/utils.js\";\nimport csstree from \"css-tree\";\n\nclass TargetCounters extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\n\t\tthis.styleSheet = polisher.styleSheet;\n\n\t\tthis.counterTargets = {};\n\t}\n\n\tonContent(funcNode, fItem, fList, declaration, rule) {\n\t\tif (funcNode.name === \"target-counter\") {\n\t\t\tlet selector = csstree.generate(rule.ruleNode.prelude);\n\n\t\t\tlet first = funcNode.children.first();\n\t\t\tlet func = first.name;\n\n\t\t\tlet value = csstree.generate(funcNode);\n\n\t\t\tlet args = [];\n\n\t\t\tfirst.children.forEach((child) => {\n\t\t\t\tif (child.type === \"Identifier\") {\n\n\t\t\t\t\targs.push(child.name);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlet counter;\n\t\t\tlet style;\n\t\t\tlet styleIdentifier;\n\n\t\t\tfuncNode.children.forEach((child) => {\n\t\t\t\tif (child.type === \"Identifier\") {\n\t\t\t\t\tif (!counter) {\n\t\t\t\t\t\tcounter = child.name;\n\t\t\t\t\t} else if (!style) {\n\t\t\t\t\t\tstyleIdentifier = csstree.clone(child);\n\t\t\t\t\t\tstyle = child.name;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlet variable = \"target-counter-\" + UUID();\n\n\t\t\tselector.split(\",\").forEach((s) => {\n\t\t\t\tthis.counterTargets[s] = {\n\t\t\t\t\tfunc: func,\n\t\t\t\t\targs: args,\n\t\t\t\t\tvalue: value,\n\t\t\t\t\tcounter: counter,\n\t\t\t\t\tstyle: style,\n\t\t\t\t\tselector: s,\n\t\t\t\t\tfullSelector: selector,\n\t\t\t\t\tvariable: variable\n\t\t\t\t};\n\t\t\t});\n\n\t\t\t// Replace with counter\n\t\t\tfuncNode.name = \"counter\";\n\t\t\tfuncNode.children = new csstree.List();\n\t\t\tfuncNode.children.appendData({\n\t\t\t\ttype: \"Identifier\",\n\t\t\t\tloc: 0,\n\t\t\t\tname: variable\n\t\t\t});\n\n\t\t\tif (styleIdentifier) {\n\t\t\t\tfuncNode.children.appendData({type: \"Operator\", loc: null, value: \",\"});\n\t\t\t\tfuncNode.children.appendData(styleIdentifier);\n\t\t\t}\n\t\t}\n\t}\n\n\tafterPageLayout(fragment, page, breakToken, chunker) {\n\t\tObject.keys(this.counterTargets).forEach((name) => {\n\t\t\tlet target = this.counterTargets[name];\n\t\t\tlet split = target.selector.split(/::?/g);\n\t\t\tlet query = split[0];\n\n\t\t\tlet queried = chunker.pagesArea.querySelectorAll(query + \":not([data-\" + target.variable + \"])\");\n\n\t\t\tqueried.forEach((selected, index) => {\n\t\t\t\t// TODO: handle func other than attr\n\t\t\t\tif (target.func !== \"attr\") {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlet val = attr(selected, target.args);\n\t\t\t\tlet element = chunker.pagesArea.querySelector(querySelectorEscape(val));\n\n\t\t\t\tif (element) {\n\t\t\t\t\tlet selector = UUID();\n\t\t\t\t\tselected.setAttribute(\"data-\" + target.variable, selector);\n\t\t\t\t\t// TODO: handle other counter types (by query)\n\t\t\t\t\tlet pseudo = \"\";\n\t\t\t\t\tif (split.length > 1) {\n\t\t\t\t\t\tpseudo += \"::\" + split[1];\n\t\t\t\t\t}\n\t\t\t\t\tif (target.counter === \"page\") {\n\t\t\t\t\t\tlet pages = chunker.pagesArea.querySelectorAll(\".pagedjs_page\");\n\t\t\t\t\t\tlet pg = 0;\n\t\t\t\t\t\tfor (let i = 0; i < pages.length; i++) {\n\t\t\t\t\t\t\tlet page = pages[i];\n\t\t\t\t\t\t\tlet styles = window.getComputedStyle(page);\n\t\t\t\t\t\t\tlet reset = styles[\"counter-reset\"].replace(\"page\", \"\").trim();\n\t\t\t\t\t\t\tlet increment = styles[\"counter-increment\"].replace(\"page\", \"\").trim();\n\n\t\t\t\t\t\t\tif (reset !== \"none\") {\n\t\t\t\t\t\t\t\tpg = parseInt(reset);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (increment !== \"none\") {\n\t\t\t\t\t\t\t\tpg += parseInt(increment);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (page.contains(element)){\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.styleSheet.insertRule(`[data-${target.variable}=\"${selector}\"]${pseudo} { counter-reset: ${target.variable} ${pg}; }`, this.styleSheet.cssRules.length);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlet value = element.getAttribute(`data-counter-${target.counter}-value`);\n\t\t\t\t\t\tif (value) {\n\t\t\t\t\t\t\tthis.styleSheet.insertRule(`[data-${target.variable}=\"${selector}\"]${pseudo} { counter-reset: ${target.variable} ${target.variable} ${parseInt(value)}; }`, this.styleSheet.cssRules.length);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// force redraw\n\t\t\t\t\tlet el = document.querySelector(`[data-${target.variable}=\"${selector}\"]`);\n\t\t\t\t\tif (el) {\n\t\t\t\t\t\tel.style.display = \"none\";\n\t\t\t\t\t\tel.clientHeight;\n\t\t\t\t\t\tel.style.removeProperty(\"display\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n}\n\nexport default TargetCounters;\n","import Handler from \"../handler.js\";\nimport { UUID, attr, querySelectorEscape } from \"../../utils/utils.js\";\nimport { cleanPseudoContent } from \"../../utils/css.js\";\nimport csstree from \"css-tree\";\n// import { nodeAfter } from \"../../utils/dom\";\n\nclass TargetText extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\n\t\tthis.styleSheet = polisher.styleSheet;\n\t\tthis.textTargets = {};\n\t\tthis.beforeContent = \"\";\n\t\tthis.afterContent = \"\";\n\t\tthis.selector = {};\n\t}\n\n\tonContent(funcNode, fItem, fList, declaration, rule) {\n\t\tif (funcNode.name === \"target-text\") {\n\t\t\tthis.selector = csstree.generate(rule.ruleNode.prelude);\n\t\t\tlet first = funcNode.children.first();\n\t\t\tlet last = funcNode.children.last();\n\t\t\tlet func = first.name;\n\n\t\t\tlet value = csstree.generate(funcNode);\n\n\t\t\tlet args = [];\n\n\t\t\tfirst.children.forEach(child => {\n\t\t\t\tif (child.type === \"Identifier\") {\n\t\t\t\t\targs.push(child.name);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlet style;\n\t\t\tif (last !== first) {\n\t\t\t\tstyle = last.name;\n\t\t\t}\n\n\t\t\tlet variable = \"--pagedjs-\" + UUID();\n\n\t\t\tthis.selector.split(\",\").forEach(s => {\n\t\t\t\tthis.textTargets[s] = {\n\t\t\t\t\tfunc: func,\n\t\t\t\t\targs: args,\n\t\t\t\t\tvalue: value,\n\t\t\t\t\tstyle: style || \"content\",\n\t\t\t\t\tselector: s,\n\t\t\t\t\tfullSelector: this.selector,\n\t\t\t\t\tvariable: variable\n\t\t\t\t};\n\t\t\t});\n\n\t\t\t// Replace with variable\n\t\t\tfuncNode.name = \"var\";\n\t\t\tfuncNode.children = new csstree.List();\n\t\t\tfuncNode.children.appendData({\n\t\t\t\ttype: \"Identifier\",\n\t\t\t\tloc: 0,\n\t\t\t\tname: variable\n\t\t\t});\n\t\t}\n\t}\n\n\t//   parse this on the ONCONTENT : get all before and after and replace the value with a variable\n\tonPseudoSelector(pseudoNode, pItem, pList, selector, rule) {\n\t\t// console.log(pseudoNode);\n\t\t// console.log(rule);\n\n\t\trule.ruleNode.block.children.forEach(properties => {\n\t\t\tif (pseudoNode.name === \"before\" && properties.property === \"content\") {\n\t\t\t\t// let beforeVariable = \"--pagedjs-\" + UUID();\n\n\t\t\t\tlet contenu = properties.value.children;\n\t\t\t\tcontenu.forEach(prop => {\n\t\t\t\t\tif (prop.type === \"String\") {\n\t\t\t\t\t\tthis.beforeContent = prop.value;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else if (pseudoNode.name === \"after\" && properties.property === \"content\") {\n\t\t\t\tproperties.value.children.forEach(prop => {\n\t\t\t\t\tif (prop.type === \"String\") {\n\t\t\t\t\t\tthis.afterContent = prop.value;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tafterParsed(fragment) {\n\t\tObject.keys(this.textTargets).forEach(name => {\n\t\t\tlet target = this.textTargets[name];\n\t\t\tlet split = target.selector.split(\"::\");\n\t\t\tlet query = split[0];\n\t\t\tlet queried = fragment.querySelectorAll(query);\n\t\t\tlet textContent;\n\t\t\tqueried.forEach((selected, index) => {\n\t\t\t\tlet val = attr(selected, target.args);\n\t\t\t\tlet element = fragment.querySelector(querySelectorEscape(val));\n\t\t\t\tif (element) {\n\t\t\t\t\t// content & first-letter & before & after refactorized\n\t\t\t\t\tif (target.style) {\n\t\t\t\t\t\tthis.selector = UUID();\n\t\t\t\t\t\tselected.setAttribute(\"data-target-text\", this.selector);\n\n\t\t\t\t\t\tlet psuedo = \"\";\n\t\t\t\t\t\tif (split.length > 1) {\n\t\t\t\t\t\t\tpsuedo += \"::\" + split[1];\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (target.style === \"before\" || target.style === \"after\") {\n\t\t\t\t\t\t\tconst pseudoType = `${target.style}Content`;\n\t\t\t\t\t\t\ttextContent = cleanPseudoContent(this[pseudoType]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttextContent = cleanPseudoContent(element.textContent, \" \");\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttextContent = target.style === \"first-letter\" ? textContent.charAt(0) : textContent;\n\t\t\t\t\t\tthis.styleSheet.insertRule(`[data-target-text=\"${this.selector}\"]${psuedo} { ${target.variable}: \"${textContent}\" }`);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.warn(\"missed target\", val);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n}\n\nexport default TargetText;\n\n","import RunningHeaders from \"./running-headers.js\";\nimport StringSets from \"./string-sets.js\";\nimport TargetCounters from \"./target-counters.js\";\nimport TargetText from \"./target-text.js\";\n\nexport default [\n\tRunningHeaders,\n\tStringSets,\n\tTargetCounters,\n\tTargetText\n];\n","import Handler from \"../handler.js\";\nimport {isElement, isIgnorable, nextSignificantNode, previousSignificantNode, filterTree} from \"../../utils/dom.js\";\n\nclass WhiteSpaceFilter extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\t}\n\n\tfilter(content) {\n\n\t\tfilterTree(content, (node) => {\n\t\t\treturn this.filterEmpty(node);\n\t\t}, NodeFilter.SHOW_TEXT);\n\n\t}\n\n\tfilterEmpty(node) {\n\t\tif (node.textContent.length > 1 && isIgnorable(node)) {\n\n\t\t\t// Do not touch the content if text is pre-formatted\n\t\t\tlet parent = node.parentNode;\n\t\t\tlet pre = isElement(parent) && parent.closest(\"pre\");\n\t\t\tif (pre) {\n\t\t\t\treturn NodeFilter.FILTER_REJECT;\n\t\t\t}\n\n\t\t\tconst previousSibling = previousSignificantNode(node);\n\t\t\tconst nextSibling = nextSignificantNode(node);\n\n\t\t\tif (nextSibling === null && previousSibling === null) {\n\t\t\t\t// we should not remove a Node that does not have any siblings.\n\t\t\t\tnode.textContent = \" \";\n\t\t\t\treturn NodeFilter.FILTER_REJECT;\n\t\t\t}\n\t\t\tif (nextSibling === null) {\n\t\t\t\t// we can safely remove this node\n\t\t\t\treturn NodeFilter.FILTER_ACCEPT;\n\t\t\t}\n\t\t\tif (previousSibling === null) {\n\t\t\t\t// we can safely remove this node\n\t\t\t\treturn NodeFilter.FILTER_ACCEPT;\n\t\t\t}\n\n\t\t\t// replace the content with a single space\n\t\t\tnode.textContent = \" \";\n\n\t\t\t// TODO: we also need to preserve sequences of white spaces when the parent has \"white-space\" rule:\n\t\t\t// pre\n\t\t\t// Sequences of white space are preserved. Lines are only broken at newline characters in the source and at <br> elements.\n\t\t\t//\n\t\t\t// pre-wrap\n\t\t\t// Sequences of white space are preserved. Lines are broken at newline characters, at <br>, and as necessary to fill line boxes.\n\t\t\t//\n\t\t\t// pre-line\n\t\t\t// Sequences of white space are collapsed. Lines are broken at newline characters, at <br>, and as necessary to fill line boxes.\n\t\t\t//\n\t\t\t// break-spaces\n\t\t\t// The behavior is identical to that of pre-wrap, except that:\n\t\t\t// - Any sequence of preserved white space always takes up space, including at the end of the line.\n\t\t\t// - A line breaking opportunity exists after every preserved white space character, including between white space characters.\n\t\t\t// - Such preserved spaces take up space and do not hang, and thus affect the box’s intrinsic sizes (min-content size and max-content size).\n\t\t\t//\n\t\t\t// See: https://developer.mozilla.org/en-US/docs/Web/CSS/white-space#Values\n\n\t\t\treturn NodeFilter.FILTER_REJECT;\n\t\t} else {\n\t\t\treturn NodeFilter.FILTER_REJECT;\n\t\t}\n\t}\n\n}\n\nexport default WhiteSpaceFilter;\n","import Handler from \"../handler.js\";\nimport {filterTree} from \"../../utils/dom.js\";\n\nclass CommentsFilter extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\t}\n\n\tfilter(content) {\n\t\tfilterTree(content, null, NodeFilter.SHOW_COMMENT);\n\t}\n\n}\n\nexport default CommentsFilter;\n","import Handler from \"../handler.js\";\n\nclass ScriptsFilter extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\t}\n\n\tfilter(content) {\n\t\tcontent.querySelectorAll(\"script\").forEach( script => { script.remove(); });\n\t}\n\n}\n\nexport default ScriptsFilter;\n","/**\n * Originally ported from https://github.com/keeganstreet/specificity/blob/866bf7ab4e7f62a7179c15b13a95af4e1c7b1afa/specificity.js\n *\n * Calculates the specificity of CSS selectors\n * http://www.w3.org/TR/css3-selectors/#specificity\n *\n * Returns a selector integer value\n */\n\n// The following regular expressions assume that selectors matching the preceding regular expressions have been removed\nvar attributeRegex = /(\\[[^\\]]+\\])/g;\nvar idRegex = /(#[^\\s\\+>~\\.\\[:]+)/g;\nvar classRegex = /(\\.[^\\s\\+>~\\.\\[:]+)/g;\nvar pseudoElementRegex = /(::[^\\s\\+>~\\.\\[:]+|:first-line|:first-letter|:before|:after)/g;\nvar pseudoClassRegex = /(:[^\\s\\+>~\\.\\[:]+)/g;\nvar elementRegex = /([^\\s\\+>~\\.\\[:]+)/g;\nvar notRegex = /:not\\(([^\\)]*)\\)/g;\nvar ruleRegex = /\\{[^]*/gm;\nvar separatorRegex = /[\\*\\s\\+>~]/g;\nvar straysRegex = /[#\\.]/g;\n\n// Find matches for a regular expression in a string and push their details to parts\n// Type is \"a\" for IDs, \"b\" for classes, attributes and pseudo-classes and \"c\" for elements and pseudo-elements\nvar findMatch = function(regex, type, types, selector) {\n  var matches = selector.match(regex);\n  if (matches) {\n    for (var i = 0; i < matches.length; i++) {\n      types[type]++;\n      // Replace this simple selector with whitespace so it won't be counted in further simple selectors\n      selector = selector.replace(matches[i], ' ');\n    }\n  }\n\n  return selector;\n}\n\n// Calculate the specificity for a selector by dividing it into simple selectors and counting them\nvar calculate = function(selector) {\n  var commaIndex = selector.indexOf(',');\n  if (commaIndex !== -1) {\n    selector = selector.substring(0, commaIndex);\n  }\n\n  var  types = {\n    a: 0,\n    b: 0,\n    c: 0\n  };\n\n  // Remove the negation psuedo-class (:not) but leave its argument because specificity is calculated on its argument\n  selector = selector.replace(notRegex, ' $1 ');\n\n  // Remove anything after a left brace in case a user has pasted in a rule, not just a selector\n  selector = selector.replace(ruleRegex, ' ');\n\n  // Add attribute selectors to parts collection (type b)\n  selector = findMatch(attributeRegex, 'b', types, selector);\n\n  // Add ID selectors to parts collection (type a)\n  selector = findMatch(idRegex, 'a', types, selector);\n\n  // Add class selectors to parts collection (type b)\n  selector = findMatch(classRegex, 'b', types, selector);\n\n  // Add pseudo-element selectors to parts collection (type c)\n  selector = findMatch(pseudoElementRegex, 'c', types, selector);\n\n  // Add pseudo-class selectors to parts collection (type b)\n  selector = findMatch(pseudoClassRegex, 'b', types, selector);\n\n  // Remove universal selector and separator characters\n  selector = selector.replace(separatorRegex, ' ');\n\n  // Remove any stray dots or hashes which aren't attached to words\n  // These may be present if the user is live-editing this selector\n  selector = selector.replace(straysRegex, ' ');\n\n  // The only things left should be element selectors (type c)\n  findMatch(elementRegex, 'c', types, selector);\n\n  return (types.a * 100) + (types.b * 10) + (types.c * 1);\n}\n\nvar specificityCache = {};\n\nexports.calculateSpecificity = function(selector) {\n  var specificity = specificityCache[selector];\n  if (specificity === undefined) {\n    specificity = calculate(selector);\n    specificityCache[selector] = specificity;\n  }\n  return specificity;\n}\n\nvar validSelectorCache = {};\nvar testSelectorElement = null;\n\nexports.isSelectorValid = function(selector) {\n  var valid = validSelectorCache[selector];\n  if (valid === undefined) {\n    if (testSelectorElement == null) {\n      testSelectorElement = document.createElement('div')\n    }\n\n    try {\n      testSelectorElement.querySelector(selector);\n      valid = true;\n    } catch (error) {\n      valid = false;\n    }\n    validSelectorCache[selector] = valid;\n  }\n  return valid;\n}\n\nexports.validateSelector = function(selector) {\n  if (!exports.isSelectorValid(selector)) {\n    var error = new SyntaxError(selector + ' is not a valid selector');\n    error.code = 'EBADSELECTOR';\n    throw error;\n  }\n}\n","import Handler from \"../handler.js\";\nimport csstree from \"css-tree\";\nimport { calculateSpecificity } from \"clear-cut\";\nimport { cleanSelector } from \"../../utils/css.js\";\n\nclass UndisplayedFilter extends Handler {\n\tconstructor(chunker, polisher, caller) {\n\t\tsuper(chunker, polisher, caller);\n\t\tthis.displayRules = {};\n\t}\n\n\tonDeclaration(declaration, dItem, dList, rule) {\n\t\tif (declaration.property === \"display\") {\n\t\t\tlet selector = csstree.generate(rule.ruleNode.prelude);\n\t\t\tlet value = declaration.value.children.first().name;\n\n\t\t\tselector.split(\",\").forEach((s) => {\n\t\t\t\tthis.displayRules[s] = {\n\t\t\t\t\tvalue: value,\n\t\t\t\t\tselector: s,\n\t\t\t\t\tspecificity: calculateSpecificity(s),\n\t\t\t\t\timportant: declaration.important\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\t}\n\n\tfilter(content) {\n\t\tlet { matches, selectors } = this.sortDisplayedSelectors(content, this.displayRules);\n\n\t\t// Find matching elements that have display styles\n\t\tfor (let i = 0; i < matches.length; i++) {\n\t\t\tlet element = matches[i];\n\t\t\tlet selector = selectors[i];\n\t\t\tlet displayValue = selector[selector.length-1].value;\n\t\t\tif(this.removable(element) && displayValue === \"none\") {\n\t\t\t\telement.dataset.undisplayed = \"undisplayed\";\n\t\t\t}\n\t\t}\n\n\t\t// Find elements that have inline styles\n\t\tlet styledElements = content.querySelectorAll(\"[style]\");\n\t\tfor (let i = 0; i < styledElements.length; i++) {\n\t\t\tlet element = styledElements[i];\n\t\t\tif (this.removable(element)) {\n\t\t\t\telement.dataset.undisplayed = \"undisplayed\";\n\t\t\t}\n\t\t}\n\t}\n\n\tsorter(a, b) {\n\t\tif (a.important && !b.important) {\n\t\t\treturn 1;\n\t\t}\n\n\t\tif (b.important && !a.important) {\n\t\t\treturn -1;\n\t\t}\n\n\t\treturn a.specificity - b.specificity;\n\t}\n\n\tsortDisplayedSelectors(content, displayRules=[]) {\n\t\tlet matches = [];\n\t\tlet selectors = [];\n\t\tfor (let d in displayRules) {\n\t\t\tlet displayItem = displayRules[d];\n\t\t\tlet selector = displayItem.selector;\n\t\t\tlet query = [];\n\t\t\ttry {\n\t\t\t\ttry {\n\t\t\t\t\tquery = content.querySelectorAll(selector);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tquery = content.querySelectorAll(cleanSelector(selector));\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tquery = [];\n\t\t\t}\n\t\t\tlet elements = Array.from(query);\n\t\t\tfor (let e of elements) {\n\t\t\t\tif (matches.includes(e)) {\n\t\t\t\t\tlet index = matches.indexOf(e);\n\t\t\t\t\tselectors[index].push(displayItem);\n\t\t\t\t\tselectors[index] = selectors[index].sort(this.sorter);\n\t\t\t\t} else {\n\t\t\t\t\tmatches.push(e);\n\t\t\t\t\tselectors.push([displayItem]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn { matches, selectors };\n\t}\n\n\tremovable(element) {\n\t\tif (element.style &&\n\t\t\t\telement.style.display !== \"\" &&\n\t\t\t\telement.style.display !== \"none\") {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n}\n\nexport default UndisplayedFilter;\n","import WhiteSpaceFilter from \"./whitespace.js\";\nimport CommentsFilter from \"./comments.js\";\nimport ScriptsFilter from \"./scripts.js\";\nimport UndisplayedFilter from \"./undisplayed.js\";\n\nexport default [\n\tWhiteSpaceFilter,\n\tCommentsFilter,\n\tScriptsFilter,\n\tUndisplayedFilter\n];\n","\"use strict\";\n\nmodule.exports = function () {\n\tvar from = Array.from, arr, result;\n\tif (typeof from !== \"function\") return false;\n\tarr = [\"raz\", \"dwa\"];\n\tresult = from(arr);\n\treturn Boolean(result && result !== arr && result[1] === \"dwa\");\n};\n","\"use strict\";\n\nmodule.exports = function () {\n\tif (typeof globalThis !== \"object\") return false;\n\tif (!globalThis) return false;\n\treturn globalThis.Array === Array;\n};\n","var naiveFallback = function () {\n\tif (typeof self === \"object\" && self) return self;\n\tif (typeof window === \"object\" && window) return window;\n\tthrow new Error(\"Unable to resolve global `this`\");\n};\n\nmodule.exports = (function () {\n\tif (this) return this;\n\n\t// Unexpected strict mode (may happen if e.g. bundled into ESM module)\n\n\t// Thanks @mathiasbynens -> https://mathiasbynens.be/notes/globalthis\n\t// In all ES5+ engines global object inherits from Object.prototype\n\t// (if you approached one that doesn't please report)\n\ttry {\n\t\tObject.defineProperty(Object.prototype, \"__global__\", {\n\t\t\tget: function () { return this; },\n\t\t\tconfigurable: true\n\t\t});\n\t} catch (error) {\n\t\t// Unfortunate case of Object.prototype being sealed (via preventExtensions, seal or freeze)\n\t\treturn naiveFallback();\n\t}\n\ttry {\n\t\t// Safari case (window.__global__ is resolved with global context, but __global__ does not)\n\t\tif (!__global__) return naiveFallback();\n\t\treturn __global__;\n\t} finally {\n\t\tdelete Object.prototype.__global__;\n\t}\n})();\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? globalThis : require(\"./implementation\");\n","\"use strict\";\n\nvar global     = require(\"ext/global-this\")\n  , validTypes = { object: true, symbol: true };\n\nmodule.exports = function () {\n\tvar Symbol = global.Symbol;\n\tvar symbol;\n\tif (typeof Symbol !== \"function\") return false;\n\tsymbol = Symbol(\"test symbol\");\n\ttry { String(symbol); }\n\tcatch (e) { return false; }\n\n\t// Return 'true' also for polyfills\n\tif (!validTypes[typeof Symbol.iterator]) return false;\n\tif (!validTypes[typeof Symbol.toPrimitive]) return false;\n\tif (!validTypes[typeof Symbol.toStringTag]) return false;\n\n\treturn true;\n};\n","\"use strict\";\n\nmodule.exports = function (value) {\n\tif (!value) return false;\n\tif (typeof value === \"symbol\") return true;\n\tif (!value.constructor) return false;\n\tif (value.constructor.name !== \"Symbol\") return false;\n\treturn value[value.constructor.toStringTag] === \"Symbol\";\n};\n","\"use strict\";\n\nvar isSymbol = require(\"./is-symbol\");\n\nmodule.exports = function (value) {\n\tif (!isSymbol(value)) throw new TypeError(value + \" is not a symbol\");\n\treturn value;\n};\n","\"use strict\";\n\nvar d = require(\"d\");\n\nvar create = Object.create, defineProperty = Object.defineProperty, objPrototype = Object.prototype;\n\nvar created = create(null);\nmodule.exports = function (desc) {\n\tvar postfix = 0, name, ie11BugWorkaround;\n\twhile (created[desc + (postfix || \"\")]) ++postfix;\n\tdesc += postfix || \"\";\n\tcreated[desc] = true;\n\tname = \"@@\" + desc;\n\tdefineProperty(\n\t\tobjPrototype, name,\n\t\td.gs(null, function (value) {\n\t\t\t// For IE11 issue see:\n\t\t\t// https://connect.microsoft.com/IE/feedbackdetail/view/1928508/\n\t\t\t//    ie11-broken-getters-on-dom-objects\n\t\t\t// https://github.com/medikoo/es6-symbol/issues/12\n\t\t\tif (ie11BugWorkaround) return;\n\t\t\tie11BugWorkaround = true;\n\t\t\tdefineProperty(this, name, d(value));\n\t\t\tie11BugWorkaround = false;\n\t\t})\n\t);\n\treturn name;\n};\n","\"use strict\";\n\nvar d            = require(\"d\")\n  , NativeSymbol = require(\"ext/global-this\").Symbol;\n\nmodule.exports = function (SymbolPolyfill) {\n\treturn Object.defineProperties(SymbolPolyfill, {\n\t\t// To ensure proper interoperability with other native functions (e.g. Array.from)\n\t\t// fallback to eventual native implementation of given symbol\n\t\thasInstance: d(\n\t\t\t\"\", (NativeSymbol && NativeSymbol.hasInstance) || SymbolPolyfill(\"hasInstance\")\n\t\t),\n\t\tisConcatSpreadable: d(\n\t\t\t\"\",\n\t\t\t(NativeSymbol && NativeSymbol.isConcatSpreadable) ||\n\t\t\t\tSymbolPolyfill(\"isConcatSpreadable\")\n\t\t),\n\t\titerator: d(\"\", (NativeSymbol && NativeSymbol.iterator) || SymbolPolyfill(\"iterator\")),\n\t\tmatch: d(\"\", (NativeSymbol && NativeSymbol.match) || SymbolPolyfill(\"match\")),\n\t\treplace: d(\"\", (NativeSymbol && NativeSymbol.replace) || SymbolPolyfill(\"replace\")),\n\t\tsearch: d(\"\", (NativeSymbol && NativeSymbol.search) || SymbolPolyfill(\"search\")),\n\t\tspecies: d(\"\", (NativeSymbol && NativeSymbol.species) || SymbolPolyfill(\"species\")),\n\t\tsplit: d(\"\", (NativeSymbol && NativeSymbol.split) || SymbolPolyfill(\"split\")),\n\t\ttoPrimitive: d(\n\t\t\t\"\", (NativeSymbol && NativeSymbol.toPrimitive) || SymbolPolyfill(\"toPrimitive\")\n\t\t),\n\t\ttoStringTag: d(\n\t\t\t\"\", (NativeSymbol && NativeSymbol.toStringTag) || SymbolPolyfill(\"toStringTag\")\n\t\t),\n\t\tunscopables: d(\n\t\t\t\"\", (NativeSymbol && NativeSymbol.unscopables) || SymbolPolyfill(\"unscopables\")\n\t\t)\n\t});\n};\n","\"use strict\";\n\nvar d              = require(\"d\")\n  , validateSymbol = require(\"../../../validate-symbol\");\n\nvar registry = Object.create(null);\n\nmodule.exports = function (SymbolPolyfill) {\n\treturn Object.defineProperties(SymbolPolyfill, {\n\t\tfor: d(function (key) {\n\t\t\tif (registry[key]) return registry[key];\n\t\t\treturn (registry[key] = SymbolPolyfill(String(key)));\n\t\t}),\n\t\tkeyFor: d(function (symbol) {\n\t\t\tvar key;\n\t\t\tvalidateSymbol(symbol);\n\t\t\tfor (key in registry) {\n\t\t\t\tif (registry[key] === symbol) return key;\n\t\t\t}\n\t\t\treturn undefined;\n\t\t})\n\t});\n};\n","// ES2015 Symbol polyfill for environments that do not (or partially) support it\n\n\"use strict\";\n\nvar d                    = require(\"d\")\n  , validateSymbol       = require(\"./validate-symbol\")\n  , NativeSymbol         = require(\"ext/global-this\").Symbol\n  , generateName         = require(\"./lib/private/generate-name\")\n  , setupStandardSymbols = require(\"./lib/private/setup/standard-symbols\")\n  , setupSymbolRegistry  = require(\"./lib/private/setup/symbol-registry\");\n\nvar create = Object.create\n  , defineProperties = Object.defineProperties\n  , defineProperty = Object.defineProperty;\n\nvar SymbolPolyfill, HiddenSymbol, isNativeSafe;\n\nif (typeof NativeSymbol === \"function\") {\n\ttry {\n\t\tString(NativeSymbol());\n\t\tisNativeSafe = true;\n\t} catch (ignore) {}\n} else {\n\tNativeSymbol = null;\n}\n\n// Internal constructor (not one exposed) for creating Symbol instances.\n// This one is used to ensure that `someSymbol instanceof Symbol` always return false\nHiddenSymbol = function Symbol(description) {\n\tif (this instanceof HiddenSymbol) throw new TypeError(\"Symbol is not a constructor\");\n\treturn SymbolPolyfill(description);\n};\n\n// Exposed `Symbol` constructor\n// (returns instances of HiddenSymbol)\nmodule.exports = SymbolPolyfill = function Symbol(description) {\n\tvar symbol;\n\tif (this instanceof Symbol) throw new TypeError(\"Symbol is not a constructor\");\n\tif (isNativeSafe) return NativeSymbol(description);\n\tsymbol = create(HiddenSymbol.prototype);\n\tdescription = description === undefined ? \"\" : String(description);\n\treturn defineProperties(symbol, {\n\t\t__description__: d(\"\", description),\n\t\t__name__: d(\"\", generateName(description))\n\t});\n};\n\nsetupStandardSymbols(SymbolPolyfill);\nsetupSymbolRegistry(SymbolPolyfill);\n\n// Internal tweaks for real symbol producer\ndefineProperties(HiddenSymbol.prototype, {\n\tconstructor: d(SymbolPolyfill),\n\ttoString: d(\"\", function () { return this.__name__; })\n});\n\n// Proper implementation of methods exposed on Symbol.prototype\n// They won't be accessible on produced symbol instances as they derive from HiddenSymbol.prototype\ndefineProperties(SymbolPolyfill.prototype, {\n\ttoString: d(function () { return \"Symbol (\" + validateSymbol(this).__description__ + \")\"; }),\n\tvalueOf: d(function () { return validateSymbol(this); })\n});\ndefineProperty(\n\tSymbolPolyfill.prototype, SymbolPolyfill.toPrimitive,\n\td(\"\", function () {\n\t\tvar symbol = validateSymbol(this);\n\t\tif (typeof symbol === \"symbol\") return symbol;\n\t\treturn symbol.toString();\n\t})\n);\ndefineProperty(SymbolPolyfill.prototype, SymbolPolyfill.toStringTag, d(\"c\", \"Symbol\"));\n\n// Proper implementaton of toPrimitive and toStringTag for returned symbol instances\ndefineProperty(\n\tHiddenSymbol.prototype, SymbolPolyfill.toStringTag,\n\td(\"c\", SymbolPolyfill.prototype[SymbolPolyfill.toStringTag])\n);\n\n// Note: It's important to define `toPrimitive` as last one, as some implementations\n// implement `toPrimitive` natively without implementing `toStringTag` (or other specified symbols)\n// And that may invoke error in definition flow:\n// See: https://github.com/medikoo/es6-symbol/issues/13#issuecomment-164146149\ndefineProperty(\n\tHiddenSymbol.prototype, SymbolPolyfill.toPrimitive,\n\td(\"c\", SymbolPolyfill.prototype[SymbolPolyfill.toPrimitive])\n);\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")()\n\t? require(\"ext/global-this\").Symbol\n\t: require(\"./polyfill\");\n","\"use strict\";\n\nvar objToString = Object.prototype.toString\n  , id = objToString.call((function () { return arguments; })());\n\nmodule.exports = function (value) { return objToString.call(value) === id; };\n","\"use strict\";\n\nvar objToString = Object.prototype.toString\n  , isFunctionStringTag = RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);\n\nmodule.exports = function (value) {\n\treturn typeof value === \"function\" && isFunctionStringTag(objToString.call(value));\n};\n","\"use strict\";\n\nmodule.exports = function () {\n\tvar sign = Math.sign;\n\tif (typeof sign !== \"function\") return false;\n\treturn sign(10) === 1 && sign(-20) === -1;\n};\n","\"use strict\";\n\nmodule.exports = function (value) {\n\tvalue = Number(value);\n\tif (isNaN(value) || value === 0) return value;\n\treturn value > 0 ? 1 : -1;\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? Math.sign : require(\"./shim\");\n","\"use strict\";\n\nvar sign  = require(\"../math/sign\")\n  , abs   = Math.abs\n  , floor = Math.floor;\n\nmodule.exports = function (value) {\n\tif (isNaN(value)) return 0;\n\tvalue = Number(value);\n\tif (value === 0 || !isFinite(value)) return value;\n\treturn sign(value) * floor(abs(value));\n};\n","\"use strict\";\n\nvar toInteger = require(\"./to-integer\")\n  , max       = Math.max;\n\nmodule.exports = function (value) { return max(0, toInteger(value)); };\n","\"use strict\";\n\nvar objToString = Object.prototype.toString, id = objToString.call(\"\");\n\nmodule.exports = function (value) {\n\treturn (\n\t\ttypeof value === \"string\" ||\n\t\t(value &&\n\t\t\ttypeof value === \"object\" &&\n\t\t\t(value instanceof String || objToString.call(value) === id)) ||\n\t\tfalse\n\t);\n};\n","\"use strict\";\n\nvar iteratorSymbol = require(\"es6-symbol\").iterator\n  , isArguments    = require(\"../../function/is-arguments\")\n  , isFunction     = require(\"../../function/is-function\")\n  , toPosInt       = require(\"../../number/to-pos-integer\")\n  , callable       = require(\"../../object/valid-callable\")\n  , validValue     = require(\"../../object/valid-value\")\n  , isValue        = require(\"../../object/is-value\")\n  , isString       = require(\"../../string/is-string\")\n  , isArray        = Array.isArray\n  , call           = Function.prototype.call\n  , desc           = { configurable: true, enumerable: true, writable: true, value: null }\n  , defineProperty = Object.defineProperty;\n\n// eslint-disable-next-line complexity, max-lines-per-function\nmodule.exports = function (arrayLike /*, mapFn, thisArg*/) {\n\tvar mapFn = arguments[1]\n\t  , thisArg = arguments[2]\n\t  , Context\n\t  , i\n\t  , j\n\t  , arr\n\t  , length\n\t  , code\n\t  , iterator\n\t  , result\n\t  , getIterator\n\t  , value;\n\n\tarrayLike = Object(validValue(arrayLike));\n\n\tif (isValue(mapFn)) callable(mapFn);\n\tif (!this || this === Array || !isFunction(this)) {\n\t\t// Result: Plain array\n\t\tif (!mapFn) {\n\t\t\tif (isArguments(arrayLike)) {\n\t\t\t\t// Source: Arguments\n\t\t\t\tlength = arrayLike.length;\n\t\t\t\tif (length !== 1) return Array.apply(null, arrayLike);\n\t\t\t\tarr = new Array(1);\n\t\t\t\tarr[0] = arrayLike[0];\n\t\t\t\treturn arr;\n\t\t\t}\n\t\t\tif (isArray(arrayLike)) {\n\t\t\t\t// Source: Array\n\t\t\t\tarr = new Array((length = arrayLike.length));\n\t\t\t\tfor (i = 0; i < length; ++i) arr[i] = arrayLike[i];\n\t\t\t\treturn arr;\n\t\t\t}\n\t\t}\n\t\tarr = [];\n\t} else {\n\t\t// Result: Non plain array\n\t\tContext = this;\n\t}\n\n\tif (!isArray(arrayLike)) {\n\t\tif ((getIterator = arrayLike[iteratorSymbol]) !== undefined) {\n\t\t\t// Source: Iterator\n\t\t\titerator = callable(getIterator).call(arrayLike);\n\t\t\tif (Context) arr = new Context();\n\t\t\tresult = iterator.next();\n\t\t\ti = 0;\n\t\t\twhile (!result.done) {\n\t\t\t\tvalue = mapFn ? call.call(mapFn, thisArg, result.value, i) : result.value;\n\t\t\t\tif (Context) {\n\t\t\t\t\tdesc.value = value;\n\t\t\t\t\tdefineProperty(arr, i, desc);\n\t\t\t\t} else {\n\t\t\t\t\tarr[i] = value;\n\t\t\t\t}\n\t\t\t\tresult = iterator.next();\n\t\t\t\t++i;\n\t\t\t}\n\t\t\tlength = i;\n\t\t} else if (isString(arrayLike)) {\n\t\t\t// Source: String\n\t\t\tlength = arrayLike.length;\n\t\t\tif (Context) arr = new Context();\n\t\t\tfor (i = 0, j = 0; i < length; ++i) {\n\t\t\t\tvalue = arrayLike[i];\n\t\t\t\tif (i + 1 < length) {\n\t\t\t\t\tcode = value.charCodeAt(0);\n\t\t\t\t\t// eslint-disable-next-line max-depth\n\t\t\t\t\tif (code >= 0xd800 && code <= 0xdbff) value += arrayLike[++i];\n\t\t\t\t}\n\t\t\t\tvalue = mapFn ? call.call(mapFn, thisArg, value, j) : value;\n\t\t\t\tif (Context) {\n\t\t\t\t\tdesc.value = value;\n\t\t\t\t\tdefineProperty(arr, j, desc);\n\t\t\t\t} else {\n\t\t\t\t\tarr[j] = value;\n\t\t\t\t}\n\t\t\t\t++j;\n\t\t\t}\n\t\t\tlength = j;\n\t\t}\n\t}\n\tif (length === undefined) {\n\t\t// Source: array or array-like\n\t\tlength = toPosInt(arrayLike.length);\n\t\tif (Context) arr = new Context(length);\n\t\tfor (i = 0; i < length; ++i) {\n\t\t\tvalue = mapFn ? call.call(mapFn, thisArg, arrayLike[i], i) : arrayLike[i];\n\t\t\tif (Context) {\n\t\t\t\tdesc.value = value;\n\t\t\t\tdefineProperty(arr, i, desc);\n\t\t\t} else {\n\t\t\t\tarr[i] = value;\n\t\t\t}\n\t\t}\n\t}\n\tif (Context) {\n\t\tdesc.value = null;\n\t\tarr.length = length;\n\t}\n\treturn arr;\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? Array.from : require(\"./shim\");\n","\"use strict\";\n\nmodule.exports = function () {\n\tvar numberIsNaN = Number.isNaN;\n\tif (typeof numberIsNaN !== \"function\") return false;\n\treturn !numberIsNaN({}) && numberIsNaN(NaN) && !numberIsNaN(34);\n};\n","\"use strict\";\n\nmodule.exports = function (value) {\n\t// eslint-disable-next-line no-self-compare\n\treturn value !== value;\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? Number.isNaN : require(\"./shim\");\n","\"use strict\";\n\nvar numberIsNaN       = require(\"../../number/is-nan\")\n  , toPosInt          = require(\"../../number/to-pos-integer\")\n  , value             = require(\"../../object/valid-value\")\n  , indexOf           = Array.prototype.indexOf\n  , objHasOwnProperty = Object.prototype.hasOwnProperty\n  , abs               = Math.abs\n  , floor             = Math.floor;\n\nmodule.exports = function (searchElement /*, fromIndex*/) {\n\tvar i, length, fromIndex, val;\n\tif (!numberIsNaN(searchElement)) return indexOf.apply(this, arguments);\n\n\tlength = toPosInt(value(this).length);\n\tfromIndex = arguments[1];\n\tif (isNaN(fromIndex)) fromIndex = 0;\n\telse if (fromIndex >= 0) fromIndex = floor(fromIndex);\n\telse fromIndex = toPosInt(this.length) - floor(abs(fromIndex));\n\n\tfor (i = fromIndex; i < length; ++i) {\n\t\tif (objHasOwnProperty.call(this, i)) {\n\t\t\tval = this[i];\n\t\t\tif (numberIsNaN(val)) return i; // Jslint: ignore\n\t\t}\n\t}\n\treturn -1;\n};\n","\"use strict\";\n\nvar indexOf = require(\"./e-index-of\")\n  , forEach = Array.prototype.forEach\n  , splice  = Array.prototype.splice;\n\n// eslint-disable-next-line no-unused-vars\nmodule.exports = function (itemToRemove /*, …item*/) {\n\tforEach.call(\n\t\targuments,\n\t\tfunction (item) {\n\t\t\tvar index = indexOf.call(this, item);\n\t\t\tif (index !== -1) splice.call(this, index, 1);\n\t\t},\n\t\tthis\n\t);\n};\n","\"use strict\";\n\nvar isValue = require(\"./is-value\");\n\nvar map = { function: true, object: true };\n\nmodule.exports = function (value) { return (isValue(value) && map[typeof value]) || false; };\n","\"use strict\";\n\nvar isObject = require(\"./is-object\");\n\nmodule.exports = function (value) {\n\tif (!isObject(value)) throw new TypeError(value + \" is not an Object\");\n\treturn value;\n};\n","'use strict';\n\nvar aFrom          = require('es5-ext/array/from')\n  , remove         = require('es5-ext/array/#/remove')\n  , value          = require('es5-ext/object/valid-object')\n  , d              = require('d')\n  , emit           = require('./').methods.emit\n\n  , defineProperty = Object.defineProperty\n  , hasOwnProperty = Object.prototype.hasOwnProperty\n  , getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\nmodule.exports = function (e1, e2/*, name*/) {\n\tvar pipes, pipe, desc, name;\n\n\t(value(e1) && value(e2));\n\tname = arguments[2];\n\tif (name === undefined) name = 'emit';\n\n\tpipe = {\n\t\tclose: function () { remove.call(pipes, e2); }\n\t};\n\tif (hasOwnProperty.call(e1, '__eePipes__')) {\n\t\t(pipes = e1.__eePipes__).push(e2);\n\t\treturn pipe;\n\t}\n\tdefineProperty(e1, '__eePipes__', d('c', pipes = [e2]));\n\tdesc = getOwnPropertyDescriptor(e1, name);\n\tif (!desc) {\n\t\tdesc = d('c', undefined);\n\t} else {\n\t\tdelete desc.get;\n\t\tdelete desc.set;\n\t}\n\tdesc.value = function () {\n\t\tvar i, emitter, data = aFrom(pipes);\n\t\temit.apply(this, arguments);\n\t\tfor (i = 0; (emitter = data[i]); ++i) emit.apply(emitter, arguments);\n\t};\n\tdefineProperty(e1, name, desc);\n\treturn pipe;\n};\n","import pagedMediaHandlers from \"../modules/paged-media/index.js\";\nimport generatedContentHandlers from \"../modules/generated-content/index.js\";\nimport filters from \"../modules/filters/index.js\";\nimport EventEmitter from \"event-emitter\";\nimport pipe from \"event-emitter/pipe.js\";\n\nexport let registeredHandlers = [...pagedMediaHandlers, ...generatedContentHandlers, ...filters];\n\nexport class Handlers {\n\tconstructor(chunker, polisher, caller) {\n\t\tlet handlers = [];\n\n\t\tregisteredHandlers.forEach((Handler) => {\n\t\t\tlet handler = new Handler(chunker, polisher, caller);\n\t\t\thandlers.push(handler);\n\t\t\tpipe(handler, this);\n\t\t});\n\t}\n}\n\nEventEmitter(Handlers.prototype);\n\nexport function registerHandlers() {\n\tfor (var i = 0; i < arguments.length; i++) {\n\t\tregisteredHandlers.push(arguments[i]);\n\t}\n}\n\nexport function initializeHandlers(chunker, polisher, caller) {\n\tlet handlers = new Handlers(chunker, polisher, caller);\n\treturn handlers;\n}\n","import EventEmitter from \"event-emitter\";\n\nimport Hook from \"../utils/hook.js\";\nimport Chunker from \"../chunker/chunker.js\";\nimport Polisher from \"../polisher/polisher.js\";\n\nimport { initializeHandlers, registerHandlers } from \"../utils/handlers.js\";\n\nclass Previewer {\n\tconstructor(options) {\n\t\t// this.preview = this.getParams(\"preview\") !== \"false\";\n\n\t\tthis.settings = options || {};\n\n\t\t// Process styles\n\t\tthis.polisher = new Polisher(false);\n\n\t\t// Chunk contents\n\t\tthis.chunker = new Chunker(undefined, undefined, this.settings);\n\n\t\t// Hooks\n\t\tthis.hooks = {};\n\t\tthis.hooks.beforePreview = new Hook(this);\n\t\tthis.hooks.afterPreview = new Hook(this);\n\n\t\t// default size\n\t\tthis.size = {\n\t\t\twidth: {\n\t\t\t\tvalue: 8.5,\n\t\t\t\tunit: \"in\"\n\t\t\t},\n\t\t\theight: {\n\t\t\t\tvalue: 11,\n\t\t\t\tunit: \"in\"\n\t\t\t},\n\t\t\tformat: undefined,\n\t\t\torientation: undefined\n\t\t};\n\n\t\tthis.chunker.on(\"page\", (page) => {\n\t\t\tthis.emit(\"page\", page);\n\t\t});\n\n\t\tthis.chunker.on(\"rendering\", () => {\n\t\t\tthis.emit(\"rendering\", this.chunker);\n\t\t});\n\t}\n\n\tinitializeHandlers() {\n\t\tlet handlers = initializeHandlers(this.chunker, this.polisher, this);\n\n\t\thandlers.on(\"size\", (size) => {\n\t\t\tthis.size = size;\n\t\t\tthis.emit(\"size\", size);\n\t\t});\n\n\t\thandlers.on(\"atpages\", (pages) => {\n\t\t\tthis.atpages = pages;\n\t\t\tthis.emit(\"atpages\", pages);\n\t\t});\n\n\t\treturn handlers;\n\t}\n\n\tregisterHandlers() {\n\t\treturn registerHandlers.apply(registerHandlers, arguments);\n\t}\n\n\tgetParams(name) {\n\t\tlet param;\n\t\tlet url = new URL(window.location);\n\t\tlet params = new URLSearchParams(url.search);\n\t\tfor(var pair of params.entries()) {\n\t\t\tif(pair[0] === name) {\n\t\t\t\tparam = pair[1];\n\t\t\t}\n\t\t}\n\n\t\treturn param;\n\t}\n\n\twrapContent() {\n\t\t// Wrap body in template tag\n\t\tlet body = document.querySelector(\"body\");\n\n\t\t// Check if a template exists\n\t\tlet template;\n\t\ttemplate = body.querySelector(\":scope > template[data-ref='pagedjs-content']\");\n\n\t\tif (!template) {\n\t\t\t// Otherwise create one\n\t\t\ttemplate = document.createElement(\"template\");\n\t\t\ttemplate.dataset.ref = \"pagedjs-content\";\n\t\t\ttemplate.innerHTML = body.innerHTML;\n\t\t\tbody.innerHTML = \"\";\n\t\t\tbody.appendChild(template);\n\t\t}\n\n\t\treturn template.content;\n\t}\n\n\tremoveStyles(doc=document) {\n\t\t// Get all stylesheets\n\t\tconst stylesheets = Array.from(doc.querySelectorAll(\"link[rel='stylesheet']:not([data-pagedjs-ignore], [media~='screen'])\"));\n\t\t// Get inline styles\n\t\tconst inlineStyles = Array.from(doc.querySelectorAll(\"style:not([data-pagedjs-inserted-styles], [data-pagedjs-ignore], [media~='screen'])\"));\n\t\tconst elements = [...stylesheets, ...inlineStyles];\n\t\treturn elements\n\t\t\t// preserve order\n\t\t\t.sort(function (element1, element2) {\n\t\t\t\tconst position = element1.compareDocumentPosition(element2);\n\t\t\t\tif (position === Node.DOCUMENT_POSITION_PRECEDING) {\n\t\t\t\t\treturn 1;\n\t\t\t\t} else if (position === Node.DOCUMENT_POSITION_FOLLOWING) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t})\n\t\t\t// extract the href\n\t\t\t.map((element) => {\n\t\t\t\tif (element.nodeName === \"STYLE\") {\n\t\t\t\t\tconst obj = {};\n\t\t\t\t\tobj[window.location.href] = element.textContent;\n\t\t\t\t\telement.remove();\n\t\t\t\t\treturn obj;\n\t\t\t\t}\n\t\t\t\tif (element.nodeName === \"LINK\") {\n\t\t\t\t\telement.remove();\n\t\t\t\t\treturn element.href;\n\t\t\t\t}\n\t\t\t\t// ignore\n\t\t\t\tconsole.warn(`Unable to process: ${element}, ignoring.`);\n\t\t\t});\n\t}\n\n\tasync preview(content, stylesheets, renderTo) {\n\n\t\tawait this.hooks.beforePreview.trigger(content, renderTo);\n\n\t\tif (!content) {\n\t\t\tcontent = this.wrapContent();\n\t\t}\n\n\t\tif (!stylesheets) {\n\t\t\tstylesheets = this.removeStyles();\n\t\t}\n\n\t\tthis.polisher.setup();\n\n\t\tthis.handlers = this.initializeHandlers();\n\n\t\tawait this.polisher.add(...stylesheets);\n\n\t\tlet startTime = performance.now();\n\n\t\t// Render flow\n\t\tlet flow = await this.chunker.flow(content, renderTo);\n\n\t\tlet endTime = performance.now();\n\n\t\tflow.performance = (endTime - startTime);\n\t\tflow.size = this.size;\n\n\t\tthis.emit(\"rendered\", flow);\n\n\t\tawait this.hooks.afterPreview.trigger(flow.pages);\n\n\t\treturn flow;\n\t}\n}\n\nEventEmitter(Previewer.prototype);\n\nexport default Previewer;\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var root = require('./_root');\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nmodule.exports = now;\n","/** Used to match a single whitespace character. */\nvar reWhitespace = /\\s/;\n\n/**\n * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n * character of `string`.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {number} Returns the index of the last non-whitespace character.\n */\nfunction trimmedEndIndex(string) {\n  var index = string.length;\n\n  while (index-- && reWhitespace.test(string.charAt(index))) {}\n  return index;\n}\n\nmodule.exports = trimmedEndIndex;\n","var trimmedEndIndex = require('./_trimmedEndIndex');\n\n/** Used to match leading whitespace. */\nvar reTrimStart = /^\\s+/;\n\n/**\n * The base implementation of `_.trim`.\n *\n * @private\n * @param {string} string The string to trim.\n * @returns {string} Returns the trimmed string.\n */\nfunction baseTrim(string) {\n  return string\n    ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')\n    : string;\n}\n\nmodule.exports = baseTrim;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nmodule.exports = isSymbol;\n","var baseTrim = require('./_baseTrim'),\n    isObject = require('./isObject'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = baseTrim(value);\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = toNumber;\n","var isObject = require('./isObject'),\n    now = require('./now'),\n    toNumber = require('./toNumber');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nmodule.exports = debounce;\n","declare const $uhuu: {\n  editDialog: (value: any) => void;\n};\n\nclass DocumentUtils {\n  prepareRendering(container: HTMLElement) {        \n    const { clientHeight: height, clientWidth: width } = container;\n    container.innerHTML = '';\n    if (height) container.style.minHeight = `${height}px`;\n    if (width && window !== window.parent) container.style.minWidth = `${width}px`;\n    document?.querySelectorAll(\"style[data-pagedjs-inserted-styles]\").forEach((style) => style.remove());\n    this.resetZoom();\n  }\n\n  finalizeRendering(container: HTMLElement) {    \n    if (container) {\n      container.style.minWidth = 'auto';\n      container.style.minHeight = 'auto';\n    }\n    this.attachEventListeners();\n    this.applyPagedCSS();\n    this.restoreZoom();\n  }\n\n  attachEventListeners() {        \n    document?.querySelectorAll(\"[data-uhuu]\").forEach((item) => {\n      const clickListener = function () {\n        const value = JSON.parse(this.getAttribute(\"data-uhuu\"));\n        $uhuu.editDialog(value);\n      };\n      item.removeEventListener('click', clickListener);\n      item.addEventListener('click', clickListener);\n    });\n  }\n\n  applyPagedCSS() {    \n    document?.querySelectorAll(\".page-break-after[data-paged-css]\").forEach((el) => {\n      const pagedSheet = el.closest('div.pagedjs_sheet');\n      const pagedCSS = el.getAttribute('data-paged-css');\n      if (pagedSheet && pagedCSS) {\n        pagedCSS.split(' ').filter(Boolean).forEach((cssClass) => pagedSheet.classList.add(cssClass));\n      }\n    });\n  }\n\n  getStyleUrls(styles: string, fileName: string) {\n    if (styles) {\n      const blob = new Blob([styles], { type: 'text/css' });\n      return [URL.createObjectURL(blob)];\n    }\n    return fileName ? [fileName] : [];\n  };\n\n  private originalStyles: {\n    width: string;\n    height: string; \n    transform: string;\n    transformOrigin: string;\n  };\n\n  resetZoom() {\n    if (typeof document === 'undefined') return;\n    \n    const body = document?.body;\n    if(!body.style.transform) {      \n      return;     \n    }\n    \n    this.originalStyles = {\n      width: body.style.width,\n      height: body.style.height,\n      transform: body.style.transform,\n      transformOrigin: body.style.transformOrigin || 'center center'\n    };\n\n    body.style.opacity = '0';\n    body.style.width = '100%';\n    body.style.height = '100%';\n    body.style.transform = '';\n  }\n\n  restoreZoom() {           \n    if (typeof document === 'undefined') return;\n    \n    const body = document?.body;\n    body.style.opacity = '1';\n\n    if(!this.originalStyles?.transform) return;            \n    body.style.width = this.originalStyles.width;\n    body.style.height = this.originalStyles.height;\n    body.style.transform = this.originalStyles.transform;    \n  }\n}\n\nexport default DocumentUtils;","/**\n * Standard page size calculations in millimeters\n */\nexport class PageSizeUtils {\n    static PAGE_SIZES = {\n        // A series\n        'A0': { width: 841, height: 1189 },\n        'A1': { width: 594, height: 841 },\n        'A2': { width: 420, height: 594 },\n        'A3': { width: 297, height: 420 },\n        'A4': { width: 210, height: 297 },\n        'A5': { width: 148, height: 210 },\n        'A6': { width: 105, height: 148 },\n        \n        // B series\n        'B0': { width: 1000, height: 1414 },\n        'B1': { width: 707, height: 1000 },\n        'B2': { width: 500, height: 707 },\n        'B3': { width: 353, height: 500 },\n        'B4': { width: 250, height: 353 },\n        'B5': { width: 176, height: 250 },\n        'B6': { width: 125, height: 176 },\n        \n        // C series (envelopes)\n        'C0': { width: 917, height: 1297 },\n        'C1': { width: 648, height: 917 },\n        'C2': { width: 458, height: 648 },\n        'C3': { width: 324, height: 458 },\n        'C4': { width: 229, height: 324 },\n        'C5': { width: 162, height: 229 },\n        'C6': { width: 114, height: 162 },\n        \n        // US Sizes\n        'LETTER': { width: 216, height: 279 },\n        'LEGAL': { width: 216, height: 356 },\n        'TABLOID': { width: 279, height: 432 },\n        'LEDGER': { width: 432, height: 279 }\n    };\n    /**\n     * Get all available page size format names\n     * @returns {string[]} Array of page size format names\n     */\n    static getStandardFormats() {\n        return ['Custom', 'A3', 'A4', 'A5', 'LETTER', 'LEGAL'];\n    }\n\n    /**\n     * Get dimensions for a specific page size\n     * @param {Object} options - Configuration options\n     * @param {string} options.format - Page size format (e.g., 'A4', 'LETTER')\n     * @param {string} [options.orientation='portrait'] - Page orientation ('portrait' or 'landscape')\n     * @returns {{ width: number, height: number } | null} Dimensions in millimeters\n     */\n    static getDimensions({ \n        format, \n        orientation = 'portrait'\n    }) {\n        const size = this.PAGE_SIZES[format.toUpperCase()];\n        if (!size) return null;\n\n        return orientation === 'landscape' ? \n            { \n                width: size.height, \n                height: size.width\n            } : \n            { \n                width: size.width, \n                height: size.height\n            };\n    }\n\n    /**\n     * Convert millimeters to pixels at a given DPI\n     * @param {number} mm - Value in millimeters\n     * @param {number} dpi - Dots per inch (default: 72)\n     * @returns {number} Value in pixels\n     */\n    static mmToPx(mm, dpi = 72) {\n        return (mm * dpi) / 25.4;\n    }\n\n    /**\n     * Get dimensions in pixels for a specific page size\n     * @param {Object} options - Configuration options\n     * @param {string} options.format - Page size format (e.g., 'A4', 'LETTER')\n     * @param {string} [options.orientation='portrait'] - Page orientation ('portrait' or 'landscape')\n     * @param {number} [options.dpi=72] - Dots per inch\n     * @returns {{ width: number, height: number } | null} Dimensions in pixels\n     */\n    static getDimensionsInPx({ \n        format, \n        orientation = 'portrait', \n        dpi = 72\n    }) {\n        const dimensions = this.getDimensions({ \n            format, \n            orientation\n        });\n        if (!dimensions) return null;\n\n        return {\n            width: this.mmToPx(dimensions.width, dpi),\n            height: this.mmToPx(dimensions.height, dpi)\n        };\n    }\n\n    /**\n     * Check if a format exists\n     * @param {string} format - Page size format to check\n     * @returns {boolean} Whether the format exists\n     */\n    static hasFormat(format) {\n        return format.toUpperCase() in this.PAGE_SIZES;\n    }\n\n    /**\n     * Get all available formats\n     * @returns {string[]} Array of available format names\n     */\n    static getAvailableFormats() {\n        return Object.keys(this.PAGE_SIZES);\n    }\n\n    static pageParams(paginationType, args) {\n        if (typeof document === 'undefined') return;\n        \n        const {format, orientation, width, height, bleed, showBleed, compatibility, printCssRaw, printCssUrl, preview} = args;\n        const dimensions = (!format || format.toLowerCase() === 'custom') && width && height && width > 10 && height > 10 && width < 4000 && height < 4000\n            ? { width, height } \n            : this.getDimensions({ format: format ?? 'A4', orientation });\n\n\n        if (dimensions) {\n            document.documentElement.style.setProperty('--uhuu-page-width', `${dimensions.width}mm`);\n            document.documentElement.style.setProperty('--uhuu-page-height', `${dimensions.height}mm`);        \n        }\n\n        document.documentElement.style.setProperty('--uhuu-page-bleed', `${Math.min(Math.max(bleed ?? 0, 0), 400)}mm`);\n\n        const page = { \n            paginationType,\n            format, \n            orientation, \n            bleed, \n            width: dimensions?.width, \n            height: dimensions?.height, \n            preview, \n            showBleed,\n            compatibility,\n            printCssRaw,\n            printCssUrl \n        };\n\n        return { page };  \n    }\n}\n\nexport default PageSizeUtils;","import React, { createContext } from 'react';\n\n// Create the Context\nexport const ConfigContext = createContext(null);\n\n// ConfigProvider Component\nconst ConfigProvider = ({ config, children }) => {\n  return (\n    <ConfigContext.Provider value={config}>\n      {children}\n    </ConfigContext.Provider>\n  );\n};\n\nexport default ConfigProvider;","import { useState, useRef, useEffect } from 'react';\nimport { Previewer } from 'pagedjs';\nimport debounce from 'lodash/debounce';\nimport DocumentUtils from './pagination/DocumentUtils';\nimport PageSizeUtils from '../utility/PageSizeUtils';\nimport ConfigProvider from '../config/config-provider';\nimport './pagination/pagination-dynamic.css';\nimport './../styles/uhuu-indicators.css';\n\ninterface PaginationProps {\n  children: React.ReactNode;\n  className?: string;\n  setup: any;  \n}\n\nconst Pagination = ({ children, className, setup }: PaginationProps) => {\n  \n  const [rendering, setRendering] = useState(false);\n  const containerRef = useRef(null);\n  const contentRef = useRef(null);    \n  const documentUtilsRef = useRef<DocumentUtils>(new DocumentUtils());\n\n  const config = PageSizeUtils.pageParams(\"dynamic\", setup);\n\n  let printCssRaw = config?.page?.printCssRaw;\n  if (config?.page?.width && config?.page?.height) {\n    const pageRuleRegex = /@page\\s*{([^}]*)}/;\n    const match = printCssRaw?.match(pageRuleRegex);\n    \n    const sizeAndBleedStyles = `\n      size: ${config.page.width}mm ${config.page.height}mm;\n      bleed: ${config.page.bleed ?? 0}mm;`;\n\n    if (match) {\n      // Remove any existing size/bleed properties\n      const existingStyles = match[1].replace(/\\s*(size|bleed)\\s*:[^;]*;/g, '');\n      const newPageRule = `@page {${sizeAndBleedStyles}${existingStyles}}`;\n      printCssRaw = printCssRaw.replace(pageRuleRegex, newPageRule);\n    } else {\n      printCssRaw = `@page {${sizeAndBleedStyles}}\\n${printCssRaw ?? ''}`;\n    }\n  }\n\n  const layoutPage = debounce(() => {\n    if (!containerRef.current || !contentRef.current) {\n      console.warn(\"Container or page content reference is missing.\");\n      return;\n    }\n\n    if(rendering) {\n      return;\n    }\n    \n    setRendering(true);    \n    documentUtilsRef.current.prepareRendering(containerRef.current);\n\n    const paged = new Previewer();\n    const styleUrls = documentUtilsRef.current.getStyleUrls(printCssRaw ?? '', config?.page?.printCssUrl ?? '');\n    \n    try {\n      paged.preview(contentRef.current?.innerHTML ?? '', styleUrls, containerRef.current).then(() => {        \n        setRendering(false);\n        documentUtilsRef.current.finalizeRendering(containerRef.current);\n      });\n    } catch (error) {\n      console.error(\"Error during Paged.js preview rendering:\", error);      \n      setRendering(false);\n    }\n  }, 500, { leading: true });\n\n  useEffect(() => {\n    layoutPage();\n  }, [children, setup]);\n\n  return (\n    <ConfigProvider config={config}>\n      <div className={[(className ?? ''), (rendering ? 'rendering' : 'rendered'), (config?.page?.showBleed ? 'uhuu-bleed-visible' : ''), (config?.page?.preview ?? '')].filter(Boolean).join(' ')} ref={containerRef}></div>\n      <div className=\"uhuu-reactive-content\" style={{display: 'none'}} ref={contentRef}>\n        {children}\n      </div>\n    </ConfigProvider>\n  );\n};\n\nexport default Pagination;","import React, { ReactNode } from \"react\";\n\ninterface SheetProps {\n  children: ReactNode;\n}\n\nconst Sheet: React.FC<SheetProps> = ({ children }) => {\n  return <>{children}</>;\n};\n\nexport default Sheet;","class Compatibility {\n\n  static handlePageBreakStyles() {\n    document?.querySelectorAll(\".page-break-after[data-paged-css]\").forEach((el) => {\n      const pagedSheet = el.closest('div.uhuu-page-sheet');\n      const pagedCSS = el.getAttribute('data-paged-css');\n      \n      if (pagedSheet && pagedCSS) {\n        const cssClasses = pagedCSS.split(' ').filter(Boolean);\n        cssClasses.forEach((cssClass) => pagedSheet.classList.add(cssClass));\n      }\n    });\n  }\n  \n  static handleUhuuDialogs() {\n    const clickListener = function(this: HTMLElement) {\n      const value = JSON.parse(this.getAttribute(\"data-uhuu\") || '{}');\n      $uhuu.editDialog(value);\n    };\n  \n    document?.querySelectorAll(\"[data-uhuu]\").forEach((el) => {\n      el.removeEventListener('click', clickListener);\n      el.addEventListener('click', clickListener);\n    });\n  }\n\n  static handle() {\n    Compatibility.handlePageBreakStyles();\n    Compatibility.handleUhuuDialogs();\n  }\n}\n\nexport default Compatibility;","class DocumentUtils {\n  static setupPageStyles(printCssUrl?: string) {\n    if (!printCssUrl || typeof document === 'undefined') return;\n    const link = document.createElement(\"link\");\n    link.rel = \"stylesheet\";\n    link.href = printCssUrl;\n    document.head.appendChild(link);\n    return link;\n  }\n\n  static removePageStyles(link: HTMLLinkElement) {\n    if (link && typeof document !== 'undefined') document?.head.removeChild(link);\n  }\n  \n}\n\nexport default DocumentUtils;","import React, { useEffect } from 'react';\nimport CompatibilityUtils from './pagination/CompatibilityUtils';\nimport DocumentUtils from './pagination/DocumentUtils';\nimport PageSizeUtils from '../utility/PageSizeUtils';\nimport ConfigProvider from '../config/config-provider';\nimport './pagination/print.css';\nimport './pagination/pagination-static.css';\nimport './../styles/uhuu-indicators.css';\n\ninterface PaginationProps {\n  children: React.ReactNode;\n  className?: string;\n  setup: any;\n}\n\nexport const Pagination: React.FC<PaginationProps> = ({ children, className, setup }) => {\n  const config = PageSizeUtils.pageParams(\"static\", setup);\n\n  useEffect(() => {\n    if (config?.page?.compatibility) {\n      CompatibilityUtils.handle();\n    }\n\n    const styleLink = DocumentUtils.setupPageStyles(config?.page?.printCssUrl);\n\n    return () => {\n      DocumentUtils.removePageStyles(styleLink);\n    };\n  }, [setup, config?.page?.compatibility, config?.page?.printCssUrl]);\n\n  const combinedClassName = [className, config?.page?.preview].filter(Boolean).join(' ');\n\n  return (\n    <ConfigProvider config={config}>\n      <div className={combinedClassName}>\n        {children}\n      </div>\n    </ConfigProvider>\n  );\n};\n\nexport default Pagination;\n","import React, { ReactNode, useContext } from \"react\";\nimport { ConfigContext } from '../config/config-provider'; // Import the ConfigContext\n\ninterface SheetProps {\n  children: ReactNode;\n  className?: string;\n  pageNo: number;\n  showBleed?: boolean;\n  overlay?: (args: {pageNo: number}) => ReactNode;\n}\n\nconst Sheet: React.FC<SheetProps> = ({ children, className = \"\", pageNo, overlay, showBleed }) => {\n  const config = useContext(ConfigContext);\n  const showBleedArea = showBleed ?? config?.page?.showBleed ?? false;\n  return (\n    <div className={`uhuu-page-sheet ${className}`}> \n      {children}\n      {overlay && overlay({pageNo}) }        \n      {showBleedArea && <div className=\"uhuu-bleed-area\"></div>}\n    </div>\n  );\n};\n\nexport default Sheet;","export const getDialogProps = (props, config) => {\n    const dialog = props.dialog;\n\n    if (!dialog) return {};\n    \n    if(config?.page?.paginationType === 'dynamic') return {\n      'data-uhuu': JSON.stringify(dialog)\n    };\n\n    return {\n      onClick: () => window.$uhuu?.editDialog(dialog),\n      'data-uhuu' : ''\n    };\n  };","import { useContext, useState } from \"react\";\nimport { ConfigContext } from '../config/config-provider'; // Import the ConfigContext\nimport { getDialogProps } from '../editable/dialog-props';\nimport './image.css';\n\ninterface ImageBleedProps {  \n  src?: string;\n  backgroundColor?: string;\n  width?: number;\n  left?: number;\n  right?: number;\n  top?: number;\n  bottom?: number;\n  height?: number;\n  pageWidth?: number;\n  pageHeight?: number;\n  bleed?: number;\n  dialog?: object;\n}\n\nconst ImageBleed = (props: ImageBleedProps) => {\n  const config = useContext(ConfigContext);  \n  // Get page dimensions and bleed from props or use defaults (from context if not provided)  \n  const BLEED = props.bleed ?? config?.page?.bleed ?? 0;  \n  const PAGE_CONTENT_WIDTH = (props.pageWidth ?? config?.page?.width ?? 210); \n  const PAGE_CONTENT_HEIGHT = (props.pageHeight ?? config?.page?.height ?? 297); \n\n  const {\n    src,\n    backgroundColor,\n    width: imageW,\n    height: imageH,\n    left: imageL = 0,\n    right: imageR = 0,\n    top: imageT = 0,\n    bottom: imageB = 0,        \n  } = props;\n\n\n  const [coverClass, setCoverClass] = useState(\"h-full w-full object-cover object-center\");\n\n  const unitFormat = (value) => `${value}mm`;\n\n  const calculateImageHeight = (): number => {\n    let result = imageH; \n    if(!imageH) {\n      result =  PAGE_CONTENT_HEIGHT;\n      if(!imageT) result +=  BLEED;\n      if(!imageB) result += BLEED;\n      if(imageT || imageB) result -= (imageT ?? 0) + (imageB ?? 0);\n    }\n    return result;\n  };\n\n  const calculateImageWidth = (): number => {\n\n    let result = imageW; \n    if(!imageW) {\n      result = PAGE_CONTENT_WIDTH;\n      if(!imageL) result += BLEED;\n      if(!imageR) result += BLEED;\n      if(imageL || imageR) result -= (imageL ?? 0) + (imageR ?? 0);\n    }\n    return result;\n  };\n\n\n  const imageWidth = calculateImageWidth();\n  const imageHeight = calculateImageHeight();\n  \n\n  const formatStyleValue = (value: number | undefined): string | undefined => \n    value !== undefined ? unitFormat(value) : undefined;\n\n  const createStyle = (styles: Record<string, string | undefined>) => {\n    return Object.fromEntries(\n      Object.entries(styles).filter(([_, value]) => value !== undefined)\n    );\n  };\n\n  // Replace old style object with new createStyle implementation\n  const style = createStyle({\n    backgroundColor,\n    width: formatStyleValue(imageWidth),\n    height: formatStyleValue(imageHeight),\n    left: formatStyleValue(imageL > 0 ? imageL + BLEED : imageL),\n    right: formatStyleValue(imageR > 0 ? imageR + BLEED : imageR),\n    top: formatStyleValue(imageT > 0 ? imageT + BLEED : imageT),\n    bottom: formatStyleValue(imageB > 0 ? imageB + BLEED : imageB),\n  });\n\n    \n  // calc ratio of image: if imageHeight set to 0 (means it should be \"auto\") then calc using default pageHeight and spacings\n  const ratio = imageHeight > 0 ? imageWidth / imageHeight : \n                                  imageWidth / (PAGE_CONTENT_HEIGHT - (imageT ?? 0) - (imageB ?? 0));\n  \n\n  const imageLoaded = (e) => {\n    // Compare loaded image ratio with container ratio to determine cover mode\n    const imageRatio = e.target.naturalWidth / e.target.naturalHeight; // Use naturalWidth/Height to get actual image dimensions\n\n    // If image is wider relative to container, use vertical cover mode\n    // Otherwise use horizontal cover mode\n    let imageClass = imageRatio > ratio  ? \"cover-vertical\"  : \"cover-horizontal\";    \n    setCoverClass(imageClass);\n  };\n\n  \n\n  return (\n    <div className=\"uhuu-image-container\" style={style}>\n      <div \n        className=\"uhuu-image-inner\" \n        {...getDialogProps(props, config)}\n      >\n        <img \n          className={coverClass} \n          src={src} \n          onLoad={(e) => imageLoaded(e)} \n          key={`${src}-${imageWidth}-${imageHeight}`}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default ImageBleed;","import { useState, useContext } from \"react\";\nimport { ConfigContext } from '../config/config-provider'; // Import the ConfigContext\nimport { getDialogProps } from '../editable/dialog-props';\nimport './image.css';\n\ninterface ImageSpreadProps {  \n  src?: string;\n  side?: \"start\" | \"end\";\n  backgroundColor?: string;\n  width?: number;\n  left?: number;\n  right?: number;\n  top?: number;\n  bottom?: number;\n  height?: number;\n  pageWidth?: number;\n  pageHeight?: number;\n  bleed?: number;\n  editDialog?: object;\n}\n\n// Constants\nexport default function ImageSpread(props: ImageSpreadProps) {\n\n  const config = useContext(ConfigContext);  \n  console.log(\"config\", config);\n  // Get page dimensions and bleed from props or use defaults (from context if not provided)\n  const BLEED = props.bleed ?? config?.page?.bleed ?? 0;  \n  const PAGE_CONTENT_WIDTH = (props.pageWidth ?? config?.page?.width ?? 210);\n  const PAGE_CONTENT_HEIGHT = (props.pageHeight ?? config?.page?.height ?? 297);\n  \n  const {\n    src,\n    side,\n    backgroundColor,\n    width: imageW,\n    height: imageH,\n    left: imageL = 0,\n    right: imageR = 0,\n    top: imageT = 0,\n    bottom: imageB = 0,        \n  } = props;\n\n  const [coverClass, setCoverClass] = useState(\"h-full w-full object-cover object-center\");\n\n\n  const unitFormat = (val: number): string => {\n    return `${val}mm`;\n  };\n\n  const calculateImageWidth = (): number => {\n    let result = imageW; \n    if(!imageW) {\n      result = 2 * PAGE_CONTENT_WIDTH;\n      if(!imageL) result += 2 * BLEED;\n      if(!imageR) result += 2 * BLEED;\n      if(imageL || imageR) result -= (imageL ?? 0) + (imageR ?? 0);\n    }\n    return result;\n  };\n\n  const calculateImageHeight = (): number => {\n    let result = imageH; \n    if(!imageH) {\n      result = PAGE_CONTENT_HEIGHT;\n      if(!imageT) result += BLEED;\n      if(!imageB) result += BLEED;\n      if(imageT || imageB) result -= (imageT ?? 0) + (imageB ?? 0);\n    }\n    return result;\n  };\n\n  // Calculate dimensions  \n  const imageWidth = calculateImageWidth();\n  const imageHeight = calculateImageHeight();  \n  \n\n  const formatStyleValue = (value: number | undefined): string | undefined => \n    value !== undefined ? unitFormat(value) : undefined;\n\n  const createStyle = (styles: Record<string, string | undefined>) => {\n    return Object.fromEntries(\n      Object.entries(styles).filter(([_, value]) => value !== undefined)\n    );\n  };\n\n  // const imageTop = imageT ?? (-1 * BLEED);\n  // const imageBottom = imageB ?? undefined;\n  const imageLeft = imageL > 0 ? imageL : (-1 * BLEED);\n  const rightPageOffset = -1 * PAGE_CONTENT_WIDTH + imageLeft; // Offset of right page\n  \n  const leftStyle = createStyle({\n    backgroundColor,\n    width: formatStyleValue(imageWidth),\n    height: formatStyleValue(imageHeight),\n    left: formatStyleValue(imageLeft),\n    top: formatStyleValue(imageT > 0 ? imageT + BLEED : imageT),\n    bottom: formatStyleValue(imageB > 0 ? imageB + BLEED : imageB)\n  });\n\n  const rightStyle = createStyle({\n    width: formatStyleValue(imageWidth),\n    height: formatStyleValue(imageHeight),\n    left: formatStyleValue(rightPageOffset),\n    top: formatStyleValue(imageT > 0 ? imageT + BLEED : imageT),\n    bottom: formatStyleValue(imageB > 0 ? imageB + BLEED : imageB)\n  });\n\n  // calc ratio of image: if imageHeight set to 0 (means it should be \"auto\") then calc using default pageHeight and spacings\n  const ratio =\n    imageHeight != 0\n      ? imageWidth / imageHeight\n      : imageWidth / (PAGE_CONTENT_HEIGHT - (imageT ?? 0) - (imageB ?? 0));\n\n  const imageLoaded = (e) => {\n    // Compare loaded image ratio with container ratio to determine cover mode\n    const imageRatio = e.target.naturalWidth / e.target.naturalHeight; // Use naturalWidth/Height to get actual image dimensions\n    \n    // If image is wider relative to container, use vertical cover mode\n    // Otherwise use horizontal cover mode\n    let imageClass = imageRatio > ratio  ? \"cover-vertical\"  : \"cover-horizontal\";    \n    setCoverClass(imageClass);\n  };\n\n\n  return <div className={`uhuu-image-container`} style={side == \"end\" ? rightStyle : leftStyle}>\n        <div className=\"uhuu-image-inner\" {...getDialogProps(props, config)}>\n          <img \n            className={coverClass} \n            src={src} \n            onLoad={(e) => imageLoaded(e)}\n            key={`${src}-${imageWidth}-${imageHeight}`} // Force reload when height or width change\n          />\n        </div>\n      </div>\n}\n\n","import { useContext, useState } from \"react\";\nimport { ConfigContext } from '../config/config-provider'; // Import the ConfigContext\nimport { getDialogProps } from './dialog-props';\nimport './../styles/uhuu-indicators.css';\n\n\ninterface EditableProps {    \n  className?: string;\n  dialog?: object;\n  children?: React.ReactNode;\n}\n\nconst Editable = (props: EditableProps) => {\n  const config = useContext(ConfigContext);  \n  // Get page dimensions and bleed from props or use defaults (from context if not provided)  \n  \n  return (    \n      <div \n        className={props.className} \n        {...getDialogProps(props, config)}\n      >\n        {props.children}\n      </div>    \n  );\n};\n\nexport default Editable;","import { useState, forwardRef, useRef, useImperativeHandle, useCallback } from 'react';\nimport { Previewer } from 'pagedjs';\nimport debounce from 'lodash/debounce';\n\nconst PagedComponent = forwardRef(({ children }, ref) => {\n  const [rendering, setRendering] = useState(false);\n  const containerRef = useRef(null);\n  const pageFlowRef = useRef(null);\n\n  if (typeof document === 'undefined') {\n    return null;\n  }\n\n  // Expose layout method to parent via ref\n  useImperativeHandle(ref, () => ({\n    layout: layoutPage,\n  }));\n\n  // Memoize the layoutPage function with debounce\n  const layoutPage = useCallback(\n    debounce(() => {\n      // Ensure container and flow elements are available\n      if (!containerRef.current || !pageFlowRef.current) {\n        console.warn(\"Container or page flow reference is missing.\");\n        return;\n      }\n\n      setRendering(true);\n\n      const { clientHeight: height, clientWidth: width } = containerRef.current;\n\n      // Clear the container before rendering new content\n      containerRef.current.innerHTML = '';\n\n      // Set fixed width and height to avoid layout issues during rendering\n      if (height) containerRef.current.style.minHeight = `${height}px`;\n      if (width && window !== window.parent) containerRef.current.style.minWidth = `${width}px`;\n\n      // Remove previously inserted paged.js styles\n      document.querySelectorAll(\"style[data-pagedjs-inserted-styles]\").forEach((style) => style.remove());\n\n      let pageFileName = \"page.css\"\n      const paged = new Previewer();\n\n      // Wrap in a try-catch to handle errors during preview generation\n      try {\n        paged.preview(pageFlowRef.current.innerHTML, [pageFileName], containerRef.current).then(() => {\n          setRendering(false);\n\n          // revert back container minWidth, minHeight after rendering.\n          containerRef.current.style.minWidth = 'auto';\n          containerRef.current.style.minHeight = 'auto';\n\n          // Attach event listeners for elements with \"data-uhuu\" attribute\n          document.querySelectorAll(\"[data-uhuu]\").forEach((item) => {\n            const clickListener = function () {\n              const value = JSON.parse(this.getAttribute(\"data-uhuu\"));\n              $uhuu.editDialog(value);\n            };\n            // Ensure unique listener attachment\n            item.removeEventListener('click', clickListener);\n            item.addEventListener('click', clickListener);\n          });\n\n          // Apply custom classes based on page-break-after elements\n          document.querySelectorAll(\".page-break-after[data-paged-css]\").forEach((el) => {\n            const pagedSheet = el.closest('div.pagedjs_sheet');\n            const pagedCSS = el.getAttribute('data-paged-css');\n            if (pagedSheet && pagedCSS) {\n              pagedCSS.split(' ').filter(Boolean).forEach((cssClass) => pagedSheet.classList.add(cssClass));\n            }\n          });\n        });\n      } catch (error) {\n        console.error(\"Error during Paged.js preview rendering:\", error);\n        setRendering(false);\n      }\n    }, 500),\n    []\n  );\n\n  return (\n    <div className={rendering ? 'rendering uhuu-page' : 'rendered uhuu-page'}>\n      {/* Container for Paged.js preview */}\n      <div className=\"pagedjs_preview_container\" ref={containerRef}></div>\n\n      {/* Hidden flow container for the content */}\n      <div style={{display:\"none\"}} ref={pageFlowRef}>\n        {children}\n      </div>\n    </div>\n  );\n});\n\nexport default PagedComponent;","// src/index.js\nimport PaginationDynamic from './uhuu/pagination-dynamic/pagination-dynamic';\nimport SheetDynamic from './uhuu/pagination-dynamic/sheet-dynamic';\n\n// Group Dynamic components\nexport const Dynamic = {\n  Pagination: PaginationDynamic,\n  Sheet: SheetDynamic\n};\n\nimport PaginationStatic from './uhuu/pagination-static/pagination-static';\nimport SheetStatic from './uhuu/pagination-static/sheet-static';\n\n// Group Static components\nexport const Static = {\n  Pagination: PaginationStatic,\n  Sheet: SheetStatic\n};\n\nexport { default as ImageBleed } from './uhuu/image/image-bleed';\nexport { default as ImageSpread } from './uhuu/image/image-spread';\nexport { default as Editable } from './uhuu/editable/editable';\n\n\n// backwards compatibility\nexport { default as PagedPreview } from './PagedPreview';\n"],"names":["getBoundingClientRect","element","rect","range","getClientRects","UUID","d","c","attr","attributes","i","querySelectorEscape","value","string","length","index","codeUnit","result","firstCodeUnit","defer","resolve","reject","requestIdleCallback","CSSValueToString","obj","isElement","node","isText","walk","start","limiter","nodeAfter","significantNode","nextSignificantNode","nodeBefore","previousSignificantNode","elementAfter","after","elementBefore","before","displayedElementAfter","displayedElementBefore","rebuildAncestors","parent","ancestor","ancestors","added","fragment","previousRow","previousRowDistance","initialColumns","k","j","column","duplicatedColumn","initialColumn","dataID","td","prev","sib","needsBreakBefore","needsPreviousBreakAfter","needsPageBreak","isIgnorable","previousSignificantNodePage","nodeWithNamedPage","getNodeWithNamedPage","currentNodePage","words","currentText","max","currentOffset","currentLetter","significantWhitespaces","letters","wordRange","isContainer","container","cloneNode","n","deep","findElement","doc","forceQuery","ref","findRef","validNode","prevValidNode","indexOf","child","hasContent","indexOfTextNode","nodeTextContent","isAllWhitespace","breakInsideAvoidParentNode","parentOf","nodeName","filterTree","content","func","what","treeWalker","current","BreakToken","offset","otherBreakToken","hash","RenderResult","breakToken","error","OverflowContentError","message","items","_undefined","is","isValue","require$$0","possibleTypes","isObject","isPrototype","isFunction","classRe","functionToString","isImplemented","assign","noop","val","keys","shim","object","require$$1","validValue","dest","src","key","e","forEach","create","process","normalizeOptions","opts1","options","str","searchString","contains","isPlainFunction","require$$2","normalizeOpts","require$$3","require$$4","dModule","dscr","w","desc","get","set","validCallable","fn","callable","apply","call","defineProperty","defineProperties","hasOwnProperty","descriptor","on","once","off","emit","methods","descriptors","base","type","listener","data","self","listeners","candidate","l","args","module","exports","o","Hook","context","promises","task","executing","results","MAX_CHARS_PER_BREAK","Layout","hooks","gap","leftMargin","wrapper","source","bounds","walker","prevNode","done","next","hasRenderedContent","newBreakToken","prevBreakToken","imgs","named","page","shallow","rendered","newToken","previousNode","parentNode","parentBreakBefore","doubleBreakBefore","rebuild","clone","newNode","img","image","width","height","breakNode","overflow","renderedNode","temp","renderedNodeFromSource","lastChildOfRenderedNodeFromSource","extract","breakLetter","newOverflow","removed","constrainingElement","scrollWidth","scrollHeight","end","vStart","vEnd","skip","breakAvoid","br","pos","left","right","top","bottom","isFloat","insideTableCell","styles","tableRow","table","rowspan","columnCount","cell","previousRowColumnCount","rects","lastChild","lastNodeIndex","original","wordwalker","word","letterwalker","letter","nextLetter","doneLetter","startContainer","extracted","startText","prevLetter","a","b","EventEmitter","Page","pagesArea","pageTemplate","blank","template","pagebox","area","footnotesArea","size","pgnum","id","contents","maxChars","settings","entries","prevHeight","entry","cr","endToken","ContentParser","cb","markup","mime","uuid","Queue","deferred","promise","queued","inwait","TEMPLATE","Chunker","renderTo","parsed","startAt","renderer","force","currentPage","currentPosition","currentSide","previousBreakAfter","breakBefore","tokens","err","fromIndex","lastPage","overflowToken","originalPage","className","fontPromises","fontFace","fontLoaded","r","createItem","allocateCursor","cursor","cursors","releaseCursor","List","prevOld","prevNew","nextOld","nextNew","array","item","initialValue","acc","list","oldItem","newItemOrList","List_1","createCustomError","name","errorStack","MAX_LINE_LENGTH","OFFSET_CORRECTION","TAB_REPLACEMENT","sourceFragment","extraLines","processLines","lines","line","idx","num","maxNumLength","startLine","endLine","cutLeft","SyntaxError","_SyntaxError","TYPE","NAME","_const","EOF","isDigit","code","isHexDigit","isUppercaseLetter","isLowercaseLetter","isLetter","isNonAscii","isNameStart","isName","isNonPrintable","isNewline","isWhiteSpace","isValidEscape","first","second","isIdentifierStart","third","isNumberStart","isBOM","CATEGORY","charCodeCategory","charCodeDefinitions","charCodeDef","getCharCode","getNewlineLength","cmpChar","testStr","referenceCode","cmpStr","referenceStr","testCode","findWhiteSpaceStart","findWhiteSpaceEnd","findDecimalNumberEnd","consumeEscaped","maxOffset","consumeName","consumeNumber","sign","consumeBadUrlRemnants","utils","constants","WHITESPACE","COMMENT","OFFSET_MASK","TYPE_SHIFT","TokenStream","tokenIndex","startToken","mode","balanceEnd","loop","skipTokenCount","tokenCount","TokenStream_1","generateMultiplier","multiplier","generateTypeOpts","generateSequence","decorate","forceBraces","compact","combinator","term","generate","generate_1","defaultLoc","locateMismatch","matchResult","longestMatch","mismatchNode","badNode","mismatchOffset","mismatchLength","css","token","fromLoc","buildLoc","point","extra","loc","SyntaxReferenceError","referenceName","SyntaxMatchError","syntax","keywords","properties","HYPHENMINUS","isCustomProperty","getVendorPrefix","secondDashIndex","getKeywordDescriptor","keyword","custom","vendor","getPropertyDescriptor","property","hack","prefix","names","MIN_SIZE","SafeUint32Array","adoptBuffer","buffer","tokenize","stream","sourceLength","consumeNumericToken","consumeIdentLikeToken","nameStartOffset","consumeUrlToken","consumeStringToken","endingCodePoint","nextCode","offsetAndType","balance","balanceCloseType","balanceStart","balancePrev","tokenizer","DELIM","IDENT","NUMBER","DIMENSION","PLUSSIGN","N","DISALLOW_SIGN","ALLOW_SIGN","isDelim","skipSC","getNextToken","checkInteger","valueOffset","disallowSign","consumeB","offset_","genericAnPlusB","QUESTIONMARK","U","startsWith","hexSequence","allowDash","hexlen","withQuestionMarkSequence","consumed","genericUrange","consumedHexLength","anPlusB","urange","cssWideKeywords","calcFunctionNames","LENGTH","ANGLE","TIME","FREQUENCY","RESOLUTION","FLEX","DECIBEL","SEMITONES","charCode","eqStr","actual","expected","eqStrAny","isPostfixIeHack","outOfRange","opts","numEnd","consumeFunction","startIdx","calc","tokenType","expectedTokenType","customIdent","customPropertyName","hexColor","idSelector","declarationValue","level","scan","anyValue","dimension","numberEnd","reverseSolidusOffset","unit","percentage","zero","number","isNumber","integer","generic","input","TAB","F","R","SPACE","Tokenizer","EXCLAMATIONMARK","NUMBERSIGN","AMPERSAND","APOSTROPHE","LEFTPARENTHESIS","RIGHTPARENTHESIS","ASTERISK","COMMA","HYPERMINUS","LESSTHANSIGN","GREATERTHANSIGN","COMMERCIALAT","LEFTSQUAREBRACKET","RIGHTSQUAREBRACKET","LEFTCURLYBRACKET","VERTICALLINE","RIGHTCURLYBRACKET","INFINITY","NAME_CHAR","createCharMap","ch","COMBINATOR_PRECEDENCE","scanSpaces","scanWord","scanNumber","scanString","readMultiplierRange","min","readMultiplier","comma","maybeMultiplied","maybeToken","readProperty","readTypeRange","readType","readKeywordOrFunction","regroupTerms","terms","combinators","createGroup","subgroupStart","readImplicitGroup","prevToken","prevTokenPos","peek","readGroup","parse","parse_1","ensureFunction","enter","leave","tokenStream","astToTokens","handlers","curNode","nodes","tmp","chunk","prepareTokens","nodesOffset","nodesIndex","currentNode","prepareTokens_1","MATCH","MISMATCH","DISALLOW_EMPTY","createCondition","match","thenBranch","elseBranch","isFunctionType","isEnumCapatible","buildGroupMatchGraph","atLeastOneTermMatched","map","thenClause","newGroupTerm","buildMultiplierMatchGraph","matchTerm","buildMatchGraph","matchGraph","syntaxTree","STUB","TOKEN","OPEN_SYNTAX","CLOSE_SYNTAX","EXIT_REASON_MATCH","EXIT_REASON_MISMATCH","EXIT_REASON_ITERATION_LIMIT","ITERATION_LIMIT","totalIterationCount","reverseList","areStringsEqualCaseInsensitive","isContextEdgeDelim","isCommaContextStart","isCommaContextEnd","internalMatch","state","syntaxes","moveToNextToken","nextIndex","stateSnapshotFromSyntax","nextState","matchStack","syntaxStack","thenStack","pushThenStack","pushElseStack","elseStack","addTokenToMatch","syntaxStash","openSyntax","closeSyntax","iterationCount","exitReason","matchFlag","lastTokenIndex","syntaxDict","dictSyntax","lowPriorityMatching","keywordName","matchAsList","matchAsTree","host","hostStack","getTrace","shouldPutToTrace","hasMatch","matchNode","testNode","trace","isType","isProperty","isKeyword","getFirstMatchNode","getLastMatchNode","matchFragments","lexer","ast","findFragments","fragments","search","isValidNumber","isValidLocation","createNodeStructureChecker","fields","warn","valid","fieldType","processStructure","nodeType","structure","docs","docsTypes","fieldTypes","config","require$$5","require$$6","require$$7","require$$8","require$$9","require$$10","getStructureFromConfig","require$$11","cssWideKeywordsWithExpression","dumpMapSyntax","syntaxAsAst","dumpAtruleMapSyntax","atrule","valueHasVar","buildMatchResult","iterations","matchSyntax","useCommon","Lexer","collectWarning","warns","res","descName","atruleName","prelude","descriptorName","propertyName","typeName","typeSyntax","declaration","fallbackBasename","atruleEntry","propertyEntry","validate","broken","brokenMap","brokenTypes","brokenProperties","pretty","Lexer_1","definitionSyntax","computeLinesAndColumns","columns","startOffset","OffsetToLocation","startColumn","filename","OffsetToLocation_1","sequence","recognizer","children","FUNCTION","URL","HASH","PERCENTAGE","NULL","createParseContext","processConfig","parserConfig","pseudo","parser","consumer","fallback","fallbackNode","head","tail","location","onComment","intToCharMap","base64","bigA","bigZ","littleA","littleZ","nine","plus","slash","littleOffset","numberOffset","VLQ_BASE_SHIFT","VLQ_BASE","VLQ_BASE_MASK","VLQ_CONTINUATION_BIT","toVLQSigned","aValue","fromVLQSigned","isNegative","shifted","base64Vlq","encoded","digit","vlq","aStr","aIndex","aOutParam","strLen","shift","continuation","getArg","aArgs","aName","aDefaultValue","urlRegexp","dataUrlRegexp","urlParse","aUrl","urlGenerate","aParsedUrl","url","normalize","aPath","path","isAbsolute","parts","part","up","join","aRoot","aPathUrl","aRootUrl","joined","relative","supportsNullProto","identity","s","toSetString","isProtoString","fromSetString","compareByOriginalPositions","mappingA","mappingB","onlyCompareOriginal","cmp","strcmp","compareByGeneratedPositionsDeflated","onlyCompareGenerated","aStr1","aStr2","compareByGeneratedPositionsInflated","parseSourceMapInput","computeSourceURL","sourceRoot","sourceURL","sourceMapURL","util","has","hasNativeMap","ArraySet","aArray","aAllowDuplicates","len","sStr","isDuplicate","aIdx","arraySet","generatedPositionAfter","lineA","lineB","columnA","columnB","MappingList","aCallback","aThisArg","aMapping","mappingList","base64VLQ","SourceMapGenerator","aSourceMapConsumer","generator","mapping","newMapping","sourceFile","sourceRelative","generated","aSourceFile","aSourceContent","aSourceMapPath","newSources","newNames","aGenerated","aOriginal","aSource","previousGeneratedColumn","previousGeneratedLine","previousOriginalColumn","previousOriginalLine","previousName","previousSource","nameIdx","sourceIdx","mappings","aSources","aSourceRoot","sourceMapGenerator","trackNodes","sourceMap","sourceMappingActive","activatedGenerated","activatedMapping","handlersNode","nodeLine","nodeColumn","handlersChunk","handlersResult","processChildren","delimeter","processNode","types","invokeForType","getWalkersFromStructure","walkers","getTypesFromConfig","createTypeIterator","reverse","contextName","useContext","walkReducer","prevContextValue","field","breakWalk","createFastTraveralMap","iterators","iteratorsNatural","iteratorsReverse","skipNode","fastTraversalIteratorsNatural","fastTraversalIteratorsReverse","root","walkNode","enterRet","ret","found","shape","appendOrAssign","appendOrAssignOrNull","deepAssign","copy","append","mix","innerShape","mix_1","createParser","createGenerator","createConvertor","createWalker","require$$12","createSyntax","convert","extension","mdnAtrules","mdnProperties","mdnSyntaxes","patch","extendSyntax","preprocessAtrules","dict","patchDictionary","patchDict","unpackSyntaxes","patchAtrules","patchDescriptors","checkTokenIsInteger","expectCharCode","msg","AnPlusB","WhiteSpace","Semicolon","LeftCurlyBracket","Delim","getOffsetExcludeWS","leftCurlyBracket","leftCurlyBracketOrSemicolon","exclamationMarkOrSemicolon","semicolonIncluded","Raw","excludeWhiteSpace","endOffset","rawMode","ATKEYWORD","SEMICOLON","consumeRaw","isDeclarationBlockAtrule","Atrule","nameLowerCase","block","AtrulePrelude","STRING","COLON","DOLLARSIGN","EQUALSSIGN","CIRCUMFLEXACCENT","TILDE","getAttributeName","expectIdent","checkColon","getOperator","AttributeSelector","matcher","flags","flagsPrefix","consumeRule","consumeRawDeclaration","consumeDeclaration","Block","isDeclaration","Brackets","readSequence","CDC","CDC_1","CDO","CDO_1","FULLSTOP","ClassSelector","SOLIDUS","Combinator","Comment","consumeValueRaw","consumeCustomPropertyRaw","consumeValue","startValueToken","Declaration","customProperty","parseValue","important","valueStart","getImportant","DeclarationList","Dimension","_Function","Hash","Identifier","IdSelector","MediaFeature","MediaQuery","space","MediaQueryList","Nth","allowOfClause","selector","query","_Number","Operator","Parentheses","Percentage","PseudoClassSelector","PseudoElementSelector","Ratio","consumePrelude","Rule","Selector","SelectorList","_String","StyleSheet","eatIdentifierOrAsterisk","TypeSelector","eatHexSequence","eatQuestionMarkSequence","count","scanUnicodeRange","hexLength","UnicodeRange","Url","rawStart","rawEnd","Value","require$$13","require$$14","require$$15","require$$16","require$$17","require$$18","require$$19","require$$20","require$$21","require$$22","require$$23","require$$24","require$$25","require$$26","require$$27","require$$28","require$$29","require$$30","require$$31","require$$32","require$$33","require$$34","require$$35","require$$36","require$$37","require$$38","require$$39","_default","atrulePrelude","getNode","expression","_var","startIndex","scope","_import","media","parentheses","supports","dir","lang","selectorList","matches","not","ALLOW_OF_CLAUSE","nthWithOfClause","nthChild","nthLastChild","DISALLOW_OF_CLAUSE","nth","nthLastOfType","nthOfType","slotted","merge","syntaxModule","lib","Sheet$2","text","csstree","rule","inserted","basename","ruleNode","ruleItem","rulelist","declarationNode","dItem","dList","funcNode","fItem","fList","selectNode","selectItem","selectList","pseudoNode","pItem","pList","href","namedPageSelectors","idNode","idItem","idList","queries","mqNode","mqItem","mqList","identNode","identItem","identList","q","urlNode","urlItem","urlList","t","baseStyles","request","status","Polisher","setup","fetched","urls","f","response","originals","cssStr","sheet","Sheet","style","Handler","chunker","polisher","caller","pageSizes","AtPage","marginalia","psuedo","needsMerge","notes","declarations","dirtyPage","format","orientation","bleed","marks","bleedverso","bleedrecto","MARGINS","prop","ident","m","p","subNode","margins","margin","paddings","padding","border","pages","pg","ruleList","selectors","mVar","pVar","borderItem","widthString","heightString","wVar","hVar","identlist","marginSelectors","marginRule","sel","displayNone","displaySelectors","displayDeclaration","displayRule","contentSelectors","contentRule","rules","widthStringRight","heightStringRight","widthStringLeft","heightStringLeft","bleedTop","bleedRight","bleedBottom","bleedLeft","bleedTopRecto","bleedRightRecto","bleedBottomRecto","bleedLeftRecto","bleedTopVerso","bleedRightVerso","bleedBottomVerso","bleedLeftVerso","pageWidthVar","pageHeightVar","mark","markDisplay","oVar","wVarR","hVarR","wVarL","hVarL","note","notesRule","childrenLeft","childrenRight","dimensions","dimensionsLeft","dimensionsRight","widthCalculations","heightCalculations","widthCalculationsLeft","heightCalculationsLeft","ruleLeft","widthCalculationsRight","heightCalculationsRight","ruleRight","splitN","splitP","namedPages","sels","marginGroup","center","centerContent","leftContent","rightContent","centerWidth","leftWidth","rightWidth","leftOuterWidth","centerOuterWidth","rightOuterWidth","outerwidths","newcenterWidth","newLeftWidth","middle","topContent","bottomContent","middleHeight","topHeight","bottomHeight","nthlist","operator","calculations","cssValue","Breaks","breaker","breaks","elements","pageBreaks","newBreaks","pageElement","PrintMedia","iItem","iList","Splits","splits","prevPage","from","split","align","alignLast","Counters","hasProperities","increments","whitespace","counter","increment","reset","counters","countersArray","inc","incrementElements","resetElements","counterName","resetValue","incrementValue","resetDelta","incrementArray","markers","counterIncrement","values","resets","Lists","orderedLists","PositionFixed","fixedEl","el","PageCounterIncrement","_","identifier","NthOfType","dataNthOfType","Following","dataFollowing","Footnotes","policy","display","newPrelude","prevElement","currentNote","pageArea","needsNoteCall","noteArea","noteContent","noteInnerContent","noteCall","noteCallBounds","noteAreaBounds","noteContentMargins","noteContentPadding","noteContentBorders","total","notAreaTop","notePolicy","noteCallPosition","noteCallOffset","prevSibling","rangeBounds","parentParagraph","contentDelta","noteDelta","notePolicyDelta","hasNotes","wrapperDiv","parentElement","footnoteCall","noteContentBounds","startIsNode","splitChild","noteInnerContentBounds","marginTop","marginBottom","paddingTop","paddingBottom","borderTop","borderBottom","borders","pagedMediaHandlers","RunningHeaders","selected","header","running","weight","weighted","orderedSelectors","cleanPseudoContent","trim","cleanSelector","StringSets","identifiers","functions","subchild","stringPrevPage","varFirst","varLast","varStart","varFirstExcept","selTop","pageContentTop","TargetCounters","styleIdentifier","variable","target","TargetText","last","queried","textContent","pseudoType","generatedContentHandlers","WhiteSpaceFilter","previousSibling","nextSibling","CommentsFilter","ScriptsFilter","script","attributeRegex","idRegex","classRegex","pseudoElementRegex","pseudoClassRegex","elementRegex","notRegex","ruleRegex","separatorRegex","straysRegex","findMatch","regex","calculate","commaIndex","specificityCache","specificity","validSelectorCache","testSelectorElement","UndisplayedFilter","calculateSpecificity","displayValue","styledElements","displayRules","displayItem","filters","arr","naiveFallback","implementation","globalThis_1","global","validTypes","Symbol","symbol","isSymbol","validateSymbol","objPrototype","created","generateName","postfix","ie11BugWorkaround","NativeSymbol","standardSymbols","SymbolPolyfill","registry","symbolRegistry","setupStandardSymbols","setupSymbolRegistry","HiddenSymbol","isNativeSafe","description","polyfill","es6Symbol","objToString","isArguments","isFunctionStringTag","abs","floor","toInteger","toPosInteger","isString","iteratorSymbol","toPosInt","isArray","arrayLike","mapFn","thisArg","Context","iterator","getIterator","numberIsNaN","isNan","objHasOwnProperty","eIndexOf","searchElement","splice","remove","itemToRemove","validObject","aFrom","getOwnPropertyDescriptor","pipe","e1","e2","pipes","emitter","registeredHandlers","Handlers","handler","registerHandlers","initializeHandlers","Previewer","param","params","pair","body","stylesheets","inlineStyles","element1","element2","position","startTime","flow","endTime","isObject_1","freeGlobal","_freeGlobal","freeSelf","_root","now","now_1","reWhitespace","trimmedEndIndex","_trimmedEndIndex","reTrimStart","baseTrim","_baseTrim","_Symbol","objectProto","nativeObjectToString","symToStringTag","getRawTag","isOwn","tag","unmasked","_getRawTag","objectToString","_objectToString","nullTag","undefinedTag","baseGetTag","_baseGetTag","isObjectLike","isObjectLike_1","symbolTag","isSymbol_1","NAN","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","toNumber","other","isBinary","toNumber_1","FUNC_ERROR_TEXT","nativeMax","nativeMin","debounce","wait","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","invokeFunc","time","leadingEdge","timerExpired","remainingWait","timeSinceLastCall","timeSinceLastInvoke","timeWaiting","shouldInvoke","trailingEdge","cancel","flush","debounced","isInvoking","debounce_1","DocumentUtils$1","clickListener","pagedSheet","pagedCSS","cssClass","fileName","blob","PageSizeUtils","mm","dpi","paginationType","showBleed","compatibility","printCssRaw","printCssUrl","preview","ConfigContext","createContext","ConfigProvider","Pagination","rendering","setRendering","useState","containerRef","useRef","contentRef","documentUtilsRef","DocumentUtils","pageRuleRegex","sizeAndBleedStyles","existingStyles","newPageRule","layoutPage","paged","styleUrls","useEffect","jsxs","jsx","Compatibility","link","CompatibilityUtils","styleLink","combinedClassName","pageNo","overlay","showBleedArea","getDialogProps","props","dialog","ImageBleed","BLEED","PAGE_CONTENT_WIDTH","PAGE_CONTENT_HEIGHT","backgroundColor","imageW","imageH","imageL","imageR","imageT","imageB","coverClass","setCoverClass","unitFormat","calculateImageHeight","imageWidth","imageHeight","formatStyleValue","ratio","imageLoaded","imageClass","ImageSpread","side","calculateImageWidth","createStyle","imageLeft","rightPageOffset","leftStyle","rightStyle","Editable","PagedComponent","forwardRef","pageFlowRef","useImperativeHandle","useCallback","pageFileName","Dynamic","PaginationDynamic","SheetDynamic","Static","PaginationStatic","SheetStatic"],"mappings":"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;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GC5EM0P,KAAal1B,IACbm1B,KAAgBr0B,IAChBs0B,KAActzB,IACduzB,KAAQrzB,IACRszB,KAAe;AAErB,SAASC,GAAkBC,GAAM;AAC7B,QAAM37B,IAAS,uBAAO,OAAO,IAAI;AAEjC,aAAWmtB,KAAcwO,GAAM;AAC3B,UAAMnP,IAASmP,EAAKxO,CAAU;AAC9B,QAAI1jB,IAAc;AAElB,QAAI+iB,EAAO,aAAa;AACpB,MAAA/iB,IAAc,uBAAO,OAAO,IAAI;AAEhC,iBAAWN,KAAcqjB,EAAO;AAC5B,QAAA/iB,EAAYN,CAAU,IAAIqjB,EAAO,YAAYrjB,CAAU,EAAE;AAAA,IAEzE;AAEQ,IAAAnJ,EAAOmtB,EAAW,OAAO,CAAC,CAAC,IAAI;AAAA,MAC3B,SAASX,EAAO,OAAO,OAAO,MAAM,mBAAmB,EAAE,CAAC,EAAE,KAAI,KAAM;AAAA,MACtE,aAAA/iB;AAAA,IACH;AAAA,EACT;AAEI,SAAOzJ;AACX;AAEA,SAAS47B,GAAgBD,GAAME,GAAW;AACtC,QAAM77B,IAAS,CAAE;AAGjB,aAAWqH,KAAOs0B;AACd,IAAA37B,EAAOqH,CAAG,IAAIs0B,EAAKt0B,CAAG,EAAE,UAAUs0B,EAAKt0B,CAAG;AAI9C,aAAWA,KAAOw0B;AACd,IAAIx0B,KAAOs0B,IACHE,EAAUx0B,CAAG,EAAE,SACfrH,EAAOqH,CAAG,IAAIo0B,GAAa,KAAKI,EAAUx0B,CAAG,EAAE,MAAM,IAC/CrH,EAAOqH,CAAG,IAAI,MAAMw0B,EAAUx0B,CAAG,EAAE,OAAO,KAAI,IAC9Cw0B,EAAUx0B,CAAG,EAAE,SAErB,OAAOrH,EAAOqH,CAAG,IAGjBw0B,EAAUx0B,CAAG,EAAE,WACfrH,EAAOqH,CAAG,IAAIw0B,EAAUx0B,CAAG,EAAE,OAAO,QAAQo0B,IAAc,EAAE;AAKxE,SAAOz7B;AACX;AAEA,SAAS87B,GAAeH,GAAM;AAC1B,QAAM37B,IAAS,CAAE;AAEjB,aAAWqH,KAAOs0B;AACd,IAAA37B,EAAOqH,CAAG,IAAIs0B,EAAKt0B,CAAG,EAAE;AAG5B,SAAOrH;AACX;AAEA,SAAS+7B,GAAaJ,GAAME,GAAW;AACnC,QAAM77B,IAAS,CAAE;AAGjB,aAAWqH,KAAOs0B,GAAM;AACpB,UAAMK,IAAoBH,EAAUx0B,CAAG,KAAKw0B,EAAUx0B,CAAG,EAAE,eAAgB;AAE3E,IAAArH,EAAOqH,CAAG,IAAI;AAAA,MACV,SAASA,KAAOw0B,KAAa,aAAaA,EAAUx0B,CAAG,IACjDw0B,EAAUx0B,CAAG,EAAE,UACfs0B,EAAKt0B,CAAG,EAAE,WAAW;AAAA,MAC3B,aAAas0B,EAAKt0B,CAAG,EAAE,cACjBu0B,GAAgBD,EAAKt0B,CAAG,EAAE,aAAa20B,KAAoB,CAAE,CAAA,IAC7DA,KAAoBF,GAAeE,CAAgB;AAAA,IAC5D;AAAA,EACT;AAGI,aAAW30B,KAAOw0B;AACd,IAAK,eAAe,KAAKF,GAAMt0B,CAAG,MAC9BrH,EAAOqH,CAAG,IAAI;AAAA,MACV,SAASw0B,EAAUx0B,CAAG,EAAE,WAAW;AAAA,MACnC,aAAaw0B,EAAUx0B,CAAG,EAAE,eAAey0B,GAAeD,EAAUx0B,CAAG,EAAE,WAAW;AAAA,IACvF;AAIT,SAAOrH;AACX;AAEA,IAAA6J,KAAiB;AAAA,EACb,OAAO+xB,GAAgBL,IAAaC,GAAM,QAAQ;AAAA,EAClD,SAASO,GAAaL,GAAkBL,EAAU,GAAGG,GAAM,OAAO;AAAA,EAClE,YAAYI,GAAgBN,IAAeE,GAAM,UAAU;AAC/D,GCtGIpkB,KAAUjR,EAA2B,SACrCwP,KAAUxP,EAA2B,SACrCoP,KAAOpP,EAA2B,MAElCkS,KAAa9C,GAAK,YAClB+C,KAAU/C,GAAK,SACf6H,KAAQ7H,GAAK,OACb8H,KAAS9H,GAAK,QACd+H,KAAY/H,GAAK,WACjBgI,KAAW,IACXrC,IAAc,IACdsC,KAAI,KACJC,KAAgB,IAChBC,KAAa;AAEjB,SAASI,GAAavY,GAAQyY,GAAc;AACxC,MAAIjQ,IAAM,KAAK,QAAQ,aAAaxI,GAChCqQ,IAAO,KAAK,QAAQ,OAAO,WAAW7H,CAAG;AAS7C,QAPI6H,MAAS2H,MAAY3H,MAASsF,OAC1B8C,KACA,KAAK,MAAM,4BAA4B,GAE3CjQ,MAGGA,IAAM,KAAK,QAAQ,UAAUA;AAChC,IAAK4H,GAAQ,KAAK,QAAQ,OAAO,WAAW5H,CAAG,CAAC,KAC5C,KAAK,MAAM,uBAAuBA,CAAG;AAGjD;AAEA,SAASkuB,GAAoBje,GAAc;AACvC,SAAOF,GAAa,KAAK,MAAM,GAAGE,CAAY;AAClD;AAEA,SAASke,GAAe32B,GAAQqQ,GAAM;AAClC,MAAI,CAACwB,GAAQ,KAAK,QAAQ,QAAQ,KAAK,QAAQ,aAAa7R,GAAQqQ,CAAI,GAAG;AACvE,QAAIumB,IAAM;AAEV,YAAQvmB,GAAI;AAAA,MACR,KAAK4H;AACD,QAAA2e,IAAM;AACN;AAAA,MACJ,KAAKjhB;AACD,QAAAihB,IAAM;AACN;AAAA,IAChB;AAEQ,SAAK,MAAMA,GAAK,KAAK,QAAQ,aAAa52B,CAAM;AAAA,EACxD;AACA;AAIA,SAAS0Y,KAAW;AAKhB,WAJI1Y,IAAS,GACT0S,IAAO,GACPtO,IAAO,KAAK,QAAQ,WAEjBA,MAAS0O,MAAc1O,MAAS2O;AACnC,IAAA3O,IAAO,KAAK,QAAQ,WAAW,EAAEpE,CAAM;AAG3C,MAAIoE,MAAS0T;AACT,QAAI,KAAK,QAAQ,QAAQE,IAAUhY,CAAM,KACrC,KAAK,QAAQ,QAAQ2V,GAAa3V,CAAM,GAAG;AAC3C,MAAA0S,IAAO,KAAK,QAAQ,QAAQsF,IAAUhY,CAAM,IAAIgY,KAAWrC;AAE3D;AACI,QAAAvR,IAAO,KAAK,QAAQ,WAAW,EAAEpE,CAAM;AAAA,aAClCoE,MAAS0O,MAAc1O,MAAS2O;AAEzC,MAAI3O,MAAS0T,OACT,KAAK,QAAQ,KAAK9X,CAAM,GACxB02B,GAAoB,KAAK,MAAMxe,EAAa;AAAA,IAE5D;AACY,aAAO;AAIf,SAAIlY,IAAS,KACT,KAAK,QAAQ,KAAKA,CAAM,GAGxB0S,MAAS,MACTtO,IAAO,KAAK,QAAQ,OAAO,WAAW,KAAK,QAAQ,UAAU,GACzDA,MAAS4T,MAAY5T,MAASuR,KAC9B,KAAK,MAAM,yBAAyB,IAI5C+gB,GAAoB,KAAK,MAAMhkB,MAAS,CAAC,GAClCA,MAASiD,IAAc,MAAM,KAAK,QAAQmC,EAAM,IAAI,KAAK,QAAQA,EAAM;AAClF;AAGA,IAAA+e,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,GAAG,CAAC,QAAQ,IAAI;AAAA,IAChB,GAAG,CAAC,QAAQ,IAAI;AAAA,EACnB;AAAA,EACD,OAAO,WAAW;AAEd,QAAIx7B,IAAQ,KAAK,QAAQ,YACrB+O,IAAI,MACJC,IAAI;AAGR,QAAI,KAAK,QAAQ,cAAcyN;AAC3B,MAAA4e,GAAoB,KAAK,MAAMve,EAAU,GACzC9N,IAAI,KAAK,QAAQyN,EAAM;AAAA,aAQlB,KAAK,QAAQ,cAAcD,MAAShG,GAAQ,KAAK,QAAQ,QAAQ,KAAK,QAAQ,YAAY8D,CAAW;AAK1G,cAJAvL,IAAI,MAEJusB,GAAe,KAAK,MAAM,GAAG1e,EAAC,GAEtB,KAAK,QAAQ,eAAgB,GAAA;AAAA,QAIjC,KAAK;AACD,eAAK,QAAQ,KAAM,GACnB5N,IAAIqO,GAAS,KAAK,IAAI;AACtB;AAAA,QAGJ,KAAK;AACD,UAAAie,GAAe,KAAK,MAAM,GAAGhhB,CAAW,GAExC,KAAK,QAAQ,KAAM,GACnB,KAAK,QAAQ,OAAQ,GAErB+gB,GAAoB,KAAK,MAAMxe,EAAa,GAE5C7N,IAAI,MAAM,KAAK,QAAQyN,EAAM;AAC7B;AAAA,QAGJ;AACI,UAAA6e,GAAe,KAAK,MAAM,GAAGhhB,CAAW,GACxC4C,GAAa,KAAK,MAAM,GAAGL,EAAa,GACxC,KAAK,QAAQ,KAAM,GAEnB7N,IAAI,KAAK,QAAQ,eAAehP,IAAQ,CAAC;AAAA,MAC7D;AAAA,aAQiB,KAAK,QAAQ,cAAcwc,MAAU,KAAK,QAAQ,QAAQG,EAAQ,KAAK,KAAK,QAAQ,WAAW,CAAC,MAAMH,IAAQ;AACnH,UAAInF,IAAO;AAWX,cAVAtI,IAAI,KAGA,KAAK,QAAQ,QAAQ4N,EAAQ,MAC7BtF,IAAO,GACP,KAAK,QAAQ,KAAM,IAGvBikB,GAAe,KAAK,MAAM,GAAG1e,EAAC,GAEtB,KAAK,QAAQ,eAAgB,GAAA;AAAA,QAIjC,KAAK;AACD,eAAK,QAAQ,KAAM,GACnB5N,IAAIqO,GAAS,KAAK,IAAI;AACtB;AAAA,QAGJ,KAAK;AACD,UAAAie,GAAe,KAAK,MAAM,GAAGhhB,CAAW,GAExC,KAAK,QAAQ,KAAM,GACnB,KAAK,QAAQ,OAAQ,GAErB+gB,GAAoB,KAAK,MAAMxe,EAAa,GAE5C7N,IAAI,MAAM,KAAK,QAAQyN,EAAM;AAC7B;AAAA,QAGJ;AACI,UAAA6e,GAAe,KAAK,MAAM,GAAGhhB,CAAW,GACxC4C,GAAa,KAAK,MAAM,GAAGL,EAAa,GACxC,KAAK,QAAQ,KAAM,GAEnB7N,IAAI,KAAK,QAAQ,eAAehP,IAAQqX,IAAO,CAAC;AAAA,MACpE;AAAA,IACA,WAOiB,KAAK,QAAQ,cAAcqF,IAAW;AAI3C,eAHI1H,IAAO,KAAK,QAAQ,OAAO,WAAW,KAAK,QAAQ,UAAU,GAC7DqC,IAAOrC,MAAS2H,MAAY3H,MAASsF,GAEhC,IAAI,KAAK,QAAQ,aAAajD,GAAM,IAAI,KAAK,QAAQ,YACrDtC,GAAQ,KAAK,QAAQ,OAAO,WAAW,CAAC,CAAC,GADsB;AACpE;AAKJ,MAAI,MAAM,KAAK,QAAQ,aAAasC,KAChC,KAAK,MAAM,uBAAuB,KAAK,QAAQ,aAAaA,CAAI,GAGpEikB,GAAe,KAAK,MAAM,IAAI,KAAK,QAAQ,YAAY1e,EAAC,GACxD7N,IAAI,KAAK,QAAQ,OAAO,UAAU/O,GAAO,CAAC,GAKtC,IAAI,MAAM,KAAK,QAAQ,YACvB,KAAK,QAAQ,KAAM,GACnBgP,IAAIqO,GAAS,KAAK,IAAI,MAEtBie,GAAe,KAAK,MAAM,IAAI,KAAK,QAAQ,aAAa,GAAGhhB,CAAW,GAGlE,IAAI,MAAM,KAAK,QAAQ,YACvB,KAAK,QAAQ,KAAM,GACnB,KAAK,QAAQ,OAAQ,GACrB+gB,GAAoB,KAAK,MAAMxe,EAAa,GAC5C7N,IAAI,MAAM,KAAK,QAAQyN,EAAM,MAI7BS,GAAa,KAAK,MAAM,IAAI,KAAK,QAAQ,aAAa,GAAGL,EAAa,GACtE,KAAK,QAAQ,KAAM,GACnB7N,IAAI,KAAK,QAAQ,eAAe,IAAI,CAAC;AAAA,IAGzD;AACY,WAAK,MAAO;AAGhB,WAAID,MAAM,QAAQA,EAAE,WAAW,CAAC,MAAM4N,OAClC5N,IAAIA,EAAE,OAAO,CAAC,IAGdC,MAAM,QAAQA,EAAE,WAAW,CAAC,MAAM2N,OAClC3N,IAAIA,EAAE,OAAO,CAAC,IAGX;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAYhP,GAAO,KAAK,QAAQ,UAAU;AAAA,MACpD,GAAG+O;AAAA,MACH,GAAGC;AAAA,IACN;AAAA,EACJ;AAAA,EACD,UAAU,SAASnP,GAAM;AACrB,QAAIkP,IAAIlP,EAAK,MAAM,QAAQA,EAAK,MAAM,QAClCmP,IAAInP,EAAK,MAAM,QAAQA,EAAK,MAAM;AAEtC,IAAIkP,KACA,KAAK;AAAA,MACDlP,EAAK,MAAM,OAAO;AAAA;AAAA,QAClBA,EAAK,MAAO,MAAO;AAAA;AAAA,UACnBA,EAAK,MAAM,OAAO;AAAA;AAAA,YAClBA,EAAK,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA,IACZ,GAEGmP,MACAA,IAAI,OAAOnP,EAAK,CAAC,GACbmP,EAAE,OAAO,CAAC,MAAM,OAAOA,EAAE,OAAO,CAAC,MAAM,OACvC,KAAK,MAAMA,EAAE,OAAO,CAAC,CAAC,GACtB,KAAK,MAAMA,EAAE,OAAO,CAAC,CAAC,MAEtB,KAAK,MAAM,GAAG,GACd,KAAK,MAAMA,CAAC,OAIpB,KAAK,MAAM,OAAOnP,EAAK,CAAC,CAAC;AAAA,EAErC;AACA,GCxSIyc,KAAY/W,GACZoP,KAAO2H,GAAU,MAEjBmf,KAAa9mB,GAAK,YAClB+mB,KAAY/mB,GAAK,WACjBgnB,KAAmBhnB,GAAK,kBACxBinB,KAAQjnB,GAAK,OACbyM,KAAkB;AAEtB,SAASya,KAAqB;AAC1B,SAAI,KAAK,QAAQ,aAAa,KACtB,KAAK,QAAQ,WAAW,EAAE,MAAMJ,KACzB,KAAK,QAAQ,aAAa,IAC3B,KAAK,QAAQ,cAAc,KAAK,QAAQ,aAAa,CAAC,IACtD,KAAK,QAAQ,kBAIpB,KAAK,QAAQ;AACxB;AAGA,SAASxjB,KAAa;AAClB,SAAO;AACX;AAGA,SAAS6jB,GAAiBpc,GAAW;AACjC,SAAOA,MAAcic,KAAmB,IAAI;AAChD;AAGA,SAASI,GAA4Brc,GAAW;AAC5C,SAAOA,MAAcic,MAAoBjc,MAAcgc,KAAY,IAAI;AAC3E;AAGA,SAASM,GAA2Btc,GAAWpV,GAAQ3F,GAAQ;AAC3D,SAAI+a,MAAckc,MAAStxB,EAAO,WAAW3F,CAAM,MAAMyc,MAIlD1B,MAAcgc,KAHV,IAG0B;AACzC;AAGA,SAASO,GAAkBvc,GAAW;AAClC,SAAOA,MAAcgc,KAAY,IAAI;AACzC;AAEA,IAAAQ,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,OAAO;AAAA,EACV;AAAA,EACD,OAAO,SAASnkB,GAAYC,GAAMmkB,GAAmB;AACjD,QAAIxO,IAAc,KAAK,QAAQ,cAAc5V,CAAU,GACnDqkB;AAEJ,gBAAK,QAAQ;AAAA,MACT,KAAK,QAAQ,aAAarkB,GAAYC,KAAQC,EAAU;AAAA,IAC3D,GAEGkkB,KAAqB,KAAK,QAAQ,aAAaxO,IAC/CyO,IAAYP,GAAmB,KAAK,IAAI,IAExCO,IAAY,KAAK,QAAQ,YAGtB;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAYzO,GAAayO,CAAS;AAAA,MAC5C,OAAO,KAAK,QAAQ,OAAO,UAAUzO,GAAayO,CAAS;AAAA,IAC9D;AAAA,EACJ;AAAA,EACD,UAAU,SAASv8B,GAAM;AACrB,SAAK,MAAMA,EAAK,KAAK;AAAA,EACxB;AAAA,EAED,MAAM;AAAA,IACF,SAASoY;AAAA,IACT,kBAAkB6jB;AAAA,IAClB,6BAA6BC;AAAA,IAC7B,4BAA4BC;AAAA,IAC5B,mBAAmBC;AAAA,EAC3B;AACA,GCtFItnB,KAAOpP,EAA2B,MAClC82B,KAAUh2B,GAAiB,MAE3Bi2B,KAAY3nB,GAAK,WACjB4nB,KAAY5nB,GAAK,WACjBuN,KAAmBvN,GAAK,kBACxByN,KAAoBzN,GAAK;AAE7B,SAAS6nB,GAAWzkB,GAAY;AAC5B,SAAO,KAAK,IAAIA,GAAYskB,GAAQ,6BAA6B,EAAI;AACzE;AAEA,SAASI,KAA2B;AAChC,WAAS93B,IAAS,GAAGoE,GAAMA,IAAO,KAAK,QAAQ,WAAWpE,CAAM,GAAGA,KAAU;AACzE,QAAIoE,MAASqZ;AACT,aAAO;AAGX,QAAIrZ,MAASmZ,MACTnZ,MAASuzB;AACT,aAAO;AAAA,EAEnB;AAEI,SAAO;AACX;AAEA,IAAAI,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,MAAM;AAAA,IACN,SAAS,CAAC,iBAAiB,OAAO,IAAI;AAAA,IACtC,OAAO,CAAC,SAAS,IAAI;AAAA,EACxB;AAAA,EACD,OAAO,WAAW;AACd,QAAI18B,IAAQ,KAAK,QAAQ,YACrByT,GACAkpB,GACAnQ,IAAU,MACVoQ,IAAQ;AA0BZ,YAxBA,KAAK,IAAIN,EAAS,GAElB7oB,IAAO,KAAK,QAAQ,eAAezT,IAAQ,CAAC,GAC5C28B,IAAgBlpB,EAAK,YAAa,GAClC,KAAK,QAAQ,OAAQ,GAGjB,KAAK,QAAQ,QAAQ,MACrB,KAAK,QAAQ,cAAcyO,MAC3B,KAAK,QAAQ,cAAcqa,OACvB,KAAK,sBACL/P,IAAU,KAAK,kBAAkB,KAAK,cAAc,KAAK,MAAM/Y,CAAI,GAAG+oB,EAAU,GAG5EhQ,EAAQ,SAAS,mBAAmBA,EAAQ,SAAS,SAAS,SAC9DA,IAAU,SAGdA,IAAUgQ,GAAW,KAAK,MAAM,KAAK,QAAQ,UAAU,GAG3D,KAAK,QAAQ,OAAQ,IAGjB,KAAK,QAAQ,WAAS;AAAA,MAC1B,KAAKD;AACD,aAAK,QAAQ,KAAM;AACnB;AAAA,MAEJ,KAAKra;AACD,QAAI,KAAK,OAAO,eAAeya,CAAa,KACxC,OAAO,KAAK,OAAOA,CAAa,EAAE,SAAU,aAC5CC,IAAQ,KAAK,OAAOD,CAAa,EAAE,MAAM,KAAK,IAAI,IAGlDC,IAAQ,KAAK,MAAMH,GAAyB,KAAK,IAAI,CAAC;AAG1D;AAAA,IAChB;AAEQ,WAAO;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAYz8B,GAAO,KAAK,QAAQ,UAAU;AAAA,MACpD,MAAMyT;AAAA,MACN,SAAS+Y;AAAA,MACT,OAAOoQ;AAAA,IACV;AAAA,EACJ;AAAA,EACD,UAAU,SAAS/8B,GAAM;AACrB,SAAK,MAAM,GAAG,GACd,KAAK,MAAMA,EAAK,IAAI,GAEhBA,EAAK,YAAY,SACjB,KAAK,MAAM,GAAG,GACd,KAAK,KAAKA,EAAK,OAAO,IAGtBA,EAAK,QACL,KAAK,KAAKA,EAAK,KAAK,IAEpB,KAAK,MAAM,GAAG;AAAA,EAErB;AAAA,EACD,aAAa;AACjB,GC1GI8U,KAAOpP,EAA2B,MAElCg3B,KAAY5nB,GAAK,WACjBuN,KAAmBvN,GAAK,kBAE5BkoB,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,UAAU,CAAC,CAAE,CAAA;AAAA,EAChB;AAAA,EACD,OAAO,SAASppB,GAAM;AAClB,QAAIya,IAAW;AAEf,WAAIza,MAAS,SACTA,IAAOA,EAAK,YAAa,IAG7B,KAAK,QAAQ,OAAQ,GAEjB,KAAK,OAAO,eAAeA,CAAI,KAC/B,OAAO,KAAK,OAAOA,CAAI,EAAE,WAAY,aAErCya,IAAW,KAAK,OAAOza,CAAI,EAAE,QAAQ,KAAK,IAAI,IAG9Cya,IAAW,KAAK,aAAa,KAAK,MAAM,aAAa,GAGzD,KAAK,QAAQ,OAAQ,GAEjB,KAAK,QAAQ,QAAQ,MACrB,KAAK,QAAQ,cAAchM,MAC3B,KAAK,QAAQ,cAAcqa,MAC3B,KAAK,MAAM,gCAAgC,GAG3CrO,MAAa,SACbA,IAAW,KAAK,WAAY,IAGzB;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,oBAAoBA,CAAQ;AAAA,MACtC,UAAUA;AAAA,IACb;AAAA,EACJ;AAAA,EACD,UAAU,SAASruB,GAAM;AACrB,SAAK,SAASA,CAAI;AAAA,EACrB;AAAA,EACD,aAAa;AACjB,GClDI8U,KAAOpP,EAA2B,MAElCiX,KAAQ7H,GAAK,OACbmoB,KAASnoB,GAAK,QACdooB,KAAQpoB,GAAK,OACbqN,KAAoBrN,GAAK,mBACzBsN,KAAqBtN,GAAK,oBAC1BqoB,KAAa,IACbtb,KAAW,IACXub,KAAa,IACbC,KAAmB,IACnB/a,KAAe,KACfgb,KAAQ;AAEZ,SAASC,KAAmB;AACxB,EAAI,KAAK,QAAQ,OACb,KAAK,MAAM,yBAAyB;AAGxC,MAAIp9B,IAAQ,KAAK,QAAQ,YACrBq9B,IAAc,IACdC,IAAa;AAEjB,SAAI,KAAK,QAAQ,QAAQ5b,EAAQ,KAC7B2b,IAAc,IACdC,IAAa,IACb,KAAK,QAAQ,KAAM,KACX,KAAK,QAAQ,QAAQnb,EAAY,KACzC,KAAK,IAAI3F,EAAK,GAGd,KAAK,QAAQ,QAAQ2F,EAAY,IAC7B,KAAK,QAAQ,OAAO,WAAW,KAAK,QAAQ,aAAa,CAAC,MAAM8a,MAChE,KAAK,QAAQ,KAAM,GACnB,KAAK,IAAIzgB,EAAK,KACP6gB,KACP,KAAK,MAAM,0BAA0B,KAAK,QAAQ,QAAQ,IAEvDA,KACP,KAAK,MAAM,2BAA2B,GAGtCC,KAAc,KAAK,QAAQ,cAAcP,OACzC,KAAK,QAAQ,KAAM,GACnB,KAAK,IAAIvgB,EAAK,IAGX;AAAA,IACH,MAAM;AAAA,IACN,KAAK,KAAK,YAAYxc,GAAO,KAAK,QAAQ,UAAU;AAAA,IACpD,MAAM,KAAK,QAAQ,eAAeA,CAAK;AAAA,EAC1C;AACL;AAEA,SAASu9B,KAAc;AACnB,MAAIv9B,IAAQ,KAAK,QAAQ,YACrBgV,IAAO,KAAK,QAAQ,OAAO,WAAWhV,CAAK;AAE/C,SAAIgV,MAASioB;AAAA,EACTjoB,MAASmoB;AAAAA,EACTnoB,MAASkoB;AAAA,EACTloB,MAASgoB;AAAAA,EACThoB,MAAS0M;AAAAA,EACT1M,MAASmN,MAET,KAAK,MAAM,wDAAwD,GAGvE,KAAK,QAAQ,KAAM,GAEfnN,MAASioB,OACJ,KAAK,QAAQ,QAAQA,EAAU,KAChC,KAAK,MAAM,wBAAwB,GAGvC,KAAK,QAAQ,KAAM,IAGhB,KAAK,QAAQ,eAAej9B,CAAK;AAC5C;AAIA,IAAAw9B,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,MAAM;AAAA,IACN,SAAS,CAAC,QAAQ,IAAI;AAAA,IACtB,OAAO,CAAC,UAAU,cAAc,IAAI;AAAA,IACpC,OAAO,CAAC,QAAQ,IAAI;AAAA,EACvB;AAAA,EACD,OAAO,WAAW;AACd,QAAIx9B,IAAQ,KAAK,QAAQ,YACrByT,GACAgqB,IAAU,MACV1+B,IAAQ,MACR2+B,IAAQ;AAEZ,gBAAK,IAAI1b,EAAiB,GAC1B,KAAK,QAAQ,OAAQ,GAErBvO,IAAO2pB,GAAiB,KAAK,IAAI,GACjC,KAAK,QAAQ,OAAQ,GAEjB,KAAK,QAAQ,cAAcnb,OAEvB,KAAK,QAAQ,cAAczF,OAC3BihB,IAAUF,GAAY,KAAK,IAAI,GAE/B,KAAK,QAAQ,OAAQ,GAErBx+B,IAAQ,KAAK,QAAQ,cAAc+9B,KAC7B,KAAK,OAAM,IACX,KAAK,WAAY,GAEvB,KAAK,QAAQ,OAAQ,IAIrB,KAAK,QAAQ,cAActgB,OAC3BkhB,IAAQ,KAAK,QAAQ,cAAe,GACpC,KAAK,QAAQ,KAAM,GAEnB,KAAK,QAAQ,OAAQ,KAI7B,KAAK,IAAIzb,EAAkB,GAEpB;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAYjiB,GAAO,KAAK,QAAQ,UAAU;AAAA,MACpD,MAAMyT;AAAA,MACN,SAASgqB;AAAA,MACT,OAAO1+B;AAAA,MACP,OAAO2+B;AAAA,IACV;AAAA,EACJ;AAAA,EACD,UAAU,SAAS79B,GAAM;AACrB,QAAI89B,IAAc;AAElB,SAAK,MAAM,GAAG,GACd,KAAK,KAAK99B,EAAK,IAAI,GAEfA,EAAK,YAAY,SACjB,KAAK,MAAMA,EAAK,OAAO,GAEnBA,EAAK,UAAU,SACf,KAAK,KAAKA,EAAK,KAAK,GAGhBA,EAAK,MAAM,SAAS,aACpB89B,IAAc,OAKtB99B,EAAK,UAAU,SACf,KAAK,MAAM89B,CAAW,GACtB,KAAK,MAAM99B,EAAK,KAAK,IAGzB,KAAK,MAAM,GAAG;AAAA,EACtB;AACA,GCpKI8U,KAAOpP,EAA2B,MAClC82B,KAAUh2B,GAAiB,MAE3BoR,KAAa9C,GAAK,YAClB+C,KAAU/C,GAAK,SACf4nB,KAAY5nB,GAAK,WACjB2nB,KAAY3nB,GAAK,WACjBuN,KAAmBvN,GAAK,kBACxByN,KAAoBzN,GAAK;AAE7B,SAAS6nB,GAAWzkB,GAAY;AAC5B,SAAO,KAAK,IAAIA,GAAY,MAAM,EAAI;AAC1C;AACA,SAAS6lB,KAAc;AACnB,SAAO,KAAK,kBAAkB,KAAK,MAAMpB,EAAU;AACvD;AACA,SAASqB,GAAsB9lB,GAAY;AACvC,SAAO,KAAK,IAAIA,GAAYskB,GAAQ,mBAAmB,EAAI;AAC/D;AACA,SAASyB,KAAqB;AAC1B,MAAI,KAAK,QAAQ,cAAcvB;AAC3B,WAAOsB,GAAsB,KAAK,MAAM,KAAK,QAAQ,UAAU;AAGnE,MAAIh+B,IAAO,KAAK,kBAAkB,KAAK,aAAag+B,EAAqB;AAEzE,SAAI,KAAK,QAAQ,cAActB,MAC3B,KAAK,QAAQ,KAAM,GAGhB18B;AACX;AAEA,IAAAk+B,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,UAAU,CAAC;AAAA,MACP;AAAA,MACA;AAAA,MACA;AAAA,IACH,CAAA;AAAA,EACJ;AAAA,EACD,OAAO,SAASC,GAAe;AAC3B,QAAInP,IAAWmP,IAAgBF,KAAqBF,IAEhD59B,IAAQ,KAAK,QAAQ,YACrBkuB,IAAW,KAAK,WAAY;AAEhC,SAAK,IAAIhM,EAAgB;AAEzB,IAAAhC;AACA,aAAO,CAAC,KAAK,QAAQ;AACjB,gBAAQ,KAAK,QAAQ,WAAS;AAAA,UAC1B,KAAKkC;AACD,kBAAMlC;AAAA,UAEV,KAAKzI;AAAAA,UACL,KAAKC;AACD,iBAAK,QAAQ,KAAM;AACnB;AAAA,UAEJ,KAAK4kB;AACD,YAAApO,EAAS,KAAK,KAAK,kBAAkB,KAAK,QAAQsO,EAAU,CAAC;AAC7D;AAAA,UAEJ;AACI,YAAAtO,EAAS,KAAKW,EAAS,KAAK,IAAI,CAAC;AAAA,QACrD;AAGQ,WAAK,KAAK,QAAQ,OACd,KAAK,IAAIzM,EAAiB,GAGvB;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAYpiB,GAAO,KAAK,QAAQ,UAAU;AAAA,MACpD,UAAUkuB;AAAA,IACb;AAAA,EACJ;AAAA,EACD,UAAU,SAASruB,GAAM;AACrB,SAAK,MAAM,GAAG,GACd,KAAK,SAASA,GAAM,SAASgC,GAAM;AAC/B,MAAIA,EAAK,SAAS,iBACd,KAAK,MAAM,GAAG;AAAA,IAE9B,CAAS,GACD,KAAK,MAAM,GAAG;AAAA,EACjB;AAAA,EACD,aAAa;AACjB,GC1FI8S,KAAOpP,EAA2B,MAElCyc,KAAoBrN,GAAK,mBACzBsN,KAAqBtN,GAAK,oBAE9BspB,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,UAAU,CAAC,CAAE,CAAA;AAAA,EAChB;AAAA,EACD,OAAO,SAASC,GAAcjQ,GAAY;AACtC,QAAIjuB,IAAQ,KAAK,QAAQ,YACrBkuB,IAAW;AAEf,gBAAK,IAAIlM,EAAiB,GAE1BkM,IAAWgQ,EAAa,KAAK,MAAMjQ,CAAU,GAExC,KAAK,QAAQ,OACd,KAAK,IAAIhM,EAAkB,GAGxB;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAYjiB,GAAO,KAAK,QAAQ,UAAU;AAAA,MACpD,UAAUkuB;AAAA,IACb;AAAA,EACJ;AAAA,EACD,UAAU,SAASruB,GAAM;AACrB,SAAK,MAAM,GAAG,GACd,KAAK,SAASA,CAAI,GAClB,KAAK,MAAM,GAAG;AAAA,EACtB;AACA,GCjCIs+B,KAAM54B,EAA2B,KAAK,KAE1C64B,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW,CAAE;AAAA,EACb,OAAO,WAAW;AACd,QAAIp+B,IAAQ,KAAK,QAAQ;AAEzB,gBAAK,IAAIm+B,EAAG,GAEL;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAYn+B,GAAO,KAAK,QAAQ,UAAU;AAAA,IACvD;AAAA,EACJ;AAAA,EACD,UAAU,WAAW;AACjB,SAAK,MAAM,KAAK;AAAA,EACxB;AACA,GClBIq+B,KAAM94B,EAA2B,KAAK,KAE1C+4B,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW,CAAE;AAAA,EACb,OAAO,WAAW;AACd,QAAIt+B,IAAQ,KAAK,QAAQ;AAEzB,gBAAK,IAAIq+B,EAAG,GAEL;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAYr+B,GAAO,KAAK,QAAQ,UAAU;AAAA,IACvD;AAAA,EACJ;AAAA,EACD,UAAU,WAAW;AACjB,SAAK,MAAM,MAAM;AAAA,EACzB;AACA,GClBI2U,KAAOpP,EAA2B,MAElCiX,KAAQ7H,GAAK,OACb4pB,KAAW,IAGfC,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,MAAM;AAAA,EACT;AAAA,EACD,OAAO,WAAW;AACd,WAAK,KAAK,QAAQ,QAAQD,EAAQ,KAC9B,KAAK,MAAM,uBAAuB,GAGtC,KAAK,QAAQ,KAAM,GAEZ;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAY,KAAK,QAAQ,aAAa,GAAG,KAAK,QAAQ,QAAQ;AAAA,MACxE,MAAM,KAAK,QAAQ/hB,EAAK;AAAA,IAC3B;AAAA,EACJ;AAAA,EACD,UAAU,SAAS3c,GAAM;AACrB,SAAK,MAAM,GAAG,GACd,KAAK,MAAMA,EAAK,IAAI;AAAA,EAC5B;AACA,GC5BI8U,KAAOpP,EAA2B,MAElCiX,KAAQ7H,GAAK,OACbgI,KAAW,IACX8hB,KAAU,IACV3c,KAAkB,IAClBqb,KAAQ,KAGZuB,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,MAAM;AAAA,EACT;AAAA,EACD,OAAO,WAAW;AACd,QAAI1+B,IAAQ,KAAK,QAAQ,YACrBgV,IAAO,KAAK,QAAQ,OAAO,WAAW,KAAK,QAAQ,UAAU;AAEjE,YAAQA,GAAI;AAAA,MACR,KAAK8M;AAAAA,MACL,KAAKnF;AAAAA,MACL,KAAKwgB;AACD,aAAK,QAAQ,KAAM;AACnB;AAAA,MAEJ,KAAKsB;AACD,aAAK,QAAQ,KAAM,IAEf,KAAK,QAAQ,cAAcjiB,MAAS,KAAK,QAAQ,YAAY,GAAG,MAAM,MAAM,OAC5E,KAAK,MAAM,+BAA+B,GAG9C,KAAK,QAAQ,KAAM,GAEd,KAAK,QAAQ,QAAQiiB,EAAO,KAC7B,KAAK,MAAM,qBAAqB,GAGpC,KAAK,QAAQ,KAAM;AACnB;AAAA,MAEJ;AACI,aAAK,MAAM,wBAAwB;AAAA,IACnD;AAEQ,WAAO;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAYz+B,GAAO,KAAK,QAAQ,UAAU;AAAA,MACpD,MAAM,KAAK,QAAQ,eAAeA,CAAK;AAAA,IAC1C;AAAA,EACJ;AAAA,EACD,UAAU,SAASH,GAAM;AACrB,SAAK,MAAMA,EAAK,IAAI;AAAA,EAC5B;AACA,GCtDI8U,KAAOpP,EAA2B,MAElCmS,KAAU/C,GAAK,SACf+M,KAAW,IACX+c,KAAU,IAGdE,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,OAAO;AAAA,EACV;AAAA,EACD,OAAO,WAAW;AACd,QAAI3+B,IAAQ,KAAK,QAAQ,YACrB6M,IAAM,KAAK,QAAQ;AAEvB,gBAAK,IAAI6K,EAAO,GAEX7K,IAAM7M,IAAQ,KAAM,KACrB,KAAK,QAAQ,OAAO,WAAW6M,IAAM,CAAC,MAAM6U,MAC5C,KAAK,QAAQ,OAAO,WAAW7U,IAAM,CAAC,MAAM4xB,OAC5C5xB,KAAO,IAGJ;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAY7M,GAAO,KAAK,QAAQ,UAAU;AAAA,MACpD,OAAO,KAAK,QAAQ,OAAO,UAAUA,IAAQ,GAAG6M,CAAG;AAAA,IACtD;AAAA,EACJ;AAAA,EACD,UAAU,SAAShN,GAAM;AACrB,SAAK,MAAM,IAAI,GACf,KAAK,MAAMA,EAAK,KAAK,GACrB,KAAK,MAAM,IAAI;AAAA,EACvB;AACA,GCnCI0a,KAAmBhV,GAA6B,kBAChDoP,KAAOtO,EAA2B,MAClCg2B,KAAUh1B,GAAiB,MAE3BmV,KAAQ7H,GAAK,OACb0Z,KAAO1Z,GAAK,MACZooB,KAAQpoB,GAAK,OACb4nB,KAAY5nB,GAAK,WACjB4H,KAAQ5H,GAAK,OACb8C,KAAa9C,GAAK,YAClByM,KAAkB,IAClBC,KAAa,IACb2b,KAAa,IACb1b,KAAY,IACZI,KAAW,IACX/E,KAAW,IACX8hB,KAAU;AAEd,SAASG,GAAgB7mB,GAAY;AACjC,SAAO,KAAK,IAAIA,GAAYskB,GAAQ,4BAA4B,EAAI;AACxE;AAEA,SAASwC,GAAyB9mB,GAAY;AAC1C,SAAO,KAAK,IAAIA,GAAYskB,GAAQ,4BAA4B,EAAK;AACzE;AAEA,SAASyC,KAAe;AACpB,MAAIC,IAAkB,KAAK,QAAQ,YAC/BhgC,IAAQ,KAAK,MAAO;AAExB,SAAIA,EAAM,SAAS,SACf,KAAK,QAAQ,QAAQ,MACrB,KAAK,QAAQ,cAAcw9B,MAC3B,KAAK,QAAQ,QAAQnb,EAAe,MAAM,MAC1C,KAAK,QAAQ,cAAc2d,CAAe,MAAM,MAChD,KAAK,MAAO,GAGThgC;AACX;AAEA,IAAAigC,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,WAAW,CAAC,SAAS,MAAM;AAAA,IAC3B,UAAU;AAAA,IACV,OAAO,CAAC,SAAS,KAAK;AAAA,EACzB;AAAA,EACD,OAAO,WAAW;AACd,QAAIh/B,IAAQ,KAAK,QAAQ,YACrB+X,IAAa,KAAK,QAAQ,YAC1BgD,IAAWqI,GAAa,KAAK,IAAI,GACjC6b,IAAiB1kB,GAAiBQ,CAAQ,GAC1CmkB,IAAaD,IAAiB,KAAK,sBAAsB,KAAK,YAC9DzC,IAAayC,IAAiBJ,KAA2BD,IACzDO,IAAY,IACZpgC;AAEJ,SAAK,QAAQ,OAAQ,GACrB,KAAK,IAAIg+B,EAAK;AAEd,UAAMqC,IAAa,KAAK,QAAQ;AAYhC,QAVKH,KACD,KAAK,QAAQ,OAAQ,GAGrBC,IACAngC,IAAQ,KAAK,kBAAkB+/B,IAActC,CAAU,IAEvDz9B,IAAQy9B,EAAW,KAAK,MAAM,KAAK,QAAQ,UAAU,GAGrDyC,KAAkBlgC,EAAM,SAAS,WAAWA,EAAM,SAAS;AAC3D,eAAS4F,IAASy6B,IAAa,KAAK,QAAQ,YAAYz6B,KAAU,GAAGA;AACjE,YAAI,KAAK,QAAQ,WAAWA,CAAM,MAAM8S,IAAY;AAChD,UAAA1Y,EAAM,SAAS,WAAW;AAAA,YACtB,MAAM;AAAA,YACN,KAAK;AAAA,YACL,OAAO;AAAA,UAC/B,CAAqB;AACD;AAAA,QACpB;AAAA;AAIQ,WAAI,KAAK,QAAQ,QAAQqiB,EAAe,MACpC+d,IAAYE,GAAa,KAAK,IAAI,GAClC,KAAK,QAAQ,OAAQ,IAMrB,KAAK,QAAQ,QAAQ,MACrB,KAAK,QAAQ,cAAc9C,MAC3B,KAAK,QAAQ,cAAcxkB,CAAU,MAAM,MAC3C,KAAK,MAAO,GAGT;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAY/X,GAAO,KAAK,QAAQ,UAAU;AAAA,MACpD,WAAWm/B;AAAA,MACX,UAAUpkB;AAAA,MACV,OAAOhc;AAAA,IACV;AAAA,EACJ;AAAA,EACD,UAAU,SAASc,GAAM;AACrB,SAAK,MAAMA,EAAK,QAAQ,GACxB,KAAK,MAAM,GAAG,GACd,KAAK,KAAKA,EAAK,KAAK,GAEhBA,EAAK,aACL,KAAK,MAAMA,EAAK,cAAc,KAAO,eAAe,MAAMA,EAAK,SAAS;AAAA,EAE/E;AAAA,EACD,aAAa;AACjB;AAEA,SAASujB,KAAe;AACpB,MAAIpjB,IAAQ,KAAK,QAAQ;AAIzB,MAAI,KAAK,QAAQ,cAAcuc;AAC3B,YAAQ,KAAK,QAAQ,OAAO,WAAW,KAAK,QAAQ,UAAU,GAAC;AAAA,MAC3D,KAAKmF;AAAAA,MACL,KAAKsb;AAAA,MACL,KAAKrgB;AAAAA,MACL,KAAK0E;AAAAA,MACL,KAAKC;AACD,aAAK,QAAQ,KAAM;AACnB;AAAA,MAGJ,KAAKmd;AACD,aAAK,QAAQ,KAAM,GACf,KAAK,QAAQ,QAAQA,EAAO,KAC5B,KAAK,QAAQ,KAAM;AAEvB;AAAA,IAChB;AAOI,SAAI,KAAK,QAAQ,cAAcpQ,KAC3B,KAAK,IAAIA,EAAI,IAEb,KAAK,IAAI7R,EAAK,GAGX,KAAK,QAAQ,eAAexc,CAAK;AAC5C;AAGA,SAASq/B,KAAe;AACpB,OAAK,IAAI9iB,EAAK,GACd,KAAK,QAAQ,OAAQ;AAErB,MAAI4iB,IAAY,KAAK,QAAQ3iB,EAAK;AAIlC,SAAO2iB,MAAc,cAAc,KAAOA;AAC9C;ACxKA,IAAIxqB,KAAOpP,EAA2B,MAClC82B,KAAUh2B,GAAiB,MAE3BoR,KAAa9C,GAAK,YAClB+C,KAAU/C,GAAK,SACf4nB,KAAY5nB,GAAK;AAErB,SAAS6nB,GAAWzkB,GAAY;AAC5B,SAAO,KAAK,IAAIA,GAAYskB,GAAQ,mBAAmB,EAAI;AAC/D;AAEA,IAAAiD,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,UAAU,CAAC;AAAA,MACP;AAAA,IACH,CAAA;AAAA,EACJ;AAAA,EACD,OAAO,WAAW;AAId,aAHIpR,IAAW,KAAK,WAAY,GAGzB,CAAC,KAAK,QAAQ;AACjB,cAAQ,KAAK,QAAQ,WAAS;AAAA,QAC1B,KAAKzW;AAAAA,QACL,KAAKC;AAAAA,QACL,KAAK6kB;AACD,eAAK,QAAQ,KAAM;AACnB;AAAA,QAEJ;AACI,UAAArO,EAAS,KAAK,KAAK,kBAAkB,KAAK,aAAasO,EAAU,CAAC;AAAA,MACtF;AAGQ,WAAO;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,oBAAoBtO,CAAQ;AAAA,MACtC,UAAUA;AAAA,IACb;AAAA,EACJ;AAAA,EACD,UAAU,SAASruB,GAAM;AACrB,SAAK,SAASA,GAAM,SAASgC,GAAM;AAC/B,MAAIA,EAAK,SAAS,iBACd,KAAK,MAAM,GAAG;AAAA,IAE9B,CAAS;AAAA,EACT;AACA,GChDIuV,KAAgB7R,GAAiC,eACjDoP,KAAOtO,EAA2B,MAElCqW,KAAY/H,GAAK,WAErB4qB,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,OAAO;AAAA,IACP,MAAM;AAAA,EACT;AAAA,EACD,OAAO,WAAW;AACd,QAAIv/B,IAAQ,KAAK,QAAQ,YACrBqgB,IAAYjJ,GAAc,KAAK,QAAQ,QAAQpX,CAAK;AAExD,gBAAK,IAAI0c,EAAS,GAEX;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAY1c,GAAO,KAAK,QAAQ,UAAU;AAAA,MACpD,OAAO,KAAK,QAAQ,OAAO,UAAUA,GAAOqgB,CAAS;AAAA,MACrD,MAAM,KAAK,QAAQ,OAAO,UAAUA,GAAW,KAAK,QAAQ,UAAU;AAAA,IACzE;AAAA,EACJ;AAAA,EACD,UAAU,SAASxgB,GAAM;AACrB,SAAK,MAAMA,EAAK,KAAK,GACrB,KAAK,MAAMA,EAAK,IAAI;AAAA,EAC5B;AACA,GC5BI8U,KAAOpP,EAA2B,MAElCkc,KAAmB9M,GAAK,kBAG5B6qB,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,MAAM;AAAA,IACN,UAAU,CAAC,CAAE,CAAA;AAAA,EAChB;AAAA,EACD,OAAO,SAAStB,GAAcjQ,GAAY;AACtC,QAAIjuB,IAAQ,KAAK,QAAQ,YACrByT,IAAO,KAAK,oBAAqB,GACjCkpB,IAAgBlpB,EAAK,YAAa,GAClCya;AAEJ,WAAAA,IAAWD,EAAW,eAAe0O,CAAa,IAC5C1O,EAAW0O,CAAa,EAAE,KAAK,MAAM1O,CAAU,IAC/CiQ,EAAa,KAAK,MAAMjQ,CAAU,GAEnC,KAAK,QAAQ,OACd,KAAK,IAAIxM,EAAgB,GAGtB;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAYzhB,GAAO,KAAK,QAAQ,UAAU;AAAA,MACpD,MAAMyT;AAAA,MACN,UAAUya;AAAA,IACb;AAAA,EACJ;AAAA,EACD,UAAU,SAASruB,GAAM;AACrB,SAAK,MAAMA,EAAK,IAAI,GACpB,KAAK,MAAM,GAAG,GACd,KAAK,SAASA,CAAI,GAClB,KAAK,MAAM,GAAG;AAAA,EACjB;AAAA,EACD,aAAa;AACjB,GCvCI8U,KAAOpP,EAA2B,MAElC8oB,KAAO1Z,GAAK,MAGhB8qB,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,OAAO;AAAA,EACV;AAAA,EACD,OAAO,WAAW;AACd,QAAIz/B,IAAQ,KAAK,QAAQ;AAEzB,gBAAK,IAAIquB,EAAI,GAEN;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAYruB,GAAO,KAAK,QAAQ,UAAU;AAAA,MACpD,OAAO,KAAK,QAAQ,eAAeA,IAAQ,CAAC;AAAA,IAC/C;AAAA,EACJ;AAAA,EACD,UAAU,SAASH,GAAM;AACrB,SAAK,MAAM,GAAG,GACd,KAAK,MAAMA,EAAK,KAAK;AAAA,EAC7B;AACA,GCzBI8U,KAAOpP,EAA2B,MAElCiX,KAAQ7H,GAAK,OAEjB+qB,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,MAAM;AAAA,EACT;AAAA,EACD,OAAO,WAAW;AACd,WAAO;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAY,KAAK,QAAQ,YAAY,KAAK,QAAQ,QAAQ;AAAA,MACpE,MAAM,KAAK,QAAQljB,EAAK;AAAA,IAC3B;AAAA,EACJ;AAAA,EACD,UAAU,SAAS3c,GAAM;AACrB,SAAK,MAAMA,EAAK,IAAI;AAAA,EAC5B;AACA,GCnBI8U,KAAOpP,EAA2B,MAElC8oB,KAAO1Z,GAAK,MAGhBgrB,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,MAAM;AAAA,EACT;AAAA,EACD,OAAO,WAAW;AACd,QAAI3/B,IAAQ,KAAK,QAAQ;AAGzB,gBAAK,IAAIquB,EAAI,GAEN;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAYruB,GAAO,KAAK,QAAQ,UAAU;AAAA,MACpD,MAAM,KAAK,QAAQ,eAAeA,IAAQ,CAAC;AAAA,IAC9C;AAAA,EACJ;AAAA,EACD,UAAU,SAASH,GAAM;AACrB,SAAK,MAAM,GAAG,GACd,KAAK,MAAMA,EAAK,IAAI;AAAA,EAC5B;AACA,GC1BI8U,KAAOpP,EAA2B,MAElCiX,KAAQ7H,GAAK,OACb8H,KAAS9H,GAAK,QACd+H,KAAY/H,GAAK,WACjB6M,KAAkB7M,GAAK,iBACvB8M,KAAmB9M,GAAK,kBACxBooB,KAAQpoB,GAAK,OACb4H,KAAQ5H,GAAK,OAEjBirB,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,MAAM;AAAA,IACN,OAAO,CAAC,cAAc,UAAU,aAAa,SAAS,IAAI;AAAA,EAC7D;AAAA,EACD,OAAO,WAAW;AACd,QAAI5/B,IAAQ,KAAK,QAAQ,YACrByT,GACA1U,IAAQ;AAQZ,QANA,KAAK,IAAIyiB,EAAe,GACxB,KAAK,QAAQ,OAAQ,GAErB/N,IAAO,KAAK,QAAQ+I,EAAK,GACzB,KAAK,QAAQ,OAAQ,GAEjB,KAAK,QAAQ,cAAciF,IAAkB;AAI7C,cAHA,KAAK,IAAIsb,EAAK,GACd,KAAK,QAAQ,OAAQ,GAEb,KAAK,QAAQ,WAAS;AAAA,QAC1B,KAAKtgB;AACD,UAAI,KAAK,gBAAgB,CAAC,MAAMF,KAC5Bxd,IAAQ,KAAK,MAAO,IAEpBA,IAAQ,KAAK,OAAQ;AAGzB;AAAA,QAEJ,KAAK2d;AACD,UAAA3d,IAAQ,KAAK,UAAW;AACxB;AAAA,QAEJ,KAAKyd;AACD,UAAAzd,IAAQ,KAAK,WAAY;AAEzB;AAAA,QAEJ;AACI,eAAK,MAAM,oDAAoD;AAAA,MACnF;AAEY,WAAK,QAAQ,OAAQ;AAAA,IACjC;AAEQ,gBAAK,IAAI0iB,EAAgB,GAElB;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAYzhB,GAAO,KAAK,QAAQ,UAAU;AAAA,MACpD,MAAMyT;AAAA,MACN,OAAO1U;AAAA,IACV;AAAA,EACJ;AAAA,EACD,UAAU,SAASc,GAAM;AACrB,SAAK,MAAM,GAAG,GACd,KAAK,MAAMA,EAAK,IAAI,GAChBA,EAAK,UAAU,SACf,KAAK,MAAM,GAAG,GACd,KAAK,KAAKA,EAAK,KAAK,IAExB,KAAK,MAAM,GAAG;AAAA,EACtB;AACA,GC3EI8U,KAAOpP,EAA2B,MAElCkS,KAAa9C,GAAK,YAClB+C,KAAU/C,GAAK,SACf6H,KAAQ7H,GAAK,OACb6M,KAAkB7M,GAAK,iBAE3BkrB,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,UAAU,CAAC;AAAA,MACP;AAAA,MACA;AAAA,MACA;AAAA,IACH,CAAA;AAAA,EACJ;AAAA,EACD,OAAO,WAAW;AACd,SAAK,QAAQ,OAAQ;AAErB,QAAI3R,IAAW,KAAK,WAAY,GAC5BtqB,IAAQ,MACRk8B,IAAQ;AAEZ,IAAA5f;AACA,aAAO,CAAC,KAAK,QAAQ,OAAK;AACtB,gBAAQ,KAAK,QAAQ,WAAS;AAAA,UAC1B,KAAKxI;AACD,iBAAK,QAAQ,KAAM;AACnB;AAAA,UAEJ,KAAKD;AACD,YAAAqoB,IAAQ,KAAK,WAAY;AACzB;AAAA,UAEJ,KAAKtjB;AACD,YAAA5Y,IAAQ,KAAK,WAAY;AACzB;AAAA,UAEJ,KAAK4d;AACD,YAAA5d,IAAQ,KAAK,aAAc;AAC3B;AAAA,UAEJ;AACI,kBAAMsc;AAAA,QAC1B;AAEY,QAAI4f,MAAU,SACV5R,EAAS,KAAK4R,CAAK,GACnBA,IAAQ,OAGZ5R,EAAS,KAAKtqB,CAAK;AAAA,MAC/B;AAEQ,WAAIA,MAAU,QACV,KAAK,MAAM,uCAAuC,GAG/C;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,oBAAoBsqB,CAAQ;AAAA,MACtC,UAAUA;AAAA,IACb;AAAA,EACJ;AAAA,EACD,UAAU,SAASruB,GAAM;AACrB,SAAK,SAASA,CAAI;AAAA,EAC1B;AACA,GCnEI8hB,KAAQpc,EAA2B,KAAK,OAE5Cw6B,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,UAAU,CAAC;AAAA,MACP;AAAA,IACH,CAAA;AAAA,EACJ;AAAA,EACD,OAAO,SAAStN,GAAU;AACtB,QAAIvE,IAAW,KAAK,WAAY;AAIhC,SAFA,KAAK,QAAQ,OAAQ,GAEd,CAAC,KAAK,QAAQ,QACjBA,EAAS,KAAK,KAAK,WAAWuE,CAAQ,CAAC,GAEnC,KAAK,QAAQ,cAAc9Q;AAI/B,WAAK,QAAQ,KAAM;AAGvB,WAAO;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,oBAAoBuM,CAAQ;AAAA,MACtC,UAAUA;AAAA,IACb;AAAA,EACJ;AAAA,EACD,UAAU,SAASruB,GAAM;AACrB,SAAK,SAASA,GAAM,WAAW;AAC3B,WAAK,MAAM,GAAG;AAAA,IAC1B,CAAS;AAAA,EACT;AACA,GCnCAmgC,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,KAAK,CAAC,WAAW,YAAY;AAAA,IAC7B,UAAU,CAAC,gBAAgB,IAAI;AAAA,EAClC;AAAA,EACD,OAAO,SAASC,GAAe;AAC3B,SAAK,QAAQ,OAAQ;AAErB,QAAIjgC,IAAQ,KAAK,QAAQ,YACrB6M,IAAM7M,GACNkgC,IAAW,MACXC;AAEJ,WAAI,KAAK,QAAQ,YAAY,GAAG,KAAK,KAAK,KAAK,QAAQ,YAAY,GAAG,MAAM,IACxEA,IAAQ,KAAK,WAAY,IAEzBA,IAAQ,KAAK,QAAS,GAG1B,KAAK,QAAQ,OAAQ,GAEjBF,KAAiB,KAAK,QAAQ,YAAY,GAAG,IAAI,KACjD,KAAK,QAAQ,KAAM,GAEnBC,IAAW,KAAK,aAAc,GAE1B,KAAK,kBACLrzB,IAAM,KAAK,gBAAgBqzB,EAAS,QAAQ,EAAE,IAAI,IAAI,WAGtD,KAAK,kBACLrzB,IAAMszB,EAAM,IAAI,IAAI,SAIrB;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAYngC,GAAO6M,CAAG;AAAA,MAChC,KAAKszB;AAAA,MACL,UAAUD;AAAA,IACb;AAAA,EACJ;AAAA,EACD,UAAU,SAASrgC,GAAM;AACrB,SAAK,KAAKA,EAAK,GAAG,GACdA,EAAK,aAAa,SAClB,KAAK,MAAM,MAAM,GACjB,KAAK,KAAKA,EAAK,QAAQ;AAAA,EAEnC;AACA,GClDI4c,KAASlX,EAA2B,KAAK,QAE7C66B,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,OAAO;AAAA,EACV;AAAA,EACD,OAAO,WAAW;AACd,WAAO;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAY,KAAK,QAAQ,YAAY,KAAK,QAAQ,QAAQ;AAAA,MACpE,OAAO,KAAK,QAAQ3jB,EAAM;AAAA,IAC7B;AAAA,EACJ;AAAA,EACD,UAAU,SAAS5c,GAAM;AACrB,SAAK,MAAMA,EAAK,KAAK;AAAA,EAC7B;AACA,GChBAwgC,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,OAAO;AAAA,EACV;AAAA,EACD,OAAO,WAAW;AACd,QAAIrgC,IAAQ,KAAK,QAAQ;AAEzB,gBAAK,QAAQ,KAAM,GAEZ;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAYA,GAAO,KAAK,QAAQ,UAAU;AAAA,MACpD,OAAO,KAAK,QAAQ,eAAeA,CAAK;AAAA,IAC3C;AAAA,EACJ;AAAA,EACD,UAAU,SAASH,GAAM;AACrB,SAAK,MAAMA,EAAK,KAAK;AAAA,EAC7B;AACA,GCpBI8U,KAAOpP,EAA2B,MAElCic,KAAkB7M,GAAK,iBACvB8M,KAAmB9M,GAAK,kBAE5B2rB,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,UAAU,CAAC,CAAE,CAAA;AAAA,EAChB;AAAA,EACD,OAAO,SAASpC,GAAcjQ,GAAY;AACtC,QAAIjuB,IAAQ,KAAK,QAAQ,YACrBkuB,IAAW;AAEf,gBAAK,IAAI1M,EAAe,GAExB0M,IAAWgQ,EAAa,KAAK,MAAMjQ,CAAU,GAExC,KAAK,QAAQ,OACd,KAAK,IAAIxM,EAAgB,GAGtB;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAYzhB,GAAO,KAAK,QAAQ,UAAU;AAAA,MACpD,UAAUkuB;AAAA,IACb;AAAA,EACJ;AAAA,EACD,UAAU,SAASruB,GAAM;AACrB,SAAK,MAAM,GAAG,GACd,KAAK,SAASA,CAAI,GAClB,KAAK,MAAM,GAAG;AAAA,EACtB;AACA,GCjCIuX,KAAgB7R,GAAiC,eACjDoP,KAAOtO,EAA2B,MAElCioB,KAAa3Z,GAAK,YAEtB4rB,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,OAAO;AAAA,EACV;AAAA,EACD,OAAO,WAAW;AACd,QAAIvgC,IAAQ,KAAK,QAAQ,YACrBqgB,IAAYjJ,GAAc,KAAK,QAAQ,QAAQpX,CAAK;AAExD,gBAAK,IAAIsuB,EAAU,GAEZ;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAYtuB,GAAO,KAAK,QAAQ,UAAU;AAAA,MACpD,OAAO,KAAK,QAAQ,OAAO,UAAUA,GAAOqgB,CAAS;AAAA,IACxD;AAAA,EACJ;AAAA,EACD,UAAU,SAASxgB,GAAM;AACrB,SAAK,MAAMA,EAAK,KAAK,GACrB,KAAK,MAAM,GAAG;AAAA,EACtB;AACA,GC1BI8U,KAAOpP,EAA2B,MAElCiX,KAAQ7H,GAAK,OACbwZ,KAAWxZ,GAAK,UAChBooB,KAAQpoB,GAAK,OACb8M,KAAmB9M,GAAK,kBAG5B6rB,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,MAAM;AAAA,IACN,UAAU,CAAC,CAAC,KAAK,GAAG,IAAI;AAAA,EAC3B;AAAA,EACD,OAAO,WAAW;AACd,QAAIxgC,IAAQ,KAAK,QAAQ,YACrBkuB,IAAW,MACXza,GACAkpB;AAEJ,gBAAK,IAAII,EAAK,GAEV,KAAK,QAAQ,cAAc5O,MAC3B1a,IAAO,KAAK,oBAAqB,GACjCkpB,IAAgBlpB,EAAK,YAAa,GAE9B,KAAK,OAAO,eAAekpB,CAAa,KACxC,KAAK,QAAQ,OAAQ,GACrBzO,IAAW,KAAK,OAAOyO,CAAa,EAAE,KAAK,IAAI,GAC/C,KAAK,QAAQ,OAAQ,MAErBzO,IAAW,KAAK,WAAY,GAC5BA,EAAS;AAAA,MACL,KAAK,IAAI,KAAK,QAAQ,YAAY,MAAM,EAAK;AAAA,IAChD,IAGL,KAAK,IAAIzM,EAAgB,KAEzBhO,IAAO,KAAK,QAAQ+I,EAAK,GAGtB;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAYxc,GAAO,KAAK,QAAQ,UAAU;AAAA,MACpD,MAAMyT;AAAA,MACN,UAAUya;AAAA,IACb;AAAA,EACJ;AAAA,EACD,UAAU,SAASruB,GAAM;AACrB,SAAK,MAAM,GAAG,GACd,KAAK,MAAMA,EAAK,IAAI,GAEhBA,EAAK,aAAa,SAClB,KAAK,MAAM,GAAG,GACd,KAAK,SAASA,CAAI,GAClB,KAAK,MAAM,GAAG;AAAA,EAErB;AAAA,EACD,aAAa;AACjB,GC5DI8U,KAAOpP,EAA2B,MAElCiX,KAAQ7H,GAAK,OACbwZ,KAAWxZ,GAAK,UAChBooB,KAAQpoB,GAAK,OACb8M,KAAmB9M,GAAK,kBAG5B8rB,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,MAAM;AAAA,IACN,UAAU,CAAC,CAAC,KAAK,GAAG,IAAI;AAAA,EAC3B;AAAA,EACD,OAAO,WAAW;AACd,QAAIzgC,IAAQ,KAAK,QAAQ,YACrBkuB,IAAW,MACXza,GACAkpB;AAEJ,gBAAK,IAAII,EAAK,GACd,KAAK,IAAIA,EAAK,GAEV,KAAK,QAAQ,cAAc5O,MAC3B1a,IAAO,KAAK,oBAAqB,GACjCkpB,IAAgBlpB,EAAK,YAAa,GAE9B,KAAK,OAAO,eAAekpB,CAAa,KACxC,KAAK,QAAQ,OAAQ,GACrBzO,IAAW,KAAK,OAAOyO,CAAa,EAAE,KAAK,IAAI,GAC/C,KAAK,QAAQ,OAAQ,MAErBzO,IAAW,KAAK,WAAY,GAC5BA,EAAS;AAAA,MACL,KAAK,IAAI,KAAK,QAAQ,YAAY,MAAM,EAAK;AAAA,IAChD,IAGL,KAAK,IAAIzM,EAAgB,KAEzBhO,IAAO,KAAK,QAAQ+I,EAAK,GAGtB;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAYxc,GAAO,KAAK,QAAQ,UAAU;AAAA,MACpD,MAAMyT;AAAA,MACN,UAAUya;AAAA,IACb;AAAA,EACJ;AAAA,EACD,UAAU,SAASruB,GAAM;AACrB,SAAK,MAAM,IAAI,GACf,KAAK,MAAMA,EAAK,IAAI,GAEhBA,EAAK,aAAa,SAClB,KAAK,MAAM,GAAG,GACd,KAAK,SAASA,CAAI,GAClB,KAAK,MAAM,GAAG;AAAA,EAErB;AAAA,EACD,aAAa;AACjB,GC7DIkV,KAAUxP,EAA2B,SACrCoP,KAAOpP,EAA2B,MAElCkX,KAAS9H,GAAK,QACd4H,KAAQ5H,GAAK,OACb8pB,KAAU,IACVF,KAAW;AAQf,SAASnnB,KAAgB;AACrB,OAAK,QAAQ,OAAQ;AAIrB,WAFIrY,IAAQ,KAAK,QAAQ0d,EAAM,GAEtB5d,IAAI,GAAGA,IAAIE,EAAM,QAAQF,KAAK;AACnC,QAAImW,IAAOjW,EAAM,WAAWF,CAAC;AAC7B,IAAI,CAACkW,GAAQC,CAAI,KAAKA,MAASupB,MAC3B,KAAK,MAAM,+BAA+B,KAAK,QAAQ,aAAax/B,EAAM,SAASF,CAAC;AAAA,EAEhG;AAEI,SAAI,OAAOE,CAAK,MAAM,KAClB,KAAK,MAAM,8BAA8B,KAAK,QAAQ,aAAaA,EAAM,MAAM,GAG5EA;AACX;AAGA,IAAA2hC,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,MAAM;AAAA,IACN,OAAO;AAAA,EACV;AAAA,EACD,OAAO,WAAW;AACd,QAAI1gC,IAAQ,KAAK,QAAQ,YACrBoN,IAAOgK,GAAc,KAAK,IAAI,GAC9B/J;AAEJ,gBAAK,QAAQ,OAAQ,GAEhB,KAAK,QAAQ,QAAQoxB,EAAO,KAC7B,KAAK,MAAM,qBAAqB,GAEpC,KAAK,IAAIliB,EAAK,GACdlP,IAAQ+J,GAAc,KAAK,IAAI,GAExB;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAYpX,GAAO,KAAK,QAAQ,UAAU;AAAA,MACpD,MAAMoN;AAAA,MACN,OAAOC;AAAA,IACV;AAAA,EACJ;AAAA,EACD,UAAU,SAASxN,GAAM;AACrB,SAAK,MAAMA,EAAK,IAAI,GACpB,KAAK,MAAM,GAAG,GACd,KAAK,MAAMA,EAAK,KAAK;AAAA,EAC7B;AACA,GCjEI8U,KAAOpP,EAA2B,MAClC82B,KAAUh2B,GAAiB,MAE3B6b,KAAmBvN,GAAK;AAE5B,SAAS6nB,GAAWzkB,GAAY;AAC5B,SAAO,KAAK,IAAIA,GAAYskB,GAAQ,kBAAkB,EAAI;AAC9D;AAEA,SAASsE,KAAiB;AACtB,MAAInU,IAAU,KAAK,aAAc;AAEjC,SAAIA,EAAQ,SAAS,SACjB,KAAK,QAAQ,QAAQ,MACrB,KAAK,QAAQ,cAActK,MAC3B,KAAK,MAAO,GAGTsK;AACX;AAEA,IAAAoU,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,SAAS,CAAC,gBAAgB,KAAK;AAAA,IAC/B,OAAO,CAAC,OAAO;AAAA,EAClB;AAAA,EACD,OAAO,WAAW;AACd,QAAI7oB,IAAa,KAAK,QAAQ,YAC1B4V,IAAc,KAAK,QAAQ,YAC3BnB,GACAoQ;AAEJ,WAAI,KAAK,mBACLpQ,IAAU,KAAK,kBAAkBmU,IAAgBnE,EAAU,IAE3DhQ,IAAUgQ,GAAW,KAAK,MAAMzkB,CAAU,GAG9C6kB,IAAQ,KAAK,MAAM,EAAI,GAEhB;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAYjP,GAAa,KAAK,QAAQ,UAAU;AAAA,MAC1D,SAASnB;AAAA,MACT,OAAOoQ;AAAA,IACV;AAAA,EACJ;AAAA,EACD,UAAU,SAAS/8B,GAAM;AACrB,SAAK,KAAKA,EAAK,OAAO,GACtB,KAAK,KAAKA,EAAK,KAAK;AAAA,EACvB;AAAA,EACD,aAAa;AACjB,GCrDAghC,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,UAAU,CAAC;AAAA,MACP;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACH,CAAA;AAAA,EACJ;AAAA,EACD,OAAO,WAAW;AACd,QAAI3S,IAAW,KAAK,aAAa,KAAK,MAAM,QAAQ;AAGpD,WAAI,KAAK,iBAAiBA,CAAQ,MAAM,QACpC,KAAK,MAAM,sBAAsB,GAG9B;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,oBAAoBA,CAAQ;AAAA,MACtC,UAAUA;AAAA,IACb;AAAA,EACJ;AAAA,EACD,UAAU,SAASruB,GAAM;AACrB,SAAK,SAASA,CAAI;AAAA,EAC1B;AACA,GC/BI8U,KAAOpP,EAA2B,MAElCoc,KAAQhN,GAAK,OAEjBmsB,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,UAAU,CAAC;AAAA,MACP;AAAA,MACA;AAAA,IACH,CAAA;AAAA,EACJ;AAAA,EACD,OAAO,WAAW;AAGd,aAFI5S,IAAW,KAAK,WAAY,GAEzB,CAAC,KAAK,QAAQ,OAAK;AAGtB,UAFAA,EAAS,KAAK,KAAK,UAAU,GAEzB,KAAK,QAAQ,cAAcvM,IAAO;AAClC,aAAK,QAAQ,KAAM;AACnB;AAAA,MAChB;AAEY;AAAA,IACZ;AAEQ,WAAO;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,oBAAoBuM,CAAQ;AAAA,MACtC,UAAUA;AAAA,IACb;AAAA,EACJ;AAAA,EACD,UAAU,SAASruB,GAAM;AACrB,SAAK,SAASA,GAAM,WAAW;AAC3B,WAAK,MAAM,GAAG;AAAA,IAC1B,CAAS;AAAA,EACJ;AAAA,EACD,aAAa;AACjB,GCtCIi9B,KAASv3B,EAA2B,KAAK,QAE7Cw7B,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,OAAO;AAAA,EACV;AAAA,EACD,OAAO,WAAW;AACd,WAAO;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAY,KAAK,QAAQ,YAAY,KAAK,QAAQ,QAAQ;AAAA,MACpE,OAAO,KAAK,QAAQjE,EAAM;AAAA,IAC7B;AAAA,EACJ;AAAA,EACD,UAAU,SAASj9B,GAAM;AACrB,SAAK,MAAMA,EAAK,KAAK;AAAA,EAC7B;AACA,GCjBI8U,KAAOpP,EAA2B,MAElCkS,KAAa9C,GAAK,YAClB+C,KAAU/C,GAAK,SACf2nB,KAAY3nB,GAAK,WACjB0pB,KAAM1pB,GAAK,KACXwpB,KAAMxpB,GAAK,KACXyM,KAAkB;AAEtB,SAASob,GAAWzkB,GAAY;AAC5B,SAAO,KAAK,IAAIA,GAAY,MAAM,EAAK;AAC3C;AAEA,IAAAipB,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,UAAU,CAAC;AAAA,MACP;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACH,CAAA;AAAA,EACJ;AAAA,EACD,OAAO,WAAW;AAMd,aALIhhC,IAAQ,KAAK,QAAQ,YACrBkuB,IAAW,KAAK,WAAY,GAC5BtqB,GAGG,CAAC,KAAK,QAAQ,OAAK;AACtB,cAAQ,KAAK,QAAQ,WAAS;AAAA,QAC1B,KAAK6T;AACD,eAAK,QAAQ,KAAM;AACnB;AAAA,QAEJ,KAAKC;AAED,cAAI,KAAK,QAAQ,OAAO,WAAW,KAAK,QAAQ,aAAa,CAAC,MAAM0J,IAAiB;AACjF,iBAAK,QAAQ,KAAM;AACnB;AAAA,UACxB;AAEoB,UAAAxd,IAAQ,KAAK,QAAS;AACtB;AAAA,QAEJ,KAAKy6B;AACD,UAAAz6B,IAAQ,KAAK,IAAK;AAClB;AAAA,QAEJ,KAAKu6B;AACD,UAAAv6B,IAAQ,KAAK,IAAK;AAClB;AAAA,QAKJ,KAAK04B;AACD,UAAA14B,IAAQ,KAAK,kBAAkB,KAAK,QAAQ44B,EAAU;AACtD;AAAA,QAGJ;AACI,UAAA54B,IAAQ,KAAK,kBAAkB,KAAK,MAAM44B,EAAU;AAAA,MACxE;AAEY,MAAAtO,EAAS,KAAKtqB,CAAK;AAAA,IAC/B;AAEQ,WAAO;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAY5D,GAAO,KAAK,QAAQ,UAAU;AAAA,MACpD,UAAUkuB;AAAA,IACb;AAAA,EACJ;AAAA,EACD,UAAU,SAASruB,GAAM;AACrB,SAAK,SAASA,CAAI;AAAA,EACrB;AAAA,EACD,aAAa;AACjB,GChFI8U,KAAOpP,EAA2B,MAElCiX,KAAQ7H,GAAK,OACb+M,KAAW,IACXS,KAAe;AAEnB,SAAS8e,KAA0B;AAC/B,EAAI,KAAK,QAAQ,cAAczkB,MAC3B,KAAK,QAAQ,QAAQkF,EAAQ,MAAM,MACnC,KAAK,MAAM,oCAAoC,GAGnD,KAAK,QAAQ,KAAM;AACvB;AAUA,IAAAwf,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,MAAM;AAAA,EACT;AAAA,EACD,OAAO,WAAW;AACd,QAAIlhC,IAAQ,KAAK,QAAQ;AAEzB,WAAI,KAAK,QAAQ,QAAQmiB,EAAY,KACjC,KAAK,QAAQ,KAAM,GACnB8e,GAAwB,KAAK,IAAI,MAEjCA,GAAwB,KAAK,IAAI,GAE7B,KAAK,QAAQ,QAAQ9e,EAAY,MACjC,KAAK,QAAQ,KAAM,GACnB8e,GAAwB,KAAK,IAAI,KAIlC;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAYjhC,GAAO,KAAK,QAAQ,UAAU;AAAA,MACpD,MAAM,KAAK,QAAQ,eAAeA,CAAK;AAAA,IAC1C;AAAA,EACJ;AAAA,EACD,UAAU,SAASH,GAAM;AACrB,SAAK,MAAMA,EAAK,IAAI;AAAA,EAC5B;AACA,GCpDIoV,KAAa1P,EAA2B,YACxCiR,KAAUjR,EAA2B,SACrCoP,KAAOpP,EAA2B,MAClCqP,KAAOrP,EAA2B,MAElCiX,KAAQ7H,GAAK,OACb8H,KAAS9H,GAAK,QACd+H,KAAY/H,GAAK,WACjBgI,KAAW,IACXrC,KAAc,IACdkD,KAAe,IACfC,KAAI;AAER,SAAS0jB,GAAex8B,GAAQiZ,GAAW;AACvC,WAASzQ,IAAM,KAAK,QAAQ,aAAaxI,GAAQ2vB,IAAM,GAAGnnB,IAAM,KAAK,QAAQ,UAAUA,KAAO;AAC1F,QAAI6H,IAAO,KAAK,QAAQ,OAAO,WAAW7H,CAAG;AAE7C,QAAI6H,MAASsF,MAAesD,KAAa0W,MAAQ;AAC7C,aAAI6M,GAAe,KAAK,MAAMx8B,IAAS2vB,IAAM,GAAG,EAAK,MAAM,KACvD,KAAK,MAAO,GAGT;AAGX,IAAKrf,GAAWD,CAAI,KAChB,KAAK;AAAA,MACD4I,KAAa0W,MAAQ,IACf,iBAAiBA,IAAM,IAAI,kBAAkB,MAAM,iBAClDA,IAAM,IAAI,0BAA0B;AAAA,MAC3CnnB;AAAA,IACH,GAGD,EAAEmnB,IAAM,KACR,KAAK,MAAM,uBAAuBnnB,CAAG;AAAA,EAEjD;AAEI,cAAK,QAAQ,KAAM,GACZmnB;AACX;AAEA,SAAS8M,GAAwB3+B,GAAK;AAGlC,WAFI4+B,IAAQ,GAEL,KAAK,QAAQ,QAAQ7jB,EAAY;AACpC,IAAI,EAAE6jB,IAAQ5+B,KACV,KAAK,MAAM,yBAAyB,GAGxC,KAAK,QAAQ,KAAM;AAE3B;AAEA,SAASib,GAAW1I,GAAM;AACtB,EAAI,KAAK,QAAQ,OAAO,WAAW,KAAK,QAAQ,UAAU,MAAMA,KAC5D,KAAK,MAAMJ,GAAKI,CAAI,IAAI,cAAc;AAE9C;AAqBA,SAASssB,KAAmB;AACxB,MAAIC,IAAY;AAIhB,MAAI,KAAK,QAAQ,QAAQ5kB,EAAQ,GAAG;AAGhC,QAFA,KAAK,QAAQ,KAAM,GAEf,KAAK,QAAQ,cAAcH,IAAO;AAClC,MAAA+kB,IAAYJ,GAAe,KAAK,MAAM,GAAG,EAAI,GACzCI,IAAY,KACZH,GAAwB,KAAK,MAAM,IAAIG,CAAS;AAEpD;AAAA,IACZ;AAEQ,QAAI,KAAK,QAAQ,QAAQ/jB,EAAY,GAAG;AACpC,WAAK,QAAQ,KAAM,GACnB4jB,GAAwB,KAAK,MAAM,CAAC;AACpC;AAAA,IACZ;AAEQ,SAAK,MAAM,wCAAwC;AACnD;AAAA,EACR;AAKI,MAAI,KAAK,QAAQ,cAAc3kB,IAAQ;AAInC,QAHAiB,GAAW,KAAK,MAAMf,EAAQ,GAC9B4kB,IAAYJ,GAAe,KAAK,MAAM,GAAG,EAAI,GAEzC,KAAK,QAAQ,QAAQ3jB,EAAY,GAAG;AACpC,MAAA4jB,GAAwB,KAAK,MAAM,IAAIG,CAAS;AAChD;AAAA,IACZ;AAEQ,QAAI,KAAK,QAAQ,cAAc7kB,MAC3B,KAAK,QAAQ,cAAcD,IAAQ;AACnC,MAAAiB,GAAW,KAAK,MAAMpD,EAAW,GACjC6mB,GAAe,KAAK,MAAM,GAAG,EAAK;AAClC;AAAA,IACZ;AAEQ;AAAA,EACR;AAGI,MAAI,KAAK,QAAQ,cAAczkB,IAAW;AACtC,IAAAgB,GAAW,KAAK,MAAMf,EAAQ,GAC9B4kB,IAAYJ,GAAe,KAAK,MAAM,GAAG,EAAI,GAEzCI,IAAY,KACZH,GAAwB,KAAK,MAAM,IAAIG,CAAS;AAGpD;AAAA,EACR;AAEI,OAAK,MAAO;AAChB;AAEA,IAAAC,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,OAAO;AAAA,EACV;AAAA,EACD,OAAO,WAAW;AACd,QAAIxhC,IAAQ,KAAK,QAAQ;AAGzB,WAAKwW,GAAQ,KAAK,QAAQ,QAAQxW,GAAOyd,EAAC,KACtC,KAAK,MAAM,eAAe,GAGzBjH,GAAQ,KAAK,QAAQ,QAAQxW,IAAQ,GAAG2c,EAAQ,KACjD,KAAK,MAAM,uBAAuB,GAGtC,KAAK,QAAQ,KAAM,GACnB2kB,GAAiB,KAAK,IAAI,GAEnB;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAYthC,GAAO,KAAK,QAAQ,UAAU;AAAA,MACpD,OAAO,KAAK,QAAQ,eAAeA,CAAK;AAAA,IAC3C;AAAA,EACJ;AAAA,EACD,UAAU,SAASH,GAAM;AACrB,SAAK,MAAMA,EAAK,KAAK;AAAA,EAC7B;AACA,GC5KI6V,KAAenQ,EAA2B,cAC1CoR,KAASpR,EAA2B,QACpCoP,KAAOpP,EAA2B,MAElC4oB,KAAWxZ,GAAK,UAChByZ,KAAMzZ,GAAK,KACX8M,KAAmB9M,GAAK,kBAG5B8sB,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,OAAO,CAAC,UAAU,KAAK;AAAA,EAC1B;AAAA,EACD,OAAO,WAAW;AACd,QAAIzhC,IAAQ,KAAK,QAAQ,YACrBjB;AAEJ,YAAQ,KAAK,QAAQ,WAAS;AAAA,MAC1B,KAAKqvB;AAID,iBAHIsT,IAAW1hC,IAAQ,GACnB2hC,IAAS,KAAK,QAAQ,WAAW,GAE9BD,IAAWC,KAAUjsB,GAAa,KAAK,QAAQ,OAAO,WAAWgsB,CAAQ,CAAC;AAC7E,UAAAA;AAGJ,eAAOA,IAAWC,KAAUjsB,GAAa,KAAK,QAAQ,OAAO,WAAWisB,IAAS,CAAC,CAAC;AAC/E,UAAAA;AAGJ,QAAA5iC,IAAQ;AAAA,UACJ,MAAM;AAAA,UACN,KAAK,KAAK,YAAY2iC,GAAUC,CAAM;AAAA,UACtC,OAAO,KAAK,QAAQ,OAAO,UAAUD,GAAUC,CAAM;AAAA,QACxD,GAED,KAAK,IAAIvT,EAAG;AACZ;AAAA,MAEJ,KAAKD;AACD,QAAKxX,GAAO,KAAK,QAAQ,QAAQ,KAAK,QAAQ,YAAY,KAAK,QAAQ,UAAU,MAAM,KACnF,KAAK,MAAM,6BAA6B,GAG5C,KAAK,IAAIwX,EAAQ,GACjB,KAAK,QAAQ,OAAQ,GACrBpvB,IAAQ,KAAK,OAAQ,GACrB,KAAK,QAAQ,OAAQ,GACrB,KAAK,IAAI0iB,EAAgB;AACzB;AAAA,MAEJ;AACI,aAAK,MAAM,6BAA6B;AAAA,IACxD;AAEQ,WAAO;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAYzhB,GAAO,KAAK,QAAQ,UAAU;AAAA,MACpD,OAAOjB;AAAA,IACV;AAAA,EACJ;AAAA,EACD,UAAU,SAASc,GAAM;AACrB,SAAK,MAAM,KAAK,GAChB,KAAK,MAAM,GAAG,GACd,KAAK,KAAKA,EAAK,KAAK,GACpB,KAAK,MAAM,GAAG;AAAA,EACtB;AACA,GCpEA+hC,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,UAAU,CAAC,CAAE,CAAA;AAAA,EAChB;AAAA,EACD,OAAO,WAAW;AACd,QAAI5hC,IAAQ,KAAK,QAAQ,YACrBkuB,IAAW,KAAK,aAAa,KAAK,MAAM,KAAK;AAEjD,WAAO;AAAA,MACH,MAAM;AAAA,MACN,KAAK,KAAK,YAAYluB,GAAO,KAAK,QAAQ,UAAU;AAAA,MACpD,UAAUkuB;AAAA,IACb;AAAA,EACJ;AAAA,EACD,UAAU,SAASruB,GAAM;AACrB,SAAK,SAASA,CAAI;AAAA,EAC1B;AACA,GClBI4X,KAAalS,EAA2B,KAAK,YAC7C2b,KAAQ,OAAO,OAAO;AAAA,EACtB,MAAM;AAAA,EACN,KAAK;AAAA,EACL,OAAO;AACX,CAAC,GAEDua,KAAiB;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,IACP,OAAO;AAAA,EACV;AAAA,EACD,OAAO,WAAW;AACd,gBAAK,IAAIhkB,EAAU,GACZyJ;AAAA,EAOV;AAAA,EACD,UAAU,SAASrhB,GAAM;AACrB,SAAK,MAAMA,EAAK,KAAK;AAAA,EAC7B;AACA,GCzBAA,KAAiB;AAAA,EACb,SAAS0F;AAAAA,EACT,QAAQc;AAAAA,EACR,eAAegB;AAAAA,EACf,mBAAmBE;AAAAA,EACnB,OAAOC;AAAAA,EACP,UAAUwjB;AAAAA,EACV,KAAKC;AAAAA,EACL,KAAKC;AAAAA,EACL,eAAeC;AAAAA,EACf,YAAYC;AAAAA,EACZ,SAASC;AAAAA,EACT,aAAaE;AAAAA,EACb,iBAAiB8O;AAAAA,EACjB,WAAWwH;AAAAA,EACX,UAAUC;AAAAA,EACV,MAAMC;AAAAA,EACN,YAAYC;AAAAA,EACZ,YAAYC;AAAAA,EACZ,cAAcC;AAAAA,EACd,YAAYC;AAAAA,EACZ,gBAAgBC;AAAAA,EAChB,KAAKC;AAAAA,EACL,QAAQC;AAAAA,EACR,UAAUC;AAAAA,EACV,aAAaC;AAAAA,EACb,YAAYC;AAAAA,EACZ,qBAAqBC;AAAAA,EACrB,uBAAuBC;AAAAA,EACvB,OAAOC;AAAAA,EACP,KAAKC;AAAAA,EACL,MAAMC;AAAAA,EACN,UAAUC;AAAAA,EACV,cAAcC;AAAAA,EACd,QAAQC;AAAAA,EACR,YAAYC;AAAAA,EACZ,cAAcC;AAAAA,EACd,cAAcC;AAAAA,EACd,KAAKC;AAAAA,EACL,OAAOC;AAAAA,EACP,YAAYC;AAChB,GCzCIt6B,KAAO1D,IAEXskB,KAAiB;AAAA,EACb,SAAS;AAAA,EACT,OAAO5gB,GAAK;AAAA,EACZ,SAASA,GAAK;AAAA,EACd,YAAYA,GAAK;AAAA,EACjB,MAAM5C;AACV,GCRImQ,KAAUjR,EAA2B,SACrCoR,KAASpR,EAA2B,QACpCoP,KAAOpP,EAA2B,MAElCiX,KAAQ7H,GAAK,OACbmoB,KAASnoB,GAAK,QACd8H,KAAS9H,GAAK,QACdwZ,KAAWxZ,GAAK,UAChByZ,KAAMzZ,GAAK,KACX0Z,KAAO1Z,GAAK,MACZ+H,KAAY/H,GAAK,WACjB2Z,KAAa3Z,GAAK,YAClB6M,KAAkB7M,GAAK,iBACvBqN,KAAoBrN,GAAK,mBACzBgN,KAAQhN,GAAK,OACb4H,KAAQ5H,GAAK,OACb0M,KAAa,IACbK,KAAW,IACX/E,KAAW,IACXrC,KAAc,IACdmkB,KAAU,IACVhhB,KAAI,KAER+lB,KAAiB,SAA2B75B,GAAS;AACjD,UAAQ,KAAK,QAAQ,WAAS;AAAA,IAC1B,KAAK0kB;AACD,aAAO,KAAK,KAAM;AAAA,IAEtB,KAAK1M;AACD,aAAAhY,EAAQ,QAAQ,MAChBA,EAAQ,gBAAgB,IACjB,KAAK,SAAU;AAAA,IAE1B,KAAK6X;AACD,aAAO,KAAK,YAAY,KAAK,cAAc7X,EAAQ,UAAU;AAAA,IAEjE,KAAKqY;AACD,aAAO,KAAK,SAAS,KAAK,cAAcrY,EAAQ,UAAU;AAAA,IAE9D,KAAKmzB;AACD,aAAO,KAAK,OAAQ;AAAA,IAExB,KAAKpgB;AACD,aAAO,KAAK,UAAW;AAAA,IAE3B,KAAK4R;AACD,aAAO,KAAK,WAAY;AAAA,IAE5B,KAAK7R;AACD,aAAO,KAAK,OAAQ;AAAA,IAExB,KAAK0R;AACD,aAAOxX,GAAO,KAAK,QAAQ,QAAQ,KAAK,QAAQ,YAAY,KAAK,QAAQ,UAAU,MAAM,IACnF,KAAK,IAAG,IACR,KAAK,SAAS,KAAK,cAAchN,EAAQ,UAAU;AAAA,IAE7D,KAAKykB;AACD,aAAO,KAAK,IAAK;AAAA,IAErB,KAAK5R;AAED,aAAIhG,GAAQ,KAAK,QAAQ,QAAQ,KAAK,QAAQ,YAAYiH,EAAC,KACvDjH,GAAQ,KAAK,QAAQ,QAAQ,KAAK,QAAQ,aAAa,GAAGmG,EAAQ,IAC3D,KAAK,aAAc,IAEnB,KAAK,WAAY;AAAA,IAGhC,KAAKJ;AACD,UAAIvH,IAAO,KAAK,QAAQ,OAAO,WAAW,KAAK,QAAQ,UAAU;AAEjE,UAAIA,MAASypB,MACTzpB,MAAS0M,MACT1M,MAAS2H,MACT3H,MAASsF;AACT,eAAO,KAAK;AAKhB,MAAItF,MAASqM,MACT,KAAK,MAAM,iCAAiC,KAAK,QAAQ,aAAa,CAAC;AAG3E;AAAA,EACZ;AACA,GCtFAoiB,KAAiB;AAAA,EACb,SAASl+B;AACb,GCFIoP,KAAOpP,EAA2B,MAElCgX,KAAQ5H,GAAK,OACb6H,KAAQ7H,GAAK,OACb+H,KAAY/H,GAAK,WACjB2Z,KAAa3Z,GAAK,YAClB8H,KAAS9H,GAAK,QACd0Z,KAAO1Z,GAAK,MACZooB,KAAQpoB,GAAK,OACbqN,KAAoBrN,GAAK,mBACzB0M,KAAa,IACbK,KAAW,IACX/E,KAAW,IACX8hB,KAAU,IACVF,KAAW,IACXzc,KAAkB,IAClBK,KAAe,KACfgb,KAAQ;AAEZ,SAASuG,GAAQ/5B,GAAS;AACtB,UAAQ,KAAK,QAAQ,WAAS;AAAA,IAC1B,KAAKqY;AACD,aAAO,KAAK,kBAAmB;AAAA,IAEnC,KAAKqM;AACD,aAAO,KAAK,WAAY;AAAA,IAE5B,KAAK0O;AACD,aAAI,KAAK,QAAQ,WAAW,CAAC,MAAMA,KACxB,KAAK,sBAAuB,IAE5B,KAAK,oBAAqB;AAAA,IAGzC,KAAKvgB;AACD,aAAO,KAAK,aAAc;AAAA,IAE9B,KAAKC;AAAA,IACL,KAAK6R;AACD,aAAO,KAAK,WAAY;AAAA,IAE5B,KAAK5R;AAED,MAAI,KAAK,QAAQ,OAAO,WAAW,KAAK,QAAQ,UAAU,MAAM6hB,MAC5D,KAAK,MAAM,0BAA0B,KAAK,QAAQ,aAAa,CAAC;AAEpE;AAAA,IAEJ,KAAKhiB;AACD,UAAIvH,IAAO,KAAK,QAAQ,OAAO,WAAW,KAAK,QAAQ,UAAU;AAEjE,cAAQA,GAAI;AAAA,QACR,KAAK2H;AAAA,QACL,KAAKmF;AAAA,QACL,KAAKqb;AACD,iBAAAxzB,EAAQ,QAAQ,MAChBA,EAAQ,gBAAgB,IACjB,KAAK,WAAY;AAAA,QAE5B,KAAK80B;AACD,iBAAO,KAAK,WAAY;AAAA,QAE5B,KAAKF;AACD,iBAAO,KAAK,cAAe;AAAA,QAE/B,KAAK7c;AAAA,QACL,KAAKS;AACD,iBAAO,KAAK,aAAc;AAAA,QAE9B,KAAKd;AACD,iBAAO,KAAK,WAAY;AAAA,MAC5C;AAEY;AAAA,EACZ;AACA;AAEA,IAAA6e,KAAiB;AAAA,EACb,SAASwD;AACb,GC7EAC,KAAiB,WAAW;AACxB,SAAO,KAAK;AAAA,IACR,KAAK,IAAI,KAAK,QAAQ,YAAY,MAAM,EAAK;AAAA,EAChD;AACL,GCNIhvB,KAAOpP,EAA2B,MAClC82B,KAAUh2B,GAAuB,MAEjCsb,KAAQhN,GAAK,OACb8C,KAAa9C,GAAK,YAGtBivB,KAAiB,WAAW;AACxB,MAAI1V,IAAW,KAAK,WAAY;AAShC,MAPA,KAAK,QAAQ,OAAQ,GAGrBA,EAAS,KAAK,KAAK,YAAY,GAE/B,KAAK,QAAQ,OAAQ,GAEjB,KAAK,QAAQ,cAAcvM,IAAO;AAClC,IAAAuM,EAAS,KAAK,KAAK,UAAU;AAE7B,UAAM2V,IAAa,KAAK,QAAQ,YAC1B9kC,IAAQ,KAAK,sBACb,KAAK,MAAM,IAAI,IACf,KAAK,IAAI,KAAK,QAAQ,YAAYs9B,GAAQ,4BAA4B,EAAK;AAEjF,QAAIt9B,EAAM,SAAS,WAAWA,EAAM,SAAS;AACzC,eAAS4F,IAASk/B,IAAa,KAAK,QAAQ,YAAYl/B,KAAU,GAAGA;AACjE,YAAI,KAAK,QAAQ,WAAWA,CAAM,MAAM8S,IAAY;AAChD,UAAA1Y,EAAM,SAAS,WAAW;AAAA,YACtB,MAAM;AAAA,YACN,KAAK;AAAA,YACL,OAAO;AAAA,UAC/B,CAAqB;AACD;AAAA,QACpB;AAAA;AAIQ,IAAAmvB,EAAS,KAAKnvB,CAAK;AAAA,EAC3B;AAEI,SAAOmvB;AACX,GC1CAnvB,KAAiB;AAAA,EACb,SAASwG;AAAAA,EACT,YAAcc;AAAAA,EACd,KAAOgB;AACX,GCJAy8B,KAAiB;AAAA,EACb,eAAev+B;AAAAA,EACf,UAAUc;AAAAA,EACV,OAAOgB;AACX,GCJA8K,KAAiB;AAAA,EACb,OAAO;AAAA,IACH,SAAS;AAAA,IACT,OAAO,WAAW;AACd,aAAO,KAAK,MAAM,EAAI;AAAA,IAClC;AAAA,EACA;AACA,GCPIwC,KAAOpP,EAA2B,MAElCu3B,KAASnoB,GAAK,QACd6H,KAAQ7H,GAAK,OACbyZ,KAAMzZ,GAAK,KACXwZ,KAAWxZ,GAAK,UAChB6M,KAAkB7M,GAAK,iBAE3BovB,KAAiB;AAAA,EACb,OAAO;AAAA,IACH,SAAS,WAAW;AAChB,UAAI7V,IAAW,KAAK,WAAY;AAIhC,cAFA,KAAK,QAAQ,OAAQ,GAEb,KAAK,QAAQ,WAAS;AAAA,QAC1B,KAAK4O;AACD,UAAA5O,EAAS,KAAK,KAAK,QAAQ;AAC3B;AAAA,QAEJ,KAAKE;AAAAA,QACL,KAAKD;AACD,UAAAD,EAAS,KAAK,KAAK,KAAK;AACxB;AAAA,QAEJ;AACI,eAAK,MAAM,6BAA6B;AAAA,MAC5D;AAEY,cAAI,KAAK,gBAAgB,CAAC,MAAM1R,MAC5B,KAAK,gBAAgB,CAAC,MAAMgF,QAC5B0M,EAAS,KAAK,KAAK,YAAY,GAC/BA,EAAS,KAAK,KAAK,gBAAgB,IAGhCA;AAAA,IACV;AAAA,IACD,OAAO;AAAA,EACf;AACA,GCvCA8V,KAAiB;AAAA,EACb,OAAO;AAAA,IACH,SAAS,WAAW;AAChB,aAAO,KAAK;AAAA,QACR,KAAK,eAAc;AAAA,MACtB;AAAA,IACJ;AAAA,IACD,OAAO,WAAW;AACd,aAAO,KAAK,MAAM,EAAK;AAAA,IACnC;AAAA,EACA;AACA,GCXA/4B,KAAiB;AAAA,EACb,OAAO;AAAA,IACH,SAAS,WAAW;AAChB,aAAO,KAAK;AAAA,QACR,KAAK,aAAY;AAAA,MACpB;AAAA,IACJ;AAAA,IACD,OAAO,WAAW;AACd,aAAO,KAAK,MAAM,EAAI;AAAA,IAClC;AAAA,EACA;AACA,GCXI0J,KAAOpP,EAA2B,MAElCkS,KAAa9C,GAAK,YAClB+C,KAAU/C,GAAK,SACf6H,KAAQ7H,GAAK,OACbwZ,KAAWxZ,GAAK,UAChBooB,KAAQpoB,GAAK,OACb6M,KAAkB7M,GAAK;AAE3B,SAAS6nB,KAAa;AAClB,SAAO,KAAK;AAAA,IACR,KAAK,IAAI,KAAK,QAAQ,YAAY,MAAM,EAAK;AAAA,EAChD;AACL;AAEA,SAASyH,KAAc;AAGnB,SAFA,KAAK,QAAQ,OAAQ,GAEjB,KAAK,QAAQ,cAAcznB,MAC3B,KAAK,gBAAgB,CAAC,MAAMugB,KACrB,KAAK;AAAA,IACR,KAAK,YAAW;AAAA,EACnB,IAGEmB,GAAa,KAAK,IAAI;AACjC;AAEA,SAASA,KAAe;AACpB,MAAIhQ,IAAW,KAAK,WAAY,GAC5B4R,IAAQ,MACRl8B;AAEJ,OAAK,QAAQ,OAAQ;AAErB,EAAAsc;AACA,WAAO,CAAC,KAAK,QAAQ,OAAK;AACtB,cAAQ,KAAK,QAAQ,WAAS;AAAA,QAC1B,KAAKzI;AACD,UAAAqoB,IAAQ,KAAK,WAAY;AACzB;AAAA,QAEJ,KAAKpoB;AACD,eAAK,QAAQ,KAAM;AACnB;AAAA,QAEJ,KAAKyW;AACD,UAAAvqB,IAAQ,KAAK,SAAS44B,IAAY,KAAK,MAAM,aAAa;AAC1D;AAAA,QAEJ,KAAKhgB;AACD,UAAA5Y,IAAQ,KAAK,WAAY;AACzB;AAAA,QAEJ,KAAK4d;AACD,UAAA5d,IAAQ,KAAK,YAAYqgC,IAAa,KAAK,MAAM,aAAa;AAC9D;AAAA,QAEJ;AACI,gBAAM/jB;AAAA,MACtB;AAEQ,MAAI4f,MAAU,SACV5R,EAAS,KAAK4R,CAAK,GACnBA,IAAQ,OAGZ5R,EAAS,KAAKtqB,CAAK;AAAA,IAC3B;AAEI,SAAOsqB;AACX;AAEA,IAAAgW,KAAiB;AAAA,EACb,OAAO;AAAA,IACH,SAAS,WAAW;AAChB,UAAIhW,IAAWgQ,GAAa,KAAK,IAAI;AAErC,aAAI,KAAK,iBAAiBhQ,CAAQ,MAAM,QACpC,KAAK,MAAM,uBAAuB,GAG/BA;AAAA,IACV;AAAA,IACD,OAAO,WAAW;AACd,aAAO,KAAK,MAAM,EAAK;AAAA,IACnC;AAAA,EACA;AACA,GCxFAtC,KAAiB;AAAA,EACb,aAAarmB;AAAAA,EACb,QAAUc;AAAAA,EACV,OAASgB;AAAAA,EACT,MAAQE;AAAAA,EACR,UAAYC;AAChB,GCNA28B,KAAiB;AAAA,EACb,OAAO,WAAW;AACd,WAAO,KAAK;AAAA,MACR,KAAK,WAAU;AAAA,IAClB;AAAA,EACT;AACA,GCNAlQ,KAAiB;AAAA,EACb,OAAO,WAAW;AACd,WAAO,KAAK;AAAA,MACR,KAAK,aAAY;AAAA,IACpB;AAAA,EACT;AACA,GCNAmQ,KAAiB;AAAA,EACb,OAAO,WAAW;AACd,WAAO,KAAK;AAAA,MACR,KAAK,WAAU;AAAA,IAClB;AAAA,EACT;AACA,GCNAC,KAAiB;AAAA,EACb,OAAO,WAAwB;AAC3B,WAAO,KAAK;AAAA,MACR,KAAK,aAAY;AAAA,IACpB;AAAA,EACT;AACA,GCNAC,KAAiB/+B,ICAjBg/B,KAAiBh/B,ICAbi/B,KAAkB,IAEtBC,KAAiB;AAAA,EACb,OAAO,WAA2B;AAC9B,WAAO,KAAK;AAAA,MACR,KAAK,IAAID,EAAe;AAAA,IAC3B;AAAA,EACT;AACA,GCRAE,KAAiBn/B,ICAjBo/B,KAAiBp/B,ICAbq/B,KAAqB,IAEzBC,KAAiB;AAAA,EACb,OAAO,WAAe;AAClB,WAAO,KAAK;AAAA,MACR,KAAK,IAAID,EAAkB;AAAA,IAC9B;AAAA,EACT;AACA,GCRAE,KAAiBv/B,ICAjBw/B,KAAiBx/B,ICAjBy/B,KAAiB;AAAA,EACb,OAAO,WAA4B;AAC/B,WAAO,KAAK;AAAA,MACR,KAAK,SAAQ;AAAA,IAChB;AAAA,EACT;AACA,GCNArW,KAAiB;AAAA,EACb,KAAOppB;AAAAA,EACP,KAAOc;AAAAA,EACP,MAAQgB;AAAAA,EACR,SAAWE;AAAAA,EACX,KAAOC;AAAAA,EACP,aAAawjB;AAAAA,EACb,kBAAkBC;AAAAA,EAClB,oBAAoBC;AAAAA,EACpB,eAAeC;AAAAA,EACf,SAAWC;AACf,GCXAwD,KAAiB;AAAA,EACb,cAAc;AAAA,IACV,SAAS;AAAA,IACT,YAAY;AAAA,IACZ,QAAQ;AAAA,IACR,eAAe,SAAS5nB,GAAS;AAC7B,aAAO,KAAK,cAAcA,EAAQ,SAAS,OAAOA,EAAQ,MAAM,IAAI,IAAI;AAAA,IAC3E;AAAA,IACD,gBAAgB;AAAA,IAChB,YAAY;AAAA,IACZ,MAAM;AAAA,IACN,cAAc;AAAA,IACd,UAAU;AAAA,IACV,OAAO,WAAW;AACd,aAAO,KAAK,MAAM,EAAI;AAAA,IACzB;AAAA,IACD,iBAAiB;AAAA,IACjB,aAAa;AAAA,IACb,OAAO;AAAA,EACV;AAAA,EACD,OAAOzB;AAAAA,EACP,QAAQc;AAAAA,EACR,QAAQgB;AAAAA,EACR,MAAME;AACV,GCxBAiD,KAAiB;AAAA,EACb,MAAMjF;AACV;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACFA,SAAS0/B,KAAQ;AAGb,WAFI1+B,IAAO,CAAE,GAEJ1H,IAAI,GAAGA,IAAI,UAAU,QAAQA,KAAK;AACvC,QAAI2H,IAAM,UAAU3H,CAAC;AACrB,aAAS4H,KAAOD;AACZ,MAAAD,EAAKE,CAAG,IAAID,EAAIC,CAAG;AAAA,EAE/B;AAEI,SAAOF;AACX;AAEA2+B,GAAc,UAAG3/B,GAAoB;AAAA,EACjC0/B;AAAA,IACI5+B;AAAAA,IACAgB;AAAAA,IACAE;AAAAA,EACR;AACA;AACsB29B,GAAA,QAAA,UAAG19B,GAA8B;qBCpBvD29B,KAAiB5/B;;ACIjB,IAAA6/B,KAAA,MAAY;AAAA,EACX,YAAYxT,GAAK1nB,GAAO;AAEvB,IAAIA,IACH,KAAK,QAAQA,KAEb,KAAK,QAAQ,CAAE,GACf,KAAK,MAAM,QAAQ,IAAIR,EAAK,IAAI,GAChC,KAAK,MAAM,WAAW,IAAIA,EAAK,IAAI,GACnC,KAAK,MAAM,YAAY,IAAIA,EAAK,IAAI,GACpC,KAAK,MAAM,SAAS,IAAIA,EAAK,IAAI,GACjC,KAAK,MAAM,gBAAgB,IAAIA,EAAK,IAAI,GACxC,KAAK,MAAM,aAAa,IAAIA,EAAK,IAAI,GACrC,KAAK,MAAM,mBAAmB,IAAIA,EAAK,IAAI,GAE3C,KAAK,MAAM,YAAY,IAAIA,EAAK,IAAI,GACpC,KAAK,MAAM,WAAW,IAAIA,EAAK,IAAI,GAEnC,KAAK,MAAM,kBAAkB,IAAIA,EAAK,IAAI,GAC1C,KAAK,MAAM,iBAAiB,IAAIA,EAAK,IAAI,GACzC,KAAK,MAAM,gBAAgB,IAAIA,EAAK,IAAI;AAGzC,QAAI;AACH,WAAK,MAAM,IAAI,IAAIkoB,GAAK,OAAO,SAAS,IAAI;AAAA,IAC5C,QAAW;AACX,WAAK,MAAM,IAAI,IAAI,OAAO,SAAS,IAAI;AAAA,IAC1C;AAAA,EACA;AAAA;AAAA,EAKC,MAAM,MAAMyT,GAAM;AACjB,gBAAK,OAAOA,GAEZ,MAAM,KAAK,MAAM,gBAAgB,QAAQ,KAAK,MAAM,IAAI,GAGxD,KAAK,MAAMC,EAAQ,MAAM,KAAK,KAAK,GAEnC,MAAM,KAAK,MAAM,eAAe,QAAQ,KAAK,GAAG,GAGhD,KAAK,YAAY,KAAK,GAAG,GAGzB,KAAK,KAAK9mC,GAAM,GAIhB,KAAK,WAAW,KAAK,GAAG,GAExB,KAAK,WAAW,CAAE,GAGlB,KAAK,KAAK,KAAK,GAAG,GAClB,KAAK,MAAM,KAAK,GAAG,GACnB,KAAK,QAAQ,KAAK,GAAG,GAErB,MAAM,KAAK,MAAM,cAAc,QAAQ,KAAK,KAAK,IAAI,GAG9C,KAAK;AAAA,EACd;AAAA,EAIC,WAAW+mC,GAAM;AAChB,QAAIC,IAAW,KAAK,IAAI,SAAS,WAAWD,CAAI;AAEhD,gBAAK,aAAaA,CAAI,GAEfC;AAAA,EACT;AAAA,EAEC,KAAK1b,GAAK;AACT,IAAAwb,EAAQ,KAAKxb,GAAK;AAAA,MACjB,OAAO;AAAA,MACP,OAAO,CAACjqB,GAAMoT,GAAMG,MAAS;AAC5B,aAAK,MAAM,MAAM,QAAQvT,GAAMoT,GAAMG,CAAI;AAAA,MAC7C;AAAA,IACA,CAAG;AAAA,EACH;AAAA,EAEC,QAAQ0W,GAAK;AACZ,IAAAwb,EAAQ,KAAKxb,GAAK;AAAA,MACjB,OAAO;AAAA,MACP,OAAO,CAACjqB,GAAMoT,GAAMG,MAAS;AAC5B,cAAMqyB,IAAWH,EAAQ,QAAQzlC,EAAK,IAAI,EAAE;AAE5C,QAAI4lC,MAAa,WAChB,KAAK,MAAM,SAAS,QAAQ5lC,GAAMoT,GAAMG,CAAI,GAC5C,KAAK,aAAavT,GAAMoT,GAAMG,CAAI,IAG/BqyB,MAAa,YAChB,KAAK,MAAM,UAAU,QAAQ5lC,GAAMoT,GAAMG,CAAI,GAC7C,KAAK,aAAavT,GAAMoT,GAAMG,CAAI,IAG/BqyB,MAAa,aAChB,KAAK,MAAM,SAAS,QAAQ5lC,GAAMoT,GAAMG,CAAI,GAC5C,KAAK,QAAQvT,GAAMoT,GAAMG,CAAI;AAAA,MAElC;AAAA,IACA,CAAG;AAAA,EACH;AAAA,EAGC,MAAM0W,GAAK;AACV,IAAAwb,EAAQ,KAAKxb,GAAK;AAAA,MACjB,OAAO;AAAA,MACP,OAAO,CAAC4b,GAAUC,GAAUC,MAAa;AAExC,aAAK,MAAM,OAAO,QAAQF,GAAUC,GAAUC,CAAQ,GACtD,KAAK,aAAaF,GAAUC,GAAUC,CAAQ,GAC9C,KAAK,WAAWF,GAAUC,GAAUC,CAAQ;AAAA,MAEhD;AAAA,IACA,CAAG;AAAA,EACH;AAAA,EAEC,aAAaF,GAAUC,GAAUC,GAAU;AAC1C,IAAAN,EAAQ,KAAKI,GAAU;AAAA,MACtB,OAAO;AAAA,MACP,OAAO,CAACG,GAAiBC,GAAOC,MAAU;AAEzC,aAAK,MAAM,cAAc,QAAQF,GAAiBC,GAAOC,GAAO,EAAC,UAAAL,GAAU,UAAAC,GAAU,UAAAC,EAAQ,CAAC,GAE1FC,EAAgB,aAAa,aAChCP,EAAQ,KAAKO,GAAiB;AAAA,UAC7B,OAAO;AAAA,UACP,OAAO,CAACG,GAAUC,GAAOC,MAAU;AAClC,iBAAK,MAAM,UAAU,QAAQF,GAAUC,GAAOC,GAAO,EAAC,iBAAAL,GAAiB,OAAAC,GAAO,OAAAC,EAAK,GAAG,EAAC,UAAAL,GAAU,UAAAC,GAAU,UAAAC,EAAQ,CAAC;AAAA,UAC3H;AAAA,QACA,CAAM;AAAA,MAGN;AAAA,IACA,CAAG;AAAA,EACH;AAAA;AAAA,EAGC,WAAWF,GAAUC,GAAUC,GAAU;AACxC,IAAAN,EAAQ,KAAKI,GAAU;AAAA,MACtB,OAAO;AAAA,MACP,OAAO,CAACS,GAAYC,GAAYC,MAAe;AAC9C,aAAK,MAAM,WAAW,QAAQF,GAAYC,GAAYC,GAAY,EAAC,UAAAX,GAAU,UAAAC,GAAU,UAAAC,EAAQ,CAAC,GAE5FO,EAAW,SAAS,QAAQ,CAAAtmC,MAAQ;AAAC,UAAIA,EAAK,SAAS,2BAC1DylC,EAAQ,KAAKzlC,GAAM;AAAA,YAClB,OAAO;AAAA,YACP,OAAO,CAACymC,GAAYC,GAAOC,MAAU;AACpC,mBAAK,MAAM,iBAAiB,QAAQF,GAAYC,GAAOC,GAAO,EAAC,YAAAL,GAAY,YAAAC,GAAY,YAAAC,EAAU,GAAG,EAAC,UAAAX,GAAU,UAAAC,GAAU,UAAAC,EAAQ,CAAC;AAAA,YACzI;AAAA,UACA,CAAM;AAAA,QACD,CAAC;AAAA,MACN;AAAA,IACA,CAAG;AAAA,EACH;AAAA,EAEC,YAAY9b,GAAK;AAChB,IAAAwb,EAAQ,KAAKxb,GAAK;AAAA,MACjB,OAAO;AAAA,MACP,OAAO,CAACjqB,GAAMoT,GAAMG,MAAS;AAC5B,YAAI/O,IAAUxE,EAAK,MAAM;AACzB,YAAK,EAAAA,EAAK,MAAM,SAAS,SAASwE,EAAQ,WAAW,OAAO,KAAOxE,EAAK,MAAM,SAAS,aAAawE,EAAQ,WAAW,QAAS,KAAKA,EAAQ,WAAW,QAAQ,KAEzJ;AACN,cAAIoiC,IAAOpiC,EAAQ,QAAQ,SAAS,EAAE,GAClCutB,IAAM,IAAI,IAAI6U,GAAM,KAAK,GAAG;AAChC,UAAA5mC,EAAK,MAAM,QAAQ+xB,EAAI,SAAU;AAAA,QACtC;AAAA,MACA;AAAA,IACA,CAAG;AAAA,EACH;AAAA,EAEC,SAAS9H,GAAKla,GAAI;AAGjB,IAAA01B,EAAQ,KAAKxb,GAAK;AAAA,MACjB,OAAO;AAAA,MACP,OAAO,CAACjqB,GAAMoT,GAAMG,MAAS;AAC5B,YAAI8a,IAAWruB,EAAK;AACpB,QAAAquB,EAAS,QAAQA,EAAS,WAAW;AAAA,UACpC,MAAM;AAAA,UACN,OAAO;AAAA,QACZ,CAAK,CAAC,GACFA,EAAS,QAAQA,EAAS,WAAW;AAAA,UACpC,MAAM;AAAA,UACN,MAAMte;AAAA,UACN,KAAK;AAAA,UACL,UAAU;AAAA,QACf,CAAK,CAAC;AAAA,MACN;AAAA,IACA,CAAG;AAAA,EACH;AAAA,EAEC,sBAAsBka,GAAK;AAC1B,QAAI4c,IAAqB,CAAE;AAC3B,WAAApB,EAAQ,KAAKxb,GAAK;AAAA,MACjB,OAAO;AAAA,MACP,OAAO,CAACjqB,GAAMoT,GAAMG,MAAS;AAC5B,QAAAkyB,EAAQ,KAAKzlC,GAAM;AAAA,UAClB,OAAO;AAAA,UACP,OAAO,CAACgtB,GAAaiZ,GAAOC,MAAU;AACrC,gBAAIlZ,EAAY,aAAa,QAAQ;AACpC,kBAAI9tB,IAAQ8tB,EAAY,MAAM,SAAS,MAAO,GAC1CpZ,IAAO1U,EAAM,MACbmhC,IAAWoF,EAAQ,SAASzlC,EAAK,OAAO;AAC5C,cAAA6mC,EAAmBjzB,CAAI,IAAI;AAAA,gBAC1B,MAAMA;AAAA,gBACN,UAAUysB;AAAA,cACV,GAKDrT,EAAY,WAAW,gBACvB9tB,EAAM,OAAO,cACbA,EAAM,OAAO;AAAA,YAEpB;AAAA,UACA;AAAA,QACA,CAAK;AAAA,MACL;AAAA,IACA,CAAG,GACM2nC;AAAA,EACT;AAAA,EAEC,WAAW5c,GAAK;AACf,IAAAwb,EAAQ,KAAKxb,GAAK;AAAA,MACjB,OAAO;AAAA,MACP,OAAO,CAACjqB,GAAMoT,GAAMG,MAAS;AAE5B,QAAAkyB,EAAQ,KAAKzlC,GAAM;AAAA,UAClB,OAAO;AAAA,UACP,OAAO,CAAC8mC,GAAQC,GAAQC,MAAW;AAClC,gBAAIpzB,IAAOkzB,EAAO;AAClB,YAAAA,EAAO,QAAQ,MACfA,EAAO,UAAU,KACjBA,EAAO,OAAO,EAAC,MAAM,cAAc,KAAK,MAAM,MAAM,UAAS,GAC7DA,EAAO,OAAO,qBACdA,EAAO,QAAQ,EAAC,MAAM,UAAU,KAAK,MAAM,OAAO,IAAIlzB,CAAI,IAAG;AAAA,UACnE;AAAA,QACA,CAAK;AAAA,MACL;AAAA,IACA,CAAG;AAAA,EACH;AAAA,EAEC,QAAQ5T,GAAMoT,GAAMG,GAAM;AAEzB,QAAI0zB,IAAU,CAAE;AAwBhB,IAvBAxB,EAAQ,KAAKzlC,GAAM;AAAA,MAClB,OAAO;AAAA,MACP,OAAO,CAACknC,GAAQC,GAAQC,MAAW;AAClC,QAAA3B,EAAQ,KAAKyB,GAAQ;AAAA,UACpB,OAAO;AAAA,UACP,OAAO,CAACG,GAAWC,GAAWC,MAAc;AAC3C,YAAAN,EAAQ,KAAKI,EAAU,IAAI;AAAA,UACjC;AAAA,QACA,CAAK;AAAA,MACL;AAAA,IACA,CAAG,GAGoB,CAAAJ,EAAQ,KAAK,CAAC3G,GAAOjhC,MAAU;AACnD,UAAImoC,IAAIlH;AACR,aAAIkH,MAAM,SACTA,IAAIP,EAAQ5nC,IAAQ,CAAC,GACd,EAAEmoC,MAAM,YAAYA,MAAM,aAEzBA,MAAM,YAAYA,MAAM;AAAA,IAEpC,CAAG,KAMD/B,EAAQ,KAAKzlC,GAAM;AAAA,MAClB,OAAO;AAAA,MACP,OAAO,CAACynC,GAASC,GAASC,MAAY;AACrC,YAAIf,IAAOa,EAAQ,MAAM,QAAQ,SAAS,EAAE,GAExCvoC,IADM,IAAI,IAAI0nC,GAAM,KAAK,GAAG,EAChB,SAAU;AAE1B,aAAK,SAAS,KAAK1nC,CAAK,GAGxBqU,EAAK,OAAOH,CAAI;AAAA,MACpB;AAAA,IACA,CAAG;AAAA,EACH;AAAA,EAEC,IAAI,KAAKw0B,GAAG;AACX,SAAK,QAAQA;AAAA,EACf;AAAA,EAEC,IAAI,OAAO;AACV,WAAO,KAAK;AAAA,EACd;AAAA;AAAA,EAGC,SAAS3d,GAAK;AACb,WAAOwb,EAAQ,SAASxb,KAAO,KAAK,GAAG;AAAA,EACzC;AACA;ACxTA,MAAe4d,KAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;A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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223]}